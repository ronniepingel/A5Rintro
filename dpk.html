<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tillämpad statistik med R</title>
  <meta name="description" content="Tillämpad statistik med R" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Tillämpad statistik med R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tillämpad statistik med R" />
  
  
  

<meta name="author" content="Ronnie Pingel och Valentin Zulj" />


<meta name="date" content="2020-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Tillämpad statistik med R</h1>
<p class="author"><em>Ronnie Pingel och Valentin Zulj</em></p>
<p class="date"><em>2020-12-01</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#introduktion"><span class="toc-section-number">1</span> Introduktion</a><ul>
<li><a href="#om-statistisk-programmering-med-r"><span class="toc-section-number">1.1</span> Om statistisk programmering med R</a></li>
<li><a href="#allmänna-tips-om-r-på-kursen"><span class="toc-section-number">1.2</span> Allmänna tips om R på kursen</a></li>
<li><a href="#sammanfattning"><span class="toc-section-number">1.3</span> Sammanfattning</a></li>
<li><a href="#referenser"><span class="toc-section-number">1.4</span> Referenser</a></li>
</ul></li>
<li><a href="#att-börja-använda-r"><span class="toc-section-number">2</span> Att börja använda R</a><ul>
<li><a href="#installation-av-r-och-rstudio"><span class="toc-section-number">2.1</span> Installation av R och RStudio</a><ul>
<li><a href="#installation-av-r-på-macos"><span class="toc-section-number">2.1.1</span> Installation av R på MacOS</a></li>
<li><a href="#installation-av-r-på-windows"><span class="toc-section-number">2.1.2</span> Installation av R på Windows</a></li>
</ul></li>
<li><a href="#installation-av-rstudio"><span class="toc-section-number">2.2</span> Installation av RStudio</a></li>
<li><a href="#första-sessionen"><span class="toc-section-number">2.3</span> Första sessionen</a></li>
<li><a href="#paket"><span class="toc-section-number">2.4</span> Paket</a></li>
<li><a href="#sammanfattning-1"><span class="toc-section-number">2.5</span> Sammanfattning</a></li>
<li><a href="#övningar"><span class="toc-section-number">2.6</span> Övningar</a><ul>
<li><a href="#övning-2.1">Övning 2.1</a></li>
<li><a href="#övning-2.2">Övning 2.2</a></li>
<li><a href="#övning-2.3">Övning 2.3</a></li>
<li><a href="#övning-2.4">Övning 2.4</a></li>
<li><a href="#övning-2.5">Övning 2.5</a></li>
<li><a href="#övning-2.6">Övning 2.6</a></li>
<li><a href="#övning-2.7">Övning 2.7</a></li>
<li><a href="#övning-2.8">Övning 2.8</a></li>
</ul></li>
</ul></li>
<li><a href="#data-objekt-och-funktioner"><span class="toc-section-number">3</span> Data, objekt och funktioner</a><ul>
<li><a href="#data-och-objekt"><span class="toc-section-number">3.1</span> Data och objekt</a></li>
<li><a href="#vektorer"><span class="toc-section-number">3.2</span> Vektorer</a><ul>
<li><a href="#vektorer-och-indexering"><span class="toc-section-number">3.2.1</span> Vektorer och indexering</a></li>
<li><a href="#vektorer-och-logiska-operatorer"><span class="toc-section-number">3.2.2</span> Vektorer och logiska operatorer</a></li>
</ul></li>
<li><a href="#matriser"><span class="toc-section-number">3.3</span> Matriser</a></li>
<li><a href="#data-frames"><span class="toc-section-number">3.4</span> Data frames</a></li>
<li><a href="#funktioner"><span class="toc-section-number">3.5</span> Funktioner</a></li>
<li><a href="#sammanfattning-2"><span class="toc-section-number">3.6</span> Sammanfattning</a></li>
<li><a href="#övningar-1"><span class="toc-section-number">3.7</span> Övningar</a><ul>
<li><a href="#övning-3.1">Övning 3.1</a></li>
<li><a href="#övning-3.2">Övning 3.2</a></li>
<li><a href="#övning-3.3">Övning 3.3</a></li>
<li><a href="#övning-3.4">Övning 3.4</a></li>
<li><a href="#övning-3.5">Övning 3.5</a></li>
<li><a href="#övning-3.6">Övning 3.6</a></li>
<li><a href="#övning-3.7">Övning 3.7</a></li>
<li><a href="#övning-3.8">Övning 3.8</a></li>
<li><a href="#övning-3.9">Övning 3.9</a></li>
<li><a href="#övning-3.10">Övning 3.10</a></li>
<li><a href="#övning-3.11">Övning 3.11</a></li>
<li><a href="#övning-3.12">Övning 3.12</a></li>
<li><a href="#övning-3.13">Övning 3.13</a></li>
<li><a href="#övning-3.14">Övning 3.14</a></li>
</ul></li>
</ul></li>
<li><a href="#läsa-in-och-spara-data"><span class="toc-section-number">4</span> Läsa in och spara data</a><ul>
<li><a href="#principer-för-organiserade-datamaterial"><span class="toc-section-number">4.1</span> Principer för organiserade datamaterial</a></li>
<li><a href="#working-directory"><span class="toc-section-number">4.2</span> Working directory</a></li>
<li><a href="#läsa-in-datamaterial-med-hjälp-av-kod"><span class="toc-section-number">4.3</span> Läsa in datamaterial med hjälp av kod</a><ul>
<li><a href="#text--och-csv-filer"><span class="toc-section-number">4.3.1</span> Text- och CSV-filer</a></li>
<li><a href="#excel-filer"><span class="toc-section-number">4.3.2</span> Excel-filer</a></li>
<li><a href="#övriga-format"><span class="toc-section-number">4.3.3</span> Övriga format</a></li>
</ul></li>
<li><a href="#läsa-in-datamaterial-med-hjälp-av-menyerna-i-rstudio"><span class="toc-section-number">4.4</span> Läsa in datamaterial med hjälp av menyerna i RStudio</a><ul>
<li><a href="#läsa-in-data-från-working-directory"><span class="toc-section-number">4.4.1</span> Läsa in data från working directory</a></li>
<li><a href="#läsa-in-data-med-import-dataset"><span class="toc-section-number">4.4.2</span> Läsa in data med “Import Dataset”</a></li>
</ul></li>
<li><a href="#spara-datamaterial-med-hjälp-av-r"><span class="toc-section-number">4.5</span> Spara datamaterial med hjälp av R</a></li>
<li><a href="#övningar-2"><span class="toc-section-number">4.6</span> Övningar</a><ul>
<li><a href="#övning-4.1">Övning 4.1</a></li>
<li><a href="#övning-4.2">Övning 4.2</a></li>
<li><a href="#övning-4.3">Övning 4.3</a></li>
</ul></li>
</ul></li>
<li><a href="#kategorivariabler"><span class="toc-section-number">5</span> Kategorivariabler</a><ul>
<li><a href="#en-binär-variabel"><span class="toc-section-number">5.1</span> En binär variabel</a><ul>
<li><a href="#kodning"><span class="toc-section-number">5.1.1</span> Kodning</a></li>
<li><a href="#tabeller-och-figurer"><span class="toc-section-number">5.1.2</span> Tabeller och figurer</a></li>
<li><a href="#inferens"><span class="toc-section-number">5.1.3</span> Inferens</a></li>
</ul></li>
<li><a href="#två-binära-variabler"><span class="toc-section-number">5.2</span> Två binära variabler</a><ul>
<li><a href="#tabeller"><span class="toc-section-number">5.2.1</span> Tabeller</a></li>
<li><a href="#kvantifiering-av-samband"><span class="toc-section-number">5.2.2</span> Kvantifiering av samband</a></li>
<li><a href="#figurer"><span class="toc-section-number">5.2.3</span> Figurer</a></li>
<li><a href="#inferens-1"><span class="toc-section-number">5.2.4</span> Inferens</a></li>
</ul></li>
<li><a href="#tre-kategorier-eller-fler"><span class="toc-section-number">5.3</span> Tre kategorier eller fler</a><ul>
<li><a href="#kodning-1"><span class="toc-section-number">5.3.1</span> Kodning</a></li>
<li><a href="#tabeller-och-figurer-1"><span class="toc-section-number">5.3.2</span> Tabeller och figurer</a></li>
<li><a href="#inferens-2"><span class="toc-section-number">5.3.3</span> Inferens</a></li>
</ul></li>
<li><a href="#samband-mellan-kategorivariabler"><span class="toc-section-number">5.4</span> Samband mellan kategorivariabler</a><ul>
<li><a href="#tabeller-och-figurer-2"><span class="toc-section-number">5.4.1</span> Tabeller och figurer</a></li>
<li><a href="#inferens-3"><span class="toc-section-number">5.4.2</span> Inferens</a></li>
</ul></li>
<li><a href="#övningar-3"><span class="toc-section-number">5.5</span> Övningar</a><ul>
<li><a href="#övning-5.1">Övning 5.1</a></li>
<li><a href="#övning-5.2">Övning 5.2</a></li>
<li><a href="#övning-5.3">Övning 5.3</a></li>
<li><a href="#övning-5.4">Övning 5.4</a></li>
<li><a href="#övning-5.5">Övning 5.5</a></li>
<li><a href="#övning-5.6">Övning 5.6</a></li>
<li><a href="#övning-5.7">Övning 5.7</a></li>
<li><a href="#övning-5.8">Övning 5.8</a></li>
<li><a href="#övning-5.9">Övning 5.9</a></li>
<li><a href="#övning-5.10">Övning 5.10</a></li>
<li><a href="#övning-5.11">Övning 5.11</a></li>
<li><a href="#övning-5.12">Övning 5.12</a></li>
<li><a href="#övning-5.13">Övning 5.13</a></li>
</ul></li>
<li><a href="#referenser-1"><span class="toc-section-number">5.6</span> Referenser</a></li>
</ul></li>
<li><a href="#kvantitativa-variabler-kommer-ej-uppdateras-ht20"><span class="toc-section-number">6</span> Kvantitativa variabler (Kommer ej uppdateras HT20)</a></li>
<li><a href="#tabeller-1"><span class="toc-section-number">7</span> Tabeller</a><ul>
<li><a href="#exportera-tabeller-till-html"><span class="toc-section-number">7.1</span> Exportera tabeller till html</a></li>
<li><a href="#några-vanliga-tabeller"><span class="toc-section-number">7.2</span> Några vanliga tabeller</a><ul>
<li><a href="#tabell-för-att-beskriva-urvalet"><span class="toc-section-number">7.2.1</span> Tabell för att beskriva urvalet</a></li>
</ul></li>
<li><a href="#principer-för-tabeller"><span class="toc-section-number">7.3</span> Principer för tabeller</a></li>
<li><a href="#paket-för-tabeller"><span class="toc-section-number">7.4</span> Paket för tabeller</a></li>
</ul></li>
<li><a href="#figurer-1"><span class="toc-section-number">8</span> Figurer</a><ul>
<li><a href="#grundläggande-figurhantering"><span class="toc-section-number">8.1</span> Grundläggande figurhantering</a></li>
<li><a href="#färger-och-figurer"><span class="toc-section-number">8.2</span> Färger och figurer</a><ul>
<li><a href="#presentation-av-aggregerade-data"><span class="toc-section-number">8.2.1</span> Presentation av aggregerade data</a></li>
</ul></li>
<li><a href="#cirkeldigram"><span class="toc-section-number">8.3</span> Cirkeldigram</a></li>
<li><a href="#figurer-för-fördelningar"><span class="toc-section-number">8.4</span> Figurer för fördelningar</a></li>
<li><a href="#lådagram"><span class="toc-section-number">8.5</span> Lådagram</a></li>
<li><a href="#spridningsdiagram"><span class="toc-section-number">8.6</span> Spridningsdiagram</a></li>
<li><a href="#exportera-figurer"><span class="toc-section-number">8.7</span> Exportera figurer</a></li>
</ul></li>
<li><a href="#urvalsmetoder"><span class="toc-section-number">9</span> Urvalsmetoder</a><ul>
<li><a href="#obundet-slumpmässigt-urval-utan-återläggning"><span class="toc-section-number">9.1</span> Obundet slumpmässigt urval utan återläggning</a><ul>
<li><a href="#inferens-för-populationsmedelvärdet-mu"><span class="toc-section-number">9.1.1</span> Inferens för populationsmedelvärdet, <span class="math inline">\(\mu\)</span></a></li>
<li><a href="#inferens-för-populationsandelen-p"><span class="toc-section-number">9.1.2</span> Inferens för populationsandelen, <span class="math inline">\(p\)</span></a></li>
<li><a href="#inferens-för-populationstotalen-tau"><span class="toc-section-number">9.1.3</span> Inferens för populationstotalen, <span class="math inline">\(\tau\)</span></a></li>
<li><a href="#beräkningar-av-stickprovstorlek"><span class="toc-section-number">9.1.4</span> Beräkningar av stickprovstorlek</a></li>
</ul></li>
<li><a href="#stratifierat-urval"><span class="toc-section-number">9.2</span> Stratifierat urval</a><ul>
<li><a href="#inferens-för-mu"><span class="toc-section-number">9.2.1</span> Inferens för <span class="math inline">\(\mu\)</span></a></li>
<li><a href="#inferens-för-p"><span class="toc-section-number">9.2.2</span> Inferens för <span class="math inline">\(p\)</span></a></li>
<li><a href="#inferens-för-tau"><span class="toc-section-number">9.2.3</span> Inferens för <span class="math inline">\(\tau\)</span></a></li>
<li><a href="#allokering-av-n"><span class="toc-section-number">9.2.4</span> Allokering av <span class="math inline">\(n\)</span></a></li>
</ul></li>
<li><a href="#gruppurval"><span class="toc-section-number">9.3</span> Gruppurval</a><ul>
<li><a href="#inferens-för-mu-1"><span class="toc-section-number">9.3.1</span> Inferens för <span class="math inline">\(\mu\)</span></a></li>
<li><a href="#inferens-för-tau-1"><span class="toc-section-number">9.3.2</span> Inferens för <span class="math inline">\(\tau\)</span></a></li>
<li><a href="#inferens-för-p-1"><span class="toc-section-number">9.3.3</span> Inferens för <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li><a href="#efterstratifiering"><span class="toc-section-number">9.4</span> Efterstratifiering</a></li>
<li><a href="#övningar-4"><span class="toc-section-number">9.5</span> Övningar</a><ul>
<li><a href="#övning-7.1">Övning 7.1</a></li>
<li><a href="#övning-7.2">Övning 7.2</a></li>
<li><a href="#övning-7.3">Övning 7.3</a></li>
<li><a href="#övning-7.4">Övning 7.4</a></li>
<li><a href="#övning-7.5">Övning 7.5</a></li>
<li><a href="#övning-7.6">Övning 7.6</a></li>
<li><a href="#övning-7.7">Övning 7.7</a></li>
<li><a href="#övning-7.8">Övning 7.8</a></li>
<li><a href="#övning-7.9">Övning 7.9</a></li>
<li><a href="#övning-7.10">Övning 7.10</a></li>
<li><a href="#övning-7.11">Övning 7.11</a></li>
<li><a href="#övning-7.12">Övning 7.12</a></li>
<li><a href="#övning-7.13">Övning 7.13</a></li>
<li><a href="#övning-7.14">Övning 7.14</a></li>
<li><a href="#övning-7.15">Övning 7.15</a></li>
<li><a href="#övning-7.16">Övning 7.16</a></li>
<li><a href="#övning-7.16-1">Övning 7.16</a></li>
<li><a href="#övning-7.17">Övning 7.17</a></li>
<li><a href="#övning-7.18">Övning 7.18</a></li>
<li><a href="#övning-7.19">Övning 7.19</a></li>
<li><a href="#övning-7.20">Övning 7.20</a></li>
<li><a href="#övning-7.21">Övning 7.21</a></li>
<li><a href="#övning-7.22">Övning 7.22</a></li>
<li><a href="#övning-7.23">Övning 7.23</a></li>
<li><a href="#övning-7.24">Övning 7.24</a></li>
<li><a href="#övning-7.25">Övning 7.25</a></li>
<li><a href="#övning-7.26">Övning 7.26</a></li>
<li><a href="#övning-7.27">Övning 7.27</a></li>
</ul></li>
</ul></li>
<li><a href="#experiment"><span class="toc-section-number">10</span> Experiment</a><ul>
<li><a href="#det-klassiska-experimentet"><span class="toc-section-number">10.1</span> Det klassiska experimentet</a><ul>
<li><a href="#randomiseringen"><span class="toc-section-number">10.1.1</span> Randomiseringen</a></li>
<li><a href="#balans-av-baslinjemätningar"><span class="toc-section-number">10.1.2</span> Balans av baslinjemätningar</a></li>
<li><a href="#analys"><span class="toc-section-number">10.1.3</span> Analys</a></li>
</ul></li>
<li><a href="#stratifiering"><span class="toc-section-number">10.2</span> Stratifiering</a></li>
<li><a href="#anova"><span class="toc-section-number">10.3</span> ANOVA</a></li>
<li><a href="#jämförelse-med-t-test"><span class="toc-section-number">10.4</span> Jämförelse med t-test</a></li>
<li><a href="#experimentella-designer"><span class="toc-section-number">10.5</span> Experimentella designer</a></li>
<li><a href="#aspekter-som-inte-ingår-i-detta-block"><span class="toc-section-number">10.6</span> Aspekter som inte ingår i detta block</a></li>
</ul></li>
<li><a href="#referenser-2"><span class="toc-section-number">11</span> Referenser</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tillämpad statistik med R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="introduktion" class="section level1">
<h1><span class="header-section-number">1</span> Introduktion</h1>
<p>Detta material utgör kurslitteratur till kursen Tillämpad statistik (A5). Observera att materialet kommer att utökas under kursens gång.</p>
<div id="om-statistisk-programmering-med-r" class="section level2">
<h2><span class="header-section-number">1.1</span> Om statistisk programmering med R</h2>
<p>På denna kurs arbetar vi med R, som är ett programspråk och en miljö för statistisk dataanalys (<a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a>) som fungerar på UNIX plattformar, Windows och MacOS. Det finns flera anledningar till att vi valt R:</p>
<ul>
<li>R är gratis och har en öppen källkod.</li>
<li>R ger tillgång till avancerade verktyg för dataanalys och datavisualisering.</li>
<li>Användare av R bidrar ofta med egen programkod och egna paket, vilket innebär att en omfattande mängd funktioner enkelt går att implementera.</li>
<li>Många läroböcker skrivs med utgångspunkt från R.</li>
<li>Online-resurserna är mycket stora. Det finns många forum där användare av R kan få hjälp (t ex <a href="https://stackoverflow.com/" class="uri">https://stackoverflow.com/</a>).</li>
<li>R är ett av de absolut vanligaste programmen för statistisk dataanalys. (<a href="http://r4stats.com/2019/04/01/scholarly-datasci-popularity-2019/" class="uri">http://r4stats.com/2019/04/01/scholarly-datasci-popularity-2019/</a>)</li>
</ul>
<p>Finns det anledningar till att inte välja R?</p>
<ul>
<li>Det finns ingen officiell support.</li>
<li>Eftersom R bygger på användarnas bidrag finns ingen garanti att funktioner fungerar som de ska.</li>
<li>Jämfört med andra programspråk kan R uppfattas som långsamt.</li>
</ul>
<p>För den som van vid menybaserade system (sk point-and-click) kan dessutom kodning uppfattas som en nackdel. Det finns emellertid <strong>etiska</strong> och <strong>praktiska</strong> skäl att lära sig programmera i statistikprogram (dvs att i kod skriva ange hur data ska hanteras och analyseras), och inte förlita sig på menyer. Programmering</p>
<ul>
<li>är nödvändig för att tillförlitligt upprepa (replikera) dataanalyser. På företag och på myndigheter ska kolleger kunna ta över datamaterial och tillhörande analyser och på nytt genomföra dessa med samma resultat. Samma sak gäller inom forskning, där andra forskare ska erhålla samma resultat givet samma data och analys. Notera att detta även gäller för dig själv, dvs det är inte ovanligt att som analytiker på nytt upprepa en analys.</li>
<li>spar tid för repetativa moment, t ex om många liknande analyser ska genomföras.<br />
</li>
<li>ger möjlighet till avancerade analyser samt frihet att utforma egna analyser.</li>
<li>bidrar till ökad förståelse för dataanalys.</li>
</ul>
<p>Kruxet? Statistisk programmering tar längre tid att lära sig jämfört med att lära sig menybaserad datahantering och analyser! Tabell 2.1 redovisar några reflektioner över ett antal vanliga statistikprogram.</p>
<table>
<caption>(#tab:unnamed-chunk-2)En jämförelse av några vanliga statistikprogram</caption>
<tbody>
<tr class="odd">
<td align="left">Minitab</td>
<td align="left">Mycket enkelt att lära sig. Används främst inom kvalitetskontroll i industri samt planering av randomiserade försök. Billigt. Begränsat urval av statistiska metoder</td>
</tr>
<tr class="even">
<td align="left">SPSS</td>
<td align="left">Enkelt att lära sig. Stor spridning bland samhällsvetare och utredare. Ganska stort urval av statistiska metoder som är organiserade på ett något rörigt sätt. Krånglig programkod.</td>
</tr>
<tr class="odd">
<td align="left">Stata</td>
<td align="left">Enkelt att lära sig och mycket enkel programkod. Spridning bland forskare inom ekonometri och epidemiologi. Stort urval av, även de senaste, statistiska metoderna</td>
</tr>
<tr class="even">
<td align="left">SAS</td>
<td align="left">Medelsvårt att lära sig, med en föråldrad programkod. Kan hantera stora dataset. Används av myndigheter, industri och forskare inom alla områden. Standard för läkemdelsbolag. Stort urval av statistiska metoder, men inte de allra senaste. Dyrt. Svårt att göra bra figurer.</td>
</tr>
<tr class="odd">
<td align="left">R</td>
<td align="left">Svårt att lära sig. Gratis. Flexibelt. Mycket stor spridning inom alla områden för dataanalys. Enkel programkod.</td>
</tr>
<tr class="even">
<td align="left">Python</td>
<td align="left">Mycket svårt att lära sig. Gratis. Flexibelt. Stor spridning inom maskininlärning och AI.</td>
</tr>
</tbody>
</table>
<p>Varför är inte Excel, Open Office Calc, Google Docs och andra kalkylprogram inkluderade i jämförelsen? SVaret är enkelt. Dessa är nämligen inga statistikprogram! Ofta saknas i sådana program viktiga statistiska funktioner och dessutom är den numeriska tillförlitligheten lägre än för konventionella statistiskprogram (Keeling, K. B., &amp; Pavur, R. J., 2011).</p>
</div>
<div id="allmänna-tips-om-r-på-kursen" class="section level2">
<h2><span class="header-section-number">1.2</span> Allmänna tips om R på kursen</h2>
<p>Det tar tid att lära sig R. Det kan även vara frustrerande, inte minst eftersom programmering är inte förlåtande vad gäller fel.
Men misströsta inte, i slutändan är det värt det och är i högsta grad tidsbesparande. Här följer några tips vad gäller inlärningen och användandet av R under kursens gång:</p>
<ul>
<li>Se till att snabbt få grunderna på plats. R kommer att användas löpande under kursens gång.</li>
<li>Arbeta aktivt med R. Programmering lär man sig genom tillämpning, inte genom att läsa. Det krävs normalt sett många timmar av aktivt arbete för att lära sig ett programspråk. Använd därför R till att lösa övningsuppgifter och att replikera exempel från föreläsningar. På så vis får du rutin vad gäller användandet av R.<br />
</li>
<li>Använd kod som presenterats på kursen. Ändra och laborera i färdig kod för att se vad som händer. Det är inte viktigt att kunna skriva all kod utantill, däremot ska man förstå skriven kod och kunna manipulera denna för sitt syfte.</li>
<li>Lös övningsuppgifter på följande vis: 1. Läs uppgiften och skissa därefter på papper upp en lösning, men gör inga beräkningar inte. Skriv ner antaganden och formler. 2. Lös sedan uppgiften med hjälp av beräkningar i R. Om du fastnar, studera R-koden i lösningsförslaget förstå hur hur uppgiften har lösts med hjälp R alternativt använd kod som presenterats på kursen. 3. Räkna därefter igenom uppgiften för hand. När du känner dig helt trygg med att räkna för hand kan du så småningom hoppa över detta moment. 4. Fyll i din papperslösning och avsluta med ett svar.</li>
<li>Var inte rädd för att använda resurser på nätet. Se ovan.</li>
<li>Kontakta lärare och lärarassistenter på kursen om ni fastnar och har frågor. Utnyttja de lärarledda sessionerna.</li>
<li>Samarbeta och diskutera i de diskussionsforum som skapats för er studenter.</li>
</ul>
<p>På denna kurs rekommenderas att ni <strong>endast skriver kod på det sätt som det presenteras på kursen</strong>. Visserligen är R oerhört flexibelt och en uppgift går att lösa på en mängd sätt. Koden som presenteras på kursen är emellertid framtagen för att vara tydlig och tillförlitlig och syftet är att du ska bli trygg med att beräkningarna är korrekta snarare än effektiva.</p>
<p>Slutligen, så är det bra att som läsare ha i åtanke att all beskrivning av kodens funktionalitet inte är uttömmande. Syftet är nämligen att lära ut vad som är nödvändigt för denna kurs och då behövs inte en fullständig beskrivning av till exempel vad ett verktyg i R kan göra.</p>
<p>Lycka till!</p>
<hr />
<p><img src="docs/images/important.png" width="5%" /></p>
</div>
<div id="sammanfattning" class="section level2">
<h2><span class="header-section-number">1.3</span> Sammanfattning</h2>
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> </font>
Du ska kunna</p>
<ul>
<li>motivera varför statistisk programmering är nödvändig för arbete med data och dataanalyser.</li>
</ul>
</div>
<hr />
</div>
<div id="referenser" class="section level2">
<h2><span class="header-section-number">1.4</span> Referenser</h2>
<p>Keeling, K. B., &amp; Pavur, R. J. (2011). Statistical accuracy of spreadsheet software. The American Statistician, 65(4), 265-273.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="att-börja-använda-r" class="section level1">
<h1><span class="header-section-number">2</span> Att börja använda R</h1>
<p>I detta kapitel ska du inledningsvis installera R samt ett gränssnitt som kallas för RStudio. RStudio kan liknas vid en avancerad textredigerare som underlättar arbetet med R. Det går visserligen alldeles utmärkt att använda R som det är, men RStudio förenklar i många avseenden programmeringen.</p>
<div id="installation-av-r-och-rstudio" class="section level2">
<h2><span class="header-section-number">2.1</span> Installation av R och RStudio</h2>
<p>Vid programmering är det mycket viktigt att noga följa instruktioner. Du ska nu <strong>först</strong> installera R.
<strong>Därefter</strong> ska du installera RStudio.</p>
<div id="installation-av-r-på-macos" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Installation av R på MacOS</h3>
<ol style="list-style-type: decimal">
<li>Ladda ner den senaste versionen från <a href="https://cran.r-project.org/bin/macosx/" class="uri">https://cran.r-project.org/bin/macosx/</a>.</li>
</ol>
<p>Notera att versionen
måste passa för ditt MacOS. Leta upp den version som passar till ditt MacOS
om du har en äldre Mac.</p>
<ol start="2" style="list-style-type: decimal">
<li>Ladda ner pkg-filen under <em>Latest release</em>. Öppna den nedladdade .pkg-filen och installera R.</li>
</ol>
</div>
<div id="installation-av-r-på-windows" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Installation av R på Windows</h3>
<ol style="list-style-type: decimal">
<li><p>Gå till hemsidan <a href="https://cran.r-project.org/bin/windows/base/" class="uri">https://cran.r-project.org/bin/windows/base/</a>.</p></li>
<li><p>Klicka på ‘’Download R (versionnummer) for Windows’’. Eventuellt fungerar inte den senaste versionen ditt Window om du har en äldre Windows-versions. Prova då en tidigare version av R. Du kanske även upptäcker att senaste versionnummer på Rs hemsida inte är samma som används i detta exempel eftersom det kan ha kommit senare versioner. För din del saknar just detta praktisk betydelse.</p></li>
</ol>
<p><img src="docs/images/installR.png" width="70%" /></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Dubbelklicka på ‘’R installer’’ för att starta installationen.</p></li>
<li><p>Välj språk och tryck <strong>OK</strong>.</p></li>
</ol>
<p><img src="docs/images/languageR.png" width="70%" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Välj <strong>Next</strong>.</li>
</ol>
<p><img src="docs/images/licenseR.png" width="70%" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Välj sökväg för din installation. Låt default vara. Klicka <strong>Next</strong>.</li>
</ol>
<p><img src="docs/images/destinationR.png" width="70%" /></p>
<ol start="7" style="list-style-type: decimal">
<li>För att förenkla, välj alla komponenter för installation. Klicka <strong>Next</strong>.</li>
</ol>
<p><img src="docs/images/componentsR.png" width="70%" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Klicka <strong>No (accept defaults)</strong>.</li>
</ol>
<p><img src="docs/images/customizeR.png" width="80%" /></p>
<ol start="9" style="list-style-type: decimal">
<li>För att lägga till R i Startmenyn, klicka bort kryssrutan nedan. Klicka <strong>Next</strong>.</li>
</ol>
<p><img src="docs/images/startmenuR.png" width="70%" /></p>
<ol start="10" style="list-style-type: decimal">
<li>Välj om du vill ha genvägar. Klicka <strong>Next</strong>.</li>
</ol>
<p><img src="docs/images/tasksR.png" width="80%" /></p>
<ol start="11" style="list-style-type: decimal">
<li>Installation börjar! Starta R när den är klar.</li>
</ol>
<p><img src="docs/images/installingR.png" width="70%" /></p>
<ol start="12" style="list-style-type: decimal">
<li>Starta R för första gången.
På Windows ser det ut så här.</li>
</ol>
<p><img src="docs/images/firstR.PNG" width="70%" /></p>
<p><img src="docs/images/firstR2.PNG" width="70%" /></p>
</div>
</div>
<div id="installation-av-rstudio" class="section level2">
<h2><span class="header-section-number">2.2</span> Installation av RStudio</h2>
<p>Av olika anledningar väljer vi att inte arbeta i R Editor utan vi väljer RStudio. Stäng därför ner R.</p>
<ol style="list-style-type: decimal">
<li>Gå till <a href="https://rstudio.com/products/rstudio/download/" class="uri">https://rstudio.com/products/rstudio/download/</a>}.
2 Välj RStudio Desktop Free.
3 Välj sedan den version stämmer överens med ditt operativsystem.</li>
<li>Installera (på Windows) genom att klicka <strong>Next-&gt;Next-&gt;Install</strong></li>
<li>Starta RStudio.</li>
</ol>
<p>Du ska nu fått upp nedanstående. Vi ska i detalj beskriva vad de olika panelerna till höger kommer vi återkomma till när det är aktuellt.</p>
<p><img src="docs/images/Rstudio1.png" width="80%" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Avsluta RStudio.</li>
</ol>
<p><img src="docs/images/tip.png" width="5%" /></p>
<p>Om du mot förmodan inte skulle lyckas installera R och RStudio, så finns möjligheten att koppla upp sig till Statistiska institutionens datorer via fjärrskrivbordet och på så sätt få tillgång nödvändig programvara.</p>
</div>
<div id="första-sessionen" class="section level2">
<h2><span class="header-section-number">2.3</span> Första sessionen</h2>
<p>I denna session ska du bekanta dig med R och prova använda R som en miniräknare. Starta RStudio. Till vänster ska du ha en panel som heter <strong>Console</strong>. I denna panel redovisas resultat. Vad övriga paneler gör kommer vi återkomma till när det blir aktuellt. Välj i menyn <strong>File &gt; New File &gt; R Script</strong>. Ett nytt fönster (Untitled1) öppnas ovanför <strong>Console</strong></p>
<p><img src="docs/images/Rstudio2.PNG" width="80%" /></p>
<p>Detta är ett script-fönster eller en <strong>editor</strong>. I editorn skrivs kommandon in som sedan kan utvärderas av R. Resultaten redovisas i <strong>Console</strong>. Ha för vana att <strong>aldrig</strong> skriva kod direkt i R Console. I princip är en script-fil inte annorlunda än en vanlig textfil, förutom att filen har tillägget <em>.R</em>. Spara script med jämna mellanrum eftersom det är önskvärt att inte förlora sin kod ifall något oförutsett händer. Skapa därför en mapp med namnet <strong>A5Rkod</strong> på din dator. Välj <strong>File &gt; Save As…</strong> och spara i <strong>A5Rkod</strong> scriptet <strong>Untitled</strong> med namnet <strong>myfirstscript.R</strong>.</p>
<p>Efter att vi har skrivit koden i editorn måste vi meddela R att koden ska utvärderas. Kod i scriptfilen körs (exekveras) på tre olika sätt:</p>
<ol style="list-style-type: decimal">
<li>En rad: Raden där markören är placerad körs med Ctrl+Enter (command + Enter på Mac) eller Run ovanför scriptet.</li>
<li>Flera rader: Markera kodavsnittet och tryck Ctrl+Enter (command + Enter på Mac) eller Run.</li>
<li>Hela scriptet: Ctrl+Shift+Enter</li>
</ol>
<p>Det finns några viktiga punkter att ha i åtanke:</p>
<ul>
<li>Om avsikten är att köra kod som sträcker
sig över flera rader måste man avsluta raden med räknetecken <span class="math inline">\((+,-,*,/)\)</span>, kommatecken <span class="math inline">\(,\)</span> eller vänsterparentes <span class="math inline">\((\)</span>.</li>
<li>En rad inleds aldrig med räknetecken eller kommatecken.</li>
<li>En rad som inleds med <strong>#</strong> exekveras inte. Tecknet <strong>#</strong> används för att kommentera koden, vilket viktigt eftersom vi då i text kan förklara vad koden gör.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Skriv in nedanstående script till <strong>myfirstscript.R</strong>. Spara.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Detta är mitt första R-script som heter myfirstscript.R. </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># I detta script använder jag R som miniräknare samt </span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># exekverar kod från scriptet.</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="dv">1</span><span class="op">+</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="dv">2-7</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="dv">2</span><span class="op">*</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="dv">4</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="dv">3</span><span class="op">^</span><span class="dv">2</span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Använd R som miniräknare genom att prova alla <strong>tre</strong> sätt att köra kod. Det är nödvändigt att bekanta sig med hur kod körs för att bli bekväm med att simultant arbeta i script-fönstret och se resultat i Console. Återigen, skriv <strong>aldrig</strong> i Console.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-2" title="2">[<span class="dv">1</span>] <span class="dv">2</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="dv">1</span><span class="op">+</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb2-4" title="4">[<span class="dv">1</span>] <span class="dv">4</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="dv">2-7</span></a>
<a class="sourceLine" id="cb2-6" title="6">[<span class="dv">1</span>] <span class="dv">-5</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dv">2</span><span class="op">*</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb2-8" title="8">[<span class="dv">1</span>] <span class="dv">6</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="dv">4</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-10" title="10">[<span class="dv">1</span>] <span class="fl">0.8</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="dv">3</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-12" title="12">[<span class="dv">1</span>] <span class="dv">9</span></a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Matematiska funktioner, t ex kvadratroten, finns implementerade i R. Skriv <code>sqrt(6)</code> i scriptet och spara. Kör koden och erhåll följande i Console.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">sqrt</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">[<span class="dv">1</span>] <span class="fl">2.44949</span></a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Även exponentialfunktionen <span class="math inline">\(\exp(x)\)</span> finns i R. Skriv <code>exp(3)</code> i script-filen, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">exp</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">[<span class="dv">1</span>] <span class="fl">20.08554</span></a></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Konstanten <span class="math inline">\(\pi\)</span> finns i R. Skriv <code>pi</code> i script-filen, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">pi</a>
<a class="sourceLine" id="cb5-2" title="2">[<span class="dv">1</span>] <span class="fl">3.141593</span></a></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Kod finns ofta på flera rader. Anta att vi önskar beräkna <span class="math inline">\(2 + 2+ 3+ 5\)</span> men att koden inte får plats på en rad utan måste delas upp på två rader. Skriv in följande rader i scriptet, spara, markera bägge raderna och kör.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Kod över 2 rader</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<p>Följande resultat ska presenteras i Console.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Kod över 2 rader</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb7-4" title="4">[<span class="dv">1</span>] <span class="dv">12</span></a></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Kod finns ofta på flera rader. Skriv in följande rader i scriptet, spara, markera bägge raderna och kör. Jämför resultatet med punkt 6!</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb8-2" title="2"><span class="op">+</span><span class="st">  </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<p>Nu utvärderas raderna var för sig, vilket inte var avsikten med analysen.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb9-2" title="2">[<span class="dv">1</span>] <span class="dv">4</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="op">+</span><span class="st">  </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb9-4" title="4">[<span class="dv">1</span>] <span class="dv">8</span></a></code></pre></div>
<p><strong>Grattis!</strong> Du har nu genomfört din första session i R. Scriptet ska se ut enligt nedan. Spara och stäng R.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Detta är mitt första R-script som heter myfirstscript.R. </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># I detta script använder jag R som miniräknare samt </span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co"># exekverar kod från scriptet.</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="dv">1</span><span class="op">+</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="dv">2-7</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="dv">2</span><span class="op">*</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="dv">4</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="dv">3</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co"># Kvadratroten</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">sqrt</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co"># Exponentialfunktionen </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="kw">exp</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co"># Pi </span></a>
<a class="sourceLine" id="cb10-15" title="15">pi</a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co"># Kod över 2 rader</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb10-20" title="20"><span class="op">+</span><span class="st">  </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a></code></pre></div>
</div>
<div id="paket" class="section level2">
<h2><span class="header-section-number">2.4</span> Paket</h2>
<p>En viktig styrka med R är det stora antalet tillgängliga paket utvecklade av användare. Grundinstallationen av R är nämligen tämligen begränsad vad gäller funktionalitet, men med alla paket utvidgas den statistiska verktygslådan, de grafiska möjligheterna och förmågan att hantera olika typer av data rejält. Det finns ungefär 15000 paket på “The Comprehensive R Archive Network” (CRAN) som är Rs arkiv för paket:</p>
<p><a href="https://cran.r-project.org/web/packages/available_packages_by_name.html" class="uri">https://cran.r-project.org/web/packages/available_packages_by_name.html</a></p>
<p>Det finns ytterligare tusentals andra paket som dock inte genomgått samma granskning som paketen på CRAN, till exempel på github. Eftersom antalet paket är överväldigande för nybörjaren kan det vara ett stöd att känna till de vanligaste paketen. Ett förslag på en lista över viktiga paket finns här:</p>
<p><a href="https://support.rstudio.com/hc/en-us/articles/201057987-Quick-list-of-useful-R-packages" class="uri">https://support.rstudio.com/hc/en-us/articles/201057987-Quick-list-of-useful-R-packages</a></p>
<p>För att installera ett paket skriver man in paketnamnet med ett kommando alternativt använda menyn i RStudio under *Tools &gt; Install Packages**.</p>
<p>Vi exemplifierar nu med ett paket som hjälper oss att läsa data från Excel-filer. Funktionalitet för inläsning från Excel-filer finns inte i basversionen av R, därför är detta paket nödvändigt om data är sparat i en Excelfil.</p>
<p>Vi installerar paketet <strong>readxl</strong> genom att i Console skriva in <code>install.packages("readxl")</code> och trycka enter.
Som tidigare nämnt går det även att installera paket via menyn.
Efter installationen finns paketet sparat på din dator. R har emellertid inte ännu aktiverat det. Genom att skriva <code>library("readxl")</code> och trycka enter aktiveras paketet.
Nu kan analyser i R utnyttja paketets funktionalitet.</p>
<p>Observera att ett paket måste aktiveras på nytt varje gång RStudio öppnas. Dock behövs det bara installeras en enda gång.</p>
<hr />
</div>
<div id="sammanfattning-1" class="section level2">
<h2><span class="header-section-number">2.5</span> Sammanfattning</h2>
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> </font>
Du ska kunna</p>
<ul>
<li>installera R och Rstudio och starta det utan felmeddelanden.</li>
<li>använda R som miniräknare och använda de olika metoderna för att exekvera kod i editorn.</li>
<li>installera ett R-paket och aktivera det.</li>
</ul>
</div>
<hr />
</div>
<div id="övningar" class="section level2">
<h2><span class="header-section-number">2.6</span> Övningar</h2>
<div id="övning-2.1" class="section level3 unnumbered">
<h3>Övning 2.1</h3>
<p>Du har ett stickprov betående av observationerna <span class="math inline">\(4,-2,5,6,8\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna medelvärdet.</li>
<li>Beräkna standardavvikelsen.</li>
<li>Beräkna variationsbredden.</li>
<li>Beräkna det geometriska medelvärdet för de positiva värden <span class="math inline">\(4, 5, 6, 8\)</span>.</li>
<li>Beräkna det geometriska medelvärdet för alla värden <span class="math inline">\(4, -2, 5, 6, 8\)</span>.</li>
</ol>
<button title="q201" type="button" onclick="if(document.getElementById(&#39;q201&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q201&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q201&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q201" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li>Medelvärdet <span class="math inline">\(\bar{x}\)</span> beräknas i R i editorn med</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span></a></code></pre></div>
<p>vilket i Console ger svaret</p>
<pre><code>## [1] 4.2</code></pre>
<ul>
<li>Svar: Medelvärdet är 4.2</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Standardavvikelsen <span class="math inline">\(s\)</span> beräknas i R i editorn antingen genom att direkt tillämpa formeln för stickprovets standardavvikelse</li>
</ol>
<p><span class="math display">\[s=\sqrt{\dfrac{\sum_{i=1}^n (x_i -\bar{x})^2}{n-1}}\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">sqrt</span>( ( ( <span class="dv">4</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span> )<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">      </span>( (<span class="op">-</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span> )<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">      </span>( <span class="dv">5</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span> )<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">      </span>( <span class="dv">6</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span> )<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">      </span>( <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span> )<span class="op">^</span><span class="dv">2</span> ) <span class="op">/</span><span class="st"> </span>(<span class="dv">5-1</span>) )</a></code></pre></div>
<p>eller genom att använda beräkningsformeln <span class="math display">\[s=\sqrt{\dfrac{\sum_{i=1}^{n}x_i ^2 - (\sum_{i=1}^n x_i)^2/n}{n-1}}\]</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">sqrt</span>( ( <span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span> )<span class="op">/</span><span class="st"> </span>(<span class="dv">5-1</span>) )</a></code></pre></div>
<p>Oavsett formel erhålls i Console svaret</p>
<pre><code>## [1] 3.768289</code></pre>
<ul>
<li>Svar: Standardavvikelsen är 3.768</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Variationsbredden, dvs skillnaden mellan det största och det minsta värdet är</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="dv">8</span> <span class="op">-</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<ul>
<li>Svar: Variationsbredden är är 10.</li>
</ul>
<ol start="4" style="list-style-type: lower-alpha">
<li>Det geometriska medelvärdet <span class="math display">\[\bar{x}_g=(x_1\cdot x_2 \cdot \cdots \cdot x_n)^{1/n}\]</span> kan i R beräknas med</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">(<span class="dv">4</span>  <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 5.566315</code></pre>
<ul>
<li>Svar: Det geometriska medelvärdet är 3.95.</li>
</ul>
<ol start="5" style="list-style-type: lower-alpha">
<li>Det geometriska medelvärdet <span class="math display">\[\bar{x}_g=(x_1\cdot x_2 \cdot \cdots \cdot x_n)^{1/n}\]</span> kan i R beräknas med</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">(<span class="dv">4</span>  <span class="op">*</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<ul>
<li>Svar: Eftersom en observation är negativ blir NaN, vilket betyder ‘’Not a Number’’. Det går alltså inte att beräkna.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.2" class="section level3 unnumbered">
<h3>Övning 2.2</h3>
<p>Ett slumpmässigt urval ger följande observationer <span class="math inline">\(0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1\)</span>,där <span class="math inline">\(1=Arbetslös\)</span> och <span class="math inline">\(0=Förvärvsarbetande\)</span>.
Beräkna andelen arbetslösa i stickprovet.</p>
<button title="q202" type="button" onclick="if(document.getElementById(&#39;q202&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q202&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q202&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q202" style="display:none">
<div class="alert alert-info">
<p>Andelen arbetslösa beräkna i R med</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="dv">13</span> </a></code></pre></div>
<pre><code>## [1] 0.3846154</code></pre>
<ul>
<li>Svar: Andelen arbetslösa i stickprovet är 0.38.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.3" class="section level3 unnumbered">
<h3>Övning 2.3</h3>
<p>Kosumentpriset 2006-2011 är</p>
<table>
<caption>(#tab:unnamed-chunk-37)Konsumentprisindex (KPI) 2006-2011</caption>
<tbody>
<tr class="odd">
<td align="right">2006</td>
<td align="right">284.2</td>
</tr>
<tr class="even">
<td align="right">2007</td>
<td align="right">290.5</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">300.6</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="right">299.7</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">303.5</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">311.4</td>
</tr>
</tbody>
</table>
<p>Med hur många procent har prisnivån förändrats från 2007 till 2010?</p>
<button title="q203" type="button" onclick="if(document.getElementById(&#39;q203&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q203&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q203&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q203" style="display:none">
<div class="alert alert-info">
<p>Beräkning i R ger</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="fl">303.46</span><span class="op">/</span><span class="fl">290.51</span></a></code></pre></div>
<pre><code>## [1] 1.044577</code></pre>
<ul>
<li>Svar: Prisnivån har ökat med 4.5%.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.4" class="section level3 unnumbered">
<h3>Övning 2.4</h3>
<p>Denna övningar handlar om potentslagarna. Då <span class="math inline">\(x\)</span> och <span class="math inline">\(y\)</span> är reella och <span class="math inline">\(a,b&gt;0\)</span> gäller följande likheter:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(a^x\cdot a^y=a^{x+y}\)</span></li>
<li><span class="math inline">\((a^x)^y=a^{xy}\)</span></li>
<li><span class="math inline">\(\left(\frac{a}{b}\right)^x=\frac{a^x}{b^x}\)</span></li>
<li><span class="math inline">\(\frac{a^x}{a^y}=a^{x-y}\)</span></li>
<li><span class="math inline">\(a^x \cdot b^x=(ab)^x\)</span></li>
<li><span class="math inline">\(a^0=1\)</span></li>
</ol>
<p>Beräkna nedanstående uttryck relatera svaren till potenslagarna.</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(4^2 + 4^3\)</span></li>
<li><span class="math inline">\(4^2*4^3\)</span></li>
<li><span class="math inline">\(4^5\)</span></li>
<li><span class="math inline">\((4^2)^3\)</span></li>
<li><span class="math inline">\(4^15\)</span></li>
<li><span class="math inline">\(4^2/4^3\)</span></li>
<li><span class="math inline">\(4^{-1}\)</span></li>
<li><span class="math inline">\(4^{-2}\)</span></li>
<li><span class="math inline">\(1/(4^2)\)</span></li>
<li><span class="math inline">\(1/16\)</span></li>
<li><span class="math inline">\(3^4*4^4\)</span></li>
<li><span class="math inline">\(12^4\)</span></li>
</ol>
<button title="q204" type="button" onclick="if(document.getElementById(&#39;q204&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q204&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q204&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q204" style="display:none">
<div class="alert alert-info">
<p>I R kan uttrycken enkelt beräknas.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb26-2" title="2">[<span class="dv">1</span>] <span class="dv">80</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="dv">4</span><span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb26-4" title="4">[<span class="dv">1</span>] <span class="dv">1024</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="dv">4</span><span class="op">^</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb26-6" title="6">[<span class="dv">1</span>] <span class="dv">1024</span></a>
<a class="sourceLine" id="cb26-7" title="7">(<span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb26-8" title="8">[<span class="dv">1</span>] <span class="dv">4096</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="dv">4</span><span class="op">^</span><span class="dv">15</span></a>
<a class="sourceLine" id="cb26-10" title="10">[<span class="dv">1</span>] <span class="dv">1073741824</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="dv">4</span><span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb26-12" title="12">[<span class="dv">1</span>] <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="dv">4</span><span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb26-14" title="14">[<span class="dv">1</span>] <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="dv">4</span><span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>}</a>
<a class="sourceLine" id="cb26-16" title="16">[<span class="dv">1</span>] <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="dv">1</span><span class="op">/</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-18" title="18">[<span class="dv">1</span>] <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="dv">1</span><span class="op">/</span><span class="dv">16</span></a>
<a class="sourceLine" id="cb26-20" title="20">[<span class="dv">1</span>] <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb26-21" title="21"><span class="dv">3</span><span class="op">^</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span><span class="op">^</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb26-22" title="22">[<span class="dv">1</span>] <span class="dv">20736</span></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="dv">12</span><span class="op">^</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb26-24" title="24">[<span class="dv">1</span>] <span class="dv">20736</span></a></code></pre></div>
<p>Vi ser att för <span class="math inline">\(b= c\)</span> pga 1. <span class="math inline">\(d= e\)</span> pga 2. <span class="math inline">\(k=l\)</span> pga 5. Vidare gäller…</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.5" class="section level3 unnumbered">
<h3>Övning 2.5</h3>
<p>Den naturliga logaritmen, dvs logaritmen med
basen <span class="math inline">\(e \approx 2.718282\)</span>, används ofta i statistiska beräkningar. Några logaratimlagar som gäller för naturliga logaritmen är:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\ln\, \left (x\cdot y \right )=\ln\,x+\ln\,y\)</span></li>
<li><span class="math inline">\(\ln\, \left (x/ y \right )=\ln\,x-\ln\,y\)</span></li>
<li><span class="math inline">\(\ln\,x^{a}=a\cdot \ln\,x\)</span></li>
<li><span class="math inline">\(\ln e = 1\)</span></li>
<li><span class="math inline">\(e^{\ln x} = x\)</span></li>
<li><span class="math inline">\(\ln^{e^x} = x\)</span></li>
</ol>
<p>Beräkna nedanstående uttryck och relatera svaren till logaritmlagarna</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(\ln(3*4)\)</span></li>
<li><span class="math inline">\(\ln(3) + \ln(4)\)</span></li>
<li><span class="math inline">\(\ln(3/4)\)</span></li>
<li><span class="math inline">\(\ln(3) - \ln(4)\)</span></li>
<li><span class="math inline">\(\ln e\)</span></li>
<li><span class="math inline">\(\ln e^5\)</span></li>
<li><span class="math inline">\(e^{5+6}\)</span></li>
<li><span class="math inline">\(e^5*e^6\)</span></li>
<li>$5 5 + 6 6</li>
</ol>
<button title="q205" type="button" onclick="if(document.getElementById(&#39;q205&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q205&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q205&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q205" style="display:none">
<div class="alert alert-info">
<p>I R kan uttrycken enkelt beräknas.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">log</span>(<span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb27-2" title="2">[<span class="dv">1</span>] <span class="fl">2.484907</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">log</span>(<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb27-4" title="4">[<span class="dv">1</span>] <span class="fl">2.484907</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="kw">log</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb27-6" title="6">[<span class="dv">1</span>] <span class="fl">-0.2876821</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="kw">log</span>(<span class="dv">3</span>) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb27-8" title="8">[<span class="dv">1</span>] <span class="fl">-0.2876821</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb27-10" title="10">[<span class="dv">1</span>] <span class="dv">1</span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb27-12" title="12">[<span class="dv">1</span>] <span class="dv">5</span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="kw">exp</span>(<span class="dv">5</span><span class="op">+</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb27-14" title="14">[<span class="dv">1</span>] <span class="fl">59874.14</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="kw">exp</span>(<span class="dv">5</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb27-16" title="16">[<span class="dv">1</span>] <span class="fl">59874.14</span></a>
<a class="sourceLine" id="cb27-17" title="17"><span class="dv">5</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">6</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb27-18" title="18">[<span class="dv">1</span>] <span class="fl">18.79775</span></a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.6" class="section level3 unnumbered">
<h3>Övning 2.6</h3>
<p>Låt observationerna <span class="math inline">\(4,-2,5,6,8\)</span> vara obundet slumpmässigt urval från en normalfördelad population. Genomför en hypotesprövning på 5% signifikansnivå för att testa medelvärdet i population är skild från 1.</p>
<button title="q206" type="button" onclick="if(document.getElementById(&#39;q206&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q206&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q206&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q206" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: decimal">
<li>Vi observerar <span class="math inline">\(x=\{4,-2,5,6,8\}.\)</span></li>
<li>Hypoteser: <span class="math inline">\(H_0:\mu=0\)</span> vs <span class="math inline">\(H_1:\mu \neq 0\)</span></li>
<li>Antaganden: Variabeln <span class="math inline">\(x\)</span> är normalfördelad i populationen. Populationsvariansen <span class="math inline">\(\sigma^2\)</span> är okänd i populationen. Vi har ett litet stickprov, <span class="math inline">\(n=5\)</span>.</li>
<li>Testfunktionen ges av <span class="math inline">\(t=\dfrac{\bar{x}-\mu}{\sqrt{s^2/n}}\)</span>. Denna teststatistika är <span class="math inline">\(t\)</span>-fördelad med <span class="math inline">\(n-1\)</span> frihetsgrader om nollhypotesen är sann.</li>
<li>Beslutregel: <span class="math inline">\(\alpha=0.05\)</span>. Tvåsidigt test, förkasta därför <span class="math inline">\(H_0\)</span> om <span class="math inline">\(|t_{obs}| &gt; t_{krit} = t_{4,\alpha/2=0.025} = 2.776\)</span></li>
</ol>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">( (<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">/</span><span class="dv">5</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> )<span class="op">/</span><span class="kw">sqrt</span>( ( <span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span> )<span class="op">/</span><span class="st"> </span>(<span class="dv">5-1</span>)<span class="op">/</span><span class="dv">5</span> )</a>
<a class="sourceLine" id="cb28-2" title="2">[<span class="dv">1</span>] <span class="fl">1.898851</span></a></code></pre></div>
<p>Eftersom <span class="math inline">\(t_{obs}=\)</span> 1.8988507 <span class="math inline">\(&lt; 2.776 = t_{krit}\)</span> kan vi inte förkasta nollhypotesen.</p>
<ul>
<li>Svar: Vi kan på 5% signifikansnivå inte påvisa att medelvärdet i populationen är skilt från 1. Notera att detta <strong>inte</strong> innebär att vi visar att medelvärdet är 1.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.7" class="section level3 unnumbered">
<h3>Övning 2.7</h3>
<p>Du observerar följande datapunkter <span class="math inline">\(x = \{4,7,2,4,6\}\)</span> och $y={7,3, 2, 5,6}$.</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<ol style="list-style-type: lower-alpha">
<li>Använd minsta-kvadratmetoden och beräkna koefficienterna <span class="math inline">\(a\)</span> och <span class="math inline">\(b\)</span> i regressionslinjen <span class="math inline">\(y=a + bx\)</span>.</li>
<li>Använd koefficienterna och ge en prediktion för <span class="math inline">\(y\)</span> givet att <span class="math inline">\(x=7\)</span>.</li>
<li>Beräkna residualen för <span class="math inline">\(x=7\)</span></li>
<li>Beräkna residualspridningen.</li>
</ol>
<button title="q207" type="button" onclick="if(document.getElementById(&#39;q207&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q207&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q207&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q207" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li>Riktningskoefficienten ges av
<span class="math display">\[b=\dfrac{\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^n(x_i - \bar{x})^2}\]</span></li>
</ol>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># Direkt tillämpning av formeln ger </span></a>
<a class="sourceLine" id="cb29-2" title="2">( (<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">7</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span>(<span class="dv">7</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span>(<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="st">  </span>(<span class="dv">6</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">6</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>) ) <span class="op">/</span></a>
<a class="sourceLine" id="cb29-7" title="7">( (<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="st">  </span>(<span class="dv">7</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="st">  </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="st">  </span>(<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb29-11" title="11"><span class="st">  </span>(<span class="dv">6</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb29-12" title="12">[<span class="dv">1</span>] <span class="fl">0.2105263</span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="co"># Det går att räkna ut detta i flera steg genom att </span></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="co"># t ex beräkna täljare och nämnare separat. </span></a>
<a class="sourceLine" id="cb29-15" title="15"><span class="co"># Alternativt använda beräkningsformeln</span></a>
<a class="sourceLine" id="cb29-16" title="16"></a>
<a class="sourceLine" id="cb29-17" title="17">( <span class="dv">4</span><span class="op">*</span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span><span class="op">*</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span><span class="op">*</span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span><span class="op">+</span><span class="dv">7</span><span class="op">+</span><span class="dv">2</span><span class="op">+</span><span class="dv">4</span><span class="op">+</span><span class="dv">6</span>)<span class="op">*</span>(<span class="dv">7</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span><span class="op">+</span><span class="dv">5</span><span class="op">+</span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span> )<span class="op">/</span></a>
<a class="sourceLine" id="cb29-18" title="18">( (<span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span><span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="st">  </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span> )  </a>
<a class="sourceLine" id="cb29-19" title="19">[<span class="dv">1</span>] <span class="fl">0.2105263</span></a>
<a class="sourceLine" id="cb29-20" title="20"></a>
<a class="sourceLine" id="cb29-21" title="21"><span class="co"># En kommentar: Dessa beräkningar kommer förenklas betydligt i R, vilket vi ska se senare.</span></a></code></pre></div>
<p>Interceptet är <span class="math inline">\(a=\bar{y} - b\bar{x}\)</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">(<span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.2105</span><span class="op">*</span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">/</span><span class="dv">5</span>  </a>
<a class="sourceLine" id="cb30-2" title="2">[<span class="dv">1</span>] <span class="fl">3.6317</span></a></code></pre></div>
<ul>
<li>Svar: Riktningskoefficienten beräknas till <span class="math inline">\(b=0.2105\)</span>, vilket tolkas som att om <span class="math inline">\(x\)</span> ökar en enhet så ökar <span class="math inline">\(y\)</span> i <em>genomsnitt</em> med <span class="math inline">\(0.2105\)</span>
enheter. Interceptet beräknas till <span class="math inline">\(a=3.632\)</span>, vilket tolkas som medelvärdet för <span class="math inline">\(y\)</span> när <span class="math inline">\(x=0\)</span>.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Använd koefficienterna från regressionslinjen och sätt in värdet <span class="math inline">\(x=7\)</span>.</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">7</span>  </a>
<a class="sourceLine" id="cb31-2" title="2">[<span class="dv">1</span>] <span class="fl">5.1051</span></a></code></pre></div>
<ul>
<li>Svar: Prediktionen <span class="math inline">\(\hat{y}=\)</span> 5.1051. Detta är punkten på regressionslinjen när <span class="math inline">\(x=7\)</span> och vår bästa gissning för det <span class="math inline">\(y\)</span>-värde en individ med värdet <span class="math inline">\(x=7\)</span> kommer att ha.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>En residual är skillnaden mellan ett predicerat värde och det faktiska observerade värdet, <span class="math inline">\(\hat{\varepsilon}=y_i - \hat{y}\)</span>.
Eftersom <span class="math inline">\(y=3\)</span> när <span class="math inline">\(x=7\)</span> så residualen</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="dv">3</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">7</span>) </a>
<a class="sourceLine" id="cb32-2" title="2">[<span class="dv">1</span>] <span class="fl">-2.1051</span></a></code></pre></div>
<ul>
<li>Svar: Residualen för <span class="math inline">\(x=7\)</span> är -2.1051.</li>
</ul>
<ol start="4" style="list-style-type: lower-alpha">
<li>Residualspridningen ges av <span class="math display">\[s_\varepsilon=\sqrt{\dfrac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n-2}}= \sqrt{\dfrac{\sum_{i=1}^n\hat{\varepsilon}_i^2}{n-2}}\]</span>. Vi beräknar på samma sätt som i c) övriga residualer, kvadrerar och summerar.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sqrt</span>(</a>
<a class="sourceLine" id="cb33-2" title="2">( (<span class="dv">7</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">4</span>))<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">  </span>(<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">7</span>))<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">  </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">2</span>))<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="st">  </span>(<span class="dv">5</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">4</span>))<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="st">  </span>(<span class="dv">6</span> <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span><span class="dv">6</span>))<span class="op">^</span><span class="dv">2</span> ) <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="st">  </span>(<span class="dv">5</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) )</a>
<a class="sourceLine" id="cb33-8" title="8">[<span class="dv">1</span>] <span class="fl">2.347077</span></a></code></pre></div>
<ul>
<li>Svar: Residualspridningen är 2.347</li>
</ul>
<p>(Notera att <span class="math inline">\(\sum_{i=1}^n \hat{\varepsilon}_i^2\)</span> kallas för <em>residualkvadratsumman</em>.)</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-2.8" class="section level3 unnumbered">
<h3>Övning 2.8</h3>
<ol style="list-style-type: decimal">
<li>Installera paketet <strong>MASS</strong> som innehåller funktioner som kan vara användbara senare på kursen.</li>
<li>Aktivera det installerade paketet <strong>MASS</strong>.</li>
</ol>
<button title="q208" type="button" onclick="if(document.getElementById(&#39;q208&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q208&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q208&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q208" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># Installera paket</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">install.packages</span>(<span class="st">&quot;psych&quot;</span>)</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co"># Aktivera paket</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw">library</span>(<span class="st">&quot;psych&quot;</span>)</a></code></pre></div>
</div>
</div>
<p></br></p>
<!--chapter:end:02-installation.Rmd-->
</div>
</div>
</div>
<div id="data-objekt-och-funktioner" class="section level1">
<h1><span class="header-section-number">3</span> Data, objekt och funktioner</h1>
<p>För att kunna arbeta med statistik och dataanalys är det viktigt att inte enbart förstå den statistiska metoden och kunna lösa problem med hjälp av en miniräknare. I praktiken är det även nödvändigt att förstå hur data hanteras, lagras och struktureras. I detta kapitel introduceras typer av data som normalt hanteras i R, sedan följer avsnitt om de olika typer av objekt som finns i R. Kapitlet avslutas med se på vad en funktion i R är för något och hur funkioner kan användas för att hantera objekt. Detta är ett omfattande kapitel, men det är viktigt att du kan hantera <em>allt</em> som presenteras. Avsikten med kaptitlet är nämligen att ta upp de allra vanligaste.</p>
<div id="data-och-objekt" class="section level2">
<h2><span class="header-section-number">3.1</span> Data och objekt</h2>
<p>Utan data är statistik innehållslöst. På samma sätt är data grundläggande för arbete i R. De vanligaste datatyperna i R är</p>
<ul>
<li>character (text), som anges med citationstecken t ex “a”, “3”.</li>
<li>numeric (decimaltal), t ex är 3, 32.1. Notera att 3 kan skriva 3.0.</li>
<li>integer (heltal). 3, 32. Skillnaden mellan numeric och integer är att inga decimaler sparas, vilket spar minne.</li>
<li>logical (data indikerar om något är sant eller falskt, TRUE/FALSE).</li>
</ul>
<p>Observera att dessa datatyper beskriver hur data är lagrad och hur R ska tolka data. Det säger sig kanske självt att det inte går att använda räkneoperation om data är character (text).</p>
<p>Datatyper ska inte förväxlas med de datanivåer (nominal, ordinal, intervall och kvotskala) som man normalt förknippar med statistiska analyser. Datatyper ska inte heller förväxlas med om data är diskreta, kontinuerliga, kategorier eller kvantitativa.</p>
<p>Det är <strong>mycket viktigt</strong> för alla som arbetar med statistiska analyser av data att kunna tillämpa alla ovanstående begrepp på rätt situation. Ofta överlappar begreppen, men det är vanligt att begreppen inte gör det. Tabellen nedan ger en översikt av begreppen som används, men notera att det finns undantag från denna klassificering och det finns andra sätt att klassificera.</p>
<table>
<thead>
<tr class="header">
<th>Mätskala</th>
<th>Variabeltyp</th>
<th>Datatyp i R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nominal</td>
<td>Kategori, kvalitativ</td>
<td>Character, factor med ordered = FALSE</td>
</tr>
<tr class="even">
<td>Ordinal</td>
<td>Kategori, kvalitativ</td>
<td>Character, factor med ordered = TRUE</td>
</tr>
<tr class="odd">
<td>Intervall</td>
<td>Kvantitativ, kontinuerlig, heltal, diskret</td>
<td>Numeric, integer</td>
</tr>
<tr class="even">
<td>Kvot</td>
<td>Kvantitativ, kontinuerlig, heltal, diskret</td>
<td>Numeric, integer</td>
</tr>
</tbody>
</table>
<p>Data hanteras och sparas som <strong>objekt</strong>. För att skapa ett objekt används <strong>assignment</strong>-operatorn <strong>&lt;-</strong>. Objektet sparas därmed i minnet i R, men inget resultat redovisas i Console. Om R stängs ner måste objektet skapas på nytt såvida användaren inte har angett att objektet ska sparas.</p>
<p>I regel arbetar man i R med flera olika objekt samtidigt. Objekten måste därför
namnges och precis som Vid all programmering är noggrannhet a och o. Objektnamn inleds med en bokstav och får endast innehålla bokstäver, siffror, _ och ..
Dessutom skiljer R på versaler och gemener. Det är inte alltid enkelt att namnge objekt, men det
viktigaste är att vara konsekvent. På denna kurs rekommenderas följande principer för namngivning av objekt. Använd</p>
<ul>
<li>endast <strong>gemener</strong>.</li>
<li><strong>korta</strong> och <strong>logiska</strong> namn, t ex kan objektet <strong>population</strong> förkortas till <strong>pop</strong>.</li>
<li>gärna understreck _ för sammanbinda långa objektnamn. Objektet ålder för kvinnor skulle kunna betecknas <strong>age_women</strong> och motsvarande för män är då <strong>age_men</strong>.</li>
<li>Använd inte å, ä och ö.</li>
<li>inte namn som redan är upptagna i R, t ex <strong>exp</strong> eller <strong>log</strong>.</li>
</ul>
<p>Det tre vanligaste objekten för hantering av data är:</p>
<ul>
<li>vektorer,</li>
<li>matriser,</li>
<li>data frames.</li>
</ul>
</div>
<div id="vektorer" class="section level2">
<h2><span class="header-section-number">3.2</span> Vektorer</h2>
<p>En vektor är ett dataobjekt som är endimensionellt och består av <span class="math inline">\(n\)</span> element. En vektor skapas med kommandot <strong>c()</strong> (‘’Combine Values into a Vector’’). Anta att vi observerar värdena <span class="math inline">\(3,-1,1,5,0\)</span>. Med hjälp av nedanstående kod skapas ett vektor-objekt med med 5 element:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Skapa din första numeriska vektor</span></a>
<a class="sourceLine" id="cb35-2" title="2">my__first_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>)</a></code></pre></div>
<p>Notera att inget visas i Console, men att objektet finns sparat i minnet upptäcker man i RStudio genom att observera den övre högra panelen under fliken <strong>Environment</strong>. Där listas alla objekt som finns sparade i minnet i R. För att titta på objektet exekveras objektet genom att köra nedanstående kod.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa din första numeriska vektor</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="er">&gt;</span><span class="st"> </span>my__first_vec </a>
<a class="sourceLine" id="cb36-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>]  <span class="dv">3</span> <span class="dv">-1</span>  <span class="dv">1</span>  <span class="dv">5</span>  <span class="dv">0</span></a></code></pre></div>
<p>Du ska nu skapa ett antal vektorobjekt som sedan på olika sätt ska manipuleras.</p>
<ol style="list-style-type: decimal">
<li>Skapa ett script som heter <strong>kap3_objekt_och_funktioner.R</strong> genom att välja <em>File &gt; New File &gt; R Script</em> och sedan direkt spara scriptet med <em>File &gt; Save As</em> i mappen <strong>A5Rkod</strong>.<br />
</li>
<li>Skriv in koden nedan i scriptet och spara med <em>File &gt; Save</em>. Det är bra att få rutin på att ofta spara sitt script så att inte kod råkar försvinna.</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># Skapar två numeriska vektorer</span></a>
<a class="sourceLine" id="cb37-2" title="2">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb37-3" title="3">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="co"># Kombinera vektorer till en ny vektor</span></a>
<a class="sourceLine" id="cb37-5" title="5">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a></code></pre></div>
<p>Generellt gäller i R att om <span class="math inline">\(x\)</span> är en vektor bestående av <span class="math inline">\(k\)</span> element
<span class="math display">\[x = (x_1,x_2,\ldots,x_k)\]</span>
och <span class="math inline">\(y\)</span> är en vektor bestående av <span class="math inline">\(l\)</span> element
<span class="math display">\[y = (y_1,y_2,\ldots,y_l)\]</span>
så skapar kommandot</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a></code></pre></div>
<p>en vektor med <span class="math inline">\(k + l\)</span> element,
<span class="math display">\[z= (x_1,x_2,\ldots,x_k,y_1,y_2,\ldots,y_l)=(z_1,z_2,\ldots,z_{k+l}).\]</span>
För att se om detta stämmer tittar vi på objekten genom att exekvera dem.</p>
<ol start="3" style="list-style-type: decimal">
<li>Fortsätt scriptet genom att skriva in nedanstående kod. Spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">x</a>
<a class="sourceLine" id="cb39-2" title="2">y</a>
<a class="sourceLine" id="cb39-3" title="3">z</a></code></pre></div>
<p>I Console ser du då följande:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="op">&gt;</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="op">&gt;</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="op">&gt;</span><span class="st"> </span>z</a>
<a class="sourceLine" id="cb40-6" title="6"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">9</span></a></code></pre></div>
<p>Både <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> och <span class="math inline">\(z\)</span> är numeriska vektorer. Det går även att skapa en vektor bestående av bokstäver. För att skapa en sådan vektor (character vector) sätts de enskilda elementen inom citationstecken.</p>
<ol start="4" style="list-style-type: decimal">
<li>Fortsätt scriptet och skriv in nedanstående kod i scriptet, spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co"># Skapar en vektor med ord</span></a>
<a class="sourceLine" id="cb41-2" title="2">nordic_countries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Denmark&quot;</span>, <span class="st">&quot;Finland&quot;</span>, <span class="st">&quot;Iceland&quot;</span>, <span class="st">&quot;Norway&quot;</span>, <span class="st">&quot;Sweden&quot;</span>)</a>
<a class="sourceLine" id="cb41-3" title="3">nordic_countries</a></code></pre></div>
<p>I Console ser du då följande resultat.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapar en vektor med ord</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="er">&gt;</span><span class="st"> </span>nordic_countries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Denmark&quot;</span>, <span class="st">&quot;Finland&quot;</span>, <span class="st">&quot;Iceland&quot;</span>, <span class="st">&quot;Norway&quot;</span>, <span class="st">&quot;Sweden&quot;</span>)</a>
<a class="sourceLine" id="cb42-3" title="3"><span class="op">&gt;</span><span class="st"> </span>nordic_countries</a>
<a class="sourceLine" id="cb42-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;Denmark&quot;</span> <span class="st">&quot;Finland&quot;</span> <span class="st">&quot;Iceland&quot;</span> <span class="st">&quot;Norway&quot;</span>  <span class="st">&quot;Sweden&quot;</span></a></code></pre></div>
<p>Kombineras en numerisk och en character-vektor blir hela vektorn en character-vector.</p>
<ol start="5" style="list-style-type: decimal">
<li>Skriv följande kod i scriptet, spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># Kombinera en numerisk vektor med en vektor med ord</span></a>
<a class="sourceLine" id="cb43-2" title="2">x_nordic_countries &lt;-<span class="st"> </span><span class="kw">c</span>(x, nordic_countries )</a>
<a class="sourceLine" id="cb43-3" title="3">x_nordic_countries</a></code></pre></div>
<p>I Console erhålls följande output och vi ser att de tidigare numeriska värdena nu omges av citationstecken.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Kombinera en numerisk vektor med en vektor med ord</span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x_nordic_countries &lt;-<span class="st"> </span><span class="kw">c</span>(x, nordic_countries )</a>
<a class="sourceLine" id="cb44-3" title="3"><span class="op">&gt;</span><span class="st"> </span>x_nordic_countries</a>
<a class="sourceLine" id="cb44-4" title="4"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="st">&quot;3&quot;</span>       <span class="st">&quot;1&quot;</span>       <span class="st">&quot;1&quot;</span>       <span class="st">&quot;5&quot;</span>       <span class="st">&quot;0&quot;</span>       <span class="st">&quot;Denmark&quot;</span> <span class="st">&quot;Finland&quot;</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">8</span>] <span class="st">&quot;Iceland&quot;</span> <span class="st">&quot;Norway&quot;</span>  <span class="st">&quot;Sweden&quot;</span></a></code></pre></div>
<p>Om en numerisk vektor kombineras med en vektor med bokstäver så blir hela vektorn en character-vektor. R tolkas alltså siffrorna som bokstäver/tecken utan relation till numeriska värden. Det ser vi genom att
det finns finns citationstecken kring siffrorna.</p>
<p>Vi ska nu se introducera hur man på andra sätt kan skapa vektorer typer av vektorer.</p>
<ol start="6" style="list-style-type: decimal">
<li>Skriv in nedanstående kod i scriptet och spara. Kör koden.</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Skapar en vektor med värdena 1,2,3,4,5</span></a>
<a class="sourceLine" id="cb45-2" title="2">v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="co"># Skapar en vektor med endast ett element</span></a>
<a class="sourceLine" id="cb45-4" title="4">u &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb45-5" title="5"><span class="co"># Skapar en vektor med ett bortfall. </span></a>
<a class="sourceLine" id="cb45-6" title="6">ymis &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="ot">NA</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">6</span>)</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapar en vektor med värdena 1,2,3,4,5</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="er">&gt;</span><span class="st"> </span>v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapar en vektor med endast ett element</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="er">&gt;</span><span class="st"> </span>u &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapar en vektor med ett bortfall. </span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="er">&gt;</span><span class="st"> </span>ymis &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="ot">NA</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">6</span>)</a></code></pre></div>
<p>För att sammanfatta så har vi har hittills skapat numeriska vektorer, vektorer som enbart innehåller bokstäver och vektorer som skapats genom sekvenser. Vidare finns vektorer med bortfall anges med <code>NA</code> (Not Available).</p>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> </font>
<img src="docs/images/important.png" width="5%" /></p>
<ul>
<li>En vektor som innehåller enbart en datatyp kallas för <strong>atomic</strong>. Detta kan vara värt att känna till eftersom eftersom det är vanligt att felmeddelande referar till just att en vektor inte är atomic.<br />
</li>
<li>Inled en rad med # för att kommentera kod. <em>Kommentera alltid kod!</em>. Vid all programmering är det viktigt att förklara kod så att du själv och andra snabbt förstår vad koden gör. Det är viktigt att få rutin på att kommentera, kommentera därför även enkel kod.</li>
</ul>
</div>
<p>Nya vektorer kan skapas med räkneoperationer. Beräkningarna sker då <strong>elementvis</strong>, till exempel adderas elementvärden i en vektor till elementvärden i en annan vektor som har motsvarade position. Vektorerna måste</p>
<ul>
<li>antingen <strong>ha lika många element</strong> eller</li>
<li>att den enda vektorna består av <strong>en</strong> konstant.</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Skriv in nedanstående i ditt script, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># Addition av x och y</span></a>
<a class="sourceLine" id="cb47-2" title="2">x <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co"># Multiplikation av x och y</span></a>
<a class="sourceLine" id="cb47-4" title="4">x <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb47-5" title="5"><span class="co"># Potenser skrivs med a^b</span></a>
<a class="sourceLine" id="cb47-6" title="6">y<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="co"># En konstant u adderas till alla element i vektorn</span></a>
<a class="sourceLine" id="cb47-8" title="8">x <span class="op">+</span><span class="st"> </span>u </a>
<a class="sourceLine" id="cb47-9" title="9"><span class="co"># Räkneoperationer med NA ger NA</span></a>
<a class="sourceLine" id="cb47-10" title="10">x <span class="op">+</span><span class="st"> </span>ymis </a>
<a class="sourceLine" id="cb47-11" title="11"><span class="co"># Division med 0 är ej definierat. R anger det som Inf (infinity) </span></a>
<a class="sourceLine" id="cb47-12" title="12"><span class="co"># eller NaN (Not a Number) om det är 0/0.</span></a>
<a class="sourceLine" id="cb47-13" title="13">x<span class="op">/</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb47-14" title="14"><span class="co"># Exempel på längre räkneoperationer. </span></a>
<a class="sourceLine" id="cb47-15" title="15"><span class="co"># Notera att alla beräkningar är elementvisa.</span></a>
<a class="sourceLine" id="cb47-16" title="16">w &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(y<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>u)<span class="op">/</span>v</a>
<a class="sourceLine" id="cb47-17" title="17">w</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Addition av x och y</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb48-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>]  <span class="dv">5</span>  <span class="dv">4</span>  <span class="dv">6</span> <span class="dv">11</span>  <span class="dv">9</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Multiplikation av x och y</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="er">&gt;</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb48-6" title="6"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>]  <span class="dv">6</span>  <span class="dv">3</span>  <span class="dv">5</span> <span class="dv">30</span>  <span class="dv">0</span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Potenser skrivs med a^b</span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="er">&gt;</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>]  <span class="dv">4</span>  <span class="dv">9</span> <span class="dv">25</span> <span class="dv">36</span> <span class="dv">81</span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="co"># En konstant u adderas till alla element i vektorn</span></a>
<a class="sourceLine" id="cb48-11" title="11"><span class="er">&gt;</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>u </a>
<a class="sourceLine" id="cb48-12" title="12"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">153</span> <span class="dv">151</span> <span class="dv">151</span> <span class="dv">155</span> <span class="dv">150</span></a>
<a class="sourceLine" id="cb48-13" title="13"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Räkneoperationer med NA ger NA</span></a>
<a class="sourceLine" id="cb48-14" title="14"><span class="er">&gt;</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>ymis </a>
<a class="sourceLine" id="cb48-15" title="15"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>]  <span class="dv">6</span> <span class="ot">NA</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">6</span></a>
<a class="sourceLine" id="cb48-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Division med 0 är ej definierat. R anger det som Inf (infinity) </span></a>
<a class="sourceLine" id="cb48-17" title="17"><span class="er">&gt;</span><span class="st"> </span><span class="co"># eller NaN (Not a Number) om det är 0/0.</span></a>
<a class="sourceLine" id="cb48-18" title="18"><span class="er">&gt;</span><span class="st"> </span>x<span class="op">/</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb48-19" title="19"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="ot">Inf</span> <span class="ot">Inf</span> <span class="ot">Inf</span> <span class="ot">Inf</span> <span class="ot">NaN</span></a>
<a class="sourceLine" id="cb48-20" title="20"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Exempel på längre räkneoperationer. </span></a>
<a class="sourceLine" id="cb48-21" title="21"><span class="er">&gt;</span><span class="st"> </span><span class="co"># Notera att alla beräkningar är elementvisa.</span></a>
<a class="sourceLine" id="cb48-22" title="22"><span class="er">&gt;</span><span class="st"> </span>w &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(y<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>u)<span class="op">/</span>v</a>
<a class="sourceLine" id="cb48-23" title="23"><span class="op">&gt;</span><span class="st"> </span>w</a>
<a class="sourceLine" id="cb48-24" title="24"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">-143.00000</span>  <span class="fl">-69.50000</span>  <span class="fl">-40.66667</span>  <span class="fl">-23.50000</span>  <span class="fl">-13.80000</span></a></code></pre></div>
<p>Ovanstående illustrerar att genom att användning av objekt kan beräkningar förenklas.</p>
<p>Nu ska vi se vad som händer om elemementen består av olika antal element. <strong>Skriv i Console</strong> in nedanstående kod och tryck enter.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">x <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>)</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="op">&gt;</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="op">&gt;</span><span class="st"> </span>Warning <span class="cf">in</span> x <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>)<span class="op">:</span><span class="st"> </span>longer object length is not a multiple of shorter</a>
<a class="sourceLine" id="cb50-3" title="3"><span class="op">&gt;</span><span class="st"> </span>object length</a>
<a class="sourceLine" id="cb50-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">7</span> <span class="dv">5</span></a></code></pre></div>
<p>Detta innebär att om vektorn <span class="math inline">\(x\)</span> (innehållande 5 element) adderas till en vektor bestående av endast 3 element, dvs antalet element skiljer sig åt, erhålls ett felmeddelande. Det gäller oavsett räknesätt. Om däremot den ena vektorn är en konstant, som i exemplet med vektorn <span class="math inline">\(u\)</span> ovan, fungerar beräkningarna genom att konstanten beräknas för alla element i den större vektorn.</p>
<div id="vektorer-och-indexering" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Vektorer och indexering</h3>
<p>Vi ska nu presentera hur enskilda element kan väljas ut i vektorer. Eftersom data i praktiken alltid måste anpassas för planerade analyser är detta nödvändigt. Det mest grundläggande i hantering av vektorer är att konstatera att varje element i en vektor har en position. Med hakparenteser <code>[]</code> erhålls åtkomst till ett eller flera element.</p>
<ol style="list-style-type: decimal">
<li>Skriv in nedanstående i ditt script, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co"># Visa element nummer 2 i vektorn x </span></a>
<a class="sourceLine" id="cb51-2" title="2">x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="co"># Visa element 2, 3 och 4 i vektorn y</span></a>
<a class="sourceLine" id="cb51-4" title="4">y[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</a></code></pre></div>
<p>I Console redovisas</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element nummer 2 i vektorn x </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">1</span></a>
<a class="sourceLine" id="cb52-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element 2, 3 och 4 i vektorn y</span></a>
<a class="sourceLine" id="cb52-5" title="5"><span class="er">&gt;</span><span class="st"> </span>y[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb52-6" title="6"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span></a></code></pre></div>
<p>Det går även att spara utvalda element till en ny vektor.</p>
<ol start="2" style="list-style-type: decimal">
<li>Skriv in nedanstående i ditt script.</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># Spara element nummer 2 i vektorn x2 </span></a>
<a class="sourceLine" id="cb53-2" title="2">x2 &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb53-3" title="3">x2</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="co"># Visa element 2, 3 och 4 i vektorn y234</span></a>
<a class="sourceLine" id="cb53-5" title="5">y234 &lt;-<span class="st"> </span>y[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb53-6" title="6">y234</a></code></pre></div>
<p>I Console redovisas</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Spara element nummer 2 till vektorn x2 </span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x2 &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb54-3" title="3"><span class="op">&gt;</span><span class="st"> </span>x2</a>
<a class="sourceLine" id="cb54-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">1</span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Spara element 2, 3 och 4 till vektorn y234</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="er">&gt;</span><span class="st"> </span>y234 &lt;-<span class="st"> </span>y[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb54-7" title="7"><span class="op">&gt;</span><span class="st"> </span>y234</a>
<a class="sourceLine" id="cb54-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span></a></code></pre></div>
<p>Det går att tillämpa <strong>negativ indexering</strong> för att <strong>exkludera</strong> angivna element. Resterande element i en vektor behålls då.</p>
<ol start="3" style="list-style-type: decimal">
<li>Skriv in nedanstående i scriptet, spara, och kör.</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># Spara element nummer 1,3,4,5 till vektorn x1345 </span></a>
<a class="sourceLine" id="cb55-2" title="2">x1345 &lt;-<span class="st"> </span>x[<span class="op">-</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb55-3" title="3">x1345</a>
<a class="sourceLine" id="cb55-4" title="4"><span class="co"># Spara element 1 och 5 till vektorn y15</span></a>
<a class="sourceLine" id="cb55-5" title="5">y15 &lt;-<span class="st"> </span>y[<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb55-6" title="6">y15</a></code></pre></div>
<p>I Console redovisas nedanstående.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Spara element nummer 1,3,4,5 till vektorn x1345 </span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x1345 &lt;-<span class="st"> </span>x[<span class="op">-</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb56-3" title="3"><span class="op">&gt;</span><span class="st"> </span>x1345</a>
<a class="sourceLine" id="cb56-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Spara element 1 och 5 till vektorn y15</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="er">&gt;</span><span class="st"> </span>y15 &lt;-<span class="st"> </span>y[<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb56-7" title="7"><span class="op">&gt;</span><span class="st"> </span>y15</a>
<a class="sourceLine" id="cb56-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">9</span></a></code></pre></div>
<p>En viktigt skäl till att identifiera element är att användaren då på ett enkelt sätt kan hantera värden som identifierade element har.</p>
<ol start="4" style="list-style-type: decimal">
<li>Skriv i nedanstående i scriptet, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># Ändra element 3 från 1 till 4</span></a>
<a class="sourceLine" id="cb57-2" title="2">x_new &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb57-3" title="3">x_new[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb57-4" title="4">x_new </a>
<a class="sourceLine" id="cb57-5" title="5"><span class="co"># Ändra element 3 från &quot;Iceland&quot; till 4</span></a>
<a class="sourceLine" id="cb57-6" title="6">nordic_countries_new &lt;-<span class="st"> </span>nordic_countries</a>
<a class="sourceLine" id="cb57-7" title="7">nordic_countries_new[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb57-8" title="8">nordic_countries_new </a></code></pre></div>
<p>I Console redovisas nedanstående.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Ändra element 3 från 1 till 4</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x_new &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="op">&gt;</span><span class="st"> </span>x_new[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="op">&gt;</span><span class="st"> </span>x_new </a>
<a class="sourceLine" id="cb58-5" title="5"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb58-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Ändra element 3 från &quot;Iceland&quot; till 4</span></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="er">&gt;</span><span class="st"> </span>nordic_countries_new &lt;-<span class="st"> </span>nordic_countries</a>
<a class="sourceLine" id="cb58-8" title="8"><span class="op">&gt;</span><span class="st"> </span>nordic_countries_new[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb58-9" title="9"><span class="op">&gt;</span><span class="st"> </span>nordic_countries_new </a>
<a class="sourceLine" id="cb58-10" title="10"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;Denmark&quot;</span> <span class="st">&quot;Finland&quot;</span> <span class="st">&quot;4&quot;</span>       <span class="st">&quot;Norway&quot;</span>  <span class="st">&quot;Sweden&quot;</span></a></code></pre></div>
<p>Ovanstående kod illustrerar två vanliga företeelser:</p>
<ul>
<li>Vektorerna <em>x_new</em> och <em>nordic_countries_new</em> skapas på grund av att användaren ofta önskar behålla originalvektorerna <em>x</em> och <em>nordic_countries</em>. Detta är ofta önskvärt.</li>
<li>Om ett numeriskt värde läggs till en vektor med bokstäver så tolkas det numeriska värdet som ett tecken, dvs <em>“4”</em>. Det illustrerar vikten av vara noga med om vektorerna är <em>numeriska</em> eller <em>character</em></li>
</ul>
</div>
<div id="vektorer-och-logiska-operatorer" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Vektorer och logiska operatorer</h3>
<p>Istället för att direkt identifiera positionen i vektorn kan man använda <strong>logiska operatorer</strong>. Några vanliga och viktiga logiska operatorer är:</p>
<ul>
<li><code>&gt;</code> är större än.</li>
<li><code>&lt;</code> är mindre än.</li>
<li><code>&gt;=</code> större än eller lika med</li>
<li><code>&lt;=</code> mindre än eller lika med</li>
<li><code>==</code> lika med.</li>
<li><code>!=</code> är ej lika med</li>
<li><code>x|y</code> <span class="math inline">\(x\)</span> eller <span class="math inline">\(y\)</span></li>
<li><code>x &amp; y</code> <span class="math inline">\(x\)</span> och <span class="math inline">\(y\)</span></li>
</ul>
<p>Genom att använda dessa kan användaren direkt hantera data i vektorn.</p>
<ol style="list-style-type: decimal">
<li>Fortsätt scriptet genom att skriva in nedanstående kod. Spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># Visa element i vektor y som är större än 6</span></a>
<a class="sourceLine" id="cb59-2" title="2">y[y <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb59-3" title="3"><span class="co"># Visa element i vektor y som är större än eller lika med 6</span></a>
<a class="sourceLine" id="cb59-4" title="4">y[y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb59-5" title="5"><span class="co"># Visa element i vektor y från positioner där x har värden lika med 1. </span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="co"># (Kräver att x och y har lika många element) </span></a>
<a class="sourceLine" id="cb59-7" title="7">y[x <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb59-8" title="8"><span class="co"># Visa element i vektor där x är ej lika med 1.</span></a>
<a class="sourceLine" id="cb59-9" title="9">y[x <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb59-10" title="10"><span class="co"># Visa element i vektor y från positioner där nordic_countries == &quot;Finland&quot;</span></a>
<a class="sourceLine" id="cb59-11" title="11">y[nordic_countries <span class="op">==</span><span class="st"> &quot;Finland&quot;</span>]</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element i vektor y som är större än 6</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="er">&gt;</span><span class="st"> </span>y[y <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">9</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element i vektor y som är större än eller lika med 6</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="er">&gt;</span><span class="st"> </span>y[y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb60-6" title="6"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">6</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb60-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element i vektor y från positioner där x har värden lika med 1. </span></a>
<a class="sourceLine" id="cb60-8" title="8"><span class="er">&gt;</span><span class="st"> </span><span class="co"># (Kräver att x och y har lika många element) </span></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="er">&gt;</span><span class="st"> </span>y[x <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb60-10" title="10"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb60-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element i vektor där x är ej lika med 1.</span></a>
<a class="sourceLine" id="cb60-12" title="12"><span class="er">&gt;</span><span class="st"> </span>y[x <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb60-13" title="13"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">6</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb60-14" title="14"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element i vektor y från positioner där nordic_countries == &quot;Finland&quot;</span></a>
<a class="sourceLine" id="cb60-15" title="15"><span class="er">&gt;</span><span class="st"> </span>y[nordic_countries <span class="op">==</span><span class="st"> &quot;Finland&quot;</span>]</a>
<a class="sourceLine" id="cb60-16" title="16"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span></a></code></pre></div>
<p>Precis som förut skapas i regel nya vektorer när logiska operatorer tillämpas.</p>
<ol start="2" style="list-style-type: decimal">
<li>Skriv in nedanstående i scriptet, spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># Välj vektorn som är större än eller lika med 6</span></a>
<a class="sourceLine" id="cb61-2" title="2">ysub &lt;-<span class="st"> </span>y[y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">6</span>] </a>
<a class="sourceLine" id="cb61-3" title="3"></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co"># Skapa en binär vektor x_bin som är 1 om x är större än eller lika med 3 och 0</span></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="co"># om x är mindre än 3. Börja med att skapa en tom vektor med motsvarande antal element</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co"># och fyll sedan denna med saknade värden.</span></a>
<a class="sourceLine" id="cb61-7" title="7">x_bin &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb61-8" title="8">x_bin[x <span class="op">&gt;=</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb61-9" title="9">x_bin[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb61-10" title="10"></a>
<a class="sourceLine" id="cb61-11" title="11"><span class="co"># Skapa en tom vektor med 5 element och fyll därefter denna vektor med</span></a>
<a class="sourceLine" id="cb61-12" title="12"><span class="co"># data om landet är skandinaviskt eller ej</span></a>
<a class="sourceLine" id="cb61-13" title="13">scandinavia &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>) </a>
<a class="sourceLine" id="cb61-14" title="14">scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Finland&quot;</span>] &lt;-<span class="st"> &quot;Not scandinavia&quot;</span></a>
<a class="sourceLine" id="cb61-15" title="15">scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Denmark&quot;</span>] &lt;-<span class="st"> &quot;Scandinavia&quot;</span></a>
<a class="sourceLine" id="cb61-16" title="16">scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>] &lt;-<span class="st"> &quot;Scandinavia&quot;</span></a>
<a class="sourceLine" id="cb61-17" title="17">scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Norway&quot;</span>] &lt;-<span class="st"> &quot;Scandinavia&quot;</span></a>
<a class="sourceLine" id="cb61-18" title="18">scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Iceland&quot;</span>] &lt;-<span class="st"> &quot;Not scandinavia&quot;</span></a>
<a class="sourceLine" id="cb61-19" title="19">scandinavia</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Välj vektorn som är större än eller lika med 6</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="er">&gt;</span><span class="st"> </span>ysub &lt;-<span class="st"> </span>y[y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">6</span>] </a>
<a class="sourceLine" id="cb62-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="er">&gt;</span><span class="st"> </span><span class="co"># Skapa en binär vektor x_bin som är 1 om x är större än eller lika med 3 och 0</span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="co"># om x är mindre än 3. Börja med att skapa en tom vektor med motsvarande antal element</span></a>
<a class="sourceLine" id="cb62-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="co"># och fyll sedan denna med saknade värden.</span></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="er">&gt;</span><span class="st"> </span>x_bin &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb62-8" title="8"><span class="op">&gt;</span><span class="st"> </span>x_bin[x <span class="op">&gt;=</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="op">&gt;</span><span class="st"> </span>x_bin[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="op">&gt;</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb62-11" title="11"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb62-12" title="12"><span class="op">&gt;</span><span class="st"> </span>x_bin</a>
<a class="sourceLine" id="cb62-13" title="13"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb62-14" title="14"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en tom vektor med 5 element och fyll därefter denna vektor med</span></a>
<a class="sourceLine" id="cb62-15" title="15"><span class="er">&gt;</span><span class="st"> </span><span class="co"># data om landet är skandinaviskt eller ej</span></a>
<a class="sourceLine" id="cb62-16" title="16"><span class="er">&gt;</span><span class="st"> </span>scandinavia &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>) </a>
<a class="sourceLine" id="cb62-17" title="17"><span class="op">&gt;</span><span class="st"> </span>scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Finland&quot;</span>] &lt;-<span class="st"> &quot;Not scandinavia&quot;</span></a>
<a class="sourceLine" id="cb62-18" title="18"><span class="op">&gt;</span><span class="st"> </span>scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Denmark&quot;</span>] &lt;-<span class="st"> &quot;Scandinavia&quot;</span></a>
<a class="sourceLine" id="cb62-19" title="19"><span class="op">&gt;</span><span class="st"> </span>scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>] &lt;-<span class="st"> &quot;Scandinavia&quot;</span></a>
<a class="sourceLine" id="cb62-20" title="20"><span class="op">&gt;</span><span class="st"> </span>scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Norway&quot;</span>] &lt;-<span class="st"> &quot;Scandinavia&quot;</span></a>
<a class="sourceLine" id="cb62-21" title="21"><span class="op">&gt;</span><span class="st"> </span>scandinavia[nordic_countries <span class="op">==</span><span class="st"> &quot;Iceland&quot;</span>] &lt;-<span class="st"> &quot;Not scandinavia&quot;</span></a>
<a class="sourceLine" id="cb62-22" title="22"><span class="op">&gt;</span><span class="st"> </span>scandinavia</a>
<a class="sourceLine" id="cb62-23" title="23"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;Scandinavia&quot;</span>     <span class="st">&quot;Not scandinavia&quot;</span> <span class="st">&quot;Not scandinavia&quot;</span> <span class="st">&quot;Scandinavia&quot;</span>    </a>
<a class="sourceLine" id="cb62-24" title="24"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>] <span class="st">&quot;Scandinavia&quot;</span></a></code></pre></div>
<p>OVanstående moment är <strong>viktigt</strong>. Här illustreras nämligen en grundläggande princip för skapandet av nya variabel, dvs först skapa en tom vektor som sedans fylls med information. Även om det finns alternativa kompaktare sätt att koda om vektorer (och följaktligen variabler), är det ovanstående tillvägagångssätt som rekommenderas starkt på denna kurs.</p>
<p>Nästa steg är att använda den logiska operatorn <em>&amp;</em>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Skriv in nedanstående i scriptet, spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># Skapa en vektor z_trinary som är</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="co"># 1 om z är mindre än eller lika med 1</span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="co"># 2 om z är större än 1 eller mindre än eller lika med 5 </span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co"># 3 om z är större än 5 </span></a>
<a class="sourceLine" id="cb63-5" title="5">z_trinary &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb63-6" title="6">z_trinary[z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb63-7" title="7">z_trinary[(z <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(z <span class="op">&lt;=</span><span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-8" title="8">z_trinary[z <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb63-9" title="9">z</a>
<a class="sourceLine" id="cb63-10" title="10">z_trinary</a>
<a class="sourceLine" id="cb63-11" title="11"></a>
<a class="sourceLine" id="cb63-12" title="12"><span class="co"># Skapa en binära variabler z1, z2 och z3</span></a>
<a class="sourceLine" id="cb63-13" title="13">z1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb63-14" title="14">z1[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb63-15" title="15">z1[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-16" title="16">z1[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-17" title="17"></a>
<a class="sourceLine" id="cb63-18" title="18">z2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb63-19" title="19">z2[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-20" title="20">z2[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb63-21" title="21">z2[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-22" title="22"></a>
<a class="sourceLine" id="cb63-23" title="23">z3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb63-24" title="24">z3[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-25" title="25">z3[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-26" title="26">z3[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb63-27" title="27">z1</a>
<a class="sourceLine" id="cb63-28" title="28">z2</a>
<a class="sourceLine" id="cb63-29" title="29">z3</a></code></pre></div>
<p>I Console redovisas följande.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en vektor z_trinary som är</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="er">&gt;</span><span class="st"> </span><span class="co"># 1 om z är mindre än eller lika med 1</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="er">&gt;</span><span class="st"> </span><span class="co"># 2 om z är större än 1 eller mindre än eller lika med 5 </span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="er">&gt;</span><span class="st"> </span><span class="co"># 3 om z är större än 5 </span></a>
<a class="sourceLine" id="cb64-5" title="5"><span class="er">&gt;</span><span class="st"> </span>z_trinary &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb64-6" title="6"><span class="op">&gt;</span><span class="st"> </span>z_trinary[z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb64-7" title="7"><span class="op">&gt;</span><span class="st"> </span>z_trinary[(z <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb64-8" title="8"><span class="op">&gt;</span><span class="st"> </span>z_trinary[z <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb64-9" title="9"><span class="op">&gt;</span><span class="st"> </span>z</a>
<a class="sourceLine" id="cb64-10" title="10"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb64-11" title="11"><span class="op">&gt;</span><span class="st"> </span>z_trinary</a>
<a class="sourceLine" id="cb64-12" title="12"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb64-13" title="13"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-14" title="14"><span class="er">&gt;</span><span class="st"> </span><span class="co"># Skapa en binära variabler z1, z2 och z3</span></a>
<a class="sourceLine" id="cb64-15" title="15"><span class="er">&gt;</span><span class="st"> </span>z1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb64-16" title="16"><span class="op">&gt;</span><span class="st"> </span>z1[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb64-17" title="17"><span class="op">&gt;</span><span class="st"> </span>z1[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb64-18" title="18"><span class="op">&gt;</span><span class="st"> </span>z1[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb64-19" title="19"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-20" title="20"><span class="er">&gt;</span><span class="st"> </span>z2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb64-21" title="21"><span class="op">&gt;</span><span class="st"> </span>z2[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb64-22" title="22"><span class="op">&gt;</span><span class="st"> </span>z2[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb64-23" title="23"><span class="op">&gt;</span><span class="st"> </span>z2[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb64-24" title="24"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-25" title="25"><span class="er">&gt;</span><span class="st"> </span>z3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb64-26" title="26"><span class="op">&gt;</span><span class="st"> </span>z3[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb64-27" title="27"><span class="op">&gt;</span><span class="st"> </span>z3[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb64-28" title="28"><span class="op">&gt;</span><span class="st"> </span>z3[z_trinary <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb64-29" title="29"><span class="op">&gt;</span><span class="st"> </span>z1</a>
<a class="sourceLine" id="cb64-30" title="30"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb64-31" title="31"><span class="op">&gt;</span><span class="st"> </span>z2</a>
<a class="sourceLine" id="cb64-32" title="32"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb64-33" title="33"><span class="op">&gt;</span><span class="st"> </span>z3</a>
<a class="sourceLine" id="cb64-34" title="34"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span></a></code></pre></div>
<p>Ett par viktiga punkter att komma ihåg är</p>
<ul>
<li>Arbetsgången är att en ny vektor skapas, vilken sedan fylls på. För en binär variabel skulle vi teoretiskt kunna använda operatorn <em>!=</em>, men detta kan dels leda till att NA i en vektor kodas till 0, dels att datatvätten blir mindre noggrann. Ovanstående metodik för att skapa ny variabler är transparent.</li>
<li>Använd parenteser för att undvika eventuella fel, som till exempel var fallet med <em>(z &gt; 1) &amp; (z &lt;= 5)</em>.</li>
</ul>
<p>Avslutningsvis ska vi använda den logiska operatorn <em>|</em>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Skriv in nedanstående i scriptet, spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># Om z1 = 1 eller z3 = 1, så ska w_bin = 1.</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="co"># Om z2 = 1 så ska d_bin = 0.</span></a>
<a class="sourceLine" id="cb65-3" title="3"></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="co"># Skapa en tom vektor w_bin</span></a>
<a class="sourceLine" id="cb65-5" title="5">d_bin &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb65-6" title="6">d_bin[(z1 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">|</span><span class="st"> </span>(z3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb65-7" title="7">d_bin[z2 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb65-8" title="8">z1</a>
<a class="sourceLine" id="cb65-9" title="9">z2</a>
<a class="sourceLine" id="cb65-10" title="10">z3</a>
<a class="sourceLine" id="cb65-11" title="11">w_bin</a>
<a class="sourceLine" id="cb65-12" title="12"></a>
<a class="sourceLine" id="cb65-13" title="13"></a>
<a class="sourceLine" id="cb65-14" title="14"><span class="co"># Om landet är Norge eller Island och x &gt; 4 eller w &gt; -50 så ska vi sätta NA</span></a>
<a class="sourceLine" id="cb65-15" title="15">y_new &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb65-16" title="16">y_new[( (nordic_countries <span class="op">==</span><span class="st"> &quot;Iceland&quot;</span>) <span class="op">|</span><span class="st"> </span>(nordic_countries <span class="op">==</span><span class="st"> &quot;Norway&quot;</span>) ) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-17" title="17"><span class="st">        </span>( (x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">|</span><span class="st"> </span>(w <span class="op">&gt;</span><span class="st"> </span><span class="dv">-50</span>) ) ] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb65-18" title="18">nordic_countries</a>
<a class="sourceLine" id="cb65-19" title="19">x</a>
<a class="sourceLine" id="cb65-20" title="20">w</a>
<a class="sourceLine" id="cb65-21" title="21">y_new</a></code></pre></div>
<p>I Console ser vi utskrifterna. Om du inte har förstått koden, så kan du jämföra vektorerna och se varför <em>w_bin</em> och <em>y_new</em> har fått de värden som de har.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="co"># Om z1 = 1 eller z3 = 1, så ska w_bin = 1.</span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="co"># Om z2 = 1 så ska d_bin = 0.</span></a>
<a class="sourceLine" id="cb66-3" title="3"></a>
<a class="sourceLine" id="cb66-4" title="4"><span class="co"># Skapa en tom vektor w_bin</span></a>
<a class="sourceLine" id="cb66-5" title="5">d_bin &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb66-6" title="6">d_bin[(z1 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">|</span><span class="st"> </span>(z3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb66-7" title="7">d_bin[z2 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb66-8" title="8">z1</a>
<a class="sourceLine" id="cb66-9" title="9">z2</a>
<a class="sourceLine" id="cb66-10" title="10">z3</a>
<a class="sourceLine" id="cb66-11" title="11">w_bin</a>
<a class="sourceLine" id="cb66-12" title="12"></a>
<a class="sourceLine" id="cb66-13" title="13"></a>
<a class="sourceLine" id="cb66-14" title="14"><span class="co"># Om landet är Norge eller Island och x &gt; 4 eller w &gt; -50 så ska vi sätta NA</span></a>
<a class="sourceLine" id="cb66-15" title="15">y_new &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb66-16" title="16">y_new[( (nordic_countries <span class="op">==</span><span class="st"> &quot;Iceland&quot;</span>) <span class="op">|</span><span class="st"> </span>(nordic_countries <span class="op">==</span><span class="st"> &quot;Norway&quot;</span>) ) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-17" title="17"><span class="st">        </span>( (x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">|</span><span class="st"> </span>(w <span class="op">&gt;</span><span class="st"> </span><span class="dv">-50</span>) ) ] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb66-18" title="18">nordic_countries</a>
<a class="sourceLine" id="cb66-19" title="19">x</a>
<a class="sourceLine" id="cb66-20" title="20">w</a>
<a class="sourceLine" id="cb66-21" title="21">y_new</a></code></pre></div>
<p>Ovanstående sätt att förändra och skapa vektorer används <strong>mycket ofta</strong> i R och kan hantera mycket av den praktiska datahantering som du kommer att stöta på under denna kurs, men också ute i arbetslivet. Som tidigare nämnts finns andra sätt att åstadkomma samma resultat, som kanske till och med i specifika avseenden bättre, men utgå på denna kurs från kod som presenteras här.</p>
<p>Det bör nämnas att det naturligtvis finns mycket mer att lära sig om hur logiska operatorer fungerar. Till exempel skapar nedanstående kod den sista datatypen som nämndes inledningsvis, dvs logical data.</p>
<ol start="5" style="list-style-type: decimal">
<li>Skriv in nedanstående i scriptet, spara och kör koden.</li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co"># Ger en logisk vektor</span></a>
<a class="sourceLine" id="cb67-2" title="2">(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) </a></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># Multiplikation med en logisk vektor</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="dv">1</span><span class="op">*</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) </a></code></pre></div>
<pre><code>## [1] 0 0 0 1 0</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="dv">4</span><span class="op">*</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) </a></code></pre></div>
<pre><code>## [1] 0 0 0 4 0</code></pre>
<p>Spara scriptet <strong>kap3_objekt_och_funktioner.R</strong>.</p>
</div>
</div>
<div id="matriser" class="section level2">
<h2><span class="header-section-number">3.3</span> Matriser</h2>
<p>En matris är ett tvådimensionellt dataobjekt bestående av <strong>rader</strong> och <strong>kolumner</strong>. Notera ordningen, dvs en matris storlek anges <strong>först</strong> med rader, <strong>sedan</strong> med kolumner. Analogt med <strong>c()</strong>, som kombinerar element till en vektor, används <strong>rbind()</strong> och <strong>cbind()</strong> för att binda ihop vektorer radvis eller kolumnvis till matriser. En matris måste innehålla element av samma datatyp, vilket innebär att det <strong>inte</strong> går att binda samman numeriska vektorer som med vektorer som innehåller bokstäver. En matris kan även skapas direkt med kommandot <strong>matrix()</strong> som transformerar en vektor med <span class="math inline">\(k\)</span> antal element till en matris bestående motsvarande antal element fördelat på antal rader och kolumner.</p>
<ol style="list-style-type: decimal">
<li>Fortsätt scriptet <strong>kap3_objekt_och_funktioner.R</strong> och skriv in nedanstående kod. Spara scriptet och kör.</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co"># Skapa en matris genom att binda samman x och y radvis. Matrisen får 2 rader och 5 kolumner</span></a>
<a class="sourceLine" id="cb73-2" title="2">m1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, y)</a>
<a class="sourceLine" id="cb73-3" title="3">m1</a>
<a class="sourceLine" id="cb73-4" title="4"><span class="co"># Skapa en matris genom att binda samman x, y, n och x radvis. Matrisen får 5 rader och 4 kolumner. </span></a>
<a class="sourceLine" id="cb73-5" title="5">m2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(x, y, n, x)</a>
<a class="sourceLine" id="cb73-6" title="6">m2</a>
<a class="sourceLine" id="cb73-7" title="7"><span class="co"># Skapa en matris genom att binda samman x och ymis radvis. Matrisen får 5 rader och 2 kolumner. </span></a>
<a class="sourceLine" id="cb73-8" title="8">m3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, ymis)</a>
<a class="sourceLine" id="cb73-9" title="9">m3</a>
<a class="sourceLine" id="cb73-10" title="10"><span class="co"># Skapa med matrix() en matris med två rader och 5 kolumner. </span></a>
<a class="sourceLine" id="cb73-11" title="11"><span class="co"># Matrisen fylls på kolumnvis och notera att detta inte blir samma som m1. </span></a>
<a class="sourceLine" id="cb73-12" title="12">m4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(z, <span class="dv">2</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb73-13" title="13">m4</a>
<a class="sourceLine" id="cb73-14" title="14"><span class="co"># Skapa med matrix() en matris med fem rader och 2 kolumner.</span></a>
<a class="sourceLine" id="cb73-15" title="15"><span class="co"># I detta fall är de två första kolumnerna i m2 samma som m5.</span></a>
<a class="sourceLine" id="cb73-16" title="16">m5 &lt;-<span class="st"> </span><span class="kw">matrix</span>(z, <span class="dv">5</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-17" title="17">m5</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en matris genom att binda samman x och y radvis. Matrisen får 2 rader och 5 kolumner</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="er">&gt;</span><span class="st"> </span>m1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, y)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="op">&gt;</span><span class="st"> </span>m1</a>
<a class="sourceLine" id="cb74-4" title="4"><span class="op">&gt;</span><span class="st">   </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb74-5" title="5"><span class="op">&gt;</span><span class="st"> </span>x    <span class="dv">3</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">5</span>    <span class="dv">0</span></a>
<a class="sourceLine" id="cb74-6" title="6"><span class="op">&gt;</span><span class="st"> </span>y    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">9</span></a>
<a class="sourceLine" id="cb74-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en matris genom att binda samman x, y, n och x radvis. Matrisen får 5 rader och 4 kolumner. </span></a>
<a class="sourceLine" id="cb74-8" title="8"><span class="er">&gt;</span><span class="st"> </span>m2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(x, y, u, x)</a>
<a class="sourceLine" id="cb74-9" title="9"><span class="op">&gt;</span><span class="st"> </span>m2</a>
<a class="sourceLine" id="cb74-10" title="10"><span class="op">&gt;</span><span class="st">      </span>x y   u x</a>
<a class="sourceLine" id="cb74-11" title="11"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="dv">3</span> <span class="dv">2</span> <span class="dv">150</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb74-12" title="12"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="dv">1</span> <span class="dv">3</span> <span class="dv">150</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb74-13" title="13"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,] <span class="dv">1</span> <span class="dv">5</span> <span class="dv">150</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb74-14" title="14"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,] <span class="dv">5</span> <span class="dv">6</span> <span class="dv">150</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb74-15" title="15"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,] <span class="dv">0</span> <span class="dv">9</span> <span class="dv">150</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb74-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en matris genom att binda samman x och ymis radvis. Matrisen får 5 rader och 2 kolumner. </span></a>
<a class="sourceLine" id="cb74-17" title="17"><span class="er">&gt;</span><span class="st"> </span>m3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, ymis)</a>
<a class="sourceLine" id="cb74-18" title="18"><span class="op">&gt;</span><span class="st"> </span>m3</a>
<a class="sourceLine" id="cb74-19" title="19"><span class="op">&gt;</span><span class="st">      </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb74-20" title="20"><span class="op">&gt;</span><span class="st"> </span>x       <span class="dv">3</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">5</span>    <span class="dv">0</span></a>
<a class="sourceLine" id="cb74-21" title="21"><span class="op">&gt;</span><span class="st"> </span>ymis    <span class="dv">3</span>   <span class="ot">NA</span>    <span class="dv">6</span>    <span class="dv">3</span>    <span class="dv">6</span></a>
<a class="sourceLine" id="cb74-22" title="22"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa med matrix() en matris med två rader och 5 kolumner. </span></a>
<a class="sourceLine" id="cb74-23" title="23"><span class="er">&gt;</span><span class="st"> </span><span class="co"># Matrisen fylls på kolumnvis och notera att detta inte blir samma som m1. </span></a>
<a class="sourceLine" id="cb74-24" title="24"><span class="er">&gt;</span><span class="st"> </span>m4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(z, <span class="dv">2</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb74-25" title="25"><span class="op">&gt;</span><span class="st"> </span>m4</a>
<a class="sourceLine" id="cb74-26" title="26"><span class="op">&gt;</span><span class="st">      </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb74-27" title="27"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,]    <span class="dv">3</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">6</span></a>
<a class="sourceLine" id="cb74-28" title="28"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">5</span>    <span class="dv">2</span>    <span class="dv">5</span>    <span class="dv">9</span></a>
<a class="sourceLine" id="cb74-29" title="29"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa med matrix() en matris med fem rader och 2 kolumner.</span></a>
<a class="sourceLine" id="cb74-30" title="30"><span class="er">&gt;</span><span class="st"> </span><span class="co"># I detta fall är de två första kolumnerna i m2 samma som m5.</span></a>
<a class="sourceLine" id="cb74-31" title="31"><span class="er">&gt;</span><span class="st"> </span>m5 &lt;-<span class="st"> </span><span class="kw">matrix</span>(z, <span class="dv">5</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb74-32" title="32"><span class="op">&gt;</span><span class="st"> </span>m5</a>
<a class="sourceLine" id="cb74-33" title="33"><span class="op">&gt;</span><span class="st">      </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb74-34" title="34"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,]    <span class="dv">3</span>    <span class="dv">2</span></a>
<a class="sourceLine" id="cb74-35" title="35"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">3</span></a>
<a class="sourceLine" id="cb74-36" title="36"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">5</span></a>
<a class="sourceLine" id="cb74-37" title="37"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,]    <span class="dv">5</span>    <span class="dv">6</span></a>
<a class="sourceLine" id="cb74-38" title="38"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,]    <span class="dv">0</span>    <span class="dv">9</span></a></code></pre></div>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> </font></p>
<p><img src="docs/images/tip.png" width="5%" /></p>
<p>Använd på denna kurs <strong>rbind()</strong> och <strong>cbind()</strong> vid skapande av matriser. Det är då mindre risk för
för missförstånd var elementen hamnar i matrisen.</p>
</div>
<p>För åtkomst till element krävs nu, eftersom matriser består av rader och kolumner, att bägge dimensionerna anges. Först anges
radnummer, sedan kolumnnummer.</p>
<ol start="2" style="list-style-type: decimal">
<li>Skriv in nedanstående kod i scriptet, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="co"># Visa element på rad 2 och kolumn 3</span></a>
<a class="sourceLine" id="cb75-2" title="2">m1[<span class="dv">2</span>,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="co"># Visa element på rad 2 och alla kolumner</span></a>
<a class="sourceLine" id="cb75-4" title="4">m1[<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="co"># Visa element på alla rader och kolumner 3</span></a>
<a class="sourceLine" id="cb75-6" title="6">m1[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb75-7" title="7"><span class="co"># Visa </span></a>
<a class="sourceLine" id="cb75-8" title="8">m2[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),]</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element på rad 2 och kolumn 3</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="er">&gt;</span><span class="st"> </span>m1[<span class="dv">2</span>,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb76-3" title="3"><span class="op">&gt;</span><span class="st"> </span>y </a>
<a class="sourceLine" id="cb76-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb76-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element på rad 2 och alla kolumner</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="er">&gt;</span><span class="st"> </span>m1[<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb76-7" title="7"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb76-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa element på alla rader och kolumner 3</span></a>
<a class="sourceLine" id="cb76-9" title="9"><span class="er">&gt;</span><span class="st"> </span>m1[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb76-10" title="10"><span class="op">&gt;</span><span class="st"> </span>x y </a>
<a class="sourceLine" id="cb76-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb76-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa </span></a>
<a class="sourceLine" id="cb76-13" title="13"><span class="er">&gt;</span><span class="st"> </span>m2[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb76-14" title="14"><span class="op">&gt;</span><span class="st">      </span>x y   u x</a>
<a class="sourceLine" id="cb76-15" title="15"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="dv">3</span> <span class="dv">2</span> <span class="dv">150</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb76-16" title="16"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="dv">1</span> <span class="dv">3</span> <span class="dv">150</span> <span class="dv">1</span></a></code></pre></div>
<p>Precis som vad gäller vektorer går det att utföra elementvisa beräkningar. Det kräver att matriserna har samma antal rader och kolumner. Det går även att utföra räkneoperationer med en konstant. Observera att elementvis multiplikation <strong>inte</strong> är detsamma som matematikens <strong>matrismultiplikation</strong>. Det är naturligtvis inga problem att i R använda matrismultiplikation, men detta går utanför kursens avgränsning.</p>
<ol start="3" style="list-style-type: decimal">
<li>För att exemplfiera räkneoperationer med matriser, skriv in nedanstående kod i scriptet, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># Addera element i matris 1 med element i matris 3</span></a>
<a class="sourceLine" id="cb77-2" title="2">m1 <span class="op">+</span><span class="st"> </span>m3</a>
<a class="sourceLine" id="cb77-3" title="3"><span class="co"># Multiplicera element i matris 1 med element i matris 3. OBS! Detta är inte matrismultiplikation!</span></a>
<a class="sourceLine" id="cb77-4" title="4">m1 <span class="op">*</span><span class="st"> </span>m3</a>
<a class="sourceLine" id="cb77-5" title="5"><span class="co"># Dividera element i matris 1 med en konstant u</span></a>
<a class="sourceLine" id="cb77-6" title="6">m1 <span class="op">/</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb77-7" title="7"><span class="co"># Nedanstående är INTE det som inom matematiken benämns inversen av en matris, utan är 1/elementvärde</span></a>
<a class="sourceLine" id="cb77-8" title="8"><span class="dv">1</span><span class="op">/</span>m1 </a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Addera element i matris 1 med element i matris 3</span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="er">&gt;</span><span class="st"> </span>m1 <span class="op">+</span><span class="st"> </span>m3</a>
<a class="sourceLine" id="cb78-3" title="3"><span class="op">&gt;</span><span class="st">   </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb78-4" title="4"><span class="op">&gt;</span><span class="st"> </span>x    <span class="dv">6</span>    <span class="dv">2</span>    <span class="dv">2</span>   <span class="dv">10</span>    <span class="dv">0</span></a>
<a class="sourceLine" id="cb78-5" title="5"><span class="op">&gt;</span><span class="st"> </span>y    <span class="dv">5</span>   <span class="ot">NA</span>   <span class="dv">11</span>    <span class="dv">9</span>   <span class="dv">15</span></a>
<a class="sourceLine" id="cb78-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Multiplicera element i matris 1 med element i matris 3. OBS! Detta är inte matrismultiplikation!</span></a>
<a class="sourceLine" id="cb78-7" title="7"><span class="er">&gt;</span><span class="st"> </span>m1 <span class="op">*</span><span class="st"> </span>m3</a>
<a class="sourceLine" id="cb78-8" title="8"><span class="op">&gt;</span><span class="st">   </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb78-9" title="9"><span class="op">&gt;</span><span class="st"> </span>x    <span class="dv">9</span>    <span class="dv">1</span>    <span class="dv">1</span>   <span class="dv">25</span>    <span class="dv">0</span></a>
<a class="sourceLine" id="cb78-10" title="10"><span class="op">&gt;</span><span class="st"> </span>y    <span class="dv">6</span>   <span class="ot">NA</span>   <span class="dv">30</span>   <span class="dv">18</span>   <span class="dv">54</span></a>
<a class="sourceLine" id="cb78-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Dividera element i matris 1 med en konstant n</span></a>
<a class="sourceLine" id="cb78-12" title="12"><span class="er">&gt;</span><span class="st"> </span>m1 <span class="op">/</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb78-13" title="13"><span class="op">&gt;</span><span class="st">         </span>[,<span class="dv">1</span>]        [,<span class="dv">2</span>]        [,<span class="dv">3</span>]       [,<span class="dv">4</span>] [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb78-14" title="14"><span class="op">&gt;</span><span class="st"> </span>x <span class="fl">0.02000000</span> <span class="fl">0.006666667</span> <span class="fl">0.006666667</span> <span class="fl">0.03333333</span> <span class="fl">0.00</span></a>
<a class="sourceLine" id="cb78-15" title="15"><span class="op">&gt;</span><span class="st"> </span>y <span class="fl">0.01333333</span> <span class="fl">0.020000000</span> <span class="fl">0.033333333</span> <span class="fl">0.04000000</span> <span class="fl">0.06</span></a>
<a class="sourceLine" id="cb78-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Nedanstående är INTE det som inom matematiken benämns inversen av en matris, utan är 1/elementvärde</span></a>
<a class="sourceLine" id="cb78-17" title="17"><span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>m1</a>
<a class="sourceLine" id="cb78-18" title="18"><span class="op">&gt;</span><span class="st">        </span>[,<span class="dv">1</span>]      [,<span class="dv">2</span>] [,<span class="dv">3</span>]      [,<span class="dv">4</span>]      [,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb78-19" title="19"><span class="op">&gt;</span><span class="st"> </span>x <span class="fl">0.3333333</span> <span class="fl">1.0000000</span>  <span class="fl">1.0</span> <span class="fl">0.2000000</span>       <span class="ot">Inf</span></a>
<a class="sourceLine" id="cb78-20" title="20"><span class="op">&gt;</span><span class="st"> </span>y <span class="fl">0.5000000</span> <span class="fl">0.3333333</span>  <span class="fl">0.2</span> <span class="fl">0.1666667</span> <span class="fl">0.1111111</span></a></code></pre></div>
<p>Spara scriptet <strong>kap3_objekt_och_funktioner.R</strong>.</p>
<p>Det går att tillämpa logiska operatorer även på matriser, men den extra dimensionen gör detta omständligt. Dessutom konstaterade vi att matrisen endast kan hantera en datatyp. Därför introduceras en tredje typ av dataobjekt som bättre sätt hanterar datamaterial. Det är dock bra att känna till att vid mer avancerad användning av R är matriser dock ett mycket viktigt verktyg.</p>
</div>
<div id="data-frames" class="section level2">
<h2><span class="header-section-number">3.4</span> Data frames</h2>
<p>En <strong>data frame</strong> är i praktiken det vanligaste objektet för dataanalys. En data frame har två dimensioner (rader och kolumner), men kan till skillnad från matrisen måste inte kolumnerna ha samma datatyp. Vad som dock krävs är att en kolumn består av en och samma datatyp. Vidare innehåller en data frame detaljerad information om exempelvis <strong>variabelnamn</strong> och <strong>variabeltyp</strong>.</p>
<p>För att skapa en data frame används <strong>data.frame()</strong> och vi ska nu se på några exempel. Observera att en data frame även anger information om radnummer. Dessa nummer är dock inte definierade som en sepearat kolumn.</p>
<ol style="list-style-type: decimal">
<li>Skriv nedanstående kod i <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># Skapa en data frame genom att ange vektorer </span></a>
<a class="sourceLine" id="cb79-2" title="2">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y, nordic_countries)</a>
<a class="sourceLine" id="cb79-3" title="3">df</a>
<a class="sourceLine" id="cb79-4" title="4"><span class="co"># Skapa en data frame genom att transformera en matris.</span></a>
<a class="sourceLine" id="cb79-5" title="5"><span class="kw">data.frame</span>(m3)</a></code></pre></div>
<p>I Console erhålls följande resultat.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en data frame genom att ange vektorer </span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="er">&gt;</span><span class="st"> </span>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y, nordic_countries)</a>
<a class="sourceLine" id="cb80-3" title="3"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb80-4" title="4"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries</a>
<a class="sourceLine" id="cb80-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark</a>
<a class="sourceLine" id="cb80-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland</a>
<a class="sourceLine" id="cb80-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland</a>
<a class="sourceLine" id="cb80-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway</a>
<a class="sourceLine" id="cb80-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden</a>
<a class="sourceLine" id="cb80-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en data frame genom att transformera en matris.</span></a>
<a class="sourceLine" id="cb80-11" title="11"><span class="er">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(m3)</a>
<a class="sourceLine" id="cb80-12" title="12"><span class="op">&gt;</span><span class="st">      </span>X1 X2 X3 X4 X5</a>
<a class="sourceLine" id="cb80-13" title="13"><span class="op">&gt;</span><span class="st"> </span>x     <span class="dv">3</span>  <span class="dv">1</span>  <span class="dv">1</span>  <span class="dv">5</span>  <span class="dv">0</span></a>
<a class="sourceLine" id="cb80-14" title="14"><span class="op">&gt;</span><span class="st"> </span>ymis  <span class="dv">3</span> <span class="ot">NA</span>  <span class="dv">6</span>  <span class="dv">3</span>  <span class="dv">6</span></a></code></pre></div>
<p>För åtkomst till element finns nu flera alternati och vi ska se på de två vanligaste:</p>
<ul>
<li>Precis som för matriser kan användaren använda hakparenteserna ´[]´</li>
<li>Genom att använda <code>$</code> väljs en variabel i en dataframe. Det går sedan att använda hakparentes för att välja ett element i denna variabel.</li>
</ul>
<p>Nedanstående kod illustrerar de bägge metoderna.</p>
<ol start="2" style="list-style-type: decimal">
<li>Skriv nedanstående kod i <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># Visa kolumn 3 </span></a>
<a class="sourceLine" id="cb81-2" title="2">df[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb81-3" title="3"><span class="co"># Visa variabeln nordic countries, dvs kolumn 3 </span></a>
<a class="sourceLine" id="cb81-4" title="4">df<span class="op">$</span>nordic_countries</a>
<a class="sourceLine" id="cb81-5" title="5"><span class="co"># Visa värdet i rad 2 och kolumn 1 </span></a>
<a class="sourceLine" id="cb81-6" title="6">df[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb81-7" title="7"><span class="co"># Visa värdet för element 2 i variabeln x.</span></a>
<a class="sourceLine" id="cb81-8" title="8">df<span class="op">$</span>x[<span class="dv">2</span>]</a></code></pre></div>
<p>I Console erhålls följande resultat.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa kolumn 3 </span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="er">&gt;</span><span class="st"> </span>df[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] Denmark Finland Iceland Norway  Sweden </a>
<a class="sourceLine" id="cb82-4" title="4"><span class="op">&gt;</span><span class="st"> </span>Levels<span class="op">:</span><span class="st"> </span>Denmark Finland Iceland Norway Sweden</a>
<a class="sourceLine" id="cb82-5" title="5"><span class="op">&gt;</span><span class="st"> </span>df<span class="op">$</span>nordic_countries</a>
<a class="sourceLine" id="cb82-6" title="6"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] Denmark Finland Iceland Norway  Sweden </a>
<a class="sourceLine" id="cb82-7" title="7"><span class="op">&gt;</span><span class="st"> </span>Levels<span class="op">:</span><span class="st"> </span>Denmark Finland Iceland Norway Sweden</a>
<a class="sourceLine" id="cb82-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Visa värdet i rad 2 och kolumn 1 </span></a>
<a class="sourceLine" id="cb82-9" title="9"><span class="er">&gt;</span><span class="st"> </span>df[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb82-10" title="10"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">1</span></a>
<a class="sourceLine" id="cb82-11" title="11"><span class="op">&gt;</span><span class="st"> </span>df<span class="op">$</span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb82-12" title="12"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">1</span></a></code></pre></div>
<p>Användning av enbart hakparentes är alltså ekvivalent med datahantering med hjälp av <code>$</code> och sedan position.</p>
<p>Även om koden med <code>$</code> ofta blir längre, så blir koden mer lättförståelig jämfört med indexering för kolumn. Dessutom slipper man problemet med att indexeringen kan ändras om nya variabler adderas till det data frame man arbetar med eller om det på något annat sätt förändras.</p>
<p>Med <code>$</code> går det även enkelt att addera nya variabler till en data frame.</p>
<ol start="3" style="list-style-type: decimal">
<li>Skriv nedanstående kod i <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co"># Skapa variabeln sample_size baserat på n som bara har ett värde</span></a>
<a class="sourceLine" id="cb83-2" title="2">df<span class="op">$</span>sample_size &lt;-<span class="st"> </span>u</a>
<a class="sourceLine" id="cb83-3" title="3">df</a>
<a class="sourceLine" id="cb83-4" title="4"><span class="co"># Skapa en variabel som heter ysq baserat på y i samma data frame.</span></a>
<a class="sourceLine" id="cb83-5" title="5">df<span class="op">$</span>ysq &lt;-<span class="st"> </span>df<span class="op">$</span>y<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb83-6" title="6">df</a>
<a class="sourceLine" id="cb83-7" title="7"><span class="co"># Skapa en tom variabel som heter x_cat</span></a>
<a class="sourceLine" id="cb83-8" title="8">df<span class="op">$</span>x_cat &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb83-9" title="9">df</a></code></pre></div>
<p>I Console visas nedanstående.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa variabeln sample_size baserat på n som bara har ett värde</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="er">&gt;</span><span class="st"> </span>df<span class="op">$</span>sample_size &lt;-<span class="st"> </span>u</a>
<a class="sourceLine" id="cb84-3" title="3"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb84-4" title="4"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size</a>
<a class="sourceLine" id="cb84-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark         <span class="dv">150</span></a>
<a class="sourceLine" id="cb84-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland         <span class="dv">150</span></a>
<a class="sourceLine" id="cb84-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland         <span class="dv">150</span></a>
<a class="sourceLine" id="cb84-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway         <span class="dv">150</span></a>
<a class="sourceLine" id="cb84-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span></a>
<a class="sourceLine" id="cb84-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en variabel som heter ysq baserat på y i samma data frame.</span></a>
<a class="sourceLine" id="cb84-11" title="11"><span class="er">&gt;</span><span class="st"> </span>df<span class="op">$</span>ysq &lt;-<span class="st"> </span>df<span class="op">$</span>y<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb84-12" title="12"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb84-13" title="13"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size ysq</a>
<a class="sourceLine" id="cb84-14" title="14"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark         <span class="dv">150</span>   <span class="dv">4</span></a>
<a class="sourceLine" id="cb84-15" title="15"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland         <span class="dv">150</span>   <span class="dv">9</span></a>
<a class="sourceLine" id="cb84-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland         <span class="dv">150</span>  <span class="dv">25</span></a>
<a class="sourceLine" id="cb84-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway         <span class="dv">150</span>  <span class="dv">36</span></a>
<a class="sourceLine" id="cb84-18" title="18"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span>  <span class="dv">81</span></a>
<a class="sourceLine" id="cb84-19" title="19"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en tom variabel som heter x_bin</span></a>
<a class="sourceLine" id="cb84-20" title="20"><span class="er">&gt;</span><span class="st"> </span>df<span class="op">$</span>x_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb84-21" title="21"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb84-22" title="22"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size ysq x_bin</a>
<a class="sourceLine" id="cb84-23" title="23"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark         <span class="dv">150</span>   <span class="dv">4</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb84-24" title="24"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland         <span class="dv">150</span>   <span class="dv">9</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb84-25" title="25"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland         <span class="dv">150</span>  <span class="dv">25</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb84-26" title="26"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway         <span class="dv">150</span>  <span class="dv">36</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb84-27" title="27"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span>  <span class="dv">81</span>    <span class="ot">NA</span></a></code></pre></div>
<p>Med <code>$</code> förenklas även användningen av de logiska operatorerna och det blir enkelt att transformera variabler och även skapa mindre data frames.</p>
<ol start="4" style="list-style-type: decimal">
<li>Skriv nedanstående kod i <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># Ändra värdet på sample_size för Danmark från 150 till 300</span></a>
<a class="sourceLine" id="cb85-2" title="2">df<span class="op">$</span>sample_size[df<span class="op">$</span>nordic_countries <span class="op">==</span><span class="st"> &quot;Denmark&quot;</span>] &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb85-3" title="3">df</a>
<a class="sourceLine" id="cb85-4" title="4"><span class="co"># Ändra värden från NA till 1 i x_cat om x är större än 2</span></a>
<a class="sourceLine" id="cb85-5" title="5">df<span class="op">$</span>x_cat[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb85-6" title="6">df</a>
<a class="sourceLine" id="cb85-7" title="7"><span class="co"># Ändra värden från NA till 0 i x_cat om x är mindre än eller lika 2</span></a>
<a class="sourceLine" id="cb85-8" title="8">df<span class="op">$</span>x_cat[x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb85-9" title="9">df</a>
<a class="sourceLine" id="cb85-10" title="10"><span class="co"># Skapa ett nytt data frame som vi kallas df_sweden bestående av bara rader för Sverige</span></a>
<a class="sourceLine" id="cb85-11" title="11">df_sweden &lt;-<span class="st"> </span>df[df<span class="op">$</span>nordic_countries<span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>, ]</a>
<a class="sourceLine" id="cb85-12" title="12">df_sweden</a></code></pre></div>
<p>I Console visas nedanstående.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Ändra värdet på sample_size för Danmark från 150 till 300</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="er">&gt;</span><span class="st"> </span>df<span class="op">$</span>sample_size[df<span class="op">$</span>nordic_countries <span class="op">==</span><span class="st"> &quot;Denmark&quot;</span>] &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb86-4" title="4"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size ysq x_bin</a>
<a class="sourceLine" id="cb86-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark         <span class="dv">300</span>   <span class="dv">4</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland         <span class="dv">150</span>   <span class="dv">9</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland         <span class="dv">150</span>  <span class="dv">25</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-8" title="8"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway         <span class="dv">150</span>  <span class="dv">36</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span>  <span class="dv">81</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-10" title="10"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Ändra värden från NA till 1 i x_cat om x är större än 2</span></a>
<a class="sourceLine" id="cb86-11" title="11"><span class="er">&gt;</span><span class="st"> </span>df<span class="op">$</span>x_cat[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb86-12" title="12"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb86-13" title="13"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size ysq x_bin x_cat</a>
<a class="sourceLine" id="cb86-14" title="14"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark         <span class="dv">300</span>   <span class="dv">4</span>    <span class="ot">NA</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb86-15" title="15"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland         <span class="dv">150</span>   <span class="dv">9</span>    <span class="ot">NA</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland         <span class="dv">150</span>  <span class="dv">25</span>    <span class="ot">NA</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway         <span class="dv">150</span>  <span class="dv">36</span>    <span class="ot">NA</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb86-18" title="18"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span>  <span class="dv">81</span>    <span class="ot">NA</span>    <span class="ot">NA</span></a>
<a class="sourceLine" id="cb86-19" title="19"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Ändra värden från NA till 0 i x_cat om x är mindre än eller lika 2</span></a>
<a class="sourceLine" id="cb86-20" title="20"><span class="er">&gt;</span><span class="st"> </span>df<span class="op">$</span>x_cat[x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb86-21" title="21"><span class="op">&gt;</span><span class="st"> </span>df</a>
<a class="sourceLine" id="cb86-22" title="22"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size ysq x_bin x_cat</a>
<a class="sourceLine" id="cb86-23" title="23"><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span>          Denmark         <span class="dv">300</span>   <span class="dv">4</span>    <span class="ot">NA</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb86-24" title="24"><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="dv">1</span> <span class="dv">3</span>          Finland         <span class="dv">150</span>   <span class="dv">9</span>    <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb86-25" title="25"><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span>          Iceland         <span class="dv">150</span>  <span class="dv">25</span>    <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb86-26" title="26"><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>           Norway         <span class="dv">150</span>  <span class="dv">36</span>    <span class="ot">NA</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb86-27" title="27"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span>  <span class="dv">81</span>    <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb86-28" title="28"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa ett nytt data frame som vi kallas df_sweden bestående av bara rader för Sverige</span></a>
<a class="sourceLine" id="cb86-29" title="29"><span class="er">&gt;</span><span class="st"> </span>df_sweden &lt;-<span class="st"> </span>df[df<span class="op">$</span>nordic_countries<span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>, ]</a>
<a class="sourceLine" id="cb86-30" title="30"><span class="op">&gt;</span><span class="st"> </span>df_sweden</a>
<a class="sourceLine" id="cb86-31" title="31"><span class="op">&gt;</span><span class="st">   </span>x y nordic_countries sample_size ysq x_bin x_cat</a>
<a class="sourceLine" id="cb86-32" title="32"><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="dv">0</span> <span class="dv">9</span>           Sweden         <span class="dv">150</span>  <span class="dv">81</span>    <span class="ot">NA</span>     <span class="dv">0</span></a></code></pre></div>
<p>Vi kommer senare under kursen gång upprepade gånger att återkomma till data frames och titta närmare olika typer av sätt att hantera detta objekt.</p>
<p>Vi avslutar med några grundläggande för att hatnera data frame.</p>
<ol start="5" style="list-style-type: decimal">
<li>Skriv in nedanstående i scriptet <strong>kap3_objekt_och_funktioner.R</strong>. Spara och kör.</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># Med names() anges namnen i ett dataframe. </span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">names</span>(df)</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="co"># Med colnames() namnges variablerna i en data frame</span></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>, <span class="st">&quot;nordic_countries&quot;</span>)</a>
<a class="sourceLine" id="cb87-5" title="5"><span class="kw">names</span>(df)</a></code></pre></div>
<p>Vi ser nu i Console att variabelnamnen har ändrats.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Med names() anges namnen i ett dataframe. </span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="er">&gt;</span><span class="st"> </span><span class="kw">names</span>(df)</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;x&quot;</span>                <span class="st">&quot;y&quot;</span>                <span class="st">&quot;nordic_countries&quot;</span> <span class="st">&quot;sample_size&quot;</span>     </a>
<a class="sourceLine" id="cb88-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>] <span class="st">&quot;ysq&quot;</span>              <span class="st">&quot;x_bin&quot;</span>            <span class="st">&quot;x_cat&quot;</span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Med colnames() namnges variablerna i en data frame</span></a>
<a class="sourceLine" id="cb88-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>, <span class="st">&quot;nordic_countries&quot;</span>)</a>
<a class="sourceLine" id="cb88-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="kw">names</span>(df)</a>
<a class="sourceLine" id="cb88-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;age&quot;</span>              <span class="st">&quot;income&quot;</span>           <span class="st">&quot;nordic_countries&quot;</span> <span class="ot">NA</span>                </a>
<a class="sourceLine" id="cb88-9" title="9"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>] <span class="ot">NA</span>                 <span class="ot">NA</span>                 <span class="ot">NA</span></a></code></pre></div>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> </font>
<img src="docs/images/important.png" width="5%" /></p>
<p>Hantering av data är av lättförklarliga skäl väldigt viktigt i R. Det tar inledningsvis tid att lära, men är samtidigt något som varje användare måste vara trygg med. Värt att nämna är att nästan alltid finns alternativa sätt arbeta med data i R och vad som presentas här är är endast ett alternativ. På denna kurs <strong>rekommenderas starkt </strong>att ni följer den metodik som presenteras här. Visserligen är den inte effektivast, varken i termer av beräkningstid eller längd på kod, men det är ett transparent arbetssätt som minimerar risken för att fel uppkommer.</p>
<p>Datahanteringen är ofta en tidskrävande del i statistisk undersökning och stor noggrannhet är viktigt. Det går inte att tillräckligt betona hur betydelsefull datahanteringen är i en undersökning. En korrekt analys kräver ju korrekt data.</p>
</div>
</div>
<div id="funktioner" class="section level2">
<h2><span class="header-section-number">3.5</span> Funktioner</h2>
<p>En funktion utför operationer på objekt. Exakt vad funktionen gör beror på funktionen. Det vara allt från att utföra enkla räkneoperationer på data i en vektor, till komplicerade beräkningar och förändringar av data. Oftast sparas resultatet från en funktion som ett nytt objekt. En funktion har i regel också olika argument som gör det möjligt för användaren att anpassa vad funktionen gör. Den något mer avancerade R-användaren kan även enkelt skapa egna funktioner, vilket är styrka eftersom R då blir väldigt flexibelt. Att skapa egna funktioner ingår emellertid inte på denna kurs utan analyserna som utförs på kurser kommer hanteras av redan implementerade funktioner i R. Denna introduktionen till funktioner är därför relativt kortfattad och det enklaste sättet att introducera funktion blir med hjälp av exempel.</p>
<ol style="list-style-type: decimal">
<li>Skriv in nedanstående kod i scriptet <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co"># sum() är en funktion för att summera värdera i en vektor. Summan sparas i objektet summax</span></a>
<a class="sourceLine" id="cb89-2" title="2">summax &lt;-<span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb89-3" title="3">summax</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="co"># length() beräknar antalet element i en vektor och spara i objektet n</span></a>
<a class="sourceLine" id="cb89-5" title="5">n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb89-6" title="6">n</a></code></pre></div>
<p>I Console får erhålls följande.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># sum() är en funktion för att summera värdera i en vektor. Summan sparas i objektet sumx</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="er">&gt;</span><span class="st"> </span>sumx &lt;-<span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="op">&gt;</span><span class="st"> </span>sumx</a>
<a class="sourceLine" id="cb90-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">10</span></a>
<a class="sourceLine" id="cb90-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># length() beräknar antalet element i en vektor och spara i objektet n</span></a>
<a class="sourceLine" id="cb90-6" title="6"><span class="er">&gt;</span><span class="st"> </span>n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb90-7" title="7"><span class="op">&gt;</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb90-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">5</span></a></code></pre></div>
<p>Du har nu tillämpat funktionen <em>sum()</em> som summerar alla elementvärden i en vektor, dvs <span class="math inline">\(\sum_{i=1}^n x_i=x_1 + x_2 + \cdots + x_k\)</span>. Funktionen <em>length()</em> räknar antalet element.</p>
<p>Med hjälp av dessa funktioner går det nu att på enkelt sätt att beräkna
medelvärdet, <span class="math inline">\(\bar{x}=\dfrac{1}{n}\sum_{i=1}^n x_i\)</span>, och stickprovsvarians, <span class="math inline">\(s^2=\dfrac{1}{n-1}\sum_{i=1}^n(x_i - \bar{x})^2\)</span>. Notera att standardavvikelsen är <span class="math inline">\(s=\sqrt{s^2}\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>Skriv in nedanstående kod i scriptet <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># Beräkna medelvärdet av en vektor</span></a>
<a class="sourceLine" id="cb91-2" title="2">sample.mean &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>n)<span class="op">*</span>sumx</a>
<a class="sourceLine" id="cb91-3" title="3">sample.mean</a>
<a class="sourceLine" id="cb91-4" title="4"></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="co"># Beräkna stickprovsvarians s^2 med det sum() samt de sparade objekten xbar och n</span></a>
<a class="sourceLine" id="cb91-6" title="6">sample.variance &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>))<span class="op">*</span><span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb91-7" title="7">sample.variance</a></code></pre></div>
<p>I Console visas nedanstående.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Beräkna medelvärdet av en vektor</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="er">&gt;</span><span class="st"> </span>sample.mean &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>n)<span class="op">*</span>sumx</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="op">&gt;</span><span class="st"> </span>sample.mean</a>
<a class="sourceLine" id="cb92-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span></a>
<a class="sourceLine" id="cb92-5" title="5"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="co"># Beräkna stickprovsvarians s^2 med hjälp av sum() samt de sparade objekten xbar och n</span></a>
<a class="sourceLine" id="cb92-7" title="7"><span class="er">&gt;</span><span class="st"> </span>sample.variance &lt;-<span class="st">  </span>(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>))<span class="op">*</span><span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span>sample.mean)<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb92-8" title="8"><span class="op">&gt;</span><span class="st"> </span>sample.variance</a>
<a class="sourceLine" id="cb92-9" title="9"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">4</span></a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Naturligtvis finns i R färdiga funktioner för både medelvärde och stickprovsvarians. Skriv in nedanstående kod i scriptet <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># Beräkna medelvärdet av en vektor</span></a>
<a class="sourceLine" id="cb93-2" title="2">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb93-3" title="3">xbar</a>
<a class="sourceLine" id="cb93-4" title="4"><span class="co"># Beräkna stickprovsvariansen av en vektor</span></a>
<a class="sourceLine" id="cb93-5" title="5">s2 &lt;-<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb93-6" title="6">s2</a></code></pre></div>
<p>I Console visas nedanstående.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Beräkna medelvärdet av en vektor</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="er">&gt;</span><span class="st"> </span>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="op">&gt;</span><span class="st"> </span>xbar</a>
<a class="sourceLine" id="cb94-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Beräkna stickprovsvariansen av en vektor</span></a>
<a class="sourceLine" id="cb94-6" title="6"><span class="er">&gt;</span><span class="st"> </span>s2 &lt;-<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb94-7" title="7"><span class="op">&gt;</span><span class="st"> </span>s2</a>
<a class="sourceLine" id="cb94-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">4</span></a></code></pre></div>
<p>Resultatet är samma som det tidigare, enda skillnaden är att funktionerna <em>mean(x)</em> och <em>var()</em> förenklar ytterligare. Men vi genom detta också en förståelse för vilka formler som <em>mean()</em> och <em>var()</em> använder sig av.</p>
<ol start="4" style="list-style-type: decimal">
<li>Skriv in nedanstående kod i scriptet <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># Beräkna medelvärdet av ymis, en vektor med att bortfall</span></a>
<a class="sourceLine" id="cb95-2" title="2">ymis.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(ymis)</a>
<a class="sourceLine" id="cb95-3" title="3">ymis.mean</a>
<a class="sourceLine" id="cb95-4" title="4"><span class="co"># Beräkna medelvärdet av ymis, en vektor med att bortfall</span></a>
<a class="sourceLine" id="cb95-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb95-6" title="6">ymisbar &lt;-<span class="st"> </span><span class="kw">mean</span>(ymis, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb95-7" title="7">ymisbar</a></code></pre></div>
<p>I Console presenteras följande.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Beräkna medelvärdet av ymis, en vektor med att bortfall</span></a>
<a class="sourceLine" id="cb96-2" title="2"><span class="er">&gt;</span><span class="st"> </span>ymis.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(ymis)</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="op">&gt;</span><span class="st"> </span>ymis.mean</a>
<a class="sourceLine" id="cb96-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="ot">NA</span></a>
<a class="sourceLine" id="cb96-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Beräkna medelvärdet av ymis, en vektor med att bortfall</span></a>
<a class="sourceLine" id="cb96-6" title="6"><span class="er">&gt;</span><span class="st"> </span><span class="co">#</span></a>
<a class="sourceLine" id="cb96-7" title="7"><span class="er">&gt;</span><span class="st"> </span>ymisbar &lt;-<span class="st"> </span><span class="kw">mean</span>(ymis, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-8" title="8"><span class="op">&gt;</span><span class="st"> </span>ymisbar</a>
<a class="sourceLine" id="cb96-9" title="9"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">4.5</span></a></code></pre></div>
<p>Eftersom R ger att <span class="math inline">\(y_1 + y_2 + NA + \cdots + y_k = NA\)</span> blir även medelvärdet NA. Vi kan dock använda ett argument i funktionen som heter <em>na.rm</em> som vi sätter till <em>TRUE</em>. Om detta argument sätts till <em>TRUE</em> så tar funktionen före beräkning bort saknade värden. Default-inställningen är dock att detta argument är satt till <em>FALSE</em>. Det innebär att medelvärdet <em>ymisbar</em> är beräknat på de fyra värden som har observationer.</p>
<p>För att veta vilka argument en funktion har skriver använd funktionen <strong>help()</strong>. I exemplet med medelvärdet så skriver du <code>help(mean)</code>. I nedre högra panelen i Rstudio under fliken <em>Help</em> visas nu information om den funktion som vi ville veta mer om.</p>
<p><img src="docs/images/helpmean.PNG" width="100%" /></p>
<p>I hjälpfilen står under <em>Usage</em> hur funktionen kan användas <code>mean(x, trim = 0, na.rm = FALSE)</code> och under <em>Arguments</em> hittar beskrivs vad argumenten betyder. Till exempel står det <code>na.rm  a logical value indicating whether NA values should be stripped before the computation proceeds.</code>. Grundinställningen (default) satt till FALSE efter detta är angivet i <em>Usage</em>. Hjälpfilerna är ofta svåra att förstå, men exemplen längst ner i hjälpfilerna är i regel klargörande.</p>
<p>På denna kurs kommer funktioner att introduceras efterhand. Funktioner är nämligen något som man lär sig genom tillämpning och inte genom att lära sig utantill i förväg. Dock kan det vara bra att ha en lista över alla de vanliga funktionerna så man vet vilka möjligheter som finns.</p>
<p><a href="https://cran.r-project.org/doc/contrib/Short-refcard.pdf" class="uri">https://cran.r-project.org/doc/contrib/Short-refcard.pdf</a></p>
<p>Vi börjar här med några grundläggande funktioner som är användbara.</p>
<ol start="5" style="list-style-type: decimal">
<li>Skriv in nedanstående kod i scriptet <strong>kap3_objekt_och_funktioner.R</strong>, spara och kör.</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co"># Skapa en vektor som repeterar värde 3 fem gånger</span></a>
<a class="sourceLine" id="cb97-2" title="2">x1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb97-3" title="3">x1</a>
<a class="sourceLine" id="cb97-4" title="4"><span class="co"># Skapa en vektor som repeterar NA 10 fem gånger</span></a>
<a class="sourceLine" id="cb97-5" title="5">xNA &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb97-6" title="6">xNA</a>
<a class="sourceLine" id="cb97-7" title="7"><span class="co"># Funktion som skapar en sekvens från 2 till 3 med steglängd 0.25</span></a>
<a class="sourceLine" id="cb97-8" title="8">x2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb97-9" title="9">x2</a>
<a class="sourceLine" id="cb97-10" title="10"><span class="co"># Skapa en en vektor av element som repeterats </span></a>
<a class="sourceLine" id="cb97-11" title="11">x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">9</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb97-12" title="12">x3</a>
<a class="sourceLine" id="cb97-13" title="13"><span class="co"># Funktion för att summera information i ett objekt</span></a>
<a class="sourceLine" id="cb97-14" title="14"><span class="kw">summary</span>(ymis)</a>
<a class="sourceLine" id="cb97-15" title="15"><span class="co"># Funktion skapar ett histogram</span></a>
<a class="sourceLine" id="cb97-16" title="16"><span class="kw">hist</span>(x)</a>
<a class="sourceLine" id="cb97-17" title="17"><span class="co"># Funktion som skapar ett spridningsdiagram</span></a>
<a class="sourceLine" id="cb97-18" title="18"><span class="kw">plot</span>(x, y)</a></code></pre></div>
<p>I Console visas</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en vektor som repeterar värde 3 fem gånger</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="er">&gt;</span><span class="st"> </span>x1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="op">&gt;</span><span class="st"> </span>x1</a>
<a class="sourceLine" id="cb98-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb98-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en vektor som repeterar NA 10 fem gånger</span></a>
<a class="sourceLine" id="cb98-6" title="6"><span class="er">&gt;</span><span class="st"> </span>xNA &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-7" title="7"><span class="op">&gt;</span><span class="st"> </span>xNA</a>
<a class="sourceLine" id="cb98-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span></a>
<a class="sourceLine" id="cb98-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion som skapar en sekvens från 2 till 3 med steglängd 0.25</span></a>
<a class="sourceLine" id="cb98-10" title="10"><span class="er">&gt;</span><span class="st"> </span>x2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb98-11" title="11"><span class="op">&gt;</span><span class="st"> </span>x2</a>
<a class="sourceLine" id="cb98-12" title="12"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">2.00</span> <span class="fl">2.25</span> <span class="fl">2.50</span> <span class="fl">2.75</span> <span class="fl">3.00</span></a>
<a class="sourceLine" id="cb98-13" title="13"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa en en vektor av element som repeterats </span></a>
<a class="sourceLine" id="cb98-14" title="14"><span class="er">&gt;</span><span class="st"> </span>x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">9</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb98-15" title="15"><span class="op">&gt;</span><span class="st"> </span>x3</a>
<a class="sourceLine" id="cb98-16" title="16"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb98-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion för att summera information i ett objekt</span></a>
<a class="sourceLine" id="cb98-18" title="18"><span class="er">&gt;</span><span class="st"> </span><span class="kw">summary</span>(ymis)</a>
<a class="sourceLine" id="cb98-19" title="19"><span class="op">&gt;</span><span class="st">    </span>Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">&#39;s </span></a>
<a class="sourceLine" id="cb98-20" title="20"><span class="st">&gt;     3.0     3.0     4.5     4.5     6.0     6.0       1</span></a>
<a class="sourceLine" id="cb98-21" title="21"><span class="st">&gt; # Funktion skapar ett histogram</span></a>
<a class="sourceLine" id="cb98-22" title="22"><span class="st">&gt; hist(x)</span></a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion som skapar ett spridningsdiagram</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="er">&gt;</span><span class="st"> </span><span class="kw">plot</span>(x, y)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-111-2.png" width="672" /></p>
<p>Avslutningsvis finns det ett antal frekvent använda samt viktiga funktioner för dataobjekt. Bekanta dig med dessa.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion för att beskriva datatyp </span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="er">&gt;</span><span class="st"> </span><span class="kw">class</span>(y)</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;numeric&quot;</span></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="op">&gt;</span><span class="st"> </span><span class="kw">class</span>(nordic_countries)</a>
<a class="sourceLine" id="cb100-5" title="5"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;character&quot;</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion för att beskriva objekt </span></a>
<a class="sourceLine" id="cb100-7" title="7"><span class="er">&gt;</span><span class="st"> </span><span class="kw">str</span>(y)</a>
<a class="sourceLine" id="cb100-8" title="8"><span class="op">&gt;</span><span class="st">  </span>num [<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">9</span></a>
<a class="sourceLine" id="cb100-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="kw">str</span>(nordic_countries)</a>
<a class="sourceLine" id="cb100-10" title="10"><span class="op">&gt;</span><span class="st">  </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="st">&quot;Denmark&quot;</span> <span class="st">&quot;Finland&quot;</span> <span class="st">&quot;Iceland&quot;</span> <span class="st">&quot;Norway&quot;</span> <span class="st">&quot;Sweden&quot;</span></a>
<a class="sourceLine" id="cb100-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion för att ta reda på storleken på matris eller data frame</span></a>
<a class="sourceLine" id="cb100-12" title="12"><span class="er">&gt;</span><span class="st"> </span><span class="kw">dim</span>(m1)</a>
<a class="sourceLine" id="cb100-13" title="13"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb100-14" title="14"><span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(df)</a>
<a class="sourceLine" id="cb100-15" title="15"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">5</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb100-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(df)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb100-17" title="17"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">5</span></a>
<a class="sourceLine" id="cb100-18" title="18"><span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(df)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb100-19" title="19"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">7</span></a>
<a class="sourceLine" id="cb100-20" title="20"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktion för att beräkna längden av en vektor</span></a>
<a class="sourceLine" id="cb100-21" title="21"><span class="er">&gt;</span><span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb100-22" title="22"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">5</span></a>
<a class="sourceLine" id="cb100-23" title="23"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktionen ls() listar alla objekt i minnet</span></a>
<a class="sourceLine" id="cb100-24" title="24"><span class="er">&gt;</span><span class="st"> </span><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb100-25" title="25"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="st">&quot;df&quot;</span>                   <span class="st">&quot;df_sweden&quot;</span>            <span class="st">&quot;m1&quot;</span>                  </a>
<a class="sourceLine" id="cb100-26" title="26"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">4</span>] <span class="st">&quot;m2&quot;</span>                   <span class="st">&quot;m3&quot;</span>                   <span class="st">&quot;m4&quot;</span>                  </a>
<a class="sourceLine" id="cb100-27" title="27"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">7</span>] <span class="st">&quot;m5&quot;</span>                   <span class="st">&quot;my__first_vec&quot;</span>        <span class="st">&quot;n&quot;</span>                   </a>
<a class="sourceLine" id="cb100-28" title="28"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">10</span>] <span class="st">&quot;nordic_countries&quot;</span>     <span class="st">&quot;nordic_countries_new&quot;</span> <span class="st">&quot;s2&quot;</span>                  </a>
<a class="sourceLine" id="cb100-29" title="29"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">13</span>] <span class="st">&quot;sample.mean&quot;</span>          <span class="st">&quot;sample.variance&quot;</span>      <span class="st">&quot;scandinavia&quot;</span>         </a>
<a class="sourceLine" id="cb100-30" title="30"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">16</span>] <span class="st">&quot;sumx&quot;</span>                 <span class="st">&quot;u&quot;</span>                    <span class="st">&quot;v&quot;</span>                   </a>
<a class="sourceLine" id="cb100-31" title="31"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">19</span>] <span class="st">&quot;w&quot;</span>                    <span class="st">&quot;x&quot;</span>                    <span class="st">&quot;x_bin&quot;</span>               </a>
<a class="sourceLine" id="cb100-32" title="32"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">22</span>] <span class="st">&quot;x_new&quot;</span>                <span class="st">&quot;x_nordic_countries&quot;</span>   <span class="st">&quot;x1&quot;</span>                  </a>
<a class="sourceLine" id="cb100-33" title="33"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">25</span>] <span class="st">&quot;x1345&quot;</span>                <span class="st">&quot;x2&quot;</span>                   <span class="st">&quot;x3&quot;</span>                  </a>
<a class="sourceLine" id="cb100-34" title="34"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">28</span>] <span class="st">&quot;xbar&quot;</span>                 <span class="st">&quot;xNA&quot;</span>                  <span class="st">&quot;y&quot;</span>                   </a>
<a class="sourceLine" id="cb100-35" title="35"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">31</span>] <span class="st">&quot;y15&quot;</span>                  <span class="st">&quot;y234&quot;</span>                 <span class="st">&quot;ymis&quot;</span>                </a>
<a class="sourceLine" id="cb100-36" title="36"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">34</span>] <span class="st">&quot;ymis.mean&quot;</span>            <span class="st">&quot;ymisbar&quot;</span>              <span class="st">&quot;ysub&quot;</span>                </a>
<a class="sourceLine" id="cb100-37" title="37"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">37</span>] <span class="st">&quot;z&quot;</span>                    <span class="st">&quot;z_trinary&quot;</span>            <span class="st">&quot;z1&quot;</span>                  </a>
<a class="sourceLine" id="cb100-38" title="38"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">40</span>] <span class="st">&quot;z2&quot;</span>                   <span class="st">&quot;z3&quot;</span></a>
<a class="sourceLine" id="cb100-39" title="39"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Funktionen rm() raderar ett objekt</span></a>
<a class="sourceLine" id="cb100-40" title="40"><span class="er">&gt;</span><span class="st"> </span><span class="kw">rm</span>(y)</a>
<a class="sourceLine" id="cb100-41" title="41"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Se om objektet y finns kvar</span></a>
<a class="sourceLine" id="cb100-42" title="42"><span class="er">&gt;</span><span class="st"> </span><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb100-43" title="43"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">1</span>] <span class="st">&quot;df&quot;</span>                   <span class="st">&quot;df_sweden&quot;</span>            <span class="st">&quot;m1&quot;</span>                  </a>
<a class="sourceLine" id="cb100-44" title="44"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">4</span>] <span class="st">&quot;m2&quot;</span>                   <span class="st">&quot;m3&quot;</span>                   <span class="st">&quot;m4&quot;</span>                  </a>
<a class="sourceLine" id="cb100-45" title="45"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">7</span>] <span class="st">&quot;m5&quot;</span>                   <span class="st">&quot;my__first_vec&quot;</span>        <span class="st">&quot;n&quot;</span>                   </a>
<a class="sourceLine" id="cb100-46" title="46"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">10</span>] <span class="st">&quot;nordic_countries&quot;</span>     <span class="st">&quot;nordic_countries_new&quot;</span> <span class="st">&quot;s2&quot;</span>                  </a>
<a class="sourceLine" id="cb100-47" title="47"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">13</span>] <span class="st">&quot;sample.mean&quot;</span>          <span class="st">&quot;sample.variance&quot;</span>      <span class="st">&quot;scandinavia&quot;</span>         </a>
<a class="sourceLine" id="cb100-48" title="48"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">16</span>] <span class="st">&quot;sumx&quot;</span>                 <span class="st">&quot;u&quot;</span>                    <span class="st">&quot;v&quot;</span>                   </a>
<a class="sourceLine" id="cb100-49" title="49"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">19</span>] <span class="st">&quot;w&quot;</span>                    <span class="st">&quot;x&quot;</span>                    <span class="st">&quot;x_bin&quot;</span>               </a>
<a class="sourceLine" id="cb100-50" title="50"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">22</span>] <span class="st">&quot;x_new&quot;</span>                <span class="st">&quot;x_nordic_countries&quot;</span>   <span class="st">&quot;x1&quot;</span>                  </a>
<a class="sourceLine" id="cb100-51" title="51"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">25</span>] <span class="st">&quot;x1345&quot;</span>                <span class="st">&quot;x2&quot;</span>                   <span class="st">&quot;x3&quot;</span>                  </a>
<a class="sourceLine" id="cb100-52" title="52"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">28</span>] <span class="st">&quot;xbar&quot;</span>                 <span class="st">&quot;xNA&quot;</span>                  <span class="st">&quot;y15&quot;</span>                 </a>
<a class="sourceLine" id="cb100-53" title="53"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">31</span>] <span class="st">&quot;y234&quot;</span>                 <span class="st">&quot;ymis&quot;</span>                 <span class="st">&quot;ymis.mean&quot;</span>           </a>
<a class="sourceLine" id="cb100-54" title="54"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">34</span>] <span class="st">&quot;ymisbar&quot;</span>              <span class="st">&quot;ysub&quot;</span>                 <span class="st">&quot;z&quot;</span>                   </a>
<a class="sourceLine" id="cb100-55" title="55"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">37</span>] <span class="st">&quot;z_trinary&quot;</span>            <span class="st">&quot;z1&quot;</span>                   <span class="st">&quot;z2&quot;</span>                  </a>
<a class="sourceLine" id="cb100-56" title="56"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">40</span>] <span class="st">&quot;z3&quot;</span></a></code></pre></div>
<p>Avslutningsvis finns en viktig funktion som används för att <strong>radera alla objekt</strong>. Det är</p>
<ul>
<li><code>rm(list = ls())</code>.</li>
</ul>
<p>Var försiktig med denna funktion eftersom alla objekt i minnet försvinner! Emellertid är god idé inleda ett script för en dataanlys med denna kod för att säkerställa att minnet är tomt innan ny data läses in. På så vis undviker vi konflkter mellan objekt. Förslagsvis används denna funktion inför <strong>varje ny</strong> övningsuppgift, såvida inte uppgiftern bygger på information från tidigare uppgifter.</p>
<hr />
</div>
<div id="sammanfattning-2" class="section level2">
<h2><span class="header-section-number">3.6</span> Sammanfattning</h2>
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> </font>
Du ska kunna</p>
<ul>
<li>känna till de viktigaste datatyperna som R arbetar med.</li>
<li>känna till de tre olika typerna av dataobjekt.</li>
<li>genomföra enklare datahantering, till exempel förändra ett specifikt elements värde i ett dataobjekt eller att med logiska operationer välja ut data från ett objekt.</li>
<li>genomföra logiska operationer på vektorer och data frames.</li>
<li>använda <code>$</code> i data frames.</li>
<li>tillämpa några vanliga funktioner i R samt även informera dig om vad en funktion gör genom att använda hjälp-filen.</li>
</ul>
</div>
<hr />
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> </font>
<img src="docs/images/note.png" width="5%" /></p>
<ul>
<li>Bortfall komplicerar analyser och kodas på olika sätt. Det hanteras separat i kapitlet om bortfall.</li>
<li>På denna kurs används baspaketen i R för datahantering. I R-universumet finns även en uppsättning paket som tillhör det så kallade <em>tidyverse()</em>. Här finns paket med en mängd funktioner som förenklar avancerad datahantering betydligt och som också följer en logik som många uppskattar. På denna kurs och för de flesta användare är dock baspaketen i R fullt tillräckligt.</li>
<li>Kategorivariabler kallas faktorer och kommer att hanteras utförligt i kapitlet om faktorer. Att ha en förståelse för hur man hanterar faktorer är nödvändigt inom all dataanlys.</li>
<li>I R används även typiska programmeringssatser innehållande <em>for</em>, <em>if</em>, <em>else</em>, <em>while</em>. Detta är emellertid inte något som vi kommer att arbeta med på denna kurs.</li>
</ul>
</div>
<hr />
</div>
<div id="övningar-1" class="section level2">
<h2><span class="header-section-number">3.7</span> Övningar</h2>
<div id="övning-3.1" class="section level3 unnumbered">
<h3>Övning 3.1</h3>
<p>Du har ett stickprov betående av observationerna <span class="math inline">\(4,-2,5,6,8\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna medelvärdet.</li>
<li>Beräkna standardavvikelsen.</li>
<li>Beräkna variationsbredden.</li>
<li>Beräkna det geometriska medelvärdet för de positiva värden <span class="math inline">\(4, 5, 6, 8\)</span>.</li>
<li>Beräkna det geometriska medelvärdet för alla värden <span class="math inline">\(4, -2, 5, 6, 8\)</span>.</li>
</ol>
<button title="q301" type="button" onclick="if(document.getElementById(&#39;q301&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q301&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q301&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q301" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co"># Töm minnet inför denna Övning 3.1 </span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb101-3" title="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb101-5" title="5">[<span class="dv">1</span>] <span class="fl">4.2</span></a></code></pre></div>
<ul>
<li>Svar: Medelvärdet är 4.2</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Standardavvikelsen <span class="math inline">\(s=\sqrt{\dfrac{\sum_{i=1}^n (x_i -\bar{x})^2}{n-1}}\)</span> beräknas med</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb102-2" title="2">[<span class="dv">1</span>] <span class="fl">3.768289</span></a></code></pre></div>
<ul>
<li>Svar: Standardavvikelsen är 3.768</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Variationsbredden, dvs skillnaden mellan det största och det minsta värdet är</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<ul>
<li>Svar: Variationsbredden är är 10.</li>
</ul>
<ol start="4" style="list-style-type: lower-alpha">
<li>Det geometriska medelvärdet <span class="math inline">\(\bar{x}_g=(x_1\cdot x_2 \cdot \cdots \cdot x_n)^{1/n}\)</span> kan i R beräknas med</li>
</ol>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># Välj enbart positiva värden</span></a>
<a class="sourceLine" id="cb105-2" title="2">xpos &lt;-<span class="st"> </span>x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] </a>
<a class="sourceLine" id="cb105-3" title="3"><span class="co"># Du kan beräkna det geometriska medelvärdet med</span></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="kw">exp</span>( <span class="kw">mean</span>(<span class="kw">log</span>(xpos)) )</a></code></pre></div>
<pre><code>## [1] 5.566315</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># Alternativt kan du funktionen geometric.mean() </span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="co"># i paketet psych. Aktivera paketet och beräkna.</span></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="kw">library</span>(<span class="st">&quot;psych&quot;</span>)</a>
<a class="sourceLine" id="cb107-4" title="4"><span class="kw">geometric.mean</span>(xpos)</a></code></pre></div>
<pre><code>## [1] 5.566315</code></pre>
<ul>
<li>Svar: Det geometriska medelvärdet är 3.95.</li>
</ul>
<ol start="5" style="list-style-type: lower-alpha">
<li>Det geometriska medelvärdet <span class="math display">\[\bar{x}_g=(x_1\cdot x_2 \cdot \cdots \cdot x_n)^{1/n}\]</span> kan i R beräknas med</li>
</ol>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">(<span class="dv">4</span>  <span class="op">*</span><span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">geometric.mean</span>(x)</a></code></pre></div>
<pre><code>## Warning in log(x): NaNs produced</code></pre>
<pre><code>## [1] 5.566315</code></pre>
<ul>
<li>Svar: Eftersom en observation är negativ blir NaN, vilket betyder ‘’Not a Number’’. Det går alltså inte att beräkna.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.2" class="section level3 unnumbered">
<h3>Övning 3.2</h3>
<p>Ett slumpmässigt urval ger följande observationer <span class="math inline">\(0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1\)</span>,där <span class="math inline">\(1=Arbetslös\)</span> och <span class="math inline">\(0=Förvärvsarbetande\)</span>.
Beräkna andelen arbetslösa i stickprovet.</p>
<button title="q302" type="button" onclick="if(document.getElementById(&#39;q302&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q302&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q302&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q302" style="display:none">
<div class="alert alert-info">
<p>Andelen arbetslösa beräkna i R med</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="co"># Töm minnet inför denna Övning 3.2 </span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb114-3" title="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">1</span>, <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>, <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb114-4" title="4"><span class="kw">mean</span>(x)</a></code></pre></div>
<pre><code>## [1] 0.3846154</code></pre>
<ul>
<li>Svar: Andelen arbetslösa i stickprovet är 0.38.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.3" class="section level3 unnumbered">
<h3>Övning 3.3</h3>
<p>Kosumentpriset 2006-2011 är</p>
<table>
<caption>(#tab:unnamed-chunk-120)Konsumentprisindex (KPI) 2006-2011</caption>
<tbody>
<tr class="odd">
<td align="right">2006</td>
<td align="right">284.2</td>
</tr>
<tr class="even">
<td align="right">2007</td>
<td align="right">290.5</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">300.6</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="right">299.7</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">303.5</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">311.4</td>
</tr>
</tbody>
</table>
<p>Med hur många procent har prisnivån förändrats från 2007 till 2010?</p>
<button title="q303" type="button" onclick="if(document.getElementById(&#39;q303&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q303&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q303&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q303" style="display:none">
<div class="alert alert-info">
<p>Beräkning i R ger</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="co"># Töm minnet inför denna Övning 3.2 </span></a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb116-3" title="3">year &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2006</span>, <span class="dv">2007</span>, <span class="dv">2008</span>, <span class="dv">2009</span>, <span class="dv">2010</span>, <span class="dv">2011</span>)</a>
<a class="sourceLine" id="cb116-4" title="4">kpi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">284.22</span>, <span class="fl">290.51</span>, <span class="fl">300.61</span>, <span class="fl">299.66</span>, <span class="fl">303.46</span>, <span class="fl">311.423</span>)</a>
<a class="sourceLine" id="cb116-5" title="5">percent_change &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span>(kpi[year <span class="op">==</span><span class="st"> </span><span class="dv">2010</span>]<span class="op">/</span>kpi[year <span class="op">==</span><span class="st"> </span><span class="dv">2007</span>])<span class="op">-</span><span class="dv">100</span></a></code></pre></div>
<ul>
<li>Svar: Prisnivån har ökat med 4.458%.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.4" class="section level3 unnumbered">
<h3>Övning 3.4</h3>
<p>Låt observationerna <span class="math inline">\(4,-2,5,6,8\)</span> vara obundet slumpmässigt urval från en normalfördelad population. Genomför en hypotesprövning på 5% signifikansnivå för att testa medelvärdet i population är skild från 1.</p>
<button title="q304" type="button" onclick="if(document.getElementById(&#39;q304&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q304&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q304&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q304" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: decimal">
<li>Vi observerar <span class="math inline">\(x=\{4,-2,5,6,8\}.\)</span></li>
<li>Hypoteser: <span class="math inline">\(H_0:\mu=1\)</span> vs <span class="math inline">\(H_1:\mu \neq 1\)</span></li>
<li>Antaganden: Variabeln <span class="math inline">\(x\)</span> är normalfördelad i populationen. Populationsvariansen <span class="math inline">\(\sigma^2\)</span> är okänd i populationen. Vi har ett litet stickprov, <span class="math inline">\(n=5\)</span>.</li>
<li>Testfunktionen ges av <span class="math inline">\(t=\dfrac{\bar{x}-\mu}{\sqrt{s^2/n}}\)</span>. Denna teststatistika är <span class="math inline">\(t\)</span>-fördelad med <span class="math inline">\(n-1\)</span> frihetsgrader om nollhypotesen är sann.</li>
<li>Beslutregel: <span class="math inline">\(\alpha=0.05\)</span>. Tvåsidigt test, förkasta därför <span class="math inline">\(H_0\)</span> om <span class="math inline">\(|t_{obs}| &gt; t_{krit} = t_{4,\alpha/2=0.025} = 2.776\)</span></li>
</ol>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co"># Töm minnet inför uppgift 3.4</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb117-3" title="3"><span class="co"># Vi ska lösa uppgiften först illusterat med objekt i R</span></a>
<a class="sourceLine" id="cb117-4" title="4"><span class="co"># Sedan löser vi den med den inbyggda funktionen för t-test</span></a>
<a class="sourceLine" id="cb117-5" title="5"></a>
<a class="sourceLine" id="cb117-6" title="6"><span class="co"># Bestäm värden som ska in i testfunktionen</span></a>
<a class="sourceLine" id="cb117-7" title="7">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb117-8" title="8">n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb117-9" title="9">xbar &lt;-<span class="st"> </span><span class="kw">mean</span> (x)</a>
<a class="sourceLine" id="cb117-10" title="10">s2 &lt;-<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb117-11" title="11">mu &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb117-12" title="12"><span class="co"># Beräkna testfunktionen</span></a>
<a class="sourceLine" id="cb117-13" title="13">tobs &lt;-<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span>mu)<span class="op">/</span><span class="kw">sqrt</span>(s2<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb117-14" title="14"><span class="co"># Se var testfunktionensvärde hamnar i en t-fördelning med n-1 frihetsgrader</span></a>
<a class="sourceLine" id="cb117-15" title="15"><span class="co"># Funktionen pt() ger för ett givet t-värde vänstersvanssannolikheter i en t-fördelning med n-1 frihetsgrader </span></a>
<a class="sourceLine" id="cb117-16" title="16"><span class="co"># Eftersom vi vill ha sannolikheten i högra svansen måste vi därför ta 1-pt().</span></a>
<a class="sourceLine" id="cb117-17" title="17"><span class="co"># Slutligen, eftersom mothypotesen är två-sidig multipliceras p-värdet med 2.</span></a>
<a class="sourceLine" id="cb117-18" title="18">p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(tobs, (n<span class="dv">-1</span>)))</a>
<a class="sourceLine" id="cb117-19" title="19">p_value</a>
<a class="sourceLine" id="cb117-20" title="20">[<span class="dv">1</span>] <span class="fl">0.1304116</span></a>
<a class="sourceLine" id="cb117-21" title="21"></a>
<a class="sourceLine" id="cb117-22" title="22"><span class="kw">t.test</span>(x, <span class="dt">mu =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb117-23" title="23"></a>
<a class="sourceLine" id="cb117-24" title="24">    One Sample t<span class="op">-</span>test</a>
<a class="sourceLine" id="cb117-25" title="25"></a>
<a class="sourceLine" id="cb117-26" title="26">data<span class="op">:</span><span class="st">  </span>x</a>
<a class="sourceLine" id="cb117-27" title="27">t =<span class="st"> </span><span class="fl">1.8989</span>, df =<span class="st"> </span><span class="dv">4</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.1304</span></a>
<a class="sourceLine" id="cb117-28" title="28">alternative hypothesis<span class="op">:</span><span class="st"> </span>true mean is not equal to <span class="dv">1</span></a>
<a class="sourceLine" id="cb117-29" title="29"><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb117-30" title="30"><span class="st"> </span><span class="fl">-0.4789485</span>  <span class="fl">8.8789485</span></a>
<a class="sourceLine" id="cb117-31" title="31">sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb117-32" title="32">mean of x </a>
<a class="sourceLine" id="cb117-33" title="33">      <span class="fl">4.2</span> </a>
<a class="sourceLine" id="cb117-34" title="34"><span class="kw">t.test</span>(x, <span class="dt">mu =</span> <span class="dv">1</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb117-35" title="35">[<span class="dv">1</span>] <span class="fl">0.1304116</span></a></code></pre></div>
<ul>
<li>Svar: Efterom <span class="math inline">\(p=0.13\)</span> kan vi på 5% signifikansnivå inte påvisa att medelvärdet i populationen är skilt från 1. Notera att detta <strong>inte</strong> innebär att vi visar att medelvärdet är 1.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.5" class="section level3 unnumbered">
<h3>Övning 3.5</h3>
<p>Du observerar följande vektorer <span class="math inline">\(x = \{4,7,2,4,6,NA,89\}\)</span> och <span class="math inline">\(y=\{7,3, 2, 5,6, 5 , 7\}\)</span> och <span class="math inline">\(z=\{Alfa, bravo, Charlie, delta, Echo, Foxtrot, Golf\}\)</span></p>
<ol style="list-style-type: lower-alpha">
<li>Använd indexering för att summera element 2 och 3 i <span class="math inline">\(x\)</span> med element 6 och 7 i <span class="math inline">\(y\)</span>.</li>
<li>Använd indexering för att ändra NA i <span class="math inline">\(x\)</span> till 999.</li>
<li>Använd indexering för att korrigera så att bravo och delta inleds med versaler.</li>
<li>Exkludera Echo och Foxtrot från <span class="math inline">\(z\)</span>.</li>
</ol>
<button title="q305" type="button" onclick="if(document.getElementById(&#39;q305&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q305&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q305&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q305" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co"># Töm minnet inför uppgift 3.5 </span></a>
<a class="sourceLine" id="cb118-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb118-3" title="3"><span class="co"># a)</span></a>
<a class="sourceLine" id="cb118-4" title="4">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="ot">NA</span>,<span class="dv">89</span>)</a>
<a class="sourceLine" id="cb118-5" title="5">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb118-6" title="6">sumxy &lt;-<span class="st"> </span>x[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)] <span class="op">+</span><span class="st"> </span>y[<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">7</span>)]</a>
<a class="sourceLine" id="cb118-7" title="7">sumxy</a>
<a class="sourceLine" id="cb118-8" title="8">[<span class="dv">1</span>] <span class="dv">12</span>  <span class="dv">9</span></a>
<a class="sourceLine" id="cb118-9" title="9"><span class="co"># b)</span></a>
<a class="sourceLine" id="cb118-10" title="10">x[<span class="dv">6</span>] &lt;-<span class="st"> </span><span class="dv">999</span></a>
<a class="sourceLine" id="cb118-11" title="11">x</a>
<a class="sourceLine" id="cb118-12" title="12">[<span class="dv">1</span>]   <span class="dv">4</span>   <span class="dv">7</span>   <span class="dv">2</span>   <span class="dv">4</span>   <span class="dv">6</span> <span class="dv">999</span>  <span class="dv">89</span></a>
<a class="sourceLine" id="cb118-13" title="13"><span class="co"># c)</span></a>
<a class="sourceLine" id="cb118-14" title="14">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Alfa&quot;</span>, <span class="st">&quot;Bravo&quot;</span>, <span class="st">&quot;Charlie&quot;</span>, <span class="st">&quot;Delta&quot;</span>, <span class="st">&quot;Echo&quot;</span>, <span class="st">&quot;Foxtrot&quot;</span>, <span class="st">&quot;Golf&quot;</span>)</a>
<a class="sourceLine" id="cb118-15" title="15">z[<span class="dv">2</span>] &lt;-<span class="st"> &quot;Bravo&quot;</span></a>
<a class="sourceLine" id="cb118-16" title="16">z[<span class="dv">4</span>] &lt;-<span class="st"> &quot;Delta&quot;</span></a>
<a class="sourceLine" id="cb118-17" title="17">z</a>
<a class="sourceLine" id="cb118-18" title="18">[<span class="dv">1</span>] <span class="st">&quot;Alfa&quot;</span>    <span class="st">&quot;Bravo&quot;</span>   <span class="st">&quot;Charlie&quot;</span> <span class="st">&quot;Delta&quot;</span>   <span class="st">&quot;Echo&quot;</span>    <span class="st">&quot;Foxtrot&quot;</span> <span class="st">&quot;Golf&quot;</span>   </a>
<a class="sourceLine" id="cb118-19" title="19"><span class="co"># d)</span></a>
<a class="sourceLine" id="cb118-20" title="20">zsub &lt;-<span class="st"> </span>z[<span class="op">-</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>)]</a>
<a class="sourceLine" id="cb118-21" title="21">zsub</a>
<a class="sourceLine" id="cb118-22" title="22">[<span class="dv">1</span>] <span class="st">&quot;Alfa&quot;</span>    <span class="st">&quot;Bravo&quot;</span>   <span class="st">&quot;Charlie&quot;</span> <span class="st">&quot;Delta&quot;</span>   <span class="st">&quot;Golf&quot;</span>   </a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.6" class="section level3 unnumbered">
<h3>Övning 3.6</h3>
<p>Du observerar följande datapunkter <span class="math inline">\(x = \{4,7,2,4,6\}\)</span> och <span class="math inline">\(y=\{7,3, 2, 5,6\}\)</span>.</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<ol style="list-style-type: lower-alpha">
<li>Använd minsta-kvadratmetoden och beräkna koefficienterna <span class="math inline">\(a\)</span> och <span class="math inline">\(b\)</span> i regressionslinjen <span class="math inline">\(y=a + bx\)</span>.</li>
<li>Använd koefficienterna och ge en prediktion för <span class="math inline">\(y\)</span> givet att <span class="math inline">\(x=7\)</span>.</li>
<li>Beräkna residualen för <span class="math inline">\(x=7\)</span></li>
<li>Beräkna residualspridningen.</li>
</ol>
<button title="q306" type="button" onclick="if(document.getElementById(&#39;q306&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q306&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q306&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q306" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li>Riktningskoefficienten ges av
<span class="math display">\[b=\dfrac{\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^n(x_i - \bar{x})^2}\]</span>
och interceptet ges av
<span class="math display">\[ a = \bar{y} - b \bar{x}\]</span>. Vi tillämpar formlerna i R.</li>
</ol>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="co"># Töm minnet inför uppgift 3.5</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb119-3" title="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb119-4" title="4">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb119-5" title="5">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb119-6" title="6">ybar &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb119-7" title="7">b &lt;-<span class="st"> </span><span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">*</span>(y <span class="op">-</span><span class="st"> </span>ybar))<span class="op">/</span><span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb119-8" title="8">b</a>
<a class="sourceLine" id="cb119-9" title="9">[<span class="dv">1</span>] <span class="fl">0.2105263</span></a>
<a class="sourceLine" id="cb119-10" title="10">a &lt;-<span class="st"> </span>ybar <span class="op">-</span><span class="st"> </span>b<span class="op">*</span>xbar</a>
<a class="sourceLine" id="cb119-11" title="11">a</a>
<a class="sourceLine" id="cb119-12" title="12">[<span class="dv">1</span>] <span class="fl">3.631579</span></a>
<a class="sourceLine" id="cb119-13" title="13"><span class="co"># Det finns en inbyggd funktion i R för regressionsanalys, vilken används senare på kursen.</span></a></code></pre></div>
<ul>
<li>Svar: Riktningskoefficienten beräknas till <span class="math inline">\(b=0.2105\)</span>, vilket tolkas som att om <span class="math inline">\(x\)</span> ökar en enhet så ökar <span class="math inline">\(y\)</span> i <em>genomsnitt</em> med <span class="math inline">\(0.2105\)</span> enheter. Interceptet beräknas till <span class="math inline">\(a=3.632\)</span>, vilket tolkas som medelvärdet för <span class="math inline">\(y\)</span> när <span class="math inline">\(x=0\)</span>. Notera att det i beräkningarna</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Använd koefficienterna från regressionslinjen och sätt in värdet <span class="math inline">\(x=7\)</span>.</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">xp &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb120-2" title="2">yhat &lt;-<span class="st"> </span>a   <span class="op">+</span><span class="st">    </span>b<span class="op">*</span>xp  </a>
<a class="sourceLine" id="cb120-3" title="3">yhat</a>
<a class="sourceLine" id="cb120-4" title="4">[<span class="dv">1</span>] <span class="fl">5.105263</span></a></code></pre></div>
<ul>
<li>Svar: Prediktionen <span class="math inline">\(\hat{y}=\)</span> 5.105. Detta är punkten på regressionslinjen när <span class="math inline">\(x=7\)</span> och vår bästa gissning för det <span class="math inline">\(y\)</span>-värde en individ med värdet <span class="math inline">\(x=7\)</span> kommer att ha.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>En residual är skillnaden mellan ett predicerat värde och det faktiska observerade värdet, <span class="math inline">\(\hat{\varepsilon}=y_i - \hat{y}\)</span>.
Eftersom <span class="math inline">\(y=3\)</span> när <span class="math inline">\(x=7\)</span> så residualen</li>
</ol>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">residual &lt;-<span class="st"> </span>y[x <span class="op">==</span><span class="st"> </span>xp] <span class="op">-</span><span class="st"> </span>yhat</a></code></pre></div>
<ul>
<li>Svar: Residualen för <span class="math inline">\(x=7\)</span> är -2.105.</li>
</ul>
<ol start="4" style="list-style-type: lower-alpha">
<li>Residualspridningen ges av <span class="math display">\[s_\varepsilon=\sqrt{\dfrac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n-2}}= \sqrt{\dfrac{\sum_{i=1}^n\hat{\varepsilon}_i^2}{n-2}}\]</span>. Vi beräknar på samma sätt som i c) övriga residualer, kvadrerar och summerar.</li>
</ol>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">residuals &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span>(<span class="fl">3.6316</span>   <span class="op">+</span><span class="st">    </span><span class="fl">0.2105</span><span class="op">*</span>x)</a>
<a class="sourceLine" id="cb122-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(residuals)</a>
<a class="sourceLine" id="cb122-3" title="3">residual_spridning &lt;-<span class="st"> </span><span class="kw">sqrt</span>( <span class="kw">sum</span>(residuals<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="dv">-2</span>) )</a>
<a class="sourceLine" id="cb122-4" title="4">residual_spridning</a>
<a class="sourceLine" id="cb122-5" title="5">[<span class="dv">1</span>] <span class="fl">2.347077</span></a></code></pre></div>
<ul>
<li>Svar: Residualspridningen är 2.347</li>
</ul>
<p>(Notera att <span class="math inline">\(\sum_{i=1}^n \varepsilon_i^2\)</span> kallas för <em>residualkvadratsumman</em>.)</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.7" class="section level3 unnumbered">
<h3>Övning 3.7</h3>
<p>Du observerar följande data frame</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">income &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb123-2" title="2">education &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb123-3" title="3">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(income, education)</a></code></pre></div>
<p>Skapa en ny variabel som heter high_edu som tar värdet 1 om education är “High” och 0 annars.</p>
<button title="q307" type="button" onclick="if(document.getElementById(&#39;q307&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q307&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q307&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q307" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="co"># Töm minnet inför uppgift 3.6</span></a>
<a class="sourceLine" id="cb124-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb124-3" title="3">income &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb124-4" title="4">education &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb124-5" title="5">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(income, education)</a>
<a class="sourceLine" id="cb124-6" title="6">df<span class="op">$</span>high_edu &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb124-7" title="7">df<span class="op">$</span>high_edu[df<span class="op">$</span>education <span class="op">==</span><span class="st"> &quot;High&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb124-8" title="8">df<span class="op">$</span>high_edu[df<span class="op">$</span>education <span class="op">==</span><span class="st"> &quot;Low&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb124-9" title="9">df<span class="op">$</span>high_edu[df<span class="op">$</span>education <span class="op">==</span><span class="st"> &quot;Medium&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb124-10" title="10">df</a>
<a class="sourceLine" id="cb124-11" title="11">  income education high_edu</a>
<a class="sourceLine" id="cb124-12" title="12"><span class="dv">1</span>      <span class="dv">4</span>       Low        <span class="dv">0</span></a>
<a class="sourceLine" id="cb124-13" title="13"><span class="dv">2</span>      <span class="dv">7</span>    Medium        <span class="dv">0</span></a>
<a class="sourceLine" id="cb124-14" title="14"><span class="dv">3</span>      <span class="dv">2</span>       Low        <span class="dv">0</span></a>
<a class="sourceLine" id="cb124-15" title="15"><span class="dv">4</span>      <span class="dv">3</span>      High        <span class="dv">1</span></a>
<a class="sourceLine" id="cb124-16" title="16"><span class="dv">5</span>      <span class="dv">6</span>      High        <span class="dv">1</span></a>
<a class="sourceLine" id="cb124-17" title="17"><span class="dv">6</span>      <span class="dv">7</span>       Low        <span class="dv">0</span></a>
<a class="sourceLine" id="cb124-18" title="18"><span class="dv">7</span>      <span class="dv">8</span>    Medium        <span class="dv">0</span></a>
<a class="sourceLine" id="cb124-19" title="19"><span class="dv">8</span>      <span class="dv">6</span>      High        <span class="dv">1</span></a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.8" class="section level3 unnumbered">
<h3>Övning 3.8</h3>
<p>Ett oljebolag är intresserat av att för ett äldre bostadsområde med <span class="math inline">\(2\,000\)</span> hus skatta andelen hus utan oljeeldning. Sakkunskapen säger att det sanna antalet hus utan oljeeldning är mellan 300 och 800 stycken. Precisionskravet är formulerat så att ett 95% konfidensintervall för andelen hus utan oljeeldning inte får
bli längre än 0.05 procentenheter.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna urvalsstorleken vid OSU om dragningen sker med återläggning.</li>
</ol>
<button title="q308" type="button" onclick="if(document.getElementById(&#39;q308&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q308&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q308&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q308" style="display:none">
<div class="alert alert-info">
<ul>
<li><p>Mål: Beräkna den nödvändiga stickprovsstorleken <span class="math inline">\(n\)</span> om längden för ett 95% konfidensintervall för andelen i populationen får vara maximalt 0.05.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen hus utan oljeeldning i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}\)</span> = andelen hus utan oljeeldning i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-MÅ ger att <span class="math inline">\(E(\hat{p})=p\)</span>. Detta säger oss att andelen i stickprovprovet kan skatta andelen i populationen väntevärdesriktigt.</li>
<li><span class="math inline">\(V(\hat{p})=\frac{p(1-p)}{n}\)</span>. Detta är variansen i andelsestimatorns samplingfördelning.</li>
<li>Vi antar att <span class="math inline">\(p=\dfrac{800}{2000}=0.4\)</span> eftersom detta ger störst varians givet den information vi har.</li>
<li>Vi utgår från att <span class="math inline">\(np(1-p)&gt;5\)</span> kommer att vara uppfyllt. Vi måste sedan kontrollera att antagandet faktiskt är uppfyllt! Annars gäller inte CGS och approximativ normalfördelning.</li>
</ol>
<p>Precisionskravet i termer av konfidensintervallets längd kan nu formuleras
<span class="math display">\[
    0.05\geq 2\cdot 1.96\sqrt{\frac{0.4(1-0.4)}{n}}.
\]</span></p>
<p>Det går att ändra värdena på <span class="math inline">\(n\)</span> i R för att se vilket <span class="math inline">\(n\)</span> som ger vår önskade minsta stickprovsstorlek. Vi vill att uttrycket nedan ska vara lika med eller mindre än 0.05.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="co"># Töm minnet inför uppgift 3.7</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb125-3" title="3">n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">10000</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb125-4" title="4">p &lt;-<span class="st"> </span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb125-5" title="5"><span class="co"># Z-värdet från fördelning N(0,1) med sannolikheten 0.025 i högre svansen.</span></a>
<a class="sourceLine" id="cb125-6" title="6">z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb125-7" title="7"><span class="co"># Längden för ett konfidensintervall ges av följande formel:</span></a>
<a class="sourceLine" id="cb125-8" title="8">KIlength &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(  ( p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)  ) <span class="op">/</span><span class="st"> </span>n   )</a>
<a class="sourceLine" id="cb125-9" title="9"><span class="co"># Illustration över olika KIlength för olika värden stickprovsstorlekar n </span></a>
<a class="sourceLine" id="cb125-10" title="10"><span class="kw">plot</span>(n, KIlength, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="co"># Välj den minsta stickprovsstorleken som uppfyller precisionskravet KIlength &lt; 0.05</span></a>
<a class="sourceLine" id="cb126-2" title="2"><span class="kw">min</span>( n[KIlength <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] )</a>
<a class="sourceLine" id="cb126-3" title="3">[<span class="dv">1</span>] <span class="dv">1476</span></a></code></pre></div>
<ul>
<li>Svar: För att uppnå precisionskravet behövs ett stickprov med minst 1476 hus. Glöm inte att kontrollera CGS: <span class="math inline">\(np(1-p)=1476\cdot 0.4(1-0.4)=354.24 &gt; 5\)</span> så antagandet är uppfyllt. Det går även att lösa denna uppgift algebraiskt, genom att lösa ut $n i formeln ovan.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.9" class="section level3 unnumbered">
<h3>Övning 3.9</h3>
<p>En rikstäckande butikskedja säljer bland annat kompletta datorpaket. För ett visst paket tillåter man butikscheferna att själva sätta priset. För att centralt i företaget få en uppfattning om hur efterfrågan påverkas av priset gör man ett slumpmässigt urval om åtta butiker och inhämtar uppgifter om pris och försäljning under den närmast föregående månaden:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">pris &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5500</span>, <span class="dv">6000</span>, <span class="dv">6500</span>, <span class="dv">6000</span>, <span class="dv">5000</span>, <span class="dv">6500</span>, <span class="dv">4500</span>, <span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb127-2" title="2">antal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">38</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">44</span>, <span class="dv">38</span>, <span class="dv">45</span>, <span class="dv">42</span>)</a></code></pre></div>
<p>Beräkna korrelationskoefficienten.</p>
<button title="q309" type="button" onclick="if(document.getElementById(&#39;q309&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q309&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q309&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q309" style="display:none">
<div class="alert alert-info">
<p>Korrelationskoefficentens ges av</p>
<p><span class="math display">\[r=\dfrac{\sum_{i=1}^n(x_i - \bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^n(x_i - \bar{x})^2 \sum_{i=1}^n(y_i - \bar{y})^2}}.\]</span></p>
<p>Vi kan enkelt tillämpa formeln.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="co"># Töm minnet inför uppgift 3.8</span></a>
<a class="sourceLine" id="cb128-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb128-3" title="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5500</span>, <span class="dv">6000</span>, <span class="dv">6500</span>, <span class="dv">6000</span>, <span class="dv">5000</span>, <span class="dv">6500</span>, <span class="dv">4500</span>, <span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb128-4" title="4">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">38</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">44</span>, <span class="dv">38</span>, <span class="dv">45</span>, <span class="dv">42</span>)</a>
<a class="sourceLine" id="cb128-5" title="5">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb128-6" title="6">ybar &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb128-7" title="7">r &lt;-<span class="st"> </span><span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">*</span>(y <span class="op">-</span><span class="st"> </span>ybar) ) <span class="op">/</span><span class="kw">sqrt</span>( <span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sum</span>( (y <span class="op">-</span><span class="st"> </span>ybar)<span class="op">^</span><span class="dv">2</span>) ) </a>
<a class="sourceLine" id="cb128-8" title="8">r</a>
<a class="sourceLine" id="cb128-9" title="9">[<span class="dv">1</span>] <span class="fl">-0.9426412</span></a></code></pre></div>
<ul>
<li>Svar: Pearsons produktmomentkorrelationskoefficient är <span class="math inline">\(-0.94\)</span>, vilket tyder på ett mkt starkt negativt samband mellan pris och antal.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.10" class="section level3 unnumbered">
<h3>Övning 3.10</h3>
<p>Betrakta nedanstående vektor:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">some_letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;A&quot;</span>)</a></code></pre></div>
<p>Använd R för att räkna hur många B det finns i vektorn.</p>
<button title="q310" type="button" onclick="if(document.getElementById(&#39;q310&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q310&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q310&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q310" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="co"># Töm minnet inför uppgift 3.8</span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb130-3" title="3">some_letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;A&quot;</span>)</a>
<a class="sourceLine" id="cb130-4" title="4"><span class="kw">length</span>( some_letters[some_letters <span class="op">==</span><span class="st"> &quot;B&quot;</span>] )</a>
<a class="sourceLine" id="cb130-5" title="5">[<span class="dv">1</span>] <span class="dv">2</span></a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.11" class="section level3 unnumbered">
<h3>Övning 3.11</h3>
<p>Betrakta nedanstående vektorer:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">some_numbers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;3&quot;</span>)</a>
<a class="sourceLine" id="cb131-2" title="2">some_numbers_and_letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;-1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>)</a></code></pre></div>
<p>Använd R för att summera alla värdena i respektive vektor. Tips: Använd funktionen <em>as.numeric()</em>.</p>
<button title="q311" type="button" onclick="if(document.getElementById(&#39;q311&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q311&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q311&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q311" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co"># Töm minnet inför uppgift 3.10</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb132-3" title="3">some_numbers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;3&quot;</span>)</a>
<a class="sourceLine" id="cb132-4" title="4">some_numerics &lt;-<span class="st"> </span><span class="kw">as.numeric</span>( some_numbers )</a>
<a class="sourceLine" id="cb132-5" title="5"><span class="kw">class</span>(some_numbers)</a>
<a class="sourceLine" id="cb132-6" title="6">[<span class="dv">1</span>] <span class="st">&quot;character&quot;</span></a>
<a class="sourceLine" id="cb132-7" title="7"><span class="kw">class</span>(some_numerics)</a>
<a class="sourceLine" id="cb132-8" title="8">[<span class="dv">1</span>] <span class="st">&quot;numeric&quot;</span></a>
<a class="sourceLine" id="cb132-9" title="9"><span class="kw">sum</span>(some_numerics)</a>
<a class="sourceLine" id="cb132-10" title="10">[<span class="dv">1</span>] <span class="dv">11</span></a>
<a class="sourceLine" id="cb132-11" title="11"></a>
<a class="sourceLine" id="cb132-12" title="12">some_numbers_and_letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;-1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>)</a>
<a class="sourceLine" id="cb132-13" title="13">some_numerics_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(some_numbers_and_letters)</a>
<a class="sourceLine" id="cb132-14" title="14">Warning<span class="op">:</span><span class="st"> </span>NAs introduced by coercion</a>
<a class="sourceLine" id="cb132-15" title="15"><span class="kw">sum</span>(some_numerics_<span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb132-16" title="16">[<span class="dv">1</span>] <span class="dv">12</span></a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.12" class="section level3 unnumbered">
<h3>Övning 3.12</h3>
<p>Betrakta nedanstående vektorer.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.39</span>,  <span class="fl">0.76</span>, <span class="fl">-1.25</span>,  <span class="fl">0.28</span>,  <span class="fl">0.60</span>,  <span class="fl">0.66</span>,  <span class="fl">0.94</span>, <span class="fl">-0.18</span>, <span class="fl">-0.26</span>, <span class="fl">-1.83</span>, <span class="fl">-1.13</span>,  <span class="fl">0.45</span>,  <span class="fl">0.11</span>, <span class="fl">-1.03</span>,  <span class="fl">1.06</span>, <span class="fl">-0.08</span>,  <span class="fl">1.68</span>, <span class="fl">-1.02</span>,  <span class="fl">1.36</span>,  <span class="fl">1.58</span>)</a>
<a class="sourceLine" id="cb133-2" title="2">x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.0</span>,  <span class="fl">1.5</span>,  <span class="fl">0.2</span>, <span class="fl">-0.5</span>, <span class="fl">-1.1</span>, <span class="fl">-0.2</span>, <span class="fl">-1.0</span>, <span class="fl">-1.3</span>, <span class="fl">-1.6</span>, <span class="fl">-1.2</span>, <span class="fl">-0.4</span>, <span class="fl">-1.3</span>, <span class="fl">-0.3</span>, <span class="fl">-0.7</span>,  <span class="fl">0.7</span>, <span class="fl">-2.5</span>, <span class="fl">-1.0</span>,  <span class="fl">2.1</span>,  <span class="fl">1.3</span>, <span class="fl">-1.3</span>)</a>
<a class="sourceLine" id="cb133-3" title="3">x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.94</span>, <span class="fl">-2.38</span>, <span class="fl">-0.16</span>, <span class="fl">0.44</span>, <span class="fl">0.70</span>, <span class="fl">2.54</span>, <span class="fl">2.12</span>, <span class="fl">8.33</span>, <span class="fl">0.57</span>, <span class="fl">1.24</span>, <span class="fl">0.05</span>, <span class="fl">-1.78</span>, <span class="fl">2.53</span>, <span class="fl">-1.60</span>, <span class="fl">2.77</span>, <span class="fl">0.26</span>, <span class="fl">1.48</span>, <span class="fl">1.10</span>, <span class="fl">-8.00</span>, <span class="fl">4.57</span>)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Skapa variabeln <span class="math inline">\(x = x_1 + x_2 + x_3\)</span>.</li>
<li>Skapa variabeln <span class="math inline">\(z\)</span>, där <span class="math inline">\(z=1\)</span> om <span class="math inline">\(x &lt; 0\)</span>, <span class="math inline">\(z=2\)</span> om <span class="math inline">\(0 \leq x &lt; 5\)</span> och <span class="math inline">\(z=3\)</span> om <span class="math inline">\(x \geq 5\)</span>.</li>
<li>Skapa de binära variblerna <span class="math inline">\(v_1\)</span> som är 1 om <span class="math inline">\(x1 &gt; 0\)</span> och 0 annars, <span class="math inline">\(v_2\)</span> som är 1 om <span class="math inline">\(x2 &gt; 0\)</span> och 0 annars, och <span class="math inline">\(v_3\)</span> som är 1 om <span class="math inline">\(x3 &gt; 0\)</span> och 0 annars</li>
<li>Skapa variabeln <span class="math inline">\(v = v_1 + v_2 + v_3\)</span> som är en summa av de binära variablerna.</li>
<li>Skapa en frekvenstabell för <span class="math inline">\(v\)</span>.</li>
</ol>
<button title="q312" type="button" onclick="if(document.getElementById(&#39;q312&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q312&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q312&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q312" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co"># Töm minnet inför uppgift 3.10</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb134-3" title="3">x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.39</span>,  <span class="fl">0.76</span>, <span class="fl">-1.25</span>,  <span class="fl">0.28</span>,  <span class="fl">0.60</span>,  <span class="fl">0.66</span>,  <span class="fl">0.94</span>, <span class="fl">-0.18</span>, <span class="fl">-0.26</span>, <span class="fl">-1.83</span>, <span class="fl">-1.13</span>,  <span class="fl">0.45</span>,  <span class="fl">0.11</span>, <span class="fl">-1.03</span>,  <span class="fl">1.06</span>, <span class="fl">-0.08</span>,  <span class="fl">1.68</span>, <span class="fl">-1.02</span>,  <span class="fl">1.36</span>,  <span class="fl">1.58</span>)</a>
<a class="sourceLine" id="cb134-4" title="4">x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.0</span>,  <span class="fl">1.5</span>,  <span class="fl">0.2</span>, <span class="fl">-0.5</span>, <span class="fl">-1.1</span>, <span class="fl">-0.2</span>, <span class="fl">-1.0</span>, <span class="fl">-1.3</span>, <span class="fl">-1.6</span>, <span class="fl">-1.2</span>, <span class="fl">-0.4</span>, <span class="fl">-1.3</span>, <span class="fl">-0.3</span>, <span class="fl">-0.7</span>,  <span class="fl">0.7</span>, <span class="fl">-2.5</span>, <span class="fl">-1.0</span>,  <span class="fl">2.1</span>,  <span class="fl">1.3</span>, <span class="fl">-1.3</span>)</a>
<a class="sourceLine" id="cb134-5" title="5">x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.94</span>, <span class="fl">-2.38</span>, <span class="fl">-0.16</span>, <span class="fl">0.44</span>, <span class="fl">0.70</span>, <span class="fl">2.54</span>, <span class="fl">2.12</span>, <span class="fl">8.33</span>, <span class="fl">0.57</span>, <span class="fl">1.24</span>, <span class="fl">0.05</span>, <span class="fl">-1.78</span>, <span class="fl">2.53</span>, <span class="fl">-1.60</span>, <span class="fl">2.77</span>, <span class="fl">0.26</span>, <span class="fl">1.48</span>, <span class="fl">1.10</span>, <span class="fl">-8.00</span>, <span class="fl">4.57</span>)</a>
<a class="sourceLine" id="cb134-6" title="6"></a>
<a class="sourceLine" id="cb134-7" title="7"><span class="co"># a)</span></a>
<a class="sourceLine" id="cb134-8" title="8">x &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3</a>
<a class="sourceLine" id="cb134-9" title="9"><span class="co"># b)</span></a>
<a class="sourceLine" id="cb134-10" title="10"><span class="co"># Skapa en variabeln som består av NA som är lika lång som x</span></a>
<a class="sourceLine" id="cb134-11" title="11">z &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb134-12" title="12">z[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb134-13" title="13">z[(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>)  ] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb134-14" title="14">z[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb134-15" title="15">z</a>
<a class="sourceLine" id="cb134-16" title="16"> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb134-17" title="17"><span class="co"># c)</span></a>
<a class="sourceLine" id="cb134-18" title="18">v1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(x1))</a>
<a class="sourceLine" id="cb134-19" title="19">v1[x1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb134-20" title="20">v1[x1 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb134-21" title="21">v2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(x1))</a>
<a class="sourceLine" id="cb134-22" title="22">v2[x2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb134-23" title="23">v2[x2 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb134-24" title="24">v3 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(x1))</a>
<a class="sourceLine" id="cb134-25" title="25">v3[x3 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb134-26" title="26">v3[x3 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb134-27" title="27"><span class="co"># d)</span></a>
<a class="sourceLine" id="cb134-28" title="28">v &lt;-<span class="st"> </span>v1 <span class="op">+</span><span class="st"> </span>v2 <span class="op">+</span><span class="st"> </span>v3</a>
<a class="sourceLine" id="cb134-29" title="29">v</a>
<a class="sourceLine" id="cb134-30" title="30"> [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb134-31" title="31"><span class="co"># e)</span></a>
<a class="sourceLine" id="cb134-32" title="32">sumv0 &lt;-<span class="st"> </span><span class="kw">sum</span>(v <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb134-33" title="33">sumv1 &lt;-<span class="st"> </span><span class="kw">sum</span>(v <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb134-34" title="34">sumv2 &lt;-<span class="st"> </span><span class="kw">sum</span>(v <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb134-35" title="35">sumv3 &lt;-<span class="st"> </span><span class="kw">sum</span>(v <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb134-36" title="36">frequencies &lt;-<span class="st"> </span><span class="kw">c</span>(sumv0, sumv1, sumv2, sumv3)</a>
<a class="sourceLine" id="cb134-37" title="37">values &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb134-38" title="38">frequency.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(values, frequencies)</a>
<a class="sourceLine" id="cb134-39" title="39">frequency.table </a>
<a class="sourceLine" id="cb134-40" title="40">     values frequencies</a>
<a class="sourceLine" id="cb134-41" title="41">[<span class="dv">1</span>,]      <span class="dv">0</span>           <span class="dv">1</span></a>
<a class="sourceLine" id="cb134-42" title="42">[<span class="dv">2</span>,]      <span class="dv">1</span>           <span class="dv">7</span></a>
<a class="sourceLine" id="cb134-43" title="43">[<span class="dv">3</span>,]      <span class="dv">2</span>          <span class="dv">11</span></a>
<a class="sourceLine" id="cb134-44" title="44">[<span class="dv">4</span>,]      <span class="dv">3</span>           <span class="dv">1</span></a>
<a class="sourceLine" id="cb134-45" title="45"><span class="co"># Det finns i R också en inbyggd funktion table(), som vi ska använda oss av senare på kursen.</span></a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.13" class="section level3 unnumbered">
<h3>Övning 3.13</h3>
<p>Denna övning syftar till att förtydliga skillnaden mellan ett par summor som används ofta i statistiken, dessa är <span class="math inline">\(\sum_{i = 1}^{n}x_{i}^{2}\)</span> och <span class="math inline">\(\left(\sum_{i = 1}^{n} x_{i}\right)^{2}\)</span>.</p>
<p>Företäll dig att du har dragit ett stickprov av något slag, och att du samlat informationen i ditt stickprov i vektorn</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">4</span>)</a></code></pre></div>
<p>Föreställ dig även att du vill beräkna standardavvikelsen i vektorn, men att du inte känner till funktionen <code>sd()</code>. Därför behöver du beräkna de båda summorna som presenteras ovan. Din uppgift är nu att</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna de båda summorna manuellt i <code>R</code>, utan att använda funktionen <code>sum()</code></li>
</ol>
<button title="q313a" type="button" onclick="if(document.getElementById(&#39;q313a&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q313a&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q313a&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q313a" style="display:none">
<div class="alert alert-info">
<p>Börja med att rensa minnet och mata in vektorn i <code>R</code></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>()) <span class="co"># Rensar minnet</span></a>
<a class="sourceLine" id="cb136-2" title="2"></a>
<a class="sourceLine" id="cb136-3" title="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">4</span>) <span class="co"># Matar in vektor</span></a></code></pre></div>
<p>I beräkningen av <span class="math inline">\(\sum_{i = 1}^{n}x_{i}^{2}\)</span> är det viktigt att komma ihåg att kvadreringen sker först, och summeringen sedan. Summan räknas alltså ut som</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="co"># Kvadrera elementen först, summera sen</span></a>
<a class="sourceLine" id="cb137-2" title="2">x[<span class="dv">1</span>]<span class="op">^</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>x[<span class="dv">2</span>]<span class="op">^</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>x[<span class="dv">3</span>]<span class="op">^</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>x[<span class="dv">4</span>]<span class="op">^</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>x[<span class="dv">5</span>]<span class="op">^</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>x[<span class="dv">6</span>]<span class="op">^</span>(<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 134</code></pre>
<p>I beräkningen av <span class="math inline">\(\left(\sum_{i = 1}^{n} x_{i}\right)^{2}\)</span> sitter summan inom parenteser, och därför sker summering här innan kvadrering. Summan beräknas som</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="co"># Summera elementen först, kvadrera sen</span></a>
<a class="sourceLine" id="cb139-2" title="2">(x[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>x[<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">+</span><span class="st"> </span>x[<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span>x[<span class="dv">6</span>])<span class="op">^</span>(<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 676</code></pre>
</div>
</div>
<p></br></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Förenkla nu beräkningarna i <strong>a</strong> genom att använda <code>sum()</code> och räkna på vektorerna i sin helhet</li>
</ol>
<button title="q313b" type="button" onclick="if(document.getElementById(&#39;q313b&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q313b&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q313b&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q313b" style="display:none">
<div class="alert alert-info">
<p>Kom ihåg att <span class="math inline">\(\sum_{i = 1}^{n}x_{i}^{2}\)</span> kräver kvadrering innan summering. Börja därför med att kvadrera alla element i <code>x</code>. Resultatet blir</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">x<span class="op">^</span>(<span class="dv">2</span>) <span class="co"># Ser att elementen kvadreras var för sig</span></a></code></pre></div>
<pre><code>## [1]  4 16 25  9 64 16</code></pre>
<p>För att slutföra beräkningen av den första summan återstår bara att stoppa in ovanstående uttryck i summeringsfunktionen</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">sum</span>(x<span class="op">^</span>(<span class="dv">2</span>)) <span class="co"># Summerar över kvadrerade x</span></a></code></pre></div>
<pre><code>## [1] 134</code></pre>
<p>Som synes blir resultatet samma som i <strong>a</strong>, men koden är mer kompakt och lättare att skriva</p>
<p>För att beräkna den andra summan summeras värdena först, och sedan kvadreras hela summan. Detta innebär att kvadraten i detta fall måste sättas utanför summeringsfunktionen, precis som i koden här nedan</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">x             <span class="co"># Skriver ut x</span></a></code></pre></div>
<pre><code>## [1] 2 4 5 3 8 4</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">sum</span>(x)        <span class="co"># Summerar över alla x</span></a></code></pre></div>
<pre><code>## [1] 26</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">(<span class="kw">sum</span>(x))<span class="op">^</span>(<span class="dv">2</span>)  <span class="co"># Summerar alla x och kvadrerar summan</span></a></code></pre></div>
<pre><code>## [1] 676</code></pre>
<p>Beräkningen ger samma resultat som i <strong>a</strong>, men koden är återigen mer kompakt och lättare att skriva</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-3.14" class="section level3 unnumbered">
<h3>Övning 3.14</h3>
<p>Denna uppgift rör beräkningen av en stickprovsvarians, och syftar till att tydliggöra att likheten</p>
<p><span class="math display">\[
\frac{\sum_{i = 1}^{n}(x_{i} - \bar{x})^{2}}{n-1} = \frac{\sum_{i = 1}^{n}x_{i}^{2} - \frac{\left(\sum_{i = 1}^{n} x_{i}\right)^{2}}{n}}{n-1}
\]</span>
faktiskt håller. Uttrycket till vänster kan, genom några delsteg, skrivas om och bli uttrycket som står till höger om likhetstecknet. Din uppgift är nu att beräkna värdet på varje del i utvecklingen, och på så sätt se att uttrycken är lika.</p>
<p>Betrakta samma stickprov som i uppgift 3.13</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">4</span>)</a></code></pre></div>
<p>och utför följande beräkningar:</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna stickprovsmedelvärdet för <code>x</code>, och även antal element som finns i vektorn</li>
</ol>
<button title="q314a" type="button" onclick="if(document.getElementById(&#39;q314a&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314a&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314a&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314a" style="display:none">
<div class="alert alert-info">
<p>Börja med att rensa minnet och mata in vektorn i <code>R</code></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>()) <span class="co"># Rensar minnet</span></a>
<a class="sourceLine" id="cb152-2" title="2"></a>
<a class="sourceLine" id="cb152-3" title="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">4</span>) <span class="co"># Matar in vektor</span></a></code></pre></div>
<p>Medelvärdet beräknas nu som</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">x_streck &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb153-2" title="2">x_streck</a></code></pre></div>
<pre><code>## [1] 4.333333</code></pre>
<p>och antalet element som</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb155-2" title="2">n</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
</div>
</div>
<p></br></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{1}{n - 1} \sum_{i = 1}^{n} (x_{i} - \bar{x})^{2}\)</span></li>
</ol>
<button title="q314b" type="button" onclick="if(document.getElementById(&#39;q314b&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314b&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314b&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314b" style="display:none">
<div class="alert alert-info">
<p>Använd <span class="math inline">\(n\)</span> och <span class="math inline">\(\bar{x}\)</span> från <strong>a</strong>, och kom ihåg att kvadrering sker innan summan beräknas</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>x_streck)<span class="op">^</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{1}{n - 1} \sum_{i = 1}^{n} (x_{i} - \bar{x})(x_{i} - \bar{x})\)</span></li>
</ol>
<button title="q314c" type="button" onclick="if(document.getElementById(&#39;q314c&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314c&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314c&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314c" style="display:none">
<div class="alert alert-info">
<p>Ta bort kvadraten och multiplicera <span class="math inline">\((x_{i} - \bar{x})\)</span> med sig självt</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>x_streck) <span class="op">*</span><span class="st"> </span>(x <span class="op">-</span><span class="st"> </span>x_streck))</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{1}{n-1}\sum_{i = 1}^{n} \left(x_{i}^{2} - 2x_{i} \bar{x} + \bar{x}^{2} \right)\)</span></li>
</ol>
<button title="q314d" type="button" onclick="if(document.getElementById(&#39;q314d&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314d&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314d&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314d" style="display:none">
<div class="alert alert-info">
<p>Multiplicera ut parenteserna innanför summan</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1">(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(x<span class="op">^</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>x<span class="op">*</span>x_streck <span class="op">+</span><span class="st"> </span>x_streck<span class="op">^</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{1}{n-1}\left(\left(\sum_{i = 1}^{n} x_{i}^{2}\right) - 2n\bar{x} \cdot \bar{x} + n\bar{x}^{2} \right)\)</span></li>
</ol>
<button title="q314e" type="button" onclick="if(document.getElementById(&#39;q314e&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314e&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314e&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314e" style="display:none">
<div class="alert alert-info">
<p>Notera att summan enbart opererar på <span class="math inline">\(x_{i}^{2}\)</span></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(x<span class="op">^</span>(<span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>n<span class="op">*</span>x_streck<span class="op">*</span>x_streck <span class="op">+</span><span class="st"> </span>n<span class="op">*</span>x_streck<span class="op">^</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{1}{n-1}\left(\left(\sum_{i = 1}^{n} x_{i}^{2}\right) - 2n\bar{x}^{2} + n\bar{x}^{2} \right)\)</span></li>
</ol>
<button title="q314f" type="button" onclick="if(document.getElementById(&#39;q314f&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314f&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314f&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314f" style="display:none">
<div class="alert alert-info">
<p>Notera att summan enbart opererar på <span class="math inline">\(x_{i}^{2}\)</span></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(x<span class="op">^</span>(<span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>n<span class="op">*</span>x_streck<span class="op">^</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>n<span class="op">*</span>x_streck<span class="op">^</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{1}{n-1}\left(\left(\sum_{i = 1}^{n} x_{i}^{2}\right) - n\bar{x}^{2} \right)\)</span></li>
</ol>
<button title="q314g" type="button" onclick="if(document.getElementById(&#39;q314g&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314g&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314g&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314g" style="display:none">
<div class="alert alert-info">
<p>Notera att summan enbart opererar på <span class="math inline">\(x_{i}^{2}\)</span></p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1">(<span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(x<span class="op">^</span>(<span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span>n<span class="op">*</span>x_streck<span class="op">^</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol start="8" style="list-style-type: lower-alpha">
<li>Beräkna värdet på <span class="math inline">\(\frac{\sum_{i = 1}^{n} x_{i}^{2} - \frac{\left(\sum_{i = 1}^{n} x_{i} \right)^{2}}{n} }{n-1}\)</span></li>
</ol>
<button title="q314h" type="button" onclick="if(document.getElementById(&#39;q314h&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314h&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314h&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314h" style="display:none">
<div class="alert alert-info">
<p>Notera att summan enbart opererar på <span class="math inline">\(x_{i}^{2}\)</span></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1">(<span class="kw">sum</span>(x<span class="op">^</span>(<span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span>(<span class="kw">sum</span>(x)<span class="op">^</span>(<span class="dv">2</span>))<span class="op">/</span>n)<span class="op">/</span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<ol style="list-style-type: lower-roman">
<li>Kontrollera att beräkningarna stämmer genom att jämföra med funktionen <code>var()</code></li>
</ol>
<button title="q314i" type="button" onclick="if(document.getElementById(&#39;q314i&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q314i&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q314i&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q314i" style="display:none">
<div class="alert alert-info">
<p>Notera att summan enbart summerar över <span class="math inline">\(x_{i}^{2}\)</span></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">var</span>(x)</a></code></pre></div>
<pre><code>## [1] 4.266667</code></pre>
</div>
</div>
<p></br></p>
<!--chapter:end:03-objekt.Rmd-->
<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}

</style>
</div>
</div>
</div>
<div id="läsa-in-och-spara-data" class="section level1">
<h1><span class="header-section-number">4</span> Läsa in och spara data</h1>
<p>Avsikten med detta kapitel är att beskriva principerna för hur datamaterial är organiserade, hur datamaterial bör organiseras samt presentera de vanligaste formaten för att att importera och exportera data i R. För nybörjaren i R kan det vara uppmuntrande att känna till att datainläsning i en del fall kan vara omständligt och frustrerande, framförallt om datamaterialet inte är organiserat på ett konsekvent sätt. Misströsta därför inte ifall det dyker upp svårigheter. Det krävs mycket erfarenhet för att blir trygg med att arbeta med data.</p>
<p>På denna kurs rekommenderas två format för att importera och spara datamaterial:</p>
<ul>
<li><strong>textfiler</strong> (<strong>.txt</strong> eller <strong>.csv</strong>), vilket innebär att data sparas i textformat.</li>
<li><strong>R Data format</strong> (<strong>.RDS</strong>), vilket är det dataformat som R använder.</li>
</ul>
<p>I praktiken är det däremot nödvändigt att kunna importera och spara filer i</p>
<ul>
<li>Excel-format (<strong>.xlsx</strong> eller motsvarande),</li>
</ul>
<p>detta på grund av att många icke-statistiker använder Excel för att handskas med och analysera data.</p>
<p>Vad gäller import och export av dataformat som är kopplade till andra statistikprogram (så som SAS, SPSS, Minitab) finns R-paket (t.ex. <strong>foreign</strong> och <strong>haven</strong>) avsedda för detta. När det gäller hantering av stora dataset (<span class="math inline">\(&gt;10\)</span> Gigabyte i storlek) kan paket som <strong>data.table</strong> vara till hjälp.</p>
<div id="principer-för-organiserade-datamaterial" class="section level2">
<h2><span class="header-section-number">4.1</span> Principer för organiserade datamaterial</h2>
<p>För att göra det så lätt som möjligt att importera och handskas med data i R är det en bra idé att följa principen om <em>tidy</em> data. <em>Tidy</em> kan i denna mening översättas som <em>städat</em> eller <em>organiserat</em>, och innebär att datamaterialet är strukturerat på ett specifikt sätt som gör det lätt att hantera.</p>
<p><a href="https://twitter.com/hadleywickham">Hadley Wickham</a>, som är chefsforskare på RStudio och adjungerad professor i statistik vid bland annat Standforduniversitetet i USA, har tagit fram tre regler som bör följas för att få ett städat datamaterial. Dessa är att</p>
<ul>
<li>Varje variabel måste ha en egen kolumn</li>
<li>Varje observation måste ha sin egen rad</li>
<li>Varje värde måste ha sin egen cell.</li>
</ul>
<p>På grund av det sätt som R – och i stort sett alla andra statistikprogram – arbetar med data blir risken för felberäkningar eller förvirringar mindre när ett datamaterial är strukturerat efter de tre punkterna som ges ovan.</p>
<p>Som synes är data organiserat så att varje kolumn hör till en enskild variabel, varje rad hör till en enskild individ (observation), och varje cell hör till ett enskilt värde. För göra detta mer konkret kan det vara värt att betrakta en situation där du som analytiker blir ombedd att analysera ett datamaterial som har med Stockholms bostadsmarknad att göra. I detta datamaterial finns observationer som rör 1500 olika lägenheter i Stockholms innerstad, och informationen som delges är <code>boarea</code>, <code>antal rum</code>, <code>avstånd till närmsta tunnelbana</code>, <code>avstånd till vattnet</code>, och <code>månadsavgift</code>. Enligt principerna för städade datamaterial bör information för en specifik lägenhet finnas på en enskild rad. Varje rad bör även korsas av fem olika kolumner, som var och en innehåller information gällande en specifik variabel. På så sätt kommer varje cell i datamaterialet innehålla ett enskilt värde, och det kommer utan problem gå att utgöra vilken lägenhet samt vilken variabel varje cell hör till.</p>
<p>För att ytterligare klargöra skillnaden mellan datamaterial som är städade och datamaterial som inte är städade följer ett par tabeller här nedan. Studera gärna dessa en stund, och fundera kring varför varje tabell innehåller ett städat/ostädat datamaterial.</p>
<table>
<thead>
<tr class="header">
<th>Boarea</th>
<th>Rum, T-bana</th>
<th>Vatten</th>
<th>Avgift</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>52</td>
<td>2, 400</td>
<td>1500</td>
<td>3300</td>
</tr>
<tr class="even">
<td>24</td>
<td>1, 150</td>
<td>2500</td>
<td>3967</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Datamaterialet som presenteras i tabellen ovan är inte tidy, detta eftersom variablerna <code>Rum</code> och <code>T-bana</code> står skrivna i samma kolum, vilket medför att varje cell inte innehåller ett enskilt värde. För att datamaterialet ovan ska räknas som städat krävs att det ser ut som i tabellen här nedan.</p>
<table>
<thead>
<tr class="header">
<th>Boarea</th>
<th>Rum</th>
<th>T-bana</th>
<th>Vatten</th>
<th>Avgift</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>52</td>
<td>2</td>
<td>400</td>
<td>1500</td>
<td>3300</td>
</tr>
<tr class="even">
<td>24</td>
<td>1</td>
<td>150</td>
<td>2500</td>
<td>3967</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>I tabellen ovan finns en klar struktur som följer det som förväntas av ett städat datamaterial.</p>
<p>Utöver dessa tre grundläggande strukturer finns en del rekommendationer för att underlätta programmeringen, göra den mer intuitiv, och ge den ett bättre flyt. Dessa ges i följande punktlista:</p>
<ul>
<li><p>Många program (t ex Excel) gör det möjligt att spara data som ren text istället för i progammets eget format. Spara alltid en kopia i textformat.</p></li>
<li><p>Använd semi-kolon för att avgränsa kolumner när datamaterial sparas i textformat. Eftersom kommatecken används som decimaltecken på svenska, och avstånd eller TAB är svåra att se i en textfil då de påminner om blanksteg, undviks ofta enkla problem genom att använda semikolon.</p></li>
<li><p>Försök att inte ändra något i ursprungsfilen där datamaterialet är sparat. Det är bättre att importera data till R och göra ändringar där om så är möjligt.</p></li>
<li><p>Undvik att använda variabelnamn som innehåller blanksteg. Blanksteg har en specifik funktion i R, och om de används i variabelnamn blir dator lätt förvirrad, vilket leder till att beräkningarna inte fungerar som de ska. Istället rekommenderas att använda <strong>understreck</strong> eller <strong>punkt</strong> som avskiljare. Alltså bör en variabel döpas till <code>antal_rum</code> eller <code>antal.rum</code> snarare än bara <code>antal rum</code>.</p></li>
<li><p>Låt bli att använda variabelnamn som innehåller specielle symboler, som t.ex. ?, $, *, +, #, (, ), -, /, }, {, |, &gt;, &lt; etc. Även sådana symboler kan ha specielle funktioner i R, och om de inkluderas i variabelnamn finns risk att R inte kan hantera dem. Gör det till en vana att bara använda understreck eller punkt.</p></li>
<li><p>Inled aldrig ett variabelnamn med en siffra. Siffror är tillåtna i variabelnamn, men inte som första tecken.</p></li>
<li><p>Namnen på kolumnerna i ett datamaterial måste alltid vara unike. Det får alltså <strong>inte</strong> finnas två kolumner med samma namn i ett och samma datamaterial.</p></li>
<li><p>R är ett skiftlägeskänsligt språk, vilket innebär att det gör skillnad mellan versaler och gemener. Detta medför att variabler vid namn <code>Husdjur</code> och <code>husdjur</code> sparas som två olika objekt, eftersom ett versalt H i det första namnet skiljer variablerna åt.</p></li>
<li><p>Om ett datamaterial innehåller tomma rader bör dessa raderas innan någon analys påbörjas. Tomma rader kan lätt betraktas som <strong>missing values</strong> av R, och kan därför komma att snedvrida analysen som ska utföras.</p></li>
<li><p>Ersätt alla tomma celler med <code>NA</code>. <code>NA</code> står för <em>not available</em> i R, och celler som är kodade som <code>NA</code> är i regel relativt enkla att utesluta ur en analys.</p></li>
<li><p>Radera alla kommentarer som finns i det ursprungliga datamaterialet. Ofta förekommer kommentarer antingen längst upp i själva datafilen, eller någonstans vid sidan av det data som är av intresse. För att dessa kommentarer inte ska störa analysen är det viktigt att radera dem.</p></li>
</ul>
<p>Även om datamaterialen i denna kursen i stort sett alltid kommer vara textfiler eller formaterade som R-data är det högst sannolikt att många av er kommer behöva samla in och strukturera egna datamaterial i arbetslivet. Om (eller när) detta händer finns en <a href="http://tinyurl.com/yafq38p9">artikel</a>, skriven av Karl Broman och Kara Woo, som ger en bra sammanfattning av vad som bör tas i åtankte i sådana situationer.</p>
<p>Nog om städade datamaterial. Resten av detta kapitel kommer handla om hur olika typer av datamaterial bör läsas in, för att sedan kunna använda dem i diverse statistiska analyser.</p>
</div>
<div id="working-directory" class="section level2">
<h2><span class="header-section-number">4.2</span> Working directory</h2>
<p>För att underlätta datainläsning är det bra att anrätta ett så kallat working directory som R kan utgå ifrån. Även om namnet working directory får det att låta komplicerat är det i grund och botten ett väldigt simpelt koncept. Ett working directory är helt enkelt en mapp i datorn som R använder som “hem-mapp”. Fördelen med ett working directory är att R alltid utgår ifrån det, vilket medför att datamaterial som finns i mappen blir lättare att läsa in. Det är även så att script och figurer som produceras i R automatiskt sparas i denna mapp, vilket gör det lättare att hålla ordning på allt arbete som görs i R.</p>
<p>Det finns två sätt att bestämma vilken fil som ska räknas som ett workning directory. Den ena går ut på att skriva kod som anger sökvägen till mappen som är menad att vara directory, och den andra går ut på att använda menyer i R för att klicka sig fram till ett directory. De båda sätten är likvärdiga, och det är bra för varje enskild person att använda det sätt som verkar mest intuitivt. Faktum är att menyerna används för att generera kod som körs i Console, så i grund och botten är det samma operation som utförs. För att anrätta ett working directory är det första som behövs en mapp att använda. Skapa därför en mapp på skrivbordet som heter “Statistik A5”. Detta krävs oavsett vilken metod som används för att göra mappen till ett directory.</p>
<p>För att bestämma working directory med hjälp av kod används funktionen <strong>setwd()</strong>, och för att göra mappen Statistik A5 till directory skrivs sökvägen in mellan parenteserna i funktionen. Koden som används blir alltså följande</p>
<pre><code>setwd(&quot;/Users/valentinzulj/Desktop/Statistik A5&quot;)</code></pre>
<p><em>Notera att sökvägen är unik för alla datorer. I just detta fall används min personliga dator, och sökvägen kommer inte att fungera på andra datorer än just min.</em></p>
<p>Det är inte alltid självklart hur sökvägen till en mapp ser ut, men som tur är finns ett par knep för att lätta komma åt sökvägen. För Mac-användare är det lättast att leta upp mappen som ska bli directory, högerklicka på den (för att få fram en lista med olika alternativ), och hålla in alt-knappen på tangentbordet. När detta är gjort ändras ett alternativ till <strong>Copy “namn på filen” as Pathname</strong>, och genom att klicka på detta alternativ kopieras sökvägen så att den går att klistra in direkt i <strong>setwd()</strong>, exempelvis med hjälp av <strong>CTRL + C</strong>. För Windows-användare är processen snarlik, det gäller då att hålla ner Shift-tangenten och högerklicka på mappen som ska användas, för att sedan använda alternativet <strong>Copy as Path (Kopiera sökväg)</strong>. Efter det kan sökvägen klistras in i <strong>setwd()</strong> precis som ovan.</p>
<p>För att bestämma directory med hjälp av menyer gäller det att klicka på <strong>Session</strong> längst upp i RStudio. Sedan är det bara att gå till <strong>Set Working Directory</strong> och <strong>Choose Directory</strong> för att bläddra efter en mapp i datorn. Notera att en rad kod skrivs ut i Console när mappen som ska bli directory har valts, denna kod kan vara bra att kopiera och klistra in i det script som används för att göra analysen. Detta eftersom R återställer directory varje gång det stängs ner, och därför måste mappen anges varje gång R startas.</p>
<p>Om datamaterialet som ska läsas in finns i den mapp som är satt som directory behöver enbart filnamnet användas för att läsa in den, men om materialet inte finns i mappen behövs hela sökvägen. Därför kan det vara bra att ha det datamaterial som ska analyseras i en mapp som är (eller görs till) working directory.</p>
<p>Använd nu panelen som finns längst ner till höger i R (precis till höger om Console). Börja med att klicka på fliken <strong>Files</strong>, och klicka sedan på kugghjulet som har texten <strong>More</strong> bredvid sig. Välj nu alternativet <strong>Go To Working Directory</strong> i listan. När detta är gjort dyker allt innehåll i mappen som är satt som working directory upp i panelen längst ner till höger. Med hjälp av dessa filer kan datamaterial läsas in på ett smidigt sätt. Detta kommer att diskuteras vid ett senare skede i denna text.</p>
</div>
<div id="läsa-in-datamaterial-med-hjälp-av-kod" class="section level2">
<h2><span class="header-section-number">4.3</span> Läsa in datamaterial med hjälp av kod</h2>
<p>I R finns två huvudsakliga sätt att importera datamaterial, båda med sina egna för och nackdelar. Ett sätt är att skriva kod som får R att importera datamaterialet, och det andra är att använda menyerna som finns i RStudio för att generera kod och läsa in datamaterialet genom att bara klicka (ungefär som i Minitab eller SPSS).</p>
<p>I denna del av kapitlet kommer dataimport med hjälp av programmering att diskuteras. Fördelen med att importera datamaterial med hjälp av kod är att koden kan sparas i ett script, och därmed blir det lätt att sprida ut analysarbetet över flera tillfällen utan att behöva ödsla onödig tid på dataimport i början av varje tillfälle. Det medföljer alltså ingen klickföljd att memorera – som är fallet då menyer används – och det är relativt smidigt. Nackdelen är att det finns väldigt många olika sätt att formatera datamaterial, vilket medför att det krävs många olika funktioner och argument att lära sig och hålla reda på. Detta problem är inte lika framträdande när menyer används för att importera data.</p>
<p>Som nämnts ovan kommer tre olika dataformat att diskuteras i detta kapitel. De två huvudsakliga är text-och CSV-filer och datafiler som är lagrade i R:s eget format RDS. Dessutom tillkommer datamaterial som är lagrade i Excelark.</p>
<div id="text--och-csv-filer" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Text- och CSV-filer</h3>
<p>Ett par format som ofta används för att lagra datamaterial är text- och CSV-filer. Textfiler har oftast <strong>.txt</strong> efter filnamnet, och CSV-filer har ändelsen <strong>.csv</strong>. CSV står för <em>comma separated values</em>, vilket betyder att kommatecken används för att skilja mellan kolumner på samma rad. Eftersom det finns många länder som använder kommatecken för att skriva ut decimaltal innefattar ordet <em>comma</em> i fallet CSV även semikolon. Strukturen i denna typen av filer är relativt enkel, och ett par exempel kommer att redovisas längre ner.</p>
<p>De två funktionerna som används för att läsa in CSV-filer är <strong>read.csv()</strong> och <strong>read.csv2()</strong>. Båda dessa är varianter av funktionen <strong>read.table()</strong>, fast med argument som är förspecificerade för att passa specifika typer av datastruktur. I grund och botten går det alltid att använda <strong>read.table()</strong> så länge argumenten specificeras korrekt, men det går ofta att spara lite tid genom att istället anropa <strong>read.csv()</strong> eller <strong>read.csv2()</strong> direkt.</p>
<p>CSV.filer är textfiler och mer generellt kan text-filer läsas in med <strong>read.table()</strong>. De bägge <strong>read.csv()</strong> och <strong>read.csv2()</strong> baseras nämligen på <strong>read.table()</strong>, men med förspecificerade argument. Funktionernas vanligaste argument presenteras nedan, men det går att specificera funktionerna i stor detalj beroende på hur datafilen ser ut. De fem huvudsakliga argument som används är</p>
<ul>
<li><strong>file</strong> anger filnamnet på filen (datamaterialet) som ska läsas in</li>
<li><strong>header</strong> specificerar om namnet på varje variabel finns på första raden i datamaterialet</li>
<li><strong>sep</strong> anger vilken typ av tecken som används för att skilja kolumner åt</li>
<li><strong>quote</strong> anger vilken typ av tecken som används som citationstecken för textvariabler</li>
<li><strong>dec</strong> anger vilket teckan som används som decimaltecken.</li>
</ul>
<p>Standardinställningarna för de tre funktionernas vanligaste argument anges nedan.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">read.csv</span>(file, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb174-2" title="2"><span class="kw">read.csv2</span>(file, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb174-3" title="3"><span class="kw">read.table</span>(file, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep=</span> <span class="st">&quot; &quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</a></code></pre></div>
<p>Som syns i kodsnutten är det standard för alla tre funktionerna att läsa in första raden i ett datamaterial som variabelnamn, och de använder alla samma typ av citationstecken. Det som skiljer dem åt är vilka tecken so används för att åtskilja kolumner samt för att skriva ut decimaltal. Funktionen <strong>read.csv()</strong> använder kommatecken för att skilja mellan kolumner, och punkt för att dela upp decimaltal, samtidigt som <strong>read.csv2()</strong> använder semikolon för att skilja mellan kolumner och kommatecken för att dela upp decimaltal. <strong>read.table()</strong>, däremot, använder ett blanksteg för att skilja mellan kolumner, och en punkt för att dela upp decimaltal. För att lära sig läsa in text- och CSV-filer är det bra att gå igenom punktlistan för varje datamaterial som ska läsas in, och på så sätt ta reda på hur argumenten är specificerade i det specifika datamaterialet.</p>
<p>Här nedan finns ett utdrag ur textfilen <strong>animals1.csv</strong>. Titta gärna närmare på datamaterialet och försök identifiera hur vart och ett av argumenten i punktlistan ovan är specificerade. Försök sedan komma fram till vilken av de tre inläsningsfunktionerna som lämpar sig bäst för att läsa in datamaterialet. Svaret finns att läsa under kodsnutten.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1"><span class="st">&quot;&quot;</span>,<span class="st">&quot;animal&quot;</span>,<span class="st">&quot;body&quot;</span>,<span class="st">&quot;brain&quot;</span></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="st">&quot;1&quot;</span>,<span class="st">&quot;Lesser short-tailed shrew&quot;</span>,<span class="fl">0.005</span>,<span class="fl">0.14</span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="st">&quot;2&quot;</span>,<span class="st">&quot;Little brown bat&quot;</span>,<span class="fl">0.01</span>,<span class="fl">0.25</span></a>
<a class="sourceLine" id="cb175-4" title="4"><span class="st">&quot;3&quot;</span>,<span class="st">&quot;Big brown bat&quot;</span>,<span class="fl">0.023</span>,<span class="fl">0.3</span></a>
<a class="sourceLine" id="cb175-5" title="5"><span class="st">&quot;4&quot;</span>,<span class="st">&quot;Mouse&quot;</span>,<span class="fl">0.023</span>,<span class="fl">0.4</span></a>
<a class="sourceLine" id="cb175-6" title="6"><span class="st">&quot;5&quot;</span>,<span class="st">&quot;Musk shrew&quot;</span>,<span class="fl">0.048</span>,<span class="fl">0.33</span></a>
<a class="sourceLine" id="cb175-7" title="7"><span class="st">&quot;6&quot;</span>,<span class="st">&quot;Star-nosed mole&quot;</span>,<span class="fl">0.06</span>,<span class="dv">1</span></a>
<a class="sourceLine" id="cb175-8" title="8"><span class="st">&quot;7&quot;</span>,<span class="st">&quot;E. American mole&quot;</span>,<span class="fl">0.075</span>,<span class="fl">1.2</span></a>
<a class="sourceLine" id="cb175-9" title="9"><span class="st">&quot;8&quot;</span>,<span class="st">&quot;Ground squirrel&quot;</span>,<span class="fl">0.101</span>,<span class="dv">4</span></a>
<a class="sourceLine" id="cb175-10" title="10"><span class="st">&quot;9&quot;</span>,<span class="st">&quot;Tree shrew&quot;</span>,<span class="fl">0.104</span>,<span class="fl">2.5</span></a>
<a class="sourceLine" id="cb175-11" title="11"><span class="st">&quot;10&quot;</span>,<span class="st">&quot;Golden hamster&quot;</span>,<span class="fl">0.12</span>,<span class="dv">1</span></a></code></pre></div>
<p>I <strong>animals.csv</strong> är argumenten specificerade som</p>
<ul>
<li><code>header = TRUE</code> eftersom variabelnamnen anges i den första raden</li>
<li><code>sep = ","</code> eftersom ett kommatecken används för att skilja cellerna i varje rad åt</li>
<li><code>quote = "\""</code> eftersom helt vanliga citationstecken används för textvariabler</li>
<li><code>dec = "."</code> eftersom en vanlig punkt används som decimaltecken</li>
</ul>
<p>Dessa argument kan stämmas av med kodsnutten där standardargument anges, och då framkommer att funktionen <strong>read.csv()</strong> bör användas för att läsa in datamaterialet. Skriv därför in <code>df1 &lt;- read.csv(file="D:/animals1.csv")</code> för att läsa in datamaterialet i R (notera att det räcker att bara skriva <code>file = "animals1.csv"</code> om filen finns i den mapp som är working directory). Eftersom <strong>animals.csv</strong> är en textfil kan filen öppnas i Notepad eller Textredigerare (eller mosvarande), och på så sätt kan alla text- och CSV-filer öppnas för att inspektera hur de är organiserade. Märk väl att de tecken som används för att skilja mellan celler, hantera textvariabler, och dela upp decimaltal alla är angivna inom citationstecken – t.ex. står det alltså <code>sep = ","</code> istället för bara <code>sep = ,</code>. Detta är standard i R, och det är något som är viktigt att komma ihåg. Notera även att citationstecken anges som <code>"\""</code>, detta eftersom två uppsättningar av citationstecken skulle förvirra datorn.</p>
<p>Betrakta nu utdraget ur <strong>animals2.csv</strong> som finns här nedan, och försök återigen identifiera hur argumenten är specificerade, och vilken funktion som bör användas för att läsa in datamaterialet. Svaret finns än en gång att läsa under datamaterialet.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="st">&quot;&quot;</span>;<span class="st">&quot;animal&quot;</span>;<span class="st">&quot;body&quot;</span>;<span class="st">&quot;brain&quot;</span></a>
<a class="sourceLine" id="cb176-2" title="2"><span class="st">&quot;1&quot;</span>;<span class="st">&quot;Lesser short-tailed shrew&quot;</span>;<span class="dv">0</span>,<span class="dv">005</span>;<span class="dv">0</span>,<span class="dv">14</span></a>
<a class="sourceLine" id="cb176-3" title="3"><span class="st">&quot;2&quot;</span>;<span class="st">&quot;Little brown bat&quot;</span>;<span class="dv">0</span>,<span class="dv">01</span>;<span class="dv">0</span>,<span class="dv">25</span></a>
<a class="sourceLine" id="cb176-4" title="4"><span class="st">&quot;3&quot;</span>;<span class="st">&quot;Big brown bat&quot;</span>;<span class="dv">0</span>,<span class="dv">023</span>;<span class="dv">0</span>,<span class="dv">3</span></a>
<a class="sourceLine" id="cb176-5" title="5"><span class="st">&quot;4&quot;</span>;<span class="st">&quot;Mouse&quot;</span>;<span class="dv">0</span>,<span class="dv">023</span>;<span class="dv">0</span>,<span class="dv">4</span></a>
<a class="sourceLine" id="cb176-6" title="6"><span class="st">&quot;5&quot;</span>;<span class="st">&quot;Musk shrew&quot;</span>;<span class="dv">0</span>,<span class="dv">048</span>;<span class="dv">0</span>,<span class="dv">33</span></a>
<a class="sourceLine" id="cb176-7" title="7"><span class="st">&quot;6&quot;</span>;<span class="st">&quot;Star-nosed mole&quot;</span>;<span class="dv">0</span>,<span class="dv">06</span>;<span class="dv">1</span></a>
<a class="sourceLine" id="cb176-8" title="8"><span class="st">&quot;7&quot;</span>;<span class="st">&quot;E. American mole&quot;</span>;<span class="dv">0</span>,<span class="dv">075</span>;<span class="dv">1</span>,<span class="dv">2</span></a>
<a class="sourceLine" id="cb176-9" title="9"><span class="st">&quot;8&quot;</span>;<span class="st">&quot;Ground squirrel&quot;</span>;<span class="dv">0</span>,<span class="dv">101</span>;<span class="dv">4</span></a>
<a class="sourceLine" id="cb176-10" title="10"><span class="st">&quot;9&quot;</span>;<span class="st">&quot;Tree shrew&quot;</span>;<span class="dv">0</span>,<span class="dv">104</span>;<span class="dv">2</span>,<span class="dv">5</span></a>
<a class="sourceLine" id="cb176-11" title="11"><span class="st">&quot;10&quot;</span>;<span class="st">&quot;Golden hamster&quot;</span>;<span class="dv">0</span>,<span class="dv">12</span>;<span class="dv">1</span></a></code></pre></div>
<p>I <strong>animals2.csv</strong> är argumenten specificerade som</p>
<ul>
<li><code>header = TRUE</code> eftersom variabelnamnen anges i den första raden</li>
<li><code>sep = ";"</code> eftersom ett semikolon används för att skilja cellerna i varje rad åt</li>
<li><code>quote = "\""</code> eftersom helt vanliga citationstecken används för textvariabler</li>
<li><code>dec = ","</code> eftersom ett kommatecken används som decimaltecken</li>
</ul>
<p>Efter avstämning med standardargumenten framgår att <strong>animals2.csv</strong> bör läsas in med funktionen <strong>read.csv2()</strong>, och koden <code>df2 &lt;- read.csv2(file="D:/animals2.csv")</code> kan därför användas för att importera datamaterialet till R.</p>
<p>Studera nu utdraget ur datamaterialet <strong>animals.txt</strong> som visas här nedanför, och försök identifiera argument och agöra vilken funktion som bör användas för att importera datamaterialet till R.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="st">&quot;animal&quot;</span> <span class="st">&quot;body&quot;</span> <span class="st">&quot;brain&quot;</span></a>
<a class="sourceLine" id="cb177-2" title="2"><span class="st">&quot;Lesser short-tailed shrew&quot;</span> <span class="fl">0.005</span> <span class="fl">0.14</span></a>
<a class="sourceLine" id="cb177-3" title="3"><span class="st">&quot;Little brown bat&quot;</span> <span class="fl">0.01</span> <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb177-4" title="4"><span class="st">&quot;Big brown bat&quot;</span> <span class="fl">0.023</span> <span class="fl">0.3</span></a>
<a class="sourceLine" id="cb177-5" title="5"><span class="st">&quot;Mouse&quot;</span> <span class="fl">0.023</span> <span class="fl">0.4</span></a>
<a class="sourceLine" id="cb177-6" title="6"><span class="st">&quot;Musk shrew&quot;</span> <span class="fl">0.048</span> <span class="fl">0.33</span></a>
<a class="sourceLine" id="cb177-7" title="7"><span class="st">&quot;Star-nosed mole&quot;</span> <span class="fl">0.06</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb177-8" title="8"><span class="st">&quot;E. American mole&quot;</span> <span class="fl">0.075</span> <span class="fl">1.2</span></a>
<a class="sourceLine" id="cb177-9" title="9"><span class="st">&quot;Ground squirrel&quot;</span> <span class="fl">0.101</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb177-10" title="10"><span class="st">&quot;Tree shrew&quot;</span> <span class="fl">0.104</span> <span class="fl">2.5</span></a></code></pre></div>
<p>I <strong>animals.csv</strong> är argumenten specificerade som</p>
<ul>
<li><code>header = TRUE</code> eftersom variabelnamnen anges i den första raden</li>
<li><code>sep = " "</code> eftersom ett blanksteg används för att särskilja cellerna i varje rad</li>
<li><code>quote = "\""</code> eftersom helt vanliga citationstecken används för textvariabler</li>
<li><code>dec = "."</code> eftersom en punkt används som decimaltecken</li>
</ul>
<p>För att läsa in <strong>animals.txt</strong> är alltså <strong>read.table()</strong> mest lämplig, och datamaterialet kan importeras med hjälp av koden <code>df3 &lt;- read.table(file="D:/animals.txt", header=TRUE)</code>.</p>
<p>Återgå nu till <strong>animals1.csv</strong>, och försök läsa in datamaterialet med hjälp av</p>
<p><code>df4 &lt;- read.table(file="D:/animals1.csv", header=TRUE, sep=",", dec=".")</code></p>
<p>Studera såväl <code>df4</code> som <code>df1</code>, finns det någon skillnad mellan de två datamaterialen? Syftet med <code>df4</code> är att visa att <strong>read.table()</strong> också kan användas för att läsa in filer som inte använder de standardargument som presenterades i början av detta delkapitel. Istället för att använde <strong>read.csv()</strong> går det alltså att använda <strong>read.table()</strong>, och inom parenteserna specificera de argument som gäller för det datamaterial som ska läsas in. Det går lika bra att använda <strong>read.table()</strong> med egenspecificerade argument som att använda någon av funktionerna som har förspecificerade argument, och det är helt enkelt upp till varje individuell användare att avgöra vilken approach som är snabbast och lättast.</p>
</div>
<div id="excel-filer" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Excel-filer</h3>
<p>Eftersom många möjliga uppdragsgivare använder Excel-ark för att lagra och hantera data är det i praktiken nödvändigt att veta hur data från Excel kan importeras till R. Precis som för text-och CSV-filer finns ett antal tips som är bra att tänka på när data matas in i Excel</p>
<ul>
<li>Första raden i varje ark ska innehåla variabelnamn</li>
<li>Första kolumnen bör bestå av observationsid</li>
<li>Undvik namn och värden med mellanslag. Risken är att det tolkas som två olika kolumner.</li>
<li>Korta variabelnamn är bättre än långa.</li>
<li>Undvik tecken som ?, $,%, ^, &amp;, *, (, ),-,#, ?,,,&lt;,&gt;, /, |, , [ ,] ,{, och }</li>
<li>Radera kommentarer som du har i Excelfilen så att dessa inte tolkas som extra data.</li>
</ul>
<p>Många punkter på listan ovan finns även med i listan över saker som är värda att ta i beaktning när det rör sig om text- och CSV-filer. Det faktum att det finns ett relativt stort överlap kan ses som ett tecken på att många av dessa punkter är övergripande och gäller för nästan alla format som datamaterial kan sparas i. Det finns alltså en generell konvention för hur datamaterial bör struktureras för att göra analysen så smidig som möjligt.</p>
<p>I resten av detta avsnitt är målet att importera datamaterialen som finns in Excel-filerna <strong>animal3.xlsx</strong> och <strong>animal4.xlsx</strong>. För att importera data som lagras i Excel-filer krävs ett nytt paket i R. Paketet heter <strong>readxl</strong>, och det lättaste sättet att installera det är att skriva <code>install.packages("readxl")</code> i Console och sedan trycka enter. När paketet väl är installerat är det viktigt att även köra koden <code>library(readxl)</code> för att paketet ska aktiveras i R-sessionen. Paketet behöver bara installeras en gång, men det måste aktiveras varje gång R har varit stängt och öppnas på nytt. Det kan därför vara bra att ha <code>library(readxl)</code> längst upp i ett script där Excel-filer läses in.</p>
<p>Den första av Excel-filerna, <strong>animals3.xlsx</strong>, är en vanlig Excel-fil med bra struktur, där all data finns i det första arket. Datamaterialet som finns i filen kan därför enkelt läsas in genom att använda koden som finns i kodsnutten här nedan.</p>
<pre><code>df5 &lt;- read_excel(&quot;animal3.xlsx&quot;)</code></pre>
<p>Använd samma ansats för att läsa in <strong>animal4.xlsx</strong>, denna ska alltså läsas in som</p>
<pre><code>df6 &lt;- read_excel(&quot;animal3.xlsx&quot;)</code></pre>
<p>Jämför <code>df5</code> och <code>df6</code> visar båda tecken på att datamaterialen har lästs in på ett korrekt sätt? <code>df5</code> ser bra ut, och datamaterialet verkar ha importerats på ett bra sätt. För <code>df6</code>, däremot, är det något som har gått fel i inläsningen. Öppna filen <strong>animal4.xlsx</strong> och fundera på vad det kan vara som orsakar detta fel.</p>
<p>När filen är öppen framgår direkt att den består av flera olika kalkylblad, men att datamaterialet som är av intresse finns lagrat i blad 2. Utöver detta är det även så att datamaterialet inte börjar på första raden, utan det finns även annan text i kalkylbladet. För att R ska kunna importera data från <strong>animal4.xlsx</strong> på ett korrekt sätt krävs att två inställningar specificeras i <strong>read_excel()</strong>, nämligen <strong>sheet</strong> och <strong>range</strong>.</p>
<p>Inställningen <strong>sheet</strong> används för att bestämma vilket blad R ska använda när det importera data från Excel-filer. I fallet <strong>animal4.xlsx</strong> finns det intressanta datamaterialet i blad 2, vilkt innebär att inställningen bör specificeras som <code>sheet = "Blad2"</code>, eftersom detta är namnet på bladet. Den andra inställningen, <strong>range</strong>, används för att bestämma vilken del av kalkylbladet som ska läsas in. I detta fall finns det en del text som stör inläsningen, och datamaterialet börjar först på rad 3. Inställningen bör specificeras som <code>range = "A3:D68"</code> eftersom cellerna <strong>A3</strong> och <strong>D68</strong> kan användas för att bilda en rektangel som innefattar hela datamaterialet (tänkt på det som att dra ett lodrätt och ett vågrätt streck från var och en av cellerna, då kommer alla data finnas inom rektangeln som bildas av strecken). Notera att den första cellen i inställningen ska vara den som är <em>längst upp till vänster</em> i datamaterialet, och den andra cellen ska vara den som finns <em>längt ner till höger.</em> Läs nu in datamaterialet som</p>
<pre><code>df7 &lt;- read_excel(&quot;animal4.xlsx&quot;, sheet = &quot;Blad2&quot;, range = &quot;A3:D68&quot;)</code></pre>
<p>Studera <code>df7</code> närmare. Ser den likadan ut som <code>df6</code>, eller har specificeringen av inställningar gjort datainläsningen bättre? Denna typ av inställningar kan användas för att förenkla importen av datamaterial från Excel-filer, därför är det bra att öppna Excel-filer och titta på deras struktur innan de ska importeras till R.</p>
<p><strong>read_excel()</strong> har som standard att importera data från det första bladet i en Excel-fil, och att importera alla celler som har någon typ av information lagrad i sig (det spelar ingen roll om det är meningslös text eller viktiga data). Därför går det bra att använda funktionen rakt av för datamaterial som är strukturerade som <strong>animals3.xlsx</strong>, eftersom datamaterialet börjar på första raden och alla celler är fyllda med relevant information. I alla övriga fall är det alltså värt att fundera över hur inställningarna kan användas för att underlätta inläsningen av data.</p>
</div>
<div id="övriga-format" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Övriga format</h3>
<p>Utöver de format som diskuterats ovan finns ett flertal andra sätt att lagra data. Eftersom dessa inte är lika vanligt förekommande, och eftersom de inte kommer utgöra någon del i denna kurs, kommer majoriteten av dem inte att behandlas här. Det finns, bland annat, en rad programspecifika datalagringsformat som kan dyka upp ibland. Programspecifikt innebär att formatet är strukturerat på ett sätt som passar ett specifikt statistikprogram väldigt bra, till exempel finns speciella format för att lagra data för bruk i SPSS, Minitab, Stata och dylikt. En fördel med programspecifik datalagring är att den kan göras väldigt effektiv, och på sätt kräva mycket mindre minne än t.ex. textfiler. En nackdel som gör att denna typ av datalagring ofta undviks är att datamaterial måste formatteras om när de ska användas i program som inte är standard, och detta kan ofta vara en omständlig process som lätt går fel. R har ett eget datalagrinsformat, och filer som lagras i detta format brukar ha <strong>.rds</strong> efter filnamnet. Eftersom ett mål med kursen är att lära ut programmering med hjälp av R diskuteras användning av <strong>.rds</strong>-filer i detta avsnitt.</p>
<p>Med hjälp av R:s egna format går det alltså att lagra data mer effektivt när det kommer till minnesanvändning. Formatet gör också att importen av data blir väldigt smidig, eftersom strukturen i datamaterialet är skräddarsydd för att passa de krav som R ställer på ett datamaterial. Funktionen som används för att läsa in datamaterial som sparats i R:s eget format finns direkt tillgänglig i R, och den heter <strong>readRDS()</strong>.</p>
<p>Syntaxen som används för att läsa in datamaterial som finns lagrade i <strong>.rds</strong>-format är relativt simpel, och kan sammanfattas i kodsnutten nedan.</p>
<pre><code>readRDS(file = &quot;filnamn.rds&quot;)
</code></pre>
<p>För att läsa in datamaterialet som är sparat i filen <strong>OVB_data.rds</strong> (finns tillgänglig i Studentportalen) används koden som visas här nedanför.</p>
<pre><code>df8 &lt;- readRDS(file = &quot;OVB_data.rds&quot;)</code></pre>
<p>Som sagt är syntaxen relativt enkel, det enda som krävs är namnet på filen som datamaterialet är lagrat i. Om datamaterialet är del av ett större projekt krävs dock att alla som arbetar med det använder R om det är lagrat i en <strong>.rds</strong>-fil. Därför kan det vara bra att undvika detta format i sammanhang där flera personer ska jobba med ett och samma datamaterial.</p>
</div>
</div>
<div id="läsa-in-datamaterial-med-hjälp-av-menyerna-i-rstudio" class="section level2">
<h2><span class="header-section-number">4.4</span> Läsa in datamaterial med hjälp av menyerna i RStudio</h2>
<p>Det finns två enkla sätt att läsa in data genom att använda de menyer som finns att tillgå i RStudio. Ett av dem handlar om att använda panelen längst ner till höger för att klicka på en fil som finns i R:s working directory, och det handlar om att använda menyn <strong>Import Dataset</strong> som finns längst upp till höger i RStudio-fönstret. Båda dessa tillvägagångssätt kommer diskuteras i denna del av Kapitel 4.</p>
<p>Den stora fördelen med att läsa in datamaterial med hjälp av RStudios menyer är att det ofta kan vara väldigt lätt att göra, och att inställningar kan ändras flera gånger för att ser hur datamaterialet kommer se ut när det väl har importerats. Det kan alltså vara lättare att ordna en bra import redan vid första försöket. Den största nackdelen är dock att det är lätt att glömma att spara koden som skrivs ut i Console, och att det därför kan bli så att processen måste genomföras varje gång RStudio startas på nytt. Om olika inställningar används varje gång datamaterialet läses in kan det ge snedvridande effekter på den statistika analys som ska genomföras.</p>
<div id="läsa-in-data-från-working-directory" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Läsa in data från working directory</h3>
<p>Börja med att set till så att filerna i R:s working directory syns i panelen längst ner till vänster. Instruktioner för hur detta ordnas finns i sista stycket under rubriken <strong>Working directory</strong> i detta kapitel.</p>
<p>Flytta nu filen <strong>OVB_data.rds</strong> till mappen som är working directory, och vänta tills det att den dyker upp i panelen längst ner till vänster. Klicka på filens namn när den har dykt upp, så att en dialogruta dyker upp. I denna ruta anges det namn som datamaterialet ska ha när det importeras till R. Ange ett namn och klicka på <strong>OK</strong> så importeras datamaterialet direkt till R. När filen som ska läsas in inte är av <strong>.rds</strong>-format kan det bli lite krångligare att använda denna approach, men i de flesta fall så går det att ändra grundinställningarna precis som när data importeras med hjälp av kod.</p>
<p>Ladda nu ner filen <strong>OVB_data.csv</strong> och flytta den till working directory. Testa att klicka på dess namn i panelen längst ner till vänster, och sedan klicka på <strong>Import Dataset</strong>. När detta är gjort öppnas ett fönster där datamaterialet visas, detta fönster illustreras i bilden nedan.</p>
<p><img src="docs/images/import_wd.png" />
Som synes ser datamaterialet väldigt väl organiserat ut, men det behöver inte alltid vara fallet. Ibland kan det vara så att datamaterialet ser väldigt konstigt ut, och detta kan bero på att grundinställningarna i inläsningen inte är anpassade efter datamaterialet i fråga. När det rör sig om text- och CSV-filer finns det, precis som när data importeras med kod, fyra inställningar som kan ändras för att datamaterialet ska importeras korrekt. Dessa inställningar kan ändras i rutan <strong>Import Options</strong>, som finns precis under datamaterialet.</p>
<p>Med hjälp av rutan vid <strong>First Row as Names</strong> kan inställningen <strong>header</strong> justeras. Om rutan har en bock i sig har inställningen specifierats som <code>header = TRUE</code>, annars är inställningen satt till <code>FALSE</code>. Till höger om <strong>Delimeter:</strong> finns en rullista som kan användas för att avgöra vilket tecken som används för att skilja mellan kolumner, och Till höger om <strong>Quotes:</strong> finns en rullista som kan användas för att avgöra hur textvariabler hanteras. Dessa båda motsvarar inställningarna <strong>sep</strong> respektive <strong>quote</strong> från tidigare. Slutligen kan knappen <strong>Configure</strong> till höger om <strong>Locale</strong> användas för att få upp en ruta där alternativet <strong>dec</strong> kan användas för att avgöra vilken typ av decimaltecken som används i datamaterialet.</p>
<p>En sak som är särskilt bra med detta sätt att importera data är att det går att ange vilken datanivå varje variabel har (eller är tänkt att ha). Under varje variabel namn finns i bilden ovan en liten pil (med texten (double) bredvid). Klicka gärna på denna fil för att få upp en lista med olika datanivåer, en sådan lista visas i bilden som följer.</p>
<p><img src="docs/images/dataniva.png" /></p>
<p>Det första allternativet i listan ovan är <strong>Guess</strong>, vilket innebär att R läser av värdena som finns i kolumnen och “gissar” vilken datanivå variabeln har. Om variabeln i fråga är en faktor variabel med numeriska nivåer, till exempel de binära nivåerna <strong>0</strong> och <strong>1</strong>, är det lätt hänt att R gissar fel och klassa variabeln som <strong>Integer</strong>. För att undvika detta rekommenderas att byta datanivån till <strong>Factor</strong>, detta kommer visas sig vara till stor hjälp i analysen av datamaterialet. Notera även att alternativen <strong>Skip</strong> och <strong>Only</strong> finns längst ner i listan. Alternativet <strong>Skip</strong> medför att den valda variabeln <em>inte</em> importeras, och <strong>Only</strong> medför att <em>bara</em> den valda variabeln importeras.</p>
<p>Med hjälp av dessa fem inställningar bör det vara möjligt att läsa in datafiler på ett ordentligt sätt.</p>
</div>
<div id="läsa-in-data-med-import-dataset" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Läsa in data med “Import Dataset”</h3>
<p>Längst upp till höger i RStudio finns en knapp där det står <strong>Import Dataset</strong>. Klicka på denna för att få upp en rullista med alternativ (se bild nedan).</p>
<p><img src="docs/images/environ.png" /></p>
<p>I listan går det att välja vilket format datamaterialet som ska läsas in har. För text- och CSV-filer rekommenderas <strong>From Text (base)</strong>. Klicka på <strong>From Text (base)</strong> för att få upp ett fönster med alla filer som finns i R:s working directory. Notera att det även går att navigera runt i datorn för att hitta datamaterial som finns i mappar som inte är working directory. Välj nu filen <strong>OVB_data.csv</strong> för att få upp rutan som visas i bilden nedan.</p>
<p><img src="docs/images/import_data.png" /></p>
<p>I rutan finns tre paneler. I panelen med rubrik <strong>Input File</strong> visas filen som ska läsas in, med andra ord ger den en blick över det rådata som finns. Det som är bra med denna panel är att det går väldigt lätt att undersöka hur det ligger till med grundinställningarna som diskuterats ovan, det vill säga vilken typ av decimalteceken som använs och så vidare. I panelen som heter <strong>Data Frame</strong> visas strukturen på den data frame som kommer läsas in med de inställningar som råder för tillfället. I detta fall ser datamaterialet bra strukturerat ut, men så är inte alltid fallet. När det som visas under <strong>Data Frame</strong> ser dåligt strukturerat ut är det en bra idé att ändra på inställningarna till vänster om de två panelerna. De vanligaste inställningarna ändras med hjälp av <strong>Heading</strong> som anger huruvida den första raden innehåller variabelnamn, <strong>Separator</strong> som anger vilket tecken som används för att skilja mellan kolumner, <strong>Decimal</strong> som anger vilken typ av decimaltecken som används, och <strong>Quote</strong> som används för att specificera textvariabler. Testa att byta inställningen för <strong>Heading</strong> till <strong>Yes</strong>, vad händer? Ser materialet som visas under <strong>Data Frame</strong> bättre ut. Prova även att ändra de andra inställningarna för att se vad som händer, och fundera över varför det blir som det blir.</p>
<p>När datamaterialet som visas under <strong>Data Frame</strong> ser bra ut importeras det genom att trycka på <strong>Import</strong>. Notera att ett kommando skrivs ut och körs i Console när datamaterialet importeras. Denna kod kan vara värd att kopiera och spara i den scriptfil där datamaterialet är tänkt att analyseras, eftersom koden då bara kan köras för att importera datamaterialet nästa gång R startas. Om koden redan finns i scriptet är det inte nödvändigt att importera det genom att använda <strong>Import Data</strong>-menyn en gång till.</p>
</div>
</div>
<div id="spara-datamaterial-med-hjälp-av-r" class="section level2">
<h2><span class="header-section-number">4.5</span> Spara datamaterial med hjälp av R</h2>
<p>Många gånger kan det vara fördelaktigt att exportera ett datamaterial från R, och spara det på datorn i någon sorts text- eller excel-fil. Till exemple kan det vara så att R har använts för att städa ett datamaterial, göra olika ändringar i ett datamaterial, eller slå ihop två eller flera datamaterial. Då är det smidigt att kunna spara det förändrade datamaterialet för att sedan kunna arbeta med det direkt, och inte behöva genomföra samma förändringar varje gång analysarbete ska utföras.</p>
<p>De kommandon som används för att exportera datamaterial i R är snarlika de som används för att importera datamaterial. Funktionerna har nästan samma namn, och deras struktur är uppbygd på i stort sett sätt. För att spara datamaterial i text-filer finns tre huvudsakliga funktioner. Dessa är</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"><span class="kw">write.csv</span>(x, <span class="dt">file =</span> <span class="st">&quot; &quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb183-2" title="2"><span class="kw">write.csv2</span>(x, <span class="dt">file =</span> <span class="st">&quot; &quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb183-3" title="3"><span class="kw">write.table</span>(x, <span class="dt">file =</span> <span class="st">&quot; &quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep=</span> <span class="st">&quot; &quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</a></code></pre></div>
<p>Notera att funktionsnamnen är likadana, med skillnaden att det nu står <strong>write</strong> istället för <strong>read</strong> framför punkten. Grundinställningarna i funktionerna är samma som de för motsvarande funktion som används för dataimport. I funktionerna representerar <strong>x</strong> det material som ska exporteras, och inom de citationstecken som finns efter <strong>file = </strong> anges namnet på den fil som datamaterialet ska sparas i. Datamaterialet kommer per automatik sparas i det working directory som är angivet när kodsnutten körs.</p>
<p>För att visa hur exportfunktionerna kan komma till nytta används de två datamaterialen <strong>exp_dat1.csv</strong> och <strong>exp_dat2.csv</strong>. De båda datamaterialen är simulerade vilked medför att de inte är särskilt intressanta i sig själva, utan det intressanta är hur de kan manipuleras och sedan sparas.</p>
<p>Ladda ner de två datamaterialet till ett R:s working directory och läs in dem som</p>
<pre><code>exp_dat1 &lt;- read.csv(&quot;exp_dat1.csv&quot;)
exp_dat2 &lt;- read.csv(&quot;exp_dat2.csv&quot;)</code></pre>
<p>Sätt sedan ihop datamaterialen till ett stort material genom att använda <strong>rbind()</strong></p>
<pre><code>exp_sam &lt;- rbind(exp_dat1, exp_dat2)</code></pre>
<p>För att kontrollera huruvida de två materialen har satts ihop på ett korrekt sätt går det att använda</p>
<pre><code>View(exp_sam)</code></pre>
<p>Det nya datamaterialet kan nu exporteras med hjälp av funktionerna ovan. För att exportera det till en textfil där cellerna separeras av semikolon används</p>
<pre><code>write.csv2(exp_sam, file = &quot;exp_sam.csv&quot;)</code></pre>
<p>I detta fall sparas en textfil vid namn <em>exp_sam.csv</em> i det working directory som har angivits. Notera att filen som sparas inte måste ha samma namn som datamaterialet har i R. Om det, av någon anledning, anses att <em>sammanslagna_data.csv</em> är ett bättre namn på filen som ska sparas används helt enkelt</p>
<pre><code>write.csv2(exp_sam, file = &quot;sammanslagna_data.csv&quot;)</code></pre>
</div>
<div id="övningar-2" class="section level2">
<h2><span class="header-section-number">4.6</span> Övningar</h2>
<div id="övning-4.1" class="section level3 unnumbered">
<h3>Övning 4.1</h3>
<p>Denna uppgift kretsar kring att importera data från sjätte vågen av World Values Survey. Datamaterialet är begränsat till svar från de intevjuer som utförts i Sverige under år 2011, och innehåller 1206 observationer. Alla svar är omkodade till siffror, och ett utdrag ur datamaterialet innehåller svar på frågor gällande</p>
<ul>
<li>Äktenskaplig status</li>
<li>Antal barn</li>
<li>Huruvida responenten skulle vara villig att försvara Sverige vid ett eventuellt krigsutbrott</li>
<li>Ålder</li>
</ul>
<p>Frågorna är sorterade så att varje punkt i listan ovan motsvarar respektive kolumn i datamaterialet (alltså finns äktenskaplig status i första kolumnen, antal barn i andra kolumnen, etc.). Uppgiften är nu att:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Ladda ner datamaterialet som finns lagrat i <strong>VWS.csv</strong> från Studentportalen.</p></li>
<li><p>Öppna filen som datamaterialet är lagrad i med hjälp av Notepad, TextEdit, eller någon annan textredigerare. Fundera på hur datamaterialet materialet är strukturerat, och ange hur de fyra grundinställningarna är specificerade i filen.</p></li>
</ol>
<button title="q41b" type="button" onclick="if(document.getElementById(&#39;q41b&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q41b&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q41b&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q41b" style="display:none">
<div class="alert alert-info">
<p>I datamaterialet är</p>
<ul>
<li><code>header = FALSE</code> eftersom inga variabelnamn ges i första raden</li>
<li><code>sep = ";"</code> eftersom semikolon används för att skilja mellan kolumner</li>
<li><code>quote = "\""</code> detta går egentligen inte att se, eftersom inga textvariabler finns med</li>
<li><code>dec = "."</code> detta går inte heller att se, eftersom inga decimaltal finns i datamaterialet</li>
</ul>
</div>
</div>
<p></br></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Avgör vilken av funktionerna <code>read.csv()</code> och <code>read.csv2()</code> som är bäst lämpad för att importera datamaterialet till R, och skriv sedan en kodsnutt som kan användas för att importera datamaterialet.</li>
</ol>
<button title="q41c" type="button" onclick="if(document.getElementById(&#39;q41c&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q41c&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q41c&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q41c" style="display:none">
<div class="alert alert-info">
<p>Eftersom semikolon används för att skilja mellan kolumner är <code>read.csv2()</code> bäst lämpad för att läsa in datamaterialet. Notera dock att <code>header = FALSE</code>, och att denna inställning måste ändras i koden. Kodsnutten som används för att läsa in datameterialet blir så</p>
<pre><code>wvs &lt;- read.csv2(&quot;WVS1.csv&quot;, header = FALSE)</code></pre>
</div>
</div>
<p></br></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Använd nu <code>read.table()</code> för att importera samma datamaterial genom att ange egna specifikationer för alla inställningar.</li>
</ol>
<button title="q41d" type="button" onclick="if(document.getElementById(&#39;q41d&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q41d&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q41d&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q41d" style="display:none">
<div class="alert alert-info">
<p>För att använda <code>read.table()</code> måste inställningarna för <code>header</code> och <code>sep</code> specificeras så att</p>
<pre><code>wvs2 &lt;- read.table(&quot;WVS1.csv&quot;, header = FALSE, sep = &quot;;&quot;)</code></pre>
</div>
</div>
<p></br></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Ge varje kolumn ett meningsfullt namn.</li>
</ol>
<button title="q41e" type="button" onclick="if(document.getElementById(&#39;q41e&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q41e&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q41e&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q41e" style="display:none">
<div class="alert alert-info">
<p>Vad som räknas som bra namn är till viss del subjektivt, och det är inget krav att namnen ska vara exakt samma som de namn som anges här. Vad som är viktigt är att namnen är i linje med rekommendationerna som ges i texten.</p>
<p>Exampel på variabelnamn</p>
<pre><code>colnames(wvs) &lt;- c(&quot;ID&quot;, &quot;marital_status&quot;, &quot;children&quot;, &quot;defend_country&quot;, &quot;age&quot;)  
View(wvs) </code></pre>
</div>
</div>
<p></br></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Läs in datamaterialet genom att använda <strong>Import Dataset</strong>-menyn. Blir resultatet likadant som ovan?</li>
</ol>
</div>
<div id="övning-4.2" class="section level3 unnumbered">
<h3>Övning 4.2</h3>
<p>Denna övning använder samma datamaterial som övningen ovan, dock i ett annat format. Utför följande uppgifter:</p>
<ol style="list-style-type: lower-alpha">
<li>Ladda ner filen <strong>WVS.xlsx</strong> från Studentportalen och studera den i ett Excel-fönster. Finns det något som kan orsaka svårigheter i datainläsningen? Finns det några celler som innehåller information som inte är relevant i sammanhanget?</li>
</ol>
<button title="q42a" type="button" onclick="if(document.getElementById(&#39;q42a&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q42a&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q42a&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q42a" style="display:none">
<div class="alert alert-info">
<p>I datamaterialet finns tre saker som är värda att notera</p>
<ol style="list-style-type: decimal">
<li>All data finns i det andra arket, vid namn <strong>Sheet2</strong></li>
<li>Ovanför datamaterialet finns en informationstext som berättar var datamaterialet har hämtats och vad det innehåller för information</li>
<li>Till höger om datamaterialet finns ett index som visar vad varje kolumn innehåller data för</li>
</ol>
</div>
</div>
<p></br></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Använd funktionen <strong>read_excel()</strong> för att läsa in datamaterialet. Vilka inställningar är viktiga att ändra för att inläsningen ska gå korrekt till?</li>
</ol>
<button title="q42b" type="button" onclick="if(document.getElementById(&#39;q42b&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q42b&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q42b&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q42b" style="display:none">
<div class="alert alert-info">
<p>För att datainläsningen ska gå korrekt till finns två inställningar som behöver ändras. Den ena är <code>sheet</code>, som bestämmer vilket ark som ska läsas in, och den andra är <code>range</code> som anger vilken del av Excel-arket som ska läsas in.</p>
<p>I detta fall bör <code>sheet = "Sheet2"</code>, och <code>range = "A4:D1210"</code>, och koden blir</p>
<pre><code>wvs3 &lt;- read_excel(&quot;WVS.xlsx&quot;, sheet = &quot;Sheet2&quot;&quot;, range = &quot;A4:D1210&quot;)</code></pre>
<p>Notera att indexet över vilken variabel som hör till vilken kolumn kan vara bra att spara på annat sätt, men inte i själva datamaterialet.</p>
</div>
</div>
<p></br></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Använd valfri meny i RStudio for att importera datamaterialet som finns i <strong>WVS.xlsx</strong>. Var noga med att bara importera den del av materialet som kan komma att bli relevant för en framtida analys.</li>
</ol>
</div>
<div id="övning-4.3" class="section level3 unnumbered">
<h3>Övning 4.3</h3>
<p>I textfilen <code>covid_19.csv</code> finns information gällande antalet bekräftade fall av Covid-19 i hela Sverige, samt regionsspecifik information för Dalarna och Uppsala.</p>
<ol style="list-style-type: lower-alpha">
<li>Skriv en kodsnutt som på lämligt sätt importerar datamaterialet till <code>R</code></li>
</ol>
<button title="q43a" type="button" onclick="if(document.getElementById(&#39;q43a&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q43a&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q43a&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q43a" style="display:none">
<div class="alert alert-info">
<p>Börja med att öppna filen i <strong>textedit</strong> eller <strong>notepad</strong> (beroende på vilken typ av dator du har).</p>
<p>Det första som finns i datamaterialet är en informationstext som kan ställa till det vid datainläsning. För att komma runt denna informationstext finns två olika alternativ</p>
<ol style="list-style-type: decimal">
<li>Radera texten manuellt, spara om filen, och sedan läsa in den som vanligt</li>
<li>Använda inställningen <code>skip</code> och få <code>R</code> att hoppa över de första raderna när datamaterialet importeras.</li>
</ol>
<p>I vilket fall som helst kan konstateras att</p>
<ul>
<li><code>header = TRUE</code></li>
<li><code>sep = ","</code></li>
<li><code>quote = "\""</code> egentligen finns ingen text-data i materialet, men detta är ett antagende som kan göras</li>
<li><code>dec = "."</code> här gäller samma sak som ovan</li>
</ul>
<p>Det är alltså lämplig att använda <code>read.csv()</code> för att importera datamaterialet.</p>
<p>Om den inledande texten har raderats, och om filen finns i ett aktuellt working directory, kan materialet läsas in som</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1">covid_<span class="dv">19</span> &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;covid_19.csv&quot;</span>)</a></code></pre></div>
<p>Om informationstexten ligger kvar är det viktigt att notera att de 8 första raderna i textfilen antingen innehåller text eller är tomma. Därför kan alternativet <code>skip</code> sättas till <code>8</code>, så börjar <code>R</code> läsa in data från den nionde raden i filen. Koden skrivs då som</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1">covid_<span class="dv">19</span> &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;covid_19.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">8</span>)</a></code></pre></div>
</div>
</div>
<p></br></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Undersök datamaterialet för att se om det finns några konstigheter, så som konstiga eller orimliga värden. Koda i sådana fall om de konstiga värdena till <code>NA</code></li>
</ol>
<button title="q43b" type="button" onclick="if(document.getElementById(&#39;q43b&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q43b&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q43b&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q43b" style="display:none">
<div class="alert alert-info">
<p>För att få en sammanfattning av datamaterialet kan <code>summary()</code> användas</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1"><span class="kw">summary</span>(covid_<span class="dv">19</span>)</a></code></pre></div>
<pre><code>##        X            Statistikdatum Totalt_antal_fall    Dalarna      
##  Min.   :  1.0   2020-02-04:  1    Min.   : -99.0    Min.   :     0  
##  1st Qu.: 67.5   2020-02-05:  1    1st Qu.: 144.0    1st Qu.:     3  
##  Median :134.0   2020-02-06:  1    Median : 330.0    Median :     9  
##  Mean   :134.0   2020-02-07:  1    Mean   : 419.3    Mean   : 11685  
##  3rd Qu.:200.5   2020-02-08:  1    3rd Qu.: 655.5    3rd Qu.:    18  
##  Max.   :267.0   2020-02-09:  1    Max.   :1980.0    Max.   :999999  
##                  (Other)   :261                      NA&#39;s   :10      
##     Uppsala      
##  Min.   :  0.00  
##  1st Qu.:  4.00  
##  Median : 13.00  
##  Mean   : 20.81  
##  3rd Qu.: 33.00  
##  Max.   :173.00  
## </code></pre>
<p>Som synes finns konstiga värden på två olika stället</p>
<ol style="list-style-type: decimal">
<li>I variabeln <code>Totalt_antal_fall</code> är det minsta värdet -99. Eftersom variabeln mäter antal som bekräftats smittade är negativa tal inte möjliga, och därför bör alla tal som är mindre än noll kodas om till <code>NA</code></li>
<li>I kolumnen som mäter antalet som bekräftats smittade i Dalarna finns minst ett värde som är <code>999999</code>. Eftersom Dalarnas folkmängd är cirka 285 000 borde detta vara en ren omöjlighet.</li>
</ol>
<p>Därför används koden</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">covid_<span class="dv">19</span><span class="op">$</span>Totalt_antal_fall[covid_<span class="dv">19</span><span class="op">$</span>Totalt_antal_fall <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb197-2" title="2">covid_<span class="dv">19</span><span class="op">$</span>Dalarna[covid_<span class="dv">19</span><span class="op">$</span>Dalarna <span class="op">==</span><span class="st"> </span><span class="dv">999999</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a></code></pre></div>
<p>för att koda om de konstiga värdena.</p>
<p>För att kontrollera att altt nu står rätt till anropas <code>summary()</code> en gång till</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1"><span class="kw">summary</span>(covid_<span class="dv">19</span>)</a></code></pre></div>
<pre><code>##        X            Statistikdatum Totalt_antal_fall    Dalarna     
##  Min.   :  1.0   2020-02-04:  1    Min.   :   0.0    Min.   : 0.00  
##  1st Qu.: 67.5   2020-02-05:  1    1st Qu.: 166.5    1st Qu.: 3.00  
##  Median :134.0   2020-02-06:  1    Median : 347.5    Median : 9.00  
##  Mean   :134.0   2020-02-07:  1    Mean   : 441.6    Mean   :12.06  
##  3rd Qu.:200.5   2020-02-08:  1    3rd Qu.: 668.8    3rd Qu.:17.00  
##  Max.   :267.0   2020-02-09:  1    Max.   :1980.0    Max.   :64.00  
##                  (Other)   :261    NA&#39;s   :11        NA&#39;s   :13     
##     Uppsala      
##  Min.   :  0.00  
##  1st Qu.:  4.00  
##  Median : 13.00  
##  Mean   : 20.81  
##  3rd Qu.: 33.00  
##  Max.   :173.00  
## </code></pre>
<p>Denna gång ser allt bra ut.</p>
</div>
</div>
<p></br></p>
<!--chapter:end:04-datainlasning.Rmd-->
<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}

</style>
</div>
</div>
</div>
<div id="kategorivariabler" class="section level1">
<h1><span class="header-section-number">5</span> Kategorivariabler</h1>
<p>En nödvändig färdighet vid arbete med data är att kunna hantera och analysera kategorivariabler.
Vi börjar i detta kapitel med det enkla fallet binära variabler för att i ett senare övergå till att studera hur man arbetar med variabler som har fler än två kategorier.</p>
<p>I princip alla datamaterial innehåller variabler med kategorier och även om data inledningsvis inte innehåller kategorivariabler är det vanligt att av olika skäl omkoda kvantitativa variabler till kategorier.
Kategorivariabler kan vara antingen på nominal eller ordinalskala. Dessutom är det inte ovanligt att även analysera diskreta kvantitativa variabler som om de bestod av kategorier.</p>
<p>För nybörjaren kan det vara förvirrande att det finns åtminstone två alternativ, som bägge är viktiga, för hur man arbetar med kategorivariabler.</p>
<ul>
<li><strong>Alternativ 1</strong>. En kategorivariabel hanteras som en numerisk variabel efter att kategorierna tilldelats numeriska värden. Exempelvis kan vi för en <strong>binär variabel</strong> ange att värdena 0 och 1 representerar två kategorier. Observera att val värden påverkar hur variabeln används i analysen.</li>
<li><strong>Alternativ 2</strong>. En kategoriabel definieras med funktionen <strong>factor()</strong>som datatypen <strong>faktor</strong>. En faktors kategorier benämns i R för <strong>levels</strong> (nivåer). Fördelen med att definiera en variabel som faktor är att R kan använda information om den binära variabeln i analyser och resultat. Till exempel kan kategoriernas namn presenteras i resultat. Dessutom kräver en del metoder i R en faktor-variabel. Observera att det, av förklarliga skäl, inte går att utföra räkneoperationer på variabler definierade som datatypen faktor.</li>
</ul>
<p>Eftersom bägge varianterna har för- och nackdelar återfinns ofta <strong>bägge varianter</strong> av kodning för en och samma binära variabel i ett dataset — en numerisk (i fallet med en binär variabel kodad 0-1 kallad för <strong>variabelnamn_bin</strong>) och version kodad som faktor (kallad <strong>variabelnamn_cat</strong>).</p>
<p>Vi kommer i stor utsträckning använda data för att exemplifiera och framför allt kommer nedanstående dataset användas.</p>
<ul>
<li><strong>utbildning</strong>: “Vilken är din högsta avslutade utbildning?” - <em>låg. Gymnasieutbildning eller lägre</em>. <em>hög. Grundexamen på universitetet eller högre.</em><br />
</li>
<li><strong>alder</strong>: “Hur gammal är du?” - <em>0. 65-79 år, 1. 50-64 år, 2. 18-49 år.</em></li>
<li><strong>rokare</strong>: “Röker du minst en cigarett varje vecka?” - 1. Ja, 0. Nej.</li>
<li><strong>kon</strong>: - “Vilket kön är du?” - <em>man</em>, <em>kvinna</em></li>
<li><strong>reklam</strong>: “Anser du att TV-reklam för spel bör vara tillåtet?” - <em>Ja</em>, <em>Nej</em>, <em>Har ej tagit ställning</em>.</li>
<li><strong>inkomst</strong>: “Vilken är din månadsinkomst?” - <em>inkomst kr/mån</em></li>
<li><strong>alkohol</strong>: “Hur ställer du dig till att i Sverige ha ett totalt förbud mot att sälja alkohol?” - <em>1. Mycket positiv. 2. Ganska positiv. 3. Varken positiv eller negativ. 4. Ganska negativ 5. Mycket negativ.</em></li>
<li><strong>cannabis</strong>: “Hur ställer du dig till att i Sverige ha ett totalt förbud mot att sälja cannabis?” - <em>1. Mycket positiv. 2. Ganska positiv. 3. Varken positiv eller negativ. 4. Ganska negativ 5. Mycket negativ.</em></li>
<li><strong>cigaretter</strong>: Hur ställer du dig till att i Sverige ha ett totalt förbud mot att sälja cigaretter?" - <em>1. Mycket positiv. 2. Ganska positiv. 3. Varken positiv eller negativ. 4. Ganska negativ 5. Mycket negativ.</em></li>
<li><strong>mat</strong>: antal inköp av mat per vecka</li>
</ul>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">utbildning =</span> <span class="kw">c</span>(<span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>,<span class="st">&quot;hög&quot;</span>,<span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>,  <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>,<span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>,<span class="st">&quot;hög&quot;</span>,  <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>,  <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>,<span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>,  <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>,<span class="st">&quot;låg&quot;</span>),</a>
<a class="sourceLine" id="cb200-2" title="2"><span class="dt">alder =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb200-3" title="3"><span class="dt">rokare =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb200-4" title="4"><span class="dt">kon =</span> <span class="kw">c</span>(<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;kvinna&#39;</span>,<span class="st">&#39;man&#39;</span>),</a>
<a class="sourceLine" id="cb200-5" title="5"><span class="dt">reklam =</span> <span class="kw">c</span>(<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Nej&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Ja&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>,<span class="st">&#39;Har ej tagit ställning&#39;</span>),</a>
<a class="sourceLine" id="cb200-6" title="6"><span class="dt">inkomst =</span> <span class="kw">c</span>(<span class="dv">13941</span>,<span class="dv">39664</span>,<span class="dv">13168</span>,<span class="dv">28809</span>,<span class="dv">55952</span>,<span class="dv">12495</span>,<span class="dv">20185</span>,<span class="dv">38094</span>,<span class="dv">13822</span>,<span class="dv">32932</span>,<span class="dv">22205</span>,<span class="dv">36625</span>,<span class="dv">51575</span>,<span class="dv">21508</span>,<span class="dv">33509</span>,<span class="dv">26322</span>,<span class="dv">15392</span>,<span class="dv">21626</span>,<span class="dv">18837</span>,<span class="dv">24299</span>,<span class="dv">38921</span>,<span class="dv">38951</span>,<span class="dv">18360</span>,<span class="dv">32974</span>,<span class="dv">14131</span>,<span class="dv">28463</span>,<span class="dv">38232</span>,<span class="dv">20072</span>,<span class="dv">24300</span>,<span class="dv">40883</span>,<span class="dv">9090</span>,<span class="dv">30565</span>,<span class="dv">32935</span>,<span class="dv">32589</span>,<span class="dv">14408</span>,<span class="dv">33223</span>,<span class="dv">20177</span>,<span class="dv">32574</span>,<span class="dv">30640</span>,<span class="dv">16255</span>,<span class="dv">24056</span>,<span class="dv">18365</span>,<span class="dv">22039</span>,<span class="dv">32859</span>,<span class="dv">13595</span>,<span class="dv">10514</span>,<span class="dv">19490</span>,<span class="dv">30075</span>,<span class="dv">29849</span>,<span class="dv">14371</span>,<span class="dv">15076</span>,<span class="dv">18983</span>,<span class="dv">26641</span>,<span class="dv">14967</span>,<span class="dv">38646</span>,<span class="dv">27197</span>,<span class="dv">15314</span>,<span class="dv">9058</span>,<span class="dv">10275</span>,<span class="dv">19248</span>,<span class="dv">33629</span>,<span class="dv">16039</span>,<span class="dv">15302</span>,<span class="dv">8363</span>,<span class="dv">29178</span>,<span class="dv">29565</span>,<span class="dv">35454</span>,<span class="dv">25673</span>,<span class="dv">25116</span>,<span class="dv">21695</span>,<span class="dv">12594</span>,<span class="dv">31860</span>,<span class="dv">48489</span>,<span class="dv">37977</span>,<span class="dv">20106</span>,<span class="dv">45531</span>,<span class="dv">27277</span>,<span class="dv">15418</span>,<span class="dv">18315</span>,<span class="dv">20529</span>,<span class="dv">24322</span>,<span class="dv">9509</span>,<span class="dv">22487</span>,<span class="dv">14443</span>,<span class="dv">30287</span>,<span class="dv">33711</span>,<span class="dv">28788</span>,<span class="dv">38495</span>,<span class="dv">43640</span>,<span class="dv">21820</span>,<span class="dv">12945</span>,<span class="dv">29219</span>,<span class="dv">26099</span>,<span class="dv">53993</span>,<span class="dv">18370</span>,<span class="dv">13513</span>,<span class="dv">34515</span>,<span class="dv">39675</span>,<span class="dv">24622</span>,<span class="dv">10069</span>,<span class="dv">42460</span>,<span class="dv">21113</span>,<span class="dv">32073</span>,<span class="dv">40741</span>,<span class="dv">25925</span>,<span class="dv">48530</span>,<span class="dv">37672</span>,<span class="dv">16809</span>,<span class="dv">53412</span>,<span class="dv">28576</span>,<span class="dv">20974</span>,<span class="dv">53895</span>,<span class="dv">17485</span>,<span class="dv">9382</span>,<span class="dv">26977</span>,<span class="dv">37076</span>,<span class="dv">34885</span>,<span class="dv">24809</span>,<span class="dv">12793</span>,<span class="dv">18749</span>,<span class="dv">22223</span>,<span class="dv">27462</span>,<span class="dv">33319</span>,<span class="dv">25212</span>,<span class="dv">19846</span>,<span class="dv">36005</span>,<span class="dv">22765</span>,<span class="dv">25484</span>,<span class="dv">5710</span>,<span class="dv">22545</span>,<span class="dv">26475</span>,<span class="dv">50017</span>,<span class="dv">10044</span>,<span class="dv">28683</span>,<span class="dv">28379</span>,<span class="dv">36793</span>,<span class="dv">37007</span>,<span class="dv">43140</span>,<span class="dv">11389</span>,<span class="dv">28621</span>,<span class="dv">8074</span>,<span class="dv">18887</span>,<span class="dv">8729</span>,<span class="dv">34029</span>,<span class="dv">22957</span>,<span class="dv">25761</span>,<span class="dv">21928</span>,<span class="dv">23366</span>,<span class="dv">21629</span>,<span class="dv">29325</span>,<span class="dv">17545</span>,<span class="dv">34121</span>,<span class="dv">9780</span>,<span class="dv">34344</span>,<span class="dv">15565</span>,<span class="dv">35821</span>,<span class="dv">22192</span>,<span class="dv">24715</span>,<span class="dv">29730</span>,<span class="dv">36446</span>,<span class="dv">19315</span>,<span class="dv">18764</span>,<span class="dv">30303</span>,<span class="dv">44705</span>,<span class="dv">24113</span>,<span class="dv">24773</span>,<span class="dv">13433</span>,<span class="dv">21116</span>,<span class="dv">22444</span>,<span class="dv">17098</span>,<span class="dv">27646</span>,<span class="dv">29356</span>,<span class="dv">11167</span>,<span class="dv">39386</span>,<span class="dv">46786</span>,<span class="dv">20476</span>,<span class="dv">32806</span>,<span class="dv">8196</span>,<span class="dv">20299</span>,<span class="dv">11016</span>,<span class="dv">28822</span>,<span class="dv">34008</span>,<span class="dv">36611</span>,<span class="dv">40839</span>,<span class="dv">38823</span>,<span class="dv">27474</span>,<span class="dv">21803</span>,<span class="dv">23579</span>,<span class="dv">24328</span>,<span class="dv">26289</span>,<span class="dv">34776</span>,<span class="dv">42902</span>,<span class="dv">5958</span>,<span class="dv">20928</span>,<span class="dv">8996</span>,<span class="dv">14684</span>,<span class="dv">19391</span>,<span class="dv">14105</span>,<span class="dv">24321</span>,<span class="dv">31704</span>,<span class="dv">40910</span>,<span class="dv">14725</span>,<span class="dv">25166</span>,<span class="dv">33578</span>,<span class="dv">21071</span>,<span class="dv">37265</span>,<span class="dv">21827</span>,<span class="dv">17284</span>,<span class="dv">16401</span>,<span class="dv">38311</span>,<span class="dv">10416</span>,<span class="dv">16634</span>,<span class="dv">32329</span>,<span class="dv">18411</span>,<span class="dv">11388</span>,<span class="dv">22741</span>,<span class="dv">45799</span>,<span class="dv">24504</span>,<span class="dv">18190</span>,<span class="dv">9708</span>,<span class="dv">9590</span>,<span class="dv">10068</span>,<span class="dv">15552</span>,<span class="dv">34781</span>,<span class="dv">17205</span>,<span class="dv">12180</span>,<span class="dv">31054</span>,<span class="dv">19803</span>,<span class="dv">34321</span>,<span class="dv">28206</span>,<span class="dv">13392</span>,<span class="dv">25659</span>,<span class="dv">13679</span>,<span class="dv">10817</span>,<span class="dv">48137</span>,<span class="dv">16057</span>,<span class="dv">30680</span>,<span class="dv">28931</span>,<span class="dv">8746</span>,<span class="dv">51031</span>,<span class="dv">15530</span>,<span class="dv">21598</span>,<span class="dv">12816</span>,<span class="dv">39388</span>,<span class="dv">36873</span>,<span class="dv">10815</span>,<span class="dv">26335</span>,<span class="dv">8332</span>,<span class="dv">25860</span>,<span class="dv">12491</span>,<span class="dv">26264</span>,<span class="dv">17914</span>,<span class="dv">13240</span>,<span class="dv">51238</span>,<span class="dv">18080</span>,<span class="dv">28812</span>,<span class="dv">40576</span>,<span class="dv">33316</span>,<span class="dv">3978</span>,<span class="dv">32843</span>,<span class="dv">14942</span>,<span class="dv">33416</span>,<span class="dv">11274</span>,<span class="dv">14775</span>,<span class="dv">25466</span>,<span class="dv">15959</span>,<span class="dv">21031</span>,<span class="dv">12042</span>,<span class="dv">9518</span>,<span class="dv">38184</span>,<span class="dv">10007</span>,<span class="dv">8226</span>,<span class="dv">11975</span>,<span class="dv">29364</span>,<span class="dv">57382</span>,<span class="dv">11814</span>,<span class="dv">28760</span>,<span class="dv">19193</span>,<span class="dv">24117</span>,<span class="dv">35747</span>),</a>
<a class="sourceLine" id="cb200-7" title="7"><span class="dt">alkohol =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb200-8" title="8"><span class="dt">cannabis=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb200-9" title="9"><span class="dt">cigaretter =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb200-10" title="10"><span class="dt">mat =</span> <span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">8</span>))</a></code></pre></div>
<div id="en-binär-variabel" class="section level2">
<h2><span class="header-section-number">5.1</span> En binär variabel</h2>
<div id="kodning" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Kodning</h3>
<p>Oavsett om en binär variabel har kategorier som inte går att rangordna (till exempel variabeln <span class="math inline">\(kön\)</span> med kategorierna <span class="math inline">\(kvinna\)</span> och <span class="math inline">\(man\)</span>) eller har kategorier som går att rangordna (till exempel <span class="math inline">\(utbildning\)</span> med kategorierna <span class="math inline">\(låg\)</span> och <span class="math inline">\(hög\)</span>) beskrivs en binär variabel på samma sätt. Vi ska nu presentera visa hur man beskriver en binär variabel, utifrån de tidigare två nämnda alternativen.</p>
<p>Vi exemplifierar med att beskriva variabel som heter <span class="math inline">\(utbildning\)</span> som har två kategorier, <span class="math inline">\(låg\)</span> och <span class="math inline">\(hög\)</span> och som vi läser in nedan. Med funktionen <strong>str()</strong> identifieras att <span class="math inline">\(utbildning\)</span> är en variabel med datatypen <em>character</em>. Det är alltid viktigt att undersöka variablers datatyp, emellertid är detta ingen kod som sedan sparas i scriptet. Efter datatypen är undersökt kan denna rad med kod tas bort från scriptet. Funktionen <strong>str()</strong> är användbar för att undersöka alla typer av objekt i R, till exempel variabler, dataframes och objekt som innehåller sparade resultat.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="co"># Undersök hur R identifierar variabelns datatyp  </span></a>
<a class="sourceLine" id="cb201-2" title="2">  <span class="kw">str</span>(df<span class="op">$</span>utbildning)</a>
<a class="sourceLine" id="cb201-3" title="3"><span class="op">&gt;</span><span class="st">  </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">2</span> levels <span class="st">&quot;hög&quot;</span>,<span class="st">&quot;låg&quot;</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> ...</a></code></pre></div>
<p>Med <strong>Alternativ 1</strong> för hantering av kategorivariabler tilldelas de två kategorierna i den binära variabeln numeriska värden och variabeln analyseras sedan som en numerisk variabel. Det är vanligast att ge kategorierna värdena 0 och 1. En anledning är tolkningen blir i termer av andelar av den kategori som är kodad 1.</p>
<p>Exemplet nedan illustrerar hur man med det numeriska alternativet kan beskriva den ursprungliga variabeln <span class="math inline">\(utbildning\)</span> som har kategorierna <span class="math inline">\(low\)</span> och <span class="math inline">\(high\)</span>. Den uppenbara fördelen med att kodningen 0-1, jämfört med 1-2, är att 0-1 ger en bekväm tolkning eftersom medelvärdet då är proportionen.</p>
<p>Kommandot <strong>str()</strong> identifierar nu att både <em>utb_bin</em> och <em>utb_12</em> är av typen <em>numeric</em>.</p>
<p>Med <strong>mean()</strong> och <strong>summary()</strong> erhålls information som beskriver <em>utb_bin</em> och <em>utb_12</em>. Vi ser att 41% har hög utbildning, däremot framgår inte antalet som har låg respektive hög utbildning.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1"><span class="co"># Numerisk kodning: 0 = låg, 1 = hög</span></a>
<a class="sourceLine" id="cb202-2" title="2">  df<span class="op">$</span>utb_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb202-3" title="3">  df<span class="op">$</span>utb_bin[df<span class="op">$</span>utbildning <span class="op">==</span><span class="st"> &quot;hög&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb202-4" title="4">  df<span class="op">$</span>utb_bin[df<span class="op">$</span>utbildning <span class="op">==</span><span class="st"> &quot;låg&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb202-5" title="5">  <span class="kw">str</span>(df<span class="op">$</span>utb_bin)</a>
<a class="sourceLine" id="cb202-6" title="6"><span class="op">&gt;</span><span class="st">  </span>num [<span class="dv">1</span><span class="op">:</span><span class="dv">280</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> ...</a>
<a class="sourceLine" id="cb202-7" title="7">  phat &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>utb_bin)</a>
<a class="sourceLine" id="cb202-8" title="8">  phat</a>
<a class="sourceLine" id="cb202-9" title="9"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.4142857</span></a>
<a class="sourceLine" id="cb202-10" title="10">  <span class="kw">summary</span>(df<span class="op">$</span>utb_bin)</a>
<a class="sourceLine" id="cb202-11" title="11"><span class="op">&gt;</span><span class="st">    </span>Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </a>
<a class="sourceLine" id="cb202-12" title="12"><span class="op">&gt;</span><span class="st">  </span><span class="fl">0.0000</span>  <span class="fl">0.0000</span>  <span class="fl">0.0000</span>  <span class="fl">0.4143</span>  <span class="fl">1.0000</span>  <span class="fl">1.0000</span></a>
<a class="sourceLine" id="cb202-13" title="13"></a>
<a class="sourceLine" id="cb202-14" title="14"><span class="co"># Numerisk kodning: 1 = låg, 2 = hög</span></a>
<a class="sourceLine" id="cb202-15" title="15">  df<span class="op">$</span>utb_<span class="dv">12</span> &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb202-16" title="16">  df<span class="op">$</span>utb_<span class="dv">12</span> [df<span class="op">$</span>utbildning <span class="op">==</span><span class="st"> &quot;hög&quot;</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb202-17" title="17">  df<span class="op">$</span>utb_<span class="dv">12</span> [df<span class="op">$</span>utbildning <span class="op">==</span><span class="st"> &quot;låg&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb202-18" title="18">  <span class="kw">summary</span>(df<span class="op">$</span>utb_<span class="dv">12</span> )</a>
<a class="sourceLine" id="cb202-19" title="19"><span class="op">&gt;</span><span class="st">    </span>Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </a>
<a class="sourceLine" id="cb202-20" title="20"><span class="op">&gt;</span><span class="st">   </span><span class="fl">1.000</span>   <span class="fl">1.000</span>   <span class="fl">1.000</span>   <span class="fl">1.414</span>   <span class="fl">2.000</span>   <span class="fl">2.000</span></a></code></pre></div>
<p>Med <strong>Alternativ 2</strong> används funktionen <strong>factor()</strong> för skapa en faktorvariabel <strong>utb_cat</strong></p>
<p>Kommandot <strong>str()</strong> identifierar nu att <strong>utb_cat</strong> har två nivåer med kategorinamnen<br />
<em>“låg”</em> and <em>“hög”</em>. R tilldelar automatiskt kategorierna <em>nivåer</em>, där “high” är level 1 och “low” är level 2. Observera att nivåer används för att bestämma en rangordning och kan inte användas i aritmetiska beräkningar. Även om valet av nominal- eller ordinalskala i teorin saknar betydelse för en binär variabel är det viktigt att veta ordningen på nivåerna om man hanterar variabeln som en faktor.Det finns nämligen analyser i R där ordningen spelar roll. Nivåerna bestäms utifrån den ordning kategorierna dyker upp i variabeln <em>såvida inte en numerisk variabel görs om till en faktor</em>.</p>
<p>Faktorvariabeln kan beskrivas med <strong>summary()</strong> som redovisar antalet inom respektive utbildningskategori. Däremot kan vi inte använda <strong>mean()</strong> och därmed inte fram andelen med denna funktion.</p>
<p>Det går att i funktionen <strong>factor()</strong> använda argumentet <strong>levels</strong> för att manuellt ange nivåerna. Dessutom kan det i detta exempel uppfattas som förvirrande för användaren att <em>hög</em> har tilldelats nivå 1 medan <em>låg</em> är nivå 2. Av dessa skäl ändras därför ordningen med hjälp av argumentet <em>levels</em>.</p>
<p>Vid arbete med faktorer används ofta en funktion (ej att förväxla med <em>argumententet</em> <strong>levels()</strong> för att ändra kategorinamn.I exemplet nedan används denna funktion för att ändra kategorinamn på <span class="math inline">\(utb_cat\)</span>. Koden för att ändra namn är inte uppenbar för nybörjaren och det är enklast om du kopierar koden nedan och ändrar den efter dina behov.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="co"># Skapa en faktorvariabel  </span></a>
<a class="sourceLine" id="cb203-2" title="2">  df<span class="op">$</span>utb_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>utbildning)</a>
<a class="sourceLine" id="cb203-3" title="3">  <span class="kw">str</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb203-4" title="4"><span class="op">&gt;</span><span class="st">  </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">2</span> levels <span class="st">&quot;hög&quot;</span>,<span class="st">&quot;låg&quot;</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> ...</a>
<a class="sourceLine" id="cb203-5" title="5">  <span class="kw">mean</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb203-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Warning <span class="cf">in</span> <span class="kw">mean.default</span>(df<span class="op">$</span>utb_cat)<span class="op">:</span><span class="st"> </span>argument is not numeric or logical<span class="op">:</span></a>
<a class="sourceLine" id="cb203-7" title="7"><span class="er">&gt;</span><span class="st"> </span>returning <span class="ot">NA</span></a>
<a class="sourceLine" id="cb203-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="ot">NA</span></a>
<a class="sourceLine" id="cb203-9" title="9">  <span class="kw">summary</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb203-10" title="10"><span class="op">&gt;</span><span class="st"> </span>hög låg </a>
<a class="sourceLine" id="cb203-11" title="11"><span class="op">&gt;</span><span class="st"> </span><span class="dv">116</span> <span class="dv">164</span></a>
<a class="sourceLine" id="cb203-12" title="12"><span class="co"># Test att utföra en räkneoperation på en faktorvariabel</span></a>
<a class="sourceLine" id="cb203-13" title="13">  <span class="kw">mean</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb203-14" title="14"><span class="op">&gt;</span><span class="st"> </span>Warning <span class="cf">in</span> <span class="kw">mean.default</span>(df<span class="op">$</span>utb_cat)<span class="op">:</span><span class="st"> </span>argument is not numeric or logical<span class="op">:</span></a>
<a class="sourceLine" id="cb203-15" title="15"><span class="er">&gt;</span><span class="st"> </span>returning <span class="ot">NA</span></a>
<a class="sourceLine" id="cb203-16" title="16"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="ot">NA</span></a>
<a class="sourceLine" id="cb203-17" title="17"><span class="co"># Ändra ordningen på nivåerna </span></a>
<a class="sourceLine" id="cb203-18" title="18">  df<span class="op">$</span>utb_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>utb_cat, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>))</a>
<a class="sourceLine" id="cb203-19" title="19">  <span class="kw">str</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb203-20" title="20"><span class="op">&gt;</span><span class="st">  </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">2</span> levels <span class="st">&quot;låg&quot;</span>,<span class="st">&quot;hög&quot;</span><span class="op">:</span><span class="st"> </span><span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> ...</a>
<a class="sourceLine" id="cb203-21" title="21">  <span class="kw">summary</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb203-22" title="22"><span class="op">&gt;</span><span class="st"> </span>låg hög </a>
<a class="sourceLine" id="cb203-23" title="23"><span class="op">&gt;</span><span class="st"> </span><span class="dv">164</span> <span class="dv">116</span></a>
<a class="sourceLine" id="cb203-24" title="24"><span class="co"># Ändra för valt element namn i vektor levels(utbildning_cat)  </span></a>
<a class="sourceLine" id="cb203-25" title="25">  <span class="kw">levels</span>(df<span class="op">$</span>utb_cat)[<span class="kw">levels</span>(df<span class="op">$</span>utb_cat) <span class="op">==</span><span class="st"> &quot;låg&quot;</span>] &lt;-<span class="st"> &quot;Låg utbildning&quot;</span></a>
<a class="sourceLine" id="cb203-26" title="26">  <span class="kw">levels</span>(df<span class="op">$</span>utb_cat)[<span class="kw">levels</span>(df<span class="op">$</span>utb_cat) <span class="op">==</span><span class="st"> &quot;hög&quot;</span>] &lt;-<span class="st"> &quot;Hög utbildning&quot;</span></a>
<a class="sourceLine" id="cb203-27" title="27">  df<span class="op">$</span>utb_cat</a>
<a class="sourceLine" id="cb203-28" title="28"><span class="op">&gt;</span><span class="st">   </span>[<span class="dv">1</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-29" title="29"><span class="op">&gt;</span><span class="st">   </span>[<span class="dv">6</span>] Låg utbildning Hög utbildning Låg utbildning Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-30" title="30"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">11</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-31" title="31"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">16</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-32" title="32"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">21</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-33" title="33"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">26</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-34" title="34"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">31</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-35" title="35"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">36</span>] Hög utbildning Låg utbildning Låg utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-36" title="36"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">41</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-37" title="37"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">46</span>] Låg utbildning Hög utbildning Låg utbildning Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-38" title="38"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">51</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-39" title="39"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">56</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-40" title="40"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">61</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-41" title="41"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">66</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-42" title="42"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">71</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-43" title="43"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">76</span>] Hög utbildning Låg utbildning Låg utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-44" title="44"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">81</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-45" title="45"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">86</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-46" title="46"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">91</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-47" title="47"><span class="op">&gt;</span><span class="st">  </span>[<span class="dv">96</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-48" title="48"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">101</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-49" title="49"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">106</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-50" title="50"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">111</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-51" title="51"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">116</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-52" title="52"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">121</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-53" title="53"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">126</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-54" title="54"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">131</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-55" title="55"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">136</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-56" title="56"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">141</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-57" title="57"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">146</span>] Låg utbildning Hög utbildning Låg utbildning Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-58" title="58"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">151</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-59" title="59"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">156</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-60" title="60"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">161</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-61" title="61"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">166</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-62" title="62"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">171</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-63" title="63"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">176</span>] Hög utbildning Låg utbildning Låg utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-64" title="64"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">181</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-65" title="65"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">186</span>] Låg utbildning Hög utbildning Låg utbildning Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-66" title="66"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">191</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-67" title="67"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">196</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-68" title="68"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">201</span>] Hög utbildning Hög utbildning Hög utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-69" title="69"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">206</span>] Låg utbildning Hög utbildning Hög utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-70" title="70"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">211</span>] Hög utbildning Hög utbildning Låg utbildning Hög utbildning Hög utbildning</a>
<a class="sourceLine" id="cb203-71" title="71"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">216</span>] Hög utbildning Låg utbildning Låg utbildning Hög utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-72" title="72"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">221</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-73" title="73"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">226</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-74" title="74"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">231</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-75" title="75"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">236</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-76" title="76"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">241</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-77" title="77"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">246</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-78" title="78"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">251</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-79" title="79"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">256</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-80" title="80"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">261</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-81" title="81"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">266</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-82" title="82"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">271</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-83" title="83"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">276</span>] Låg utbildning Låg utbildning Låg utbildning Låg utbildning Låg utbildning</a>
<a class="sourceLine" id="cb203-84" title="84"><span class="op">&gt;</span><span class="st"> </span>Levels<span class="op">:</span><span class="st"> </span>Låg utbildning Hög utbildning</a></code></pre></div>
<p>Avslutningsvis är det viktigt att studera den betydelse <strong>bortfall</strong> har för analyserna. I exemplet nedan skapas bortfall genom att lägga bortfall kodat <em>NA</em> för observation 3 och 10. Vi ser att med <strong>summary()</strong> hanteras bortfallet i bägge fallen. Används däremot <strong>mean()</strong> måste argumentet <strong>na.rm</strong> användas.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1"><span class="co"># Skapa en variabel med missing data (NA) i element 3, 10 i den numeriska</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="co"># variabeln df$utb_bin och genomför samma analys som förut</span></a>
<a class="sourceLine" id="cb204-3" title="3"> df<span class="op">$</span>utb_bin_mis &lt;-<span class="st"> </span>df<span class="op">$</span>utb_bin</a>
<a class="sourceLine" id="cb204-4" title="4"> df<span class="op">$</span>utb_bin_mis[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb204-5" title="5"> df<span class="op">$</span>utb_bin_mis[<span class="dv">10</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb204-6" title="6"> <span class="kw">mean</span>(df<span class="op">$</span>utb_bin_mis)</a>
<a class="sourceLine" id="cb204-7" title="7"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="ot">NA</span></a>
<a class="sourceLine" id="cb204-8" title="8"><span class="co"># Medelvärde baserat på 278 observationer</span></a>
<a class="sourceLine" id="cb204-9" title="9"> <span class="kw">mean</span>(df<span class="op">$</span>utb_bin_mis, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb204-10" title="10"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.4136691</span></a>
<a class="sourceLine" id="cb204-11" title="11"> <span class="kw">summary</span>(df<span class="op">$</span>utb_bin_mis)</a>
<a class="sourceLine" id="cb204-12" title="12"><span class="op">&gt;</span><span class="st">    </span>Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA<span class="st">&#39;s </span></a>
<a class="sourceLine" id="cb204-13" title="13"><span class="st">&gt;  0.0000  0.0000  0.0000  0.4137  1.0000  1.0000       2</span></a>
<a class="sourceLine" id="cb204-14" title="14"></a>
<a class="sourceLine" id="cb204-15" title="15"><span class="st"># Skapa en variabel med missing data (NA) i element 3, 10 i faktor-variabeln</span></a>
<a class="sourceLine" id="cb204-16" title="16"><span class="st"># utb_cat och genomför samma analys som förut </span></a>
<a class="sourceLine" id="cb204-17" title="17"><span class="st"> df$utb_cat_mis &lt;- df$utb_cat</span></a>
<a class="sourceLine" id="cb204-18" title="18"><span class="st"> df$utb_cat_mis[3] &lt;- NA</span></a>
<a class="sourceLine" id="cb204-19" title="19"><span class="st"> df$utb_cat_mis[10] &lt;- NA</span></a>
<a class="sourceLine" id="cb204-20" title="20"><span class="st"> summary(df$utb_cat_mis)</span></a>
<a class="sourceLine" id="cb204-21" title="21"><span class="st">&gt; Låg utbildning Hög utbildning           NA&#39;</span>s </a>
<a class="sourceLine" id="cb204-22" title="22"><span class="op">&gt;</span><span class="st">            </span><span class="dv">163</span>            <span class="dv">115</span>              <span class="dv">2</span></a></code></pre></div>
</div>
<div id="tabeller-och-figurer" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Tabeller och figurer</h3>
<p>Tabeller och kategorivariabler är direkt relaterade och det går att redovisa en binär variabel med hjälp av tabell-funktionen <strong>table()</strong>. Denna funktion hanterar både en och flera variabler med olika antal kategorier. Eftersom <strong>table()</strong> kan vara något svår för nybörjaren är det lämpligt att introducera denna funktion på det enklaste fallet, nämligen tidigare skapade binära variablerna.</p>
<p>Vi ser att <strong>table()</strong> ger frekvenser oavsett om variabeln är numerisk eller en faktor. Det gäller dock att vara uppmärksam på bortfall eftersom <strong>table()</strong> ignorerar detta om vi inte anger något annat. För att presentera frekvenser även för bortfall används måste argumentet <strong>useNA</strong> användas. Tabellerna nedan illustrerar detta.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="co"># Tabell baserad på variabel utan bortfall</span></a>
<a class="sourceLine" id="cb205-2" title="2"> <span class="kw">table</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb205-3" title="3"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-4" title="4"><span class="er">&gt;</span><span class="st"> </span>Låg utbildning Hög utbildning </a>
<a class="sourceLine" id="cb205-5" title="5"><span class="op">&gt;</span><span class="st">            </span><span class="dv">164</span>            <span class="dv">116</span></a>
<a class="sourceLine" id="cb205-6" title="6"><span class="co"># Tabell baserad på variabel med bortfall</span></a>
<a class="sourceLine" id="cb205-7" title="7"> <span class="kw">table</span>(df<span class="op">$</span>utb_cat_mis)</a>
<a class="sourceLine" id="cb205-8" title="8"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-9" title="9"><span class="er">&gt;</span><span class="st"> </span>Låg utbildning Hög utbildning </a>
<a class="sourceLine" id="cb205-10" title="10"><span class="op">&gt;</span><span class="st">            </span><span class="dv">163</span>            <span class="dv">115</span></a>
<a class="sourceLine" id="cb205-11" title="11"><span class="co"># Tabell baserad på variabel med bortfall där vi tar hänsyn till detta i tabellen</span></a>
<a class="sourceLine" id="cb205-12" title="12"> <span class="kw">table</span>(df<span class="op">$</span>utb_cat_mis, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb205-13" title="13"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-14" title="14"><span class="er">&gt;</span><span class="st"> </span>Låg utbildning Hög utbildning           <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-15" title="15"><span class="er">&gt;</span><span class="st">            </span><span class="dv">163</span>            <span class="dv">115</span>              <span class="dv">2</span></a></code></pre></div>
<p>Varför använda <strong>table()</strong>? Genom att skapa ett tabell-objekt erhålls en flexibilitet genom att funktioner anpassade för tabeller kan användas. Den vanligaste funktionen är <strong>prop.table()</strong> som beräknar andelar (relativa frekvenser, proportioner) baserat på tabellobjektets frekvenser. Att enbart redovisa frekvenser är nämligen ofta inte tillräckligt om data ska analyseras.</p>
<p>Vi skapar nedan ett tabell-objekt med frekvenser, sedan appliceras <strong>prop.table()</strong> för att erhålla andelarna (0.414 och 0.586) för respektive utbildningsnivå.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Skapa tabell-objekt med frekvenser från tabell-objektetet</span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="er">&gt;</span><span class="st">  </span>freq_table_utb_cat &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb206-3" title="3"><span class="op">&gt;</span><span class="st">  </span>freq_table_utb_cat</a>
<a class="sourceLine" id="cb206-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-5" title="5"><span class="er">&gt;</span><span class="st"> </span>Låg utbildning Hög utbildning </a>
<a class="sourceLine" id="cb206-6" title="6"><span class="op">&gt;</span><span class="st">            </span><span class="dv">164</span>            <span class="dv">116</span></a>
<a class="sourceLine" id="cb206-7" title="7"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-8" title="8"><span class="er">&gt;</span><span class="st"> </span><span class="co"># Skapa tabell med andelar från tabell-objektetet</span></a>
<a class="sourceLine" id="cb206-9" title="9"><span class="er">&gt;</span><span class="st">  </span>prop_table_utb_cat &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_utb_cat)</a>
<a class="sourceLine" id="cb206-10" title="10"><span class="op">&gt;</span><span class="st">  </span>prop_table_utb_cat</a>
<a class="sourceLine" id="cb206-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-12" title="12"><span class="er">&gt;</span><span class="st"> </span>Låg utbildning Hög utbildning </a>
<a class="sourceLine" id="cb206-13" title="13"><span class="op">&gt;</span><span class="st">      </span><span class="fl">0.5857143</span>      <span class="fl">0.4142857</span></a></code></pre></div>
<p>Som nämnt är det i regel viktigt att beskriva <em>både frekvenser och andelar</em>.</p>
<p>Nedan görs detta genom använda <strong>cbind()</strong> och kombinera tabell-objektet med frekvenser och objektet med andelar med andelar. Sedan namnges kolumnerna <strong>colnames()</strong>. Eftersom <strong>utb_cat</strong>, då det är en faktorvariabel redan har kategorierna namngivna behöver raderna inte namnges. Om så inte vore fallet kunde vi använt <strong>rownames()</strong> för att namnge rader.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="op">&gt;</span><span class="st">  </span><span class="co"># Kombinera frekvenser och andelar. Passa samtidigt på att avrunda till en decimal och göra om variabeln till procent. </span></a>
<a class="sourceLine" id="cb207-2" title="2"><span class="er">&gt;</span><span class="st">  </span>table_utb &lt;-<span class="st"> </span><span class="kw">cbind</span>(freq_table_utb_cat, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table_utb_cat, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb207-3" title="3"><span class="op">&gt;</span><span class="st">  </span>table_utb</a>
<a class="sourceLine" id="cb207-4" title="4"><span class="op">&gt;</span><span class="st">                </span>freq_table_utb_cat     </a>
<a class="sourceLine" id="cb207-5" title="5"><span class="op">&gt;</span><span class="st"> </span>Låg utbildning                <span class="dv">164</span> <span class="fl">58.6</span></a>
<a class="sourceLine" id="cb207-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Hög utbildning                <span class="dv">116</span> <span class="fl">41.4</span></a>
<a class="sourceLine" id="cb207-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="co"># Ge tabellens kolumner namn </span></a>
<a class="sourceLine" id="cb207-8" title="8"><span class="er">&gt;</span><span class="st">  </span><span class="kw">colnames</span>(table_utb) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Frekvens&quot;</span>, <span class="st">&quot;Procent (%)&quot;</span>)</a>
<a class="sourceLine" id="cb207-9" title="9"><span class="op">&gt;</span><span class="st">  </span>table_utb</a>
<a class="sourceLine" id="cb207-10" title="10"><span class="op">&gt;</span><span class="st">                </span>Frekvens <span class="kw">Procent</span> (%)</a>
<a class="sourceLine" id="cb207-11" title="11"><span class="op">&gt;</span><span class="st"> </span>Låg utbildning      <span class="dv">164</span>        <span class="fl">58.6</span></a>
<a class="sourceLine" id="cb207-12" title="12"><span class="op">&gt;</span><span class="st"> </span>Hög utbildning      <span class="dv">116</span>        <span class="fl">41.4</span></a></code></pre></div>
<p>Ett alternativ till tabeller är figurer. För att illustrera kategorivariabler används ofta <strong>stapeldiagram</strong> och i R konstrueras sådana med funktionen <strong>barplot()</strong>. Det går att betrakta stapeldiagram som en grafisk representation av en tabell och vid användning av <strong>barplot()</strong> är därför utgångspunkten ofta (men inte alltid) ett tabell-objekt.</p>
<p>Nedan konstrueras två figurer, en baserad på tabell-objektet med frekvenser och en baserad på objektet med andelar. Observera att nedanstående är avsett att illustrera stapeldiagram och ett <strong>stapeldiagram tillför i fallet med en enda binär variabel ingen information.</strong> Det räcker nästan alltid med att istället bara ange numeriska värden.</p>
<p>Du bör uppmärksamma att i exemplet är axlarna namngivna på ett tydligt sätt! Vi kommer efterhand att introducera de möjligheter som finns att anpassa figurer till exakt hur man vill ha dem.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"><span class="co"># Stapeldiagram baserat på tabellen med frekvenser</span></a>
<a class="sourceLine" id="cb208-2" title="2"><span class="kw">barplot</span>(freq_table_utb_cat,     <span class="co"># Ange tabellen som ska beskrivas</span></a>
<a class="sourceLine" id="cb208-3" title="3">        <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>)         <span class="co"># Ange namn för y-axeln</span></a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-177-1.png" width="384" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="co"># Stapeldiagram baserat på tabellen med andelar</span></a>
<a class="sourceLine" id="cb209-2" title="2"><span class="kw">barplot</span>(prop_table_utb_cat, </a>
<a class="sourceLine" id="cb209-3" title="3">        <span class="dt">ylab =</span> <span class="st">&quot;Procent (%)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-177-2.png" width="384" /></p>
</div>
<div id="inferens" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Inferens</h3>
<p>Hittills har vi ägnat oss åt att beskriva en binär variabel i stickprovet, men ofta är målet att uttala oss om egenskaper i en population, så kallad inferens. Vi kommer i detta avsnitt att utgå från en <em>beskrivande frågeställning</em> och följande två sätt att göra inferens är då vanliga.</p>
<ul>
<li>Det <strong>första</strong> sättet är att beräkna <strong>konfidensintervall</strong> för med viss säkerhet få en uppfattning om andelen i populationen, <span class="math inline">\(p\)</span>.</li>
<li>Det <strong>andra</strong> är att med <strong>hypotesprövning</strong> undersöka i vilken utsträckning vårt data stämmer överens med en hypotes om populationen, <span class="math inline">\(H_0: p =p_0\)</span>.</li>
</ul>
<p>Utgångspunkten är ett slumpmässigt urval från en <strong>stor population</strong> och vi börjar med att se hur ett <strong>konfidensintervall</strong> kan konstrueras för andelen <span class="math inline">\(p\)</span> i populationen. Stickprovsandelen är <span class="math inline">\(\hat{p}\)</span> kan definieras som <span class="math inline">\(\hat{p}=\dfrac{k}{n}\)</span> där <span class="math inline">\(n\)</span> är antal försök (antal 0or och 1or) och <span class="math inline">\(k\)</span> är antalet lyckade försök (antal 1or). Givet OSU och <span class="math inline">\(np(1-p)&gt;5\)</span> är andelsestimatorn approximativt normalfördelad och ett konfidensintervall ges av
<span class="math display">\[
\hat{p}\pm z_{\alpha/2}\sqrt{\hat{V}(\hat{p})},
\]</span>
där <span class="math inline">\(\hat{V}(\hat{p}) = \dfrac{\hat{p}(1-\hat{p})}{n}\)</span> är skattningen av stickprovsandelens varians och <span class="math inline">\(z_{\alpha/2}\)</span> är ett värde från den standardnormalfördelningen baserat på konfidensgraden <span class="math inline">\(100(1-\alpha)\%\)</span>. Notera att felmarginalen är <span class="math inline">\(z_{\alpha/2}\sqrt{\hat{V}(\hat{p})}\)</span>.</p>
<p>Anta variabeln <strong>utbldning</strong> består av mätningar på individer dragna med OSU från en stor population. Målet är att beräkna ett 95% konfidensintervall för andelen med högutbildning i populationen, <span class="math inline">\(p\)</span>. Genom att implementera ovanstående formler kan detta enkelt beräknas i R.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1"><span class="co"># Beräkna antalet lyckade försök k (antal 1or)</span></a>
<a class="sourceLine" id="cb210-2" title="2">  k &lt;-<span class="st"> </span>freq_table_utb_cat[<span class="dv">2</span>]  </a>
<a class="sourceLine" id="cb210-3" title="3"><span class="co"># Beräkna antal försök (1or or 0r). Denna kodning gör att eventuella NA inte tas med i beräkningen av n</span></a>
<a class="sourceLine" id="cb210-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_utb_cat)</a>
<a class="sourceLine" id="cb210-5" title="5">  <span class="co"># Skattning av andelen med hög utbildning. Det går även att använda mean(df$utb_bin)</span></a>
<a class="sourceLine" id="cb210-6" title="6">  phat &lt;-<span class="st"> </span>k<span class="op">/</span>n   </a>
<a class="sourceLine" id="cb210-7" title="7"><span class="co"># Skatta variansen</span></a>
<a class="sourceLine" id="cb210-8" title="8">  vphat &lt;-<span class="st"> </span>phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb210-9" title="9"><span class="co"># Välja konfidensgrad 100*(1-alpha)%</span></a>
<a class="sourceLine" id="cb210-10" title="10">  alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb210-11" title="11"><span class="co"># Detta ger värdet för från z-fördelningen med 2.5% i högre svansen  </span></a>
<a class="sourceLine" id="cb210-12" title="12">  z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))  </a>
<a class="sourceLine" id="cb210-13" title="13"><span class="co"># Konfidensintervallets nedre gräns (lower limit) </span></a>
<a class="sourceLine" id="cb210-14" title="14">  ll &lt;-<span class="st"> </span>phat <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vphat)</a>
<a class="sourceLine" id="cb210-15" title="15"><span class="co"># Konfidensintervallets övre gräns (upper limit) </span></a>
<a class="sourceLine" id="cb210-16" title="16">  ul &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vphat)</a>
<a class="sourceLine" id="cb210-17" title="17">  p_KI &lt;-<span class="st"> </span><span class="kw">c</span>(ll, ul)</a>
<a class="sourceLine" id="cb210-18" title="18">  p_KI</a>
<a class="sourceLine" id="cb210-19" title="19">Hög utbildning Hög utbildning </a>
<a class="sourceLine" id="cb210-20" title="20">     <span class="fl">0.3565876</span>      <span class="fl">0.4719839</span> </a>
<a class="sourceLine" id="cb210-21" title="21"><span class="co"># Undersöker förutsättningen np(1-p) &gt;5. Vi använder phat istället för p eftersom det är det enda vi # har. Man måste alltid undersöka om resultaten går att lita på!</span></a>
<a class="sourceLine" id="cb210-22" title="22">  n<span class="op">*</span>phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)</a>
<a class="sourceLine" id="cb210-23" title="23">Hög utbildning </a>
<a class="sourceLine" id="cb210-24" title="24">      <span class="fl">67.94286</span> </a></code></pre></div>
<p>Vi skattar att 41.4% är högutbildade i populationen. Med 95% säkerhet är andelen högutbildade i populationen mellan 35.7% och 47.2%</p>
<p>Vi ska nu se på hur inferens kan göras i form av <strong>hypotesprövning</strong>. Givet OSU och samma förutsättningar som för skapandet av konfidensintervall gäller vid hypotesprövning av <span class="math inline">\(H_0: p = p_{H_0}\)</span> test-statistikan<br />
<span class="math display">\[z = \dfrac{\hat{p} - p_{H_0}}{\sqrt{\dfrac{p_{H_0}(1-p_{H_0})}{n}}}\]</span>
är approximativt <span class="math inline">\(N(0,1)\)</span> om <span class="math inline">\(H_0\)</span> är sann.</p>
<p>För att exemplifiera, anta att vi vill undersöka om 40% i populationen har hög utbildning. Vi sätter upp hypoteserna <span class="math inline">\(H_0: p = 0.4\)</span> vs <span class="math inline">\(H_1: p \neq 0.4\)</span>. Utifrån från formeln ovan beräknas det observerat <span class="math inline">\(z\)</span>-värde. Vi ser sedan se hur extremt det är i en standardnormalfördelning för att få fram <span class="math inline">\(p\)</span>-värdet. Vad som avses med extremt beror på formulering av mothypotesen, dvs om den är ensidig eller tvåsidig. Om vi önskar fatta ett beslut jämförs <span class="math inline">\(p\)</span>-värdet mot en förvald signifikansnivå.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1"><span class="co"># p givet nollhypotesen</span></a>
<a class="sourceLine" id="cb211-2" title="2">  pH0 &lt;-<span class="st"> </span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb211-3" title="3"><span class="co"># Teststatistika</span></a>
<a class="sourceLine" id="cb211-4" title="4">  zobs &lt;-<span class="st"> </span>(phat <span class="op">-</span><span class="st"> </span>pH0)<span class="op">/</span><span class="kw">sqrt</span>(pH0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pH0)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb211-5" title="5">  zobs</a>
<a class="sourceLine" id="cb211-6" title="6">Hög utbildning </a>
<a class="sourceLine" id="cb211-7" title="7">       <span class="fl">0.48795</span> </a>
<a class="sourceLine" id="cb211-8" title="8"><span class="co"># Vi erhåller ett observerat z-värde. p-värdet är anger hur extremt detta z-värde. </span></a>
<a class="sourceLine" id="cb211-9" title="9"><span class="co"># pnorm() för sannolikheten VÄNSTER om z-värdet. Se Tabell 6.2.A i Formelsamling. För att beräkna # # p-värdet vid två sidig mothypotes används absolutbesloppet (abs()) och vi tar 1 minus och multiplicerar med 2. </span></a>
<a class="sourceLine" id="cb211-10" title="10">  p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zobs)) )</a>
<a class="sourceLine" id="cb211-11" title="11">  p_value</a>
<a class="sourceLine" id="cb211-12" title="12">Hög utbildning </a>
<a class="sourceLine" id="cb211-13" title="13">     <span class="fl">0.6255852</span> </a></code></pre></div>
<p>Vi erhåller att <span class="math inline">\(p=\)</span> 0.626. Tolkningen är att <em>givet att andelen högutbildade i populationen skulle vara 40% är sannolikheten 0.63 att observera andelen som observeras eller mer extrem.</em> Data stämmer alltså ganska väl överens med nollhypotesen! Ett beslut på 5% signifikansnivå skulle innebär att vi inte kan förkasta nollhypotesen. Huruvida vi vill fatta ett beslut eller inte beror på målet för analysen.</p>
<p>Det finns dock en inbyggd funktion i R för att göra ovanstående analyser, nämligen <strong>prop.test()</strong>.
I funktionen <strong>prop.test()</strong> anges först antalet lyckade försök (1or) samt det totala antalet försök (1or och 0r). Med argumentet <strong>p</strong> anges nollhypotesen och med argumentet <strong>alternative</strong> specificeras mothypotesen. Argumentet <strong>conf.level</strong> anger konfidensgrad för konfidensintervallet. Slutligen bestämmer argumentet <strong>correct</strong> om kontinuitetsskorrektion ska användas. Vi använder inte kontinuitetskorrektion på denna kurs och sätter denna till <em>FALSE</em>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1"><span class="co"># Använd funktionen prop.test() för att skapa konfidensintervall utan korrigering</span></a>
<a class="sourceLine" id="cb212-2" title="2">  utb_analysis &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="dt">x =</span> k,        <span class="co"># Antal lyckade försök (1or)</span></a>
<a class="sourceLine" id="cb212-3" title="3">                            <span class="dt">n =</span> n,        <span class="co"># Antal försök (1or och 0or)</span></a>
<a class="sourceLine" id="cb212-4" title="4">                            <span class="dt">p =</span> <span class="fl">0.4</span>,      <span class="co"># H0</span></a>
<a class="sourceLine" id="cb212-5" title="5">                            <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,  <span class="co"># Mothypotes</span></a>
<a class="sourceLine" id="cb212-6" title="6">                            <span class="dt">conf.level =</span> <span class="fl">0.95</span>,          <span class="co"># Signifikansnivå 1-conflevel</span></a>
<a class="sourceLine" id="cb212-7" title="7">                            <span class="dt">correct =</span> <span class="ot">FALSE</span>)            <span class="co"># Ej kontnuitetskorrektion</span></a>
<a class="sourceLine" id="cb212-8" title="8">  utb_analysis</a>
<a class="sourceLine" id="cb212-9" title="9"></a>
<a class="sourceLine" id="cb212-10" title="10">    <span class="dv">1</span><span class="op">-</span>sample proportions test without continuity correction</a>
<a class="sourceLine" id="cb212-11" title="11"></a>
<a class="sourceLine" id="cb212-12" title="12">data<span class="op">:</span><span class="st">  </span>k out of n, null probability <span class="fl">0.4</span></a>
<a class="sourceLine" id="cb212-13" title="13">X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">0.2381</span>, df =<span class="st"> </span><span class="dv">1</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.6256</span></a>
<a class="sourceLine" id="cb212-14" title="14">alternative hypothesis<span class="op">:</span><span class="st"> </span>true p is not equal to <span class="fl">0.4</span></a>
<a class="sourceLine" id="cb212-15" title="15"><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb212-16" title="16"><span class="st"> </span><span class="fl">0.3581276</span> <span class="fl">0.4727639</span></a>
<a class="sourceLine" id="cb212-17" title="17">sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb212-18" title="18"><span class="st">        </span>p </a>
<a class="sourceLine" id="cb212-19" title="19"><span class="fl">0.4142857</span> </a></code></pre></div>
<p>Vi börjar med att se på resultatet från hypotesprövningen och upptäcker exakt samma <span class="math inline">\(p\)</span>-värde som förut! Vårt tidigare observerade <span class="math inline">\(z\)</span>-värde, 0.488 erhålls genom att ta roten ur 0.2380952.</p>
<p>Vidare är konfidensintervallet mycket likt det tidigare framräknade intervallet. De överensstämmer dock inte exakt, vilket beror på att R använder något en annan formel för konfidensintervallet som har något bättre egenskaper om andelen är nära 0 eller 1 och stickprovet är litet.</p>
<p>Anta att vi vill hämta värden från analysen som finns i det sparade objektet <strong>utb_analysis</strong>. Genom att använda <strong>str()</strong> redovisas vad som finns sparat i objektet. Koden nedan illustrerar hur <span class="math inline">\(p\)</span>-värdet kan hämtas om vi enbart är intresserad av just detta.</p>
<hr />
<p><img src="docs/images/warning.png" width="5%" /></p>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> Risk med inferens när <span class="math inline">\(p\)</span> är nära 0 eller 1 </font></p>
<ul>
<li>Om andelen i populationen är nära 0 eller 1 krävs stort stickprov för att inferensen ska bli korrekt! Tumregeln <span class="math inline">\(np(1-p)&gt;5\)</span> fungerar dåligt om andelen i populationen är mycket nära 0 eller 1. Konsekvensen blir för lägre konfidensgrad och ett högre Typ-I fel än i förväg angivet. Vi gör fel oftare!</li>
</ul>
<p>Beträffande konfidensintervall är Wilson score interval, som är det konfidensintervall R använder i <strong>prop.test</strong>, ett något bättre alternativ än den formeln som vi använder. I de absolut flesta fall har det inget betydelse om vi väljer <strong>prop.test()</strong> eller intervallet som baseras på normalapproximation.</p>
<p>För hypotesprövning finns alternativet att använda ett så kallat exakt binomial-test. Detta test introduceras emellertid inte här utan vi hänvisar till funktionen <strong>binom.test()</strong> och tillhörande dokumentation.</p>
<p>Var som sagt uppmärksam om andelen är nära 0 eller nära 1!</p>
<p><strong>Undersök på egen hand med följande app!</strong></p>
<p><a href="https://jetty.im.uu.se/shiny/ConfidenceIntervals_prop/" class="uri">https://jetty.im.uu.se/shiny/ConfidenceIntervals_prop/</a></p>
</div>
<hr />
<p><img src="docs/images/note.png" width="5%" /></p>
<style>
div.yellow{ background-color:#FFFA94; border-radius: 5px; padding: 20px;}
</style>
<div class="yellow">
<p><font size="5"> Test av andelar eller <span class="math inline">\(\chi^2\)</span>-test? </font></p>
<ul>
<li><p>Ett <strong>prop.test()</strong> med två-sidig mothypotes är likvärdigt med <span class="math inline">\(\chi^2\)</span>-test. <span class="math inline">\(\chi^2\)</span>-statistikan är samma som <span class="math inline">\(z\)</span>-statistikan i kvadrat! Problemet med test av <span class="math inline">\(p\)</span> kan nämligen formuleras som ett goodness-of-fit test med observerade frekvenser (<span class="math inline">\(116\)</span> 1or och <span class="math inline">\(164\)</span> 0or) och under nollhypotesen förväntade frekvenser (<span class="math inline">\(np_{H_0}=112\)</span> 1or och <span class="math inline">\(n(1-p_{H_0})=168\)</span> 0r). Vi illusterar i en tabell:</p>
<table>
<thead>
<tr class="header">
<th align="center">1or</th>
<th align="center">0or</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">116 (112)</td>
<td align="center">164 (168)</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Formeln för <span class="math inline">\(\chi^2\)</span>-testet går det sedan att tillämpa
<span class="math display">\[\chi^2 = \sum_{i=1}^2 \dfrac{(O_i-E_i)^2}{E_i} = \dfrac{(116-112)^2}{112} + \dfrac{(164-168)^2}{168}=0.2381\]</span>
vilket i detta fall jämförs med en <span class="math inline">\(\chi^2\)</span>-fördelning med 1 frihetsgrad. Notera att mothypotesen vid <span class="math inline">\(\chi^2\)</span>-testet alltid är två-sidig, vilket motiverar användningen av <strong>prop.test()</strong>.</p>
</div>
<hr />
</div>
</div>
<div id="två-binära-variabler" class="section level2">
<h2><span class="header-section-number">5.2</span> Två binära variabler</h2>
<div id="tabeller" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Tabeller</h3>
<p>Det primära analysverktyget för två binära variabler är i regel <strong>table()</strong>. Även om <strong>table()</strong> kan användas vid analys av en enda variabel, är den framför allt användbar för att skapa korstabeller, dvs analys av två kategorivariabler samtidigt. I <strong>table()</strong> anges den radvisa variabeln först, sedan kolumnvisa variabeln. Tabellen som erhålls kallas i fallet med två variabler för tvåvägs-korstabell. I de fall det går att översätta variablerna i termer av oberoende variabel och beroende variabel, sätts den oberoende variabeln i regel kolumnsvis (x-axel) och den beroende variabeln radvis (y-axel). Detta är analogt med spridningsdiagram som har en <span class="math inline">\(x\)</span>-variabel och en <span class="math inline">\(y\)</span>-variabel!</p>
<p>Vi ska nu beskriva sambandet mellan utbildningsnivå och rökning. Först skapas en korstabell med frekvenser, sedan skapas en tabell innehållande andelar. Notera att det kräver en del pusslande för att få tabeller precis som man önskar, men i gengäld erhålls stor flexibilitet vad gäller den slutliga utformningen av tabellen.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1"><span class="co"># Skapa en variabel rokare som är 1 om rökare och 0 om icke-rökare  </span></a>
<a class="sourceLine" id="cb213-2" title="2"><span class="co"># Korstabulering av utb_bin och rokare (rökning radvis och utbildning kolumnvis)</span></a>
<a class="sourceLine" id="cb213-3" title="3">  freq_table_utb_rokare &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>rokare, df<span class="op">$</span>utb_cat)</a>
<a class="sourceLine" id="cb213-4" title="4">  freq_table_utb_rokare</a>
<a class="sourceLine" id="cb213-5" title="5"><span class="op">&gt;</span><span class="st">    </span></a>
<a class="sourceLine" id="cb213-6" title="6"><span class="er">&gt;</span><span class="st">     </span>Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb213-7" title="7"><span class="op">&gt;</span><span class="st">   </span><span class="dv">0</span>             <span class="dv">76</span>             <span class="dv">80</span></a>
<a class="sourceLine" id="cb213-8" title="8"><span class="op">&gt;</span><span class="st">   </span><span class="dv">1</span>             <span class="dv">88</span>             <span class="dv">36</span></a></code></pre></div>
<p>Vi har en tabell med frekvenser, men för att använda tabellen måste den i regel modifieras. För det första måste rader och kolumner tydligare namnges. Vi kan här tillämpa <strong>rownames()</strong> eller <strong>colnames()</strong>.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1"><span class="co"># Med rownames() kan vi förtydliga radnamnen  </span></a>
<a class="sourceLine" id="cb214-2" title="2"> <span class="kw">rownames</span>(freq_table_utb_rokare) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Icke rökare&quot;</span>, <span class="st">&quot;Rökare&quot;</span>)</a>
<a class="sourceLine" id="cb214-3" title="3"> freq_table_utb_rokare</a>
<a class="sourceLine" id="cb214-4" title="4"><span class="op">&gt;</span><span class="st">              </span></a>
<a class="sourceLine" id="cb214-5" title="5"><span class="er">&gt;</span><span class="st">               </span>Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb214-6" title="6"><span class="op">&gt;</span><span class="st">   </span>Icke rökare             <span class="dv">76</span>             <span class="dv">80</span></a>
<a class="sourceLine" id="cb214-7" title="7"><span class="op">&gt;</span><span class="st">   </span>Rökare                  <span class="dv">88</span>             <span class="dv">36</span></a></code></pre></div>
<p>Sedan måste sambandet åskådliggöras bättre om sambandsanalys är syftet. Det är nämligen svårt avläsa samband med enbart frekvenser, därför måste andelar (procent) anges. Precis som tidigare används därför funktionen <strong>prop.table()</strong> på ett objekt från <strong>table()</strong>. En två-vägs kortstabell ger nu <strong>prop.table()</strong> tre möjligheter att beräkna andelar:</p>
<ul>
<li>Andelar baserade på totala antalet (default)</li>
<li>Andelar beräknade utifrån radvisa totaler i nämnarna, genom att sätta argumentet <strong>margin = 1</strong></li>
<li>Andelar baserade på kolumnvisa totaler i nämnarna, genom sätta argumentet <strong>margin = 2</strong>.</li>
</ul>
<p>Notera att det är <strong>mycket viktigt</strong> att välja rätt andelar att beräkna eftersom dessa styr tolkningen av resultaten. Vi illustrerar nu hur andelarna beräknas i R och tolkar dem sen.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="co"># Andelar baserat alla</span></a>
<a class="sourceLine" id="cb215-2" title="2">  table_all &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_utb_rokare)</a>
<a class="sourceLine" id="cb215-3" title="3">  table_all</a>
<a class="sourceLine" id="cb215-4" title="4"><span class="op">&gt;</span><span class="st">              </span></a>
<a class="sourceLine" id="cb215-5" title="5"><span class="er">&gt;</span><span class="st">               </span>Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb215-6" title="6"><span class="op">&gt;</span><span class="st">   </span>Icke rökare      <span class="fl">0.2714286</span>      <span class="fl">0.2857143</span></a>
<a class="sourceLine" id="cb215-7" title="7"><span class="op">&gt;</span><span class="st">   </span>Rökare           <span class="fl">0.3142857</span>      <span class="fl">0.1285714</span></a>
<a class="sourceLine" id="cb215-8" title="8"><span class="co"># Andelar baserat rader</span></a>
<a class="sourceLine" id="cb215-9" title="9">  table_row_prop &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_utb_rokare, <span class="dt">margin =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb215-10" title="10">  table_row_prop </a>
<a class="sourceLine" id="cb215-11" title="11"><span class="op">&gt;</span><span class="st">              </span></a>
<a class="sourceLine" id="cb215-12" title="12"><span class="er">&gt;</span><span class="st">               </span>Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb215-13" title="13"><span class="op">&gt;</span><span class="st">   </span>Icke rökare      <span class="fl">0.4871795</span>      <span class="fl">0.5128205</span></a>
<a class="sourceLine" id="cb215-14" title="14"><span class="op">&gt;</span><span class="st">   </span>Rökare           <span class="fl">0.7096774</span>      <span class="fl">0.2903226</span></a>
<a class="sourceLine" id="cb215-15" title="15"><span class="co"># Andelar baserat kolumner</span></a>
<a class="sourceLine" id="cb215-16" title="16">  table_column_prop &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_utb_rokare, <span class="dt">margin =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb215-17" title="17">  table_column_prop  </a>
<a class="sourceLine" id="cb215-18" title="18"><span class="op">&gt;</span><span class="st">              </span></a>
<a class="sourceLine" id="cb215-19" title="19"><span class="er">&gt;</span><span class="st">               </span>Låg utbildning Hög utbildning</a>
<a class="sourceLine" id="cb215-20" title="20"><span class="op">&gt;</span><span class="st">   </span>Icke rökare      <span class="fl">0.4634146</span>      <span class="fl">0.6896552</span></a>
<a class="sourceLine" id="cb215-21" title="21"><span class="op">&gt;</span><span class="st">   </span>Rökare           <span class="fl">0.5365854</span>      <span class="fl">0.3103448</span></a></code></pre></div>
<p>Spendera tid med att tolka de olika tabellerna! För att förenkla tolkningen beskriver vi nedan sambanden i termer av sannolikheter.</p>
<ul>
<li>Den första tabellen visar att av alla i undersökningen är 27.1% icke-rökare och har låg utbildning. Om urvalet är slumpmässigt är detta således en skattning av sannolikheten <span class="math inline">\(\Pr(\text{Icke-rökare}\,\, \&amp; \,\, \text{Låg utbildning})\)</span>. På motsvarande sätt är 28.6%, 31.4% och 12.9% skattningar av
<span class="math inline">\(\Pr(\text{Icke-rökare}\,\, \&amp; \,\, \text{Hög utbildning})\)</span>, <span class="math inline">\(\Pr(\text{Rökare}\,\, \&amp; \,\, \text{Låg utbildning})\)</span> och <span class="math inline">\(\Pr(\text{Rökare}\,\, \&amp; \,\, \text{Hög utbildning})\)</span>. Huruvida dessa skattningar är relevanta beror på syftet med undersökningen.</li>
<li>Den andra tabellen visar, genom att beräkna radprocent, att bland icke-rökarna har 48.7% låg utbildning. Det innebär naturligtvis att bland icke-rökarna har 51.3% hög utbildning.
Om urvalet är slumpmässigt är dessa skattningar av <span class="math inline">\(\Pr(\text{Låg utbildning}|\text{Icke-rökare})\)</span> och <span class="math inline">\(\Pr(\text{Hög utbildning}|\text{Icke-rökare})\)</span>. På motsvarande sätt har 71% låg utbildning respektive 29% hög utbildning bland rökarna. <span class="math inline">\(\Pr(\text{Låg utbildning}|\text{Rökare})\)</span> och <span class="math inline">\(\Pr(\text{Hög utbildning}|\text{Rökare})\)</span>. Vi kan alltså med denna analys jämföra utbildningsnivån bland icke-rökare och rökare.</li>
<li>Den tredje tabellen visar, genom att beräkna kolumnprocent, att bland de lågutbildade röker 53.7% medan bland de högutbildade röker 31%. Detta är således skattningar av <span class="math inline">\(\Pr(\text{Rökare} | \text{Låg utbildning})\)</span> respektive <span class="math inline">\(\Pr(\text{Rökare} | \text{Hög utbildning})\)</span>. På motsvarande sätt är 46.3% och 69% skattningar av <span class="math inline">\(\Pr(\text{Icke-rökare}|\text{Låg utbildning})\)</span> och <span class="math inline">\(\Pr(\text{Icke-rökare}|\text{Hög utbildning})\)</span>. Vi kan konstatera att i stickprovet är andelen rökare större bland lågutbildade än högutbildade.</li>
</ul>
<p>Vilken tabell som redovisas beror således på frågeställning. Om syftet är att studera huruvida utbildning påverkar benägenheten att röka är det den tredje tabellen den som ska redovisas. Det är nämligen i denna enkelt att jämföra andelarna som röker i respektive utbildningskategori.</p>
<p>Vi konstruerar nu en korstabell innehåller <em>både</em> frekvenser och andelar baserade på kolumner och som tydligt beskriver sambandet. Tabellen konstrueras med <strong>cbind()</strong>, dessutom skapas procent med en decimal genom att använda **round(100*andel,1)**.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="co"># Skapa tabell för presentation av analys</span></a>
<a class="sourceLine" id="cb216-2" title="2">  table_utb_rokare &lt;-<span class="st"> </span><span class="kw">cbind</span>(freq_table_utb_rokare[,<span class="dv">1</span>], <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>table_column_prop[,<span class="dv">1</span>], <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb216-3" title="3">                            freq_table_utb_rokare[,<span class="dv">2</span>], <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>table_column_prop[,<span class="dv">2</span>], <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb216-4" title="4"><span class="co"># Ange kolumnm</span></a>
<a class="sourceLine" id="cb216-5" title="5">  <span class="kw">colnames</span>(table_utb_rokare) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Låg (n)&quot;</span>, <span class="st">&quot;Låg (%)&quot;</span>, <span class="st">&quot;Hög (n)&quot;</span>, <span class="st">&quot;Hög (%)&quot;</span>)</a>
<a class="sourceLine" id="cb216-6" title="6"><span class="co"># Se på tabellen</span></a>
<a class="sourceLine" id="cb216-7" title="7">  table_utb_rokare</a>
<a class="sourceLine" id="cb216-8" title="8"><span class="op">&gt;</span><span class="st">             </span>Lå<span class="kw">g</span> (n) Lå<span class="kw">g</span> (<span class="op">%) Hög (n) Hög (%</span>)</a>
<a class="sourceLine" id="cb216-9" title="9"><span class="op">&gt;</span><span class="st"> </span>Icke rökare      <span class="dv">76</span>    <span class="fl">46.3</span>      <span class="dv">80</span>      <span class="dv">69</span></a>
<a class="sourceLine" id="cb216-10" title="10"><span class="op">&gt;</span><span class="st"> </span>Rökare           <span class="dv">88</span>    <span class="fl">53.7</span>      <span class="dv">36</span>      <span class="dv">31</span></a></code></pre></div>
<p>Avslutningsvis, för fullständighetens skull, används funktionen <strong>addmargins()</strong> på tabellobjektet för att addera marginalsummor till tabellen. Genom att ange 1 adderas kolumnsummor, genom att ange två adderas radsummor. Anges inget argument adderas kolumnssummor och radsummor.</p>
<p>Nu är vi klara med tabellen! Det som återstår är att exportera den till ett ordbehandlingsprogram eller ett bildspel, men detta beskrivs i ett senare avsnitt.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">  table_utb_rokare_final &lt;-<span class="st"> </span><span class="kw">addmargins</span>(table_utb_rokare, <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb217-2" title="2">  <span class="kw">rownames</span>(table_utb_rokare_final) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Icke-rökare&quot;</span>, <span class="st">&quot;Rökare&quot;</span>, <span class="st">&quot;Summa&quot;</span>)</a>
<a class="sourceLine" id="cb217-3" title="3">  table_utb_rokare_final </a>
<a class="sourceLine" id="cb217-4" title="4"><span class="op">&gt;</span><span class="st">             </span>Lå<span class="kw">g</span> (n) Lå<span class="kw">g</span> (<span class="op">%) Hög (n) Hög (%</span>)</a>
<a class="sourceLine" id="cb217-5" title="5"><span class="op">&gt;</span><span class="st"> </span>Icke<span class="op">-</span>rökare      <span class="dv">76</span>    <span class="fl">46.3</span>      <span class="dv">80</span>      <span class="dv">69</span></a>
<a class="sourceLine" id="cb217-6" title="6"><span class="op">&gt;</span><span class="st"> </span>Rökare           <span class="dv">88</span>    <span class="fl">53.7</span>      <span class="dv">36</span>      <span class="dv">31</span></a>
<a class="sourceLine" id="cb217-7" title="7"><span class="op">&gt;</span><span class="st"> </span>Summa           <span class="dv">164</span>   <span class="fl">100.0</span>     <span class="dv">116</span>     <span class="dv">100</span></a></code></pre></div>
</div>
<div id="kvantifiering-av-samband" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Kvantifiering av samband</h3>
<p>Samband eller beroende mellan två binära variabler kan kvantifieras med olika mått. Ett vanligt sätt är användning av <span class="math inline">\(\chi^2\)</span>-måttet för att testa om två variabler är oberoende och kan sägas undersöka hur starkt ett samband är. Förutom <span class="math inline">\(\chi^2\)</span>-måttet finns en rad andra mått för graden av beroende, såsom Lambda-koefficienten, Cramérs V och tetrakorisk korrelation. Dessa mått introduceras inte här, men det kan vara bra att känna till att det finns alternativ till ^2$-måttet.</p>
<p>Ofta vill undersökaren dock relatera sambandet till en konkret frågeställning som inte bara handlar om beroende, det vill säga man önskar få en uppfattning av storleken på sambandet. De tre vanligaste måtten på storleken på samband (så kallade effektstorlekar) mellan två binära variabler är:</p>
<ul>
<li><strong>Skillnaden i andelar</strong> (absolut jämförelse av andelar): <span class="math display">\[p_{diff} = \Pr(Y=1|X=1) - \Pr(Y=0|X=1) = p_1 - p_0\]</span>. Skillnaden i andelar kan anta värdena <span class="math inline">\(-1 \leq p_{diff} \leq1\)</span>. Ofta kallat riskdifferens. Skillnaden i andelar är även en skillnad i procentenheter. <span class="math inline">\(0\)</span> indikerar ingen skillnad. Positiva värden indikerar en högre sannolikhet i grupp 1 jämfört med grupp 0. Negativa värden indikerar en lägre sannolikhet i grupp 1 jämfört med grupp 0.</li>
<li><strong>Kvoten av andelar</strong> (relativ jämförelse av andelar): <span class="math display">\[p_{kvot} = \dfrac{\Pr(Y=1|X=1)}{\Pr(Y=0|X=1)}= p_1/p_0\]</span>. Kvoten av andelar kan anta värdena <span class="math inline">\(0 \leq p_{kvot} &lt; \infty\)</span>. Ofta kallat relativ risk. <span class="math inline">\(p_{kvot}=1\)</span> indikerar ingen skillnad mellan grupperna. <span class="math inline">\(p_{kvot} &gt;1\)</span> indikerar en högre sannolikhet i grupp 1 jämfört med grupp 0. <span class="math inline">\(p_{kvot} &lt; 1\)</span> indikerar en lägre sannolikhet i grupp 1 jämfört med grupp 0.</li>
<li><strong>Oddskvoten</strong> (relativ jämförelse av odds): <span class="math display">\[OR = \dfrac{Odds(X=1)}{Odds(X=0)}=\dfrac{\dfrac{\Pr(Y=1|X=1)}{1 - \Pr(Y=1|X=1)}}{\dfrac{\Pr(Y=1|X=0)}{1 - \Pr(Y=1|X=0)}} = \dfrac{p_1/(1-p_1)}{p_0/(1-p_0)},\]</span>, där oddset för en händelse givet <span class="math inline">\(x\)</span> är definierat som <span class="math display">\[Odds(X=x)=\dfrac{\Pr(Y=1|X=x)}{1-(\Pr(Y=1|X=x)}=\dfrac{\Pr(Y=1|X=x)}{\Pr(Y=0|X=x)}.\]</span> Oddskvoten kan anta värdena <span class="math inline">\(0 \leq OR &lt; \infty\)</span>. Ofta kallat oddsratio. <span class="math inline">\(OR=1\)</span> indikerar ingen skillnad mellan grupperna. <span class="math inline">\(OR &gt;1\)</span> indikerar en högre sannolikhet i grupp 1 jämfört med grupp 0. <span class="math inline">\(OR &lt; 1\)</span> indikerar en lägre sannolikhet i grupp 1 jämfört med grupp 0.</li>
</ul>
<p>Notera att ovanstående mått är definierade utifrån populationen. I praktiken används motsvarigheterna i stickprovet <span class="math inline">\(\hat{p_1}=k_1/n_1\)</span> och <span class="math inline">\(\hat{p_0}=k_0/n_0\)</span>, där <span class="math inline">\(k_1\)</span> och <span class="math inline">\(k_0\)</span> är antalet lyckade försök (1or) i respektive <span class="math inline">\(x\)</span>-kategori och <span class="math inline">\(n_1\)</span> och <span class="math inline">\(n_0\)</span> är antalet försök i respektive <span class="math inline">\(x\)</span>-kategori.</p>
<p>Vilket av dessa tre mått som är mest relevant att presentera beror på syftet med undersökningen och ofta bör åtminstone både ett absolut mått och ett relativt mått presenteras. Måste man göra en indelning kan absoluta jämförelser av andelar ofta (men inte alltid!) vara mest policy-relevant eftersom måttet kan tolkas som en skillnad i procenheter mellan två stycken grupper. Däremot kan en relativ jämförelse av andelar uppfattas som mer relevant för en enskild individ. Detta beror dock på andra faktorer som populationsstorleken!</p>
<p>Eftersom oddskvoten inte är lika enkel att förstå som relativa andelar är det ett mått som i regel främst väljs på grund av studiedesign eller statistisk analysmetod.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="co"># Beräkna andelen rökare bland högutbildade. Det går även att använda mean( rokare[df$utb_bin == 1] ) eller table_row_prop[2,2]  </span></a>
<a class="sourceLine" id="cb218-2" title="2"> k1 &lt;-<span class="st">  </span>freq_table_utb_rokare[<span class="dv">2</span>,<span class="dv">2</span>] </a>
<a class="sourceLine" id="cb218-3" title="3"> n1 &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_utb_rokare[,<span class="dv">2</span>])   <span class="co"># Summera antal i kolumn 2, dvs de i kategori 1</span></a>
<a class="sourceLine" id="cb218-4" title="4"> phat1 &lt;-<span class="st"> </span>k1<span class="op">/</span>n1</a>
<a class="sourceLine" id="cb218-5" title="5"><span class="co"># Beräkna andelen rökare bland lågutbildade. Det går även att använda mean( rokare[df$utb_bin == 0] ) eller table_row_prop[2,1] </span></a>
<a class="sourceLine" id="cb218-6" title="6"> k0 &lt;-<span class="st"> </span>freq_table_utb_rokare[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb218-7" title="7"> n0 &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_utb_rokare[,<span class="dv">1</span>])   <span class="co"># Summera antal i kolumn 1, dvs de i kategori 0</span></a>
<a class="sourceLine" id="cb218-8" title="8"> phat0 &lt;-<span class="st"> </span>k0<span class="op">/</span>n0</a>
<a class="sourceLine" id="cb218-9" title="9"><span class="co"># Skillnad i andelar </span></a>
<a class="sourceLine" id="cb218-10" title="10"> phat_diff &lt;-<span class="st"> </span>phat1 <span class="op">-</span><span class="st"> </span>phat0</a>
<a class="sourceLine" id="cb218-11" title="11"> phat_diff</a>
<a class="sourceLine" id="cb218-12" title="12">[<span class="dv">1</span>] <span class="fl">-0.2262405</span></a>
<a class="sourceLine" id="cb218-13" title="13"><span class="co"># kvot av andelar </span></a>
<a class="sourceLine" id="cb218-14" title="14"> phat_kvot &lt;-<span class="st"> </span>phat1<span class="op">/</span>phat0</a>
<a class="sourceLine" id="cb218-15" title="15"> phat_kvot</a>
<a class="sourceLine" id="cb218-16" title="16">[<span class="dv">1</span>] <span class="fl">0.5783699</span></a>
<a class="sourceLine" id="cb218-17" title="17"><span class="co"># oddskvot</span></a>
<a class="sourceLine" id="cb218-18" title="18"> orhat &lt;-<span class="st"> </span>(phat1<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>phat1))<span class="op">/</span>((phat0<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>phat0)))</a>
<a class="sourceLine" id="cb218-19" title="19"> orhat</a>
<a class="sourceLine" id="cb218-20" title="20">[<span class="dv">1</span>] <span class="fl">0.3886364</span></a></code></pre></div>
<p>Tolkningen av dessa tre resultat är:</p>
<ul>
<li>Bland högutbildade röker 22 procentenheter mindre jämfört med lågutbildade.</li>
<li>Högutbildade har 100(1 - 0.578)% = 42.2% reducerad sannolikhet (risk) att röka jämfört med lågutbildade.</li>
<li>Högutbildade har 100(1 - 0.389)% = 62.1% reducerat odds för att röka jämfört lågutbildade.</li>
</ul>
<p>En pedagogisk poäng skulle vara att vända på analysen, dvs att sätta den kategori som ökar sannolikheten (lågutbildade) som 1 och jämförelsekategorin (högutbildade) som 0. Detta skulle ge följande resultat och tolkning:</p>
<ul>
<li>Bland lågutbildade röker 22 procentenheter fler jämfört med lågutbildade.</li>
<li>Lågutbildade har 72.9% ökad sannolikhet att röka jämfört med högutbildade.</li>
<li>Lågutbildade har 2.57 gånger större odds för att röka jämfört med lågutbildade.</li>
</ul>
<hr />
<p><img src="docs/images/note.png" width="5%" /></p>
<style>
div.yellow{ background-color:#FFFA94; border-radius: 5px; padding: 20px;}
</style>
<div class="yellow">
<p><font size="5"> Absoluta eller relativa jämförelser av andelar? </font></p>
<ul>
<li><p>Anta att 0.2% (2 av 1000) av alla som får Covid-19 dör. Ett studie visar att ett nytt antiviralt läkemedel leder till att endast 0.1% (1 av 1000) dör. Det är en skillnad i dödlighet på endast 0.1 procentenheter, men för individen innebär detta en halverad risk för att dö! Huruvida det är policyrelevant beror dock på hur många man räknar med att drabbas. Låt säg att bara 10 000 drabbas av Covid-19, då skulle läkemedlet rädda 10 liv. Skulle däremot 1 miljon få Covid-19 då skulle läkemedlet potentiellt rädda 10 000 liv.</p></li>
<li><p>Anta att arbetsförmedlingen introducerar ett nytt åtgärdsprogram riktat mot gymnasieungdomar som riskerar att inte slutföra gymnasieskolan. Bland eleverna som deltar i programmet kommer 90% få slutbetyg, medan i kontrollgrupp får 70% slutbetyg. Det är alltså en skillnad på hela 20 procentenheter. För en individ ökar dock sannolikheten till behörighet med endast 29%.</p></li>
</ul>
</div>
<hr />
</div>
<div id="figurer" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Figurer</h3>
<p>För att åskådliggöra samband mellan två binära variabler används återigen oftast <strong>barplot()</strong>.</p>
<ul>
<li>Med <em>freq_table_utb_rokare</em> skapas ett stapeldiagram som redovisar antalet i respektive kategori. Vad denna figur visar är att det finns fler lågutbildade än högutbildade. Dessutom relaterar diagrammet direkt till frekvenserna i varje cell i tabellen. Denna figur är kan vara användbar i en del fall, men ofta blir det svårt att utläsa samband.</li>
<li>Med <em>table_row_prop</em> blir figuren meninglös eftersom andelen lågutbildade är mer än 1!</li>
<li>Med <em>table_col_prop</em> ges en tydlig bild av om andelen rökare inom respektive utbildning. Om vi däremot önskar få någon uppfattning om <em>antalet</em> som finns i respektive utbildningskategori ger denna figur ingen information.</li>
</ul>
<p>Vi illusterar nedan. För fullständighetens finns även argumentet <strong>legend</strong> med i koden. En <strong>legend</strong> i R är en förklaring av komponenterna i figuren. Prova kör de olika figurerna nedan och relatera till koden.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1"><span class="co"># Stapeldiagram med frekvenser</span></a>
<a class="sourceLine" id="cb219-2" title="2"> <span class="kw">barplot</span>(freq_table_utb_rokare,                               <span class="co"># Tabellen</span></a>
<a class="sourceLine" id="cb219-3" title="3">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Låg utbildning&quot;</span>, <span class="st">&quot;Hög utbildning&quot;</span>),   <span class="co"># Ge namn till staplarna</span></a>
<a class="sourceLine" id="cb219-4" title="4">         <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>,                                      <span class="co"># Namn till y-axeln</span></a>
<a class="sourceLine" id="cb219-5" title="5">         <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Icke-rökare&quot;</span>, <span class="st">&quot;Rökare&quot;</span>),                 <span class="co"># Namn till kategorierna</span></a>
<a class="sourceLine" id="cb219-6" title="6">         <span class="dt">args.legend =</span>  <span class="kw">c</span>(<span class="dt">y =</span> <span class="dv">190</span>,                            <span class="co"># Ställa in position,</span></a>
<a class="sourceLine" id="cb219-7" title="7">                          <span class="dt">horiz =</span> <span class="ot">TRUE</span>,                      <span class="co"># Horisontell legend</span></a>
<a class="sourceLine" id="cb219-8" title="8">                          <span class="dt">bty =</span><span class="st">&#39;n&#39;</span>))                         <span class="co"># Ta bort kantlinje i legend.</span></a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-191-1.png" width="384" /></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="co"># Stapeldiagram med radprocent (felaktigt diagram!)</span></a>
<a class="sourceLine" id="cb220-2" title="2"> <span class="kw">barplot</span>(table_row_prop, </a>
<a class="sourceLine" id="cb220-3" title="3">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Låg utbildning&quot;</span>, <span class="st">&quot;Hög utbildning&quot;</span>), </a>
<a class="sourceLine" id="cb220-4" title="4">         <span class="dt">ylab =</span> <span class="st">&quot;Andel&quot;</span>, </a>
<a class="sourceLine" id="cb220-5" title="5">         <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Icke-rökare&quot;</span>, <span class="st">&quot;Rökare&quot;</span>), </a>
<a class="sourceLine" id="cb220-6" title="6">         <span class="dt">args.legend =</span>  <span class="kw">c</span>(<span class="dt">y =</span> <span class="fl">1.4</span>, </a>
<a class="sourceLine" id="cb220-7" title="7">                          <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb220-8" title="8">                          <span class="dt">bty =</span><span class="st">&#39;n&#39;</span>))</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-191-2.png" width="384" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1"><span class="co"># Stapeldiagram med kolumn</span></a>
<a class="sourceLine" id="cb221-2" title="2"> <span class="kw">barplot</span>(table_column_prop, </a>
<a class="sourceLine" id="cb221-3" title="3">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Låg utbildning&quot;</span>, <span class="st">&quot;Hög utbildning&quot;</span>), </a>
<a class="sourceLine" id="cb221-4" title="4">         <span class="dt">ylab =</span> <span class="st">&quot;Andel&quot;</span>, </a>
<a class="sourceLine" id="cb221-5" title="5">         <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Icke-rökare&quot;</span>, <span class="st">&quot;Rökare&quot;</span>), </a>
<a class="sourceLine" id="cb221-6" title="6">         <span class="dt">args.legend =</span>  <span class="kw">c</span>(<span class="dt">y =</span> <span class="fl">1.2</span>, </a>
<a class="sourceLine" id="cb221-7" title="7">                          <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb221-8" title="8">                          <span class="dt">bty =</span><span class="st">&#39;n&#39;</span>))</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-191-3.png" width="384" /></p>
<p>Anta att syftet är att studera andelen rökare inom respektive utbildningskategori och vi väljer därför figuren som baseras på <strong>table_column_prop</strong>.</p>
<p>Med argumentet <strong>beside</strong> och placering av staplarna bredvid varandra kan sambandet eventuellt tydligare åskådliggöras. Alternativt skapas ett stapeldiagram baserad på enbart rad 2 från tabellen, dvs andelen rökare i respektive kategori. Förmodligen är detta sista stapeldiagram det tydligaste om vi bara är intresserade av att jämföra andelarna i respektive utbildningsnivå.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1"><span class="co"># Uppdelat stapeldiagram </span></a>
<a class="sourceLine" id="cb222-2" title="2"> <span class="kw">barplot</span>(table_column_prop, </a>
<a class="sourceLine" id="cb222-3" title="3">         <span class="dt">beside=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb222-4" title="4">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Låg utbildning&quot;</span>, <span class="st">&quot;Hög utbildning&quot;</span>), </a>
<a class="sourceLine" id="cb222-5" title="5">         <span class="dt">ylab =</span> <span class="st">&quot;Andel&quot;</span>, </a>
<a class="sourceLine" id="cb222-6" title="6">         <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Icke-rökare&quot;</span>, <span class="st">&quot;Rökare&quot;</span>),</a>
<a class="sourceLine" id="cb222-7" title="7">         <span class="dt">args.legend =</span>  <span class="kw">c</span>(<span class="dt">y =</span> <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb222-8" title="8">                          <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb222-9" title="9">                          <span class="dt">bty =</span><span class="st">&#39;n&#39;</span>))</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-192-1.png" width="384" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="co"># Stapeldiagram som enbart redovisar andelen rökare i respektive utbildningsnivå</span></a>
<a class="sourceLine" id="cb223-2" title="2"><span class="kw">barplot</span>( table_row_prop[<span class="dv">2</span>,], </a>
<a class="sourceLine" id="cb223-3" title="3">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Låg utbildning&quot;</span>, <span class="st">&quot;Hög utbildning&quot;</span>), </a>
<a class="sourceLine" id="cb223-4" title="4">         <span class="dt">ylab =</span> <span class="st">&quot;Andel rökare&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-192-2.png" width="384" /></p>
<hr />
<p><img src="docs/images/tip.png" width="5%" /></p>
<style>
div.burly{ background-color:#EAF2F8; border-radius: 5px; padding: 20px;}
</style>
<div class = "burly">

<p><font size="5"> Tips för ytterligare modifering av stapeldiagram </font></p>
<p>Varför inte unyttja den funktionalitet som R erbjuder? Den sista figuren är korrekt, men det kan behövas ytterligare modifiering för att få figuren estestisk tilltalande. Nedan presenteras ett sådant exempel. Vad gör denna figuren bättre än tidigare figurer tycker du?</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-194-1.png" width="384" /></p>
<p>Notera att utförligare information presenteras i kapitlet med figurer och om koden i exemplet är komplicerad så kan du avvakta. Det är dock ofta en bra princip att titta på kod och undersöka vad som händer när man modifierar koden.</p>
<button title="figurrokareutbildning" type="button" onclick="if(document.getElementById(&#39;figurrokareutbildning&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;figurrokareutbildning&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;figurrokareutbildning&#39;) .style.display=&#39;none&#39;}">
Visa kod
</button>
<div id="figurrokareutbildning" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1"><span class="co"># Enklast är att ta färdig kod och modifiera efter eget behov. Om du inte förstår färdig kod, testa att ändra i koden och se vad som händer!</span></a>
<a class="sourceLine" id="cb224-2" title="2"><span class="co"># Gör om andelar till procent </span></a>
<a class="sourceLine" id="cb224-3" title="3">  percentages_rokare &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>table_row_prop[<span class="dv">2</span>,], <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb224-4" title="4"><span class="co"># Skapa objekt så vi kan hämta information från figurobjekt </span></a>
<a class="sourceLine" id="cb224-5" title="5">  my_bar &lt;-<span class="st"> </span><span class="kw">barplot</span>(  percentages_rokare, </a>
<a class="sourceLine" id="cb224-6" title="6">                      <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Låg utbildning&quot;</span>, <span class="st">&quot;Hög utbildning&quot;</span>), </a>
<a class="sourceLine" id="cb224-7" title="7">                      <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>),                           <span class="co"># Gränser för y-axel</span></a>
<a class="sourceLine" id="cb224-8" title="8">                      <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,                      <span class="co"># Stapelfärg</span></a>
<a class="sourceLine" id="cb224-9" title="9">                      <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>,                       <span class="co"># Kantlinjefärg på stapel</span></a>
<a class="sourceLine" id="cb224-10" title="10">                      <span class="dt">ylab =</span> <span class="st">&quot;Rökare (%)&quot;</span>,                    <span class="co"># Namn på y-axel</span></a>
<a class="sourceLine" id="cb224-11" title="11">                      <span class="dt">cex.axis =</span> <span class="fl">1.1</span>,                         <span class="co"># Textstorlek på axlar</span></a>
<a class="sourceLine" id="cb224-12" title="12">                      <span class="dt">cex.lab =</span> <span class="fl">1.1</span>,                          <span class="co"># Textstorlek på namn</span></a>
<a class="sourceLine" id="cb224-13" title="13">                      <span class="dt">cex.names=</span><span class="fl">1.1</span>)                          <span class="co"># Textstorlek på namn</span></a>
<a class="sourceLine" id="cb224-14" title="14"><span class="co"># Lägg till proocent ovanför staplarna med hjälp av funktionen **text()**. I denna funktion anges koordinater (x,y) för # var texten ska in, där x-koordinaten är staplarnas placering i objektet my_bar och ofta får man testa sig fram. Med # argumentet **labels** bestäms vad som ska stå över staplarna. Funktionen **paste** används för att sammanfoga numeriska # värden och text, i detta fall procenttecknet.   </span></a>
<a class="sourceLine" id="cb224-15" title="15">  <span class="kw">text</span>(<span class="dt">x =</span> my_bar,                                         <span class="co"># x-koordinat för placering av text</span></a>
<a class="sourceLine" id="cb224-16" title="16">       <span class="dt">y =</span> percentages_rokare <span class="op">+</span><span class="st"> </span><span class="dv">6</span>,                         <span class="co"># y-koordinat för placering av test</span></a>
<a class="sourceLine" id="cb224-17" title="17">       <span class="dt">labels =</span> <span class="kw">paste</span>(percentages_rokare, <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),   <span class="co"># Text</span></a>
<a class="sourceLine" id="cb224-18" title="18">       <span class="dt">cex =</span> <span class="fl">1.1</span>)                                           <span class="co"># Storlek på text</span></a></code></pre></div>
</div>
</div>
<p></br></p>
<hr />
</div>
<div id="inferens-1" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Inferens</h3>
<p>Anta nu att målet är generalisera analyserna av stickprovet till en population, antingen med hjälp av konfidensintervall eller hypotesprövning.</p>
<p>Vi börjar med att göra inferens för skillnaden i populationsandelar <span class="math inline">\(p_1\)</span> och <span class="math inline">\(p_0\)</span> i två populationer, <span class="math inline">\(p_{diff}=p_1- p_0\)</span>. Utgångspunkten här är två oberoende OSU.</p>
<p>Givet att förutsättningarna för normalapproximation håller ges ett konfidensintervall av:
<span class="math display">\[\hat{p_1} - \hat{p_0}\pm  z_{\alpha/2}\sqrt{\dfrac{\hat{p_1}(1-\hat{p_1})}{n_1} + \dfrac{\hat{p_0}(1-\hat{p_0})}{n_0}}\]</span>
där <span class="math inline">\(z_{\alpha/2}\)</span> är värdet hämtat från standardiserade normalfördelningen.</p>
<p>Konfidensintervallet för skillnaden in andelar i populationen kan beräknas med <strong>prop.test()</strong>.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="co"># Ta fram värden för beräkningar</span></a>
<a class="sourceLine" id="cb225-2" title="2"> x0 &lt;-<span class="st">  </span>freq_table_utb_rokare[<span class="dv">2</span>,<span class="dv">1</span>]    <span class="co"># Antal rökare (1or) bland lågutbildare</span></a>
<a class="sourceLine" id="cb225-3" title="3"> x1 &lt;-<span class="st">  </span>freq_table_utb_rokare[<span class="dv">2</span>,<span class="dv">2</span>]    <span class="co"># Antal rökare (1or) bland högutbildare</span></a>
<a class="sourceLine" id="cb225-4" title="4"> n0 &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_utb_rokare[,<span class="dv">1</span>]) <span class="co"># Antal lågutbildare</span></a>
<a class="sourceLine" id="cb225-5" title="5"> n1 &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_utb_rokare[,<span class="dv">2</span>]) <span class="co"># Antal högutbildare</span></a>
<a class="sourceLine" id="cb225-6" title="6"><span class="co"># Skapa konfidensintervall</span></a>
<a class="sourceLine" id="cb225-7" title="7"> resultat &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1, x0), <span class="kw">c</span>(n1, n0), <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb225-8" title="8"><span class="co"># Skattning av skillnad i andelar</span></a>
<a class="sourceLine" id="cb225-9" title="9"> phat_diff &lt;-<span class="st"> </span>resultat<span class="op">$</span>estimate[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>resultat<span class="op">$</span>estimate[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb225-10" title="10"> p_diff_KI_resultat &lt;-<span class="st"> </span>resultat<span class="op">$</span>conf.int</a>
<a class="sourceLine" id="cb225-11" title="11"> phat_diff</a>
<a class="sourceLine" id="cb225-12" title="12">    prop <span class="dv">1</span> </a>
<a class="sourceLine" id="cb225-13" title="13"><span class="fl">-0.2262405</span> </a>
<a class="sourceLine" id="cb225-14" title="14"> p_diff_KI_resultat </a>
<a class="sourceLine" id="cb225-15" title="15">[<span class="dv">1</span>] <span class="fl">-0.3398732</span> <span class="fl">-0.1126079</span></a>
<a class="sourceLine" id="cb225-16" title="16"><span class="kw">attr</span>(,<span class="st">&quot;conf.level&quot;</span>)</a>
<a class="sourceLine" id="cb225-17" title="17">[<span class="dv">1</span>] <span class="fl">0.95</span></a></code></pre></div>
<p>Vi kan även implementera formeln ovan och erhålla samma resultat.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1"><span class="co"># Punktskattningar</span></a>
<a class="sourceLine" id="cb226-2" title="2"> phat1 &lt;-<span class="st"> </span>x1<span class="op">/</span>n1</a>
<a class="sourceLine" id="cb226-3" title="3"> phat0 &lt;-<span class="st"> </span>x0<span class="op">/</span>n0</a>
<a class="sourceLine" id="cb226-4" title="4"> phatdiff &lt;-<span class="st"> </span>phat1 <span class="op">-</span><span class="st"> </span>phat0</a>
<a class="sourceLine" id="cb226-5" title="5"><span class="co"># Skattningen av variansen för skattningen av skillnaden i andelar </span></a>
<a class="sourceLine" id="cb226-6" title="6"> vhatphatdiff &lt;-<span class="st"> </span>phat1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat1)<span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span>phat0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat0)<span class="op">/</span>n0 </a>
<a class="sourceLine" id="cb226-7" title="7"><span class="co"># Konfidensintervall </span></a>
<a class="sourceLine" id="cb226-8" title="8"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb226-9" title="9"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb226-10" title="10"> ll &lt;-<span class="st"> </span>phat_diff <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphatdiff)</a>
<a class="sourceLine" id="cb226-11" title="11"> ul &lt;-<span class="st"> </span>phat_diff <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphatdiff)</a>
<a class="sourceLine" id="cb226-12" title="12"> p_diff_KI &lt;-<span class="st"> </span><span class="kw">c</span>(ll, ul)</a>
<a class="sourceLine" id="cb226-13" title="13"><span class="co"># Resultat </span></a>
<a class="sourceLine" id="cb226-14" title="14"> phatdiff</a>
<a class="sourceLine" id="cb226-15" title="15"> p_diff_KI</a>
<a class="sourceLine" id="cb226-16" title="16"><span class="co"># Kolla förutsättningarna!</span></a>
<a class="sourceLine" id="cb226-17" title="17"> phat1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat1)<span class="op">*</span>n1</a>
<a class="sourceLine" id="cb226-18" title="18"> phat0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat0)<span class="op">*</span>n0</a></code></pre></div>
<p>Tolkningen av resultaten kan skrivas på olika sätt. Nedan är två alternativ:</p>
<ul>
<li>Bland högutbildade röker 23 procentenheter mindre jämfört med lågutbildade. Med 95% säkerhet finns mellan 34 och 11 procenheter färre rökare bland högutbildade jämfört med lågutbildade.<br />
</li>
<li>Skillnaden i andelen som röker bland högutbildade jämfört med lågutbildade är -0.23 (95% KI: -0.34; -11%).</li>
</ul>
<p>Litar vi på resultaten? Detta bygger på två förutsättningar, OSU (som vi vet från designen) samt att normalapproximationen (vilket vi undersöker i stickprovet) fungerar.</p>
<p>Anta att syftet inte är att skatta skillnaden i andelen som röker, utan att frågan snarare är huruvida man röker i samma utsträckning oavsett utbildningsnivå. Då kan vi istället genomföra hypotesprövning och testa <span class="math inline">\(H_0: p_1 = p_0\)</span> mot en två-sidig mothypotes, <span class="math inline">\(H_0: p_1 \neq p_0\)</span> andvänds test-funktionen
<span class="math display">\[ z = \dfrac{\hat{p}_1 - \hat{p}_0}{\hat{p}_{pool}(1- \hat{p}_{pool})\left(\dfrac{1}{n_1} + \dfrac{1}{n_0}\right)}\]</span>
där <span class="math display">\[\hat{p}_{pool} = \dfrac{n_1\hat{p}_1 + n_0 \hat{p}_0}{n_1 + n_0}.\]</span>
Testfunktionen är <span class="math inline">\(N(0,1)\)</span> om nollhypotesen är sann om vi har OSU och om normalapproximation gäller (<span class="math inline">\(n_1p_1(1-p_1) &gt; 5\)</span> och <span class="math inline">\(n_0p_0(1-p_0) &gt; 5\)</span>).</p>
<p>Ovanstående test kan göras med <strong>prop.test()</strong> och vi hämtar resultat från den redan tidigare genomförda analysen.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="co"># Z-test (som beror på X2-värdet när det är tvåsidig)</span></a>
<a class="sourceLine" id="cb227-2" title="2"> z &lt;-<span class="st"> </span><span class="kw">sqrt</span>(resultat<span class="op">$</span>statistic)</a>
<a class="sourceLine" id="cb227-3" title="3"> z</a>
<a class="sourceLine" id="cb227-4" title="4">X<span class="op">-</span>squared </a>
<a class="sourceLine" id="cb227-5" title="5"> <span class="fl">3.754285</span> </a>
<a class="sourceLine" id="cb227-6" title="6"> resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb227-7" title="7">[<span class="dv">1</span>] <span class="fl">0.0001738371</span></a></code></pre></div>
<p>Det andra alternativet är att implementera formeln ovan och beräkna <span class="math inline">\(p\)</span>-värdet, vilket ger samma resultat.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1"><span class="co"># Beräkningar baserade på tidigare kvantiteter </span></a>
<a class="sourceLine" id="cb228-2" title="2"> pooled_phat &lt;-<span class="st"> </span>(n1<span class="op">*</span>phat1 <span class="op">+</span><span class="st"> </span>n0<span class="op">*</span>phat0)<span class="op">/</span>(n1 <span class="op">+</span><span class="st"> </span>n0)</a>
<a class="sourceLine" id="cb228-3" title="3"> zobs &lt;-<span class="st"> </span>(phat1 <span class="op">-</span><span class="st"> </span>phat0)<span class="op">/</span><span class="kw">sqrt</span>(pooled_phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pooled_phat)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>n0))</a>
<a class="sourceLine" id="cb228-4" title="4"> p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zobs)))</a>
<a class="sourceLine" id="cb228-5" title="5"> p_value</a>
<a class="sourceLine" id="cb228-6" title="6">[<span class="dv">1</span>] <span class="fl">0.0001738371</span></a></code></pre></div>
<p>Tolkningen är att <em>givet att andelen rökare är lika stor i bägge utbildningskategorier i populationen så är det 0.0002 sannolikhet att hitta en så stor skillnad i andelar eller större som vi erhållit</em>. Data stämmer alltså inte alls väl överens med nollhypotesen om ingen skillnad!</p>
<p>Det går även att genomföra en ensidig hypotesprövning. Anta att vi vill testa <span class="math inline">\(H_0: p_0 = p_1\)</span> vs <span class="math inline">\(H_1: p_1 &lt; p_0\)</span>, dvs om andelen rökare mindre bland högutbildade än bland lågutbildade. Vi måste nu <strong>prop.test()</strong> ange att mothypotesen är mindre än. För testet baserat på formeln ändras inte <span class="math inline">\(z\)</span>-värdet, däremot hur <span class="math inline">\(p\)</span>-värdet beräknas i <strong>pnorm()</strong>.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1"><span class="co"># Version 1</span></a>
<a class="sourceLine" id="cb229-2" title="2">resultat_less &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1, x0), <span class="kw">c</span>(n1, n0), <span class="dt">alternativ =</span> <span class="st">&quot;less&quot;</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb229-3" title="3">resultat_less</a>
<a class="sourceLine" id="cb229-4" title="4"></a>
<a class="sourceLine" id="cb229-5" title="5">    <span class="dv">2</span><span class="op">-</span>sample test <span class="cf">for</span> equality of proportions without continuity</a>
<a class="sourceLine" id="cb229-6" title="6">    correction</a>
<a class="sourceLine" id="cb229-7" title="7"></a>
<a class="sourceLine" id="cb229-8" title="8">data<span class="op">:</span><span class="st">  </span><span class="kw">c</span>(x1, x0) out of <span class="kw">c</span>(n1, n0)</a>
<a class="sourceLine" id="cb229-9" title="9">X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">14.095</span>, df =<span class="st"> </span><span class="dv">1</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">8.692e-05</span></a>
<a class="sourceLine" id="cb229-10" title="10">alternative hypothesis<span class="op">:</span><span class="st"> </span>less</a>
<a class="sourceLine" id="cb229-11" title="11"><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb229-12" title="12"><span class="st"> </span><span class="fl">-1.000000</span> <span class="fl">-0.130877</span></a>
<a class="sourceLine" id="cb229-13" title="13">sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb229-14" title="14"><span class="st">   </span>prop <span class="dv">1</span>    prop <span class="dv">2</span> </a>
<a class="sourceLine" id="cb229-15" title="15"><span class="fl">0.3103448</span> <span class="fl">0.5365854</span> </a>
<a class="sourceLine" id="cb229-16" title="16"></a>
<a class="sourceLine" id="cb229-17" title="17"><span class="co"># Version 2</span></a>
<a class="sourceLine" id="cb229-18" title="18"><span class="kw">pnorm</span>(zobs)</a>
<a class="sourceLine" id="cb229-19" title="19">[<span class="dv">1</span>] <span class="fl">8.691855e-05</span></a></code></pre></div>
<p>Vi får ett mycket lågt <span class="math inline">\(p\)</span>-värde (<span class="math inline">\(p&lt;0.001\)</span>) som säger oss att <em>givet att andelen rökare är lika stor i bägge utbildningskategorier i populationen så är det 0.00008 sannolikhet att finna att högutbildade röker i så mycket mindre utsträckning eller ännu mindre jämfört med lågutbildade.</em>
Data stämmer alltså inte alls väl överens med nollhypotesen om ingen skillnad!</p>
<p>Ett annat sätt att testa samband mellan binära variabler om vi har en två-sidigt mothypotes är att genomföra ett <em>test för oberoende</em>. En vanlig meted för att testa detta är <span class="math inline">\(\chi^2\)</span>-metoden, som testar hypoteserna:
+ <span class="math inline">\(H_0\)</span>: Det finns inget samband mellan variablerna (oberoende)
+ <span class="math inline">\(H_1\)</span>: Det finns ett samband mellan variablerna (beroende)
Notera att mothypotesens riktning är ospecificerad!</p>
<p>Utgå från en <span class="math inline">\(2\times2\)</span>-tabell med frekvenser från två korstabulerade binära variabler. I
respektive cell finns således observerade frekvenser <span class="math inline">\(O_{ij}\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Kolumn 1</th>
<th align="center">Kolumn 2</th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Rad 1</strong></td>
<td align="center"><span class="math inline">\(O_{11}\)</span></td>
<td align="center"><span class="math inline">\(O_{12}\)</span></td>
<td align="center">Radsumma 1</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>Rad 2</strong></td>
<td align="center"><span class="math inline">\(O_{21}\)</span></td>
<td align="center"><span class="math inline">\(O_{22}\)</span></td>
<td align="center">Radsumma 2</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">Kolumnsumma 1</td>
<td align="center">Kolumnsumma 2</td>
<td align="center">Totalsumma</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Ett oberoendetest för kan genomföras med teststatistikan
<span class="math display">\[\chi^2 = \dfrac{(O_{11} - E_{11})^2}{E_{11}}+ \dfrac{(O_{12} - E_{12})^2}{E_{12}}+\dfrac{ (O_{21} - E_{21})^2}{E_{21}}+ \dfrac{ (O_{22} - E_{22})^2}{E_{22}},\]</span>
där <span class="math inline">\(E_{ij} = \dfrac{\text{Radsumma i}\cdot \text{Kolumnsumma j}}{\text{Totalsumma}}\)</span> är de förväntade frekvenserna givet att variablerna är oberoende. Teststatistikan är <span class="math inline">\(\chi^2\)</span>-fördelad med <span class="math inline">\(1\)</span> frihetsgrad om <span class="math inline">\(H_0\)</span> är sann och om antalet förväntade frekvenser i alla celler är större än 5. Det framräknade värdet i stickprovet, <span class="math inline">\(\chi^2_{obs}\)</span>, jämförs sedan med denna fördelning. Detta test är alltid ensidigt och genom att se hur extremt värdet är i högra svansen erhålls <span class="math inline">\(p\)</span>-värdet.</p>
<p>För att implementera testet i R används <strong>chisq.test()</strong> på ett tabell-objekt med frekvenser. Det går också att tillämpa formeln ovan kan genomföra ett <span class="math inline">\(\chi^2\)</span>-test. Det framräknade <span class="math inline">\(\chi^2\)</span>-värdet används sedan i <strong>pchisq()</strong> för ett erhålla <span class="math inline">\(p\)</span>-värdet.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"> resultat_chisq &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table_utb_rokare, <span class="dt">correct =</span> <span class="ot">FALSE</span> )</a>
<a class="sourceLine" id="cb230-2" title="2"> resultat_chisq</a>
<a class="sourceLine" id="cb230-3" title="3"></a>
<a class="sourceLine" id="cb230-4" title="4">    Pearson<span class="st">&#39;s Chi-squared test</span></a>
<a class="sourceLine" id="cb230-5" title="5"></a>
<a class="sourceLine" id="cb230-6" title="6"><span class="st">data:  freq_table_utb_rokare</span></a>
<a class="sourceLine" id="cb230-7" title="7"><span class="st">X-squared = 14.095, df = 1, p-value = 0.0001738</span></a></code></pre></div>
<p>Vi erhåller samma <span class="math inline">\(p\)</span>-värde som när vi testade för skillnad av andelar i fallet med två-sidig mothypotes. <span class="math inline">\(\chi^2\)</span>-metoden kan alltså användas för att testa andelar, men testet är också ett mer generellt test för oberoende. Om två binära variabler är beroende, så är de beroende <strong>oavsett val av effektstorlek</strong>. Därför kan <span class="math inline">\(\chi^2\)</span>-metoden användas även för <span class="math inline">\(p_{kvot}\)</span> och <span class="math inline">\(OR\)</span>. Oberoende testet testar alltså någon av hypoteserna:</p>
<p><span class="math display">\[H_0: p_{diff} = 0\,\,\,\text{vs}\,\,\,H_1: p_{diff} \neq 0\]</span>
<span class="math display">\[H_0: p_{kvot} = 1\,\,\,\text{vs}\,\,\,H_1: p_{kvot} \neq 1\]</span>
<span class="math display">\[H_0: p_{OR} = 1\,\,\,\text{vs}\,\,\,H_1: p_{OR} \neq 1\]</span></p>
</div>
</div>
<div id="tre-kategorier-eller-fler" class="section level2">
<h2><span class="header-section-number">5.3</span> Tre kategorier eller fler</h2>
<p>Detta avsnitt lämpar sig i regel för variabler med relativt få kategorier, låt säg färre än 10. För analys av variabler med många kategorier kan alternativa metoder för analys och presentation vara bättre. Notera ordvalet <em>kan</em> eftersom val av presentation och analys måste bedömas från fall till fall.</p>
<div id="kodning-1" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Kodning</h3>
<p>Från ett statistiskt perspektiv är en variabel med fler än två kategorier antingen på nominal eller ordinal skalnivå.
Precis som fallet med binära variabler finns möjligheten att arbeta med faktorer och det går i funktionen <strong>factor()</strong> att ange skalnivå med argumentet <strong>ordered</strong>. Det bör dock nämnas att det är vanligt att vid arbete med faktorer i R inte ta hänsyn till att variabeln är ordinalskala, utan om så görs beror på om analysen kräver det.</p>
<p>Vi inleder med det enklaste fallet, en kategorivariabel på nominalskala. Nedan skapas en faktorvariabel av <strong>reklam</strong> som anger uppfattning om reklam för spel genom att med <strong>factor</strong> definerar variabeln som en faktor. Vi tillämpar sedan <strong>str()</strong> för att förvissa oss om att den är definierad som faktor. Vi ser att varaiabeln har 3 nivåer, dvs <em>Factor w/ 3 levels</em> och med funktionen <strong>levels()</strong> listas nivåerna som är <em>“Har ej tagit ställning”, “Ja”, “Nej”</em>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="co"># Skapa en faktorvariabel reklam för spel som är på nominalskala  </span></a>
<a class="sourceLine" id="cb231-2" title="2"> df<span class="op">$</span>reklam_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>reklam)  </a>
<a class="sourceLine" id="cb231-3" title="3"><span class="co"># Undersök variabeln egenskaper</span></a>
<a class="sourceLine" id="cb231-4" title="4"> <span class="kw">str</span>(df<span class="op">$</span>reklam_cat)</a>
<a class="sourceLine" id="cb231-5" title="5"><span class="op">&gt;</span><span class="st">  </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">3</span> levels <span class="st">&quot;Har ej tagit ställning&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> ...</a>
<a class="sourceLine" id="cb231-6" title="6"> <span class="kw">levels</span>(df<span class="op">$</span>reklam_cat)</a>
<a class="sourceLine" id="cb231-7" title="7"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;Har ej tagit ställning&quot;</span> <span class="st">&quot;Ja&quot;</span>                     <span class="st">&quot;Nej&quot;</span></a></code></pre></div>
<p>Något att vara observant över är att en siffra korresponderar till varje faktornivå. Som användare måste man därför vara försiktig vid konvertering av numeriska variabler till faktorer och vice versa. Vi exemplifierar nedan med att skapa en faktorvariabel av den numeriska variabeln <strong>inkomst</strong>, för sedan göra om den till en numerisk variabel igen med <strong>as.numeric</strong>. Nedan presenteras data för de 6 första observationerna av inkomst och hur variabeln skiljer sig.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1"><span class="co"># Jämförelse av inkomst, inkomst kodad som faktorvariabel samt </span></a>
<a class="sourceLine" id="cb232-2" title="2"><span class="co"># inkomst kodad som faktorvariabel konverterad till numerisk variabel igen</span></a>
<a class="sourceLine" id="cb232-3" title="3"> <span class="kw">list</span>(<span class="kw">head</span>(df<span class="op">$</span>inkomst), <span class="kw">head</span>(<span class="kw">factor</span>(df<span class="op">$</span>inkomst)),  <span class="kw">head</span>(<span class="kw">as.numeric</span>(<span class="kw">factor</span>(df<span class="op">$</span>inkomst))))</a>
<a class="sourceLine" id="cb232-4" title="4"><span class="op">&gt;</span><span class="st"> </span>[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb232-5" title="5"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">13941</span> <span class="dv">39664</span> <span class="dv">13168</span> <span class="dv">28809</span> <span class="dv">55952</span> <span class="dv">12495</span></a>
<a class="sourceLine" id="cb232-6" title="6"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb232-7" title="7"><span class="er">&gt;</span><span class="st"> </span>[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb232-8" title="8"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">13941</span> <span class="dv">39664</span> <span class="dv">13168</span> <span class="dv">28809</span> <span class="dv">55952</span> <span class="dv">12495</span></a>
<a class="sourceLine" id="cb232-9" title="9"><span class="op">&gt;</span><span class="st"> </span><span class="dv">280</span> Levels<span class="op">:</span><span class="st"> </span><span class="dv">3978</span> <span class="dv">5710</span> <span class="dv">5958</span> <span class="dv">8074</span> <span class="dv">8196</span> <span class="dv">8226</span> <span class="dv">8332</span> <span class="dv">8363</span> <span class="dv">8729</span> <span class="dv">8746</span> <span class="dv">8996</span> <span class="dv">9058</span> ... <span class="dv">57382</span></a>
<a class="sourceLine" id="cb232-10" title="10"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb232-11" title="11"><span class="er">&gt;</span><span class="st"> </span>[[<span class="dv">3</span>]]</a>
<a class="sourceLine" id="cb232-12" title="12"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>]  <span class="dv">52</span> <span class="dv">254</span>  <span class="dv">44</span> <span class="dv">181</span> <span class="dv">279</span>  <span class="dv">39</span></a>
<a class="sourceLine" id="cb232-13" title="13"><span class="co"># Funktionen head() ger de 6 första elementen.</span></a></code></pre></div>
<p>Vi önskar nu skapa en faktor av variabeln <strong>alder</strong>, som är på ordinal datanivå även om den anges som numerisk med kategorierna <em>0,1,2</em>. Kodningen är dessutom lite märklig, eftersom det lägsta numeriska värdet korresponderar till den högsta datakategorin. När vi ska konverterar denna numeriska variabel till en factor används därför två argument. Dels <strong>ordered</strong> för att ange att faktorn är på ordinal skalnivå, dels <strong>levels</strong> där ordningen på faktornivåerna anges.
För förtydliga ändrar vi sedan namn på nivåerna. Med <strong>str()</strong> ser vi nu att variabeln <strong>alder_cat</strong> är en faktor med tre nivåer, där nivåerna har en inbördes rangordning.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="co"># Gör variabel till faktor och ändra ordningen så är 2 är minst, sedan 1 och sedan 0</span></a>
<a class="sourceLine" id="cb233-2" title="2"> df<span class="op">$</span>alder_cat &lt;-<span class="st"> </span>df<span class="op">$</span>alder</a>
<a class="sourceLine" id="cb233-3" title="3"><span class="co"># Ordningen speciferas när en factor skapas</span></a>
<a class="sourceLine" id="cb233-4" title="4"> df<span class="op">$</span>alder_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>alder, </a>
<a class="sourceLine" id="cb233-5" title="5">                        <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>), </a>
<a class="sourceLine" id="cb233-6" title="6">                        <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb233-7" title="7"><span class="co"># Ändra namn på nivåerna </span></a>
<a class="sourceLine" id="cb233-8" title="8"> <span class="kw">levels</span>(df<span class="op">$</span>alder_cat)[<span class="kw">levels</span>(df<span class="op">$</span>alder_cat) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;65-79 år&quot;</span></a>
<a class="sourceLine" id="cb233-9" title="9"> <span class="kw">levels</span>(df<span class="op">$</span>alder_cat)[<span class="kw">levels</span>(df<span class="op">$</span>alder_cat) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> &quot;50-64 år&quot;</span></a>
<a class="sourceLine" id="cb233-10" title="10"> <span class="kw">levels</span>(df<span class="op">$</span>alder_cat)[<span class="kw">levels</span>(df<span class="op">$</span>alder_cat) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> &quot;18-49 år&quot;</span></a>
<a class="sourceLine" id="cb233-11" title="11"><span class="co"># Undersök faktorn</span></a>
<a class="sourceLine" id="cb233-12" title="12"> <span class="kw">str</span>(df<span class="op">$</span>alder_cat)</a>
<a class="sourceLine" id="cb233-13" title="13"><span class="op">&gt;</span><span class="st">  </span>Ord.factor w<span class="op">/</span><span class="st"> </span><span class="dv">3</span> levels <span class="st">&quot;18-49 år&quot;</span><span class="op">&lt;</span><span class="st">&quot;50-64 år&quot;</span><span class="op">&lt;</span>..<span class="op">:</span><span class="st"> </span><span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> ...</a>
<a class="sourceLine" id="cb233-14" title="14"> <span class="kw">levels</span>(df<span class="op">$</span>alder_cat)</a>
<a class="sourceLine" id="cb233-15" title="15"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">&quot;18-49 år&quot;</span> <span class="st">&quot;50-64 år&quot;</span> <span class="st">&quot;65-79 år&quot;</span></a></code></pre></div>
<p>För somliga analyser är det praktiskt att arbeta med binära variabler som representerar kategorierna istället för att använda faktor-variabeln. Binära variabler som representerar kategorier kallas för <em>dummy-variabler</em> och sådana används ofta i regressionsanalys. Det är därför, precis som tidigare för binära variabler, vanligt att ett datamaterial innehåller en och samma kategorivariabel kodad både som en faktor och som dummy-variabler.</p>
<p>Notera att det med <em>dummy-variabeler</em> inte är möjligt att ta hänsyn till om variablers kategorier kan rangordnas.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="co"># Skapa binära variabler för respektive ålderskategori </span></a>
<a class="sourceLine" id="cb234-2" title="2"> df<span class="op">$</span>alder_<span class="dv">1849</span> &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb234-3" title="3"> df<span class="op">$</span>alder_<span class="dv">1849</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb234-4" title="4"> df<span class="op">$</span>alder_<span class="dv">1849</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb234-5" title="5"> df<span class="op">$</span>alder_<span class="dv">1849</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb234-6" title="6"></a>
<a class="sourceLine" id="cb234-7" title="7"> df<span class="op">$</span>alder_<span class="dv">5064</span> &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb234-8" title="8"> df<span class="op">$</span>alder_<span class="dv">5064</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb234-9" title="9"> df<span class="op">$</span>alder_<span class="dv">5064</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb234-10" title="10"> df<span class="op">$</span>alder_<span class="dv">5064</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb234-11" title="11"></a>
<a class="sourceLine" id="cb234-12" title="12"> df<span class="op">$</span>alder_<span class="dv">6579</span> &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb234-13" title="13"> df<span class="op">$</span>alder_<span class="dv">6579</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb234-14" title="14"> df<span class="op">$</span>alder_<span class="dv">6579</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb234-15" title="15"> df<span class="op">$</span>alder_<span class="dv">6579</span>[df<span class="op">$</span>alder <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a></code></pre></div>
</div>
<div id="tabeller-och-figurer-1" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Tabeller och figurer</h3>
<p>Det är när vi har flera kategorier som funktionerna <strong>table()</strong> och <strong>prop.table()</strong> framför allt kommer till sin rätt.
Det går visserligen att arbeta med de enskilda dummy-variabler, men koden blir lätt omfattande.</p>
<p>Vi illustrerar <strong>table()</strong> nedan med att analysera variabeln ålder, <strong>alder_cat</strong>.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="co"># Skapar tabell med frekvenser</span></a>
<a class="sourceLine" id="cb235-2" title="2"> freq_table_alder &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>alder_cat)</a>
<a class="sourceLine" id="cb235-3" title="3"> freq_table_alder</a>
<a class="sourceLine" id="cb235-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb235-5" title="5"><span class="er">&gt;</span><span class="st"> </span><span class="dv">18-49</span> år <span class="dv">50-64</span> år <span class="dv">65-79</span> år </a>
<a class="sourceLine" id="cb235-6" title="6"><span class="op">&gt;</span><span class="st">       </span><span class="dv">66</span>      <span class="dv">150</span>       <span class="dv">64</span></a>
<a class="sourceLine" id="cb235-7" title="7"><span class="co"># Skapa tabell med andelar </span></a>
<a class="sourceLine" id="cb235-8" title="8"> prop_table_alder &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_alder)</a>
<a class="sourceLine" id="cb235-9" title="9"> prop_table_alder</a>
<a class="sourceLine" id="cb235-10" title="10"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb235-11" title="11"><span class="er">&gt;</span><span class="st">  </span><span class="dv">18-49</span> år  <span class="dv">50-64</span> år  <span class="dv">65-79</span> år </a>
<a class="sourceLine" id="cb235-12" title="12"><span class="op">&gt;</span><span class="st"> </span><span class="fl">0.2357143</span> <span class="fl">0.5357143</span> <span class="fl">0.2285714</span></a></code></pre></div>
<p>I regel är det önskvärt att snygga till tabellen genom att kombinera både frekvenser och andelar.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"> table_alder &lt;-<span class="st"> </span><span class="kw">cbind</span>(freq_table_alder, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table_alder, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb236-2" title="2"> <span class="kw">colnames</span>(table_alder) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Frekvens&quot;</span>, <span class="st">&quot;Procent (%)&quot;</span>)</a>
<a class="sourceLine" id="cb236-3" title="3"> table_alder </a>
<a class="sourceLine" id="cb236-4" title="4"><span class="op">&gt;</span><span class="st">          </span>Frekvens <span class="kw">Procent</span> (%)</a>
<a class="sourceLine" id="cb236-5" title="5"><span class="op">&gt;</span><span class="st"> </span><span class="dv">18-49</span> år       <span class="dv">66</span>        <span class="fl">23.6</span></a>
<a class="sourceLine" id="cb236-6" title="6"><span class="op">&gt;</span><span class="st"> </span><span class="dv">50-64</span> år      <span class="dv">150</span>        <span class="fl">53.6</span></a>
<a class="sourceLine" id="cb236-7" title="7"><span class="op">&gt;</span><span class="st"> </span><span class="dv">65-79</span> år       <span class="dv">64</span>        <span class="fl">22.9</span></a></code></pre></div>
<p>För kategorivariabler med fler kategorier än två blir relationen mellan tabeller och figurer och tydlig. Vi använder nämligen främst stapeldiagram för att redovisa frekvenser eller andelar för en kategorivariabel. Om vi har många kategorier kan <strong>dotchart()</strong> vara ett alternativ och om kategorierna är heltal används ofta <strong>stolpdiagram</strong>. Nedan presenteras två stapeldiagram, ett med frekvenser och ett med andelar.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1"><span class="co"># Stapeldiagram baserat på tabellen med frekvenser</span></a>
<a class="sourceLine" id="cb237-2" title="2"> <span class="kw">barplot</span>(freq_table_alder, </a>
<a class="sourceLine" id="cb237-3" title="3">         <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-208-1.png" width="384" /></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1"><span class="co"># Stapeldiagram baserat på tabellen med andelar</span></a>
<a class="sourceLine" id="cb238-2" title="2"> bar_alder &lt;-<span class="st"> </span><span class="kw">barplot</span>(prop_table_alder, </a>
<a class="sourceLine" id="cb238-3" title="3">                      <span class="dt">ylab =</span> <span class="st">&quot;Andel)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-208-2.png" width="384" /></p>
<p>Figurerna ovan kan förbättras på motsvarande sätt som för de binära variablerna.</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-209-1.png" width="768" /></p>
<button title="figur2" type="button" onclick="if(document.getElementById(&#39;figur2&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;figur2&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;figur2&#39;) .style.display=&#39;none&#39;}">
Visa kod för figur
</button>
<div id="figur2" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" title="1"><span class="co"># Nedanstående kod innehåller delar som presenteras i kapitlet om figurer.</span></a>
<a class="sourceLine" id="cb239-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb239-3" title="3"><span class="co"># Stapeldiagram baserat på tabellen med frekvenser</span></a>
<a class="sourceLine" id="cb239-4" title="4"><span class="kw">barplot</span>(freq_table_alder, </a>
<a class="sourceLine" id="cb239-5" title="5">        <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>,   </a>
<a class="sourceLine" id="cb239-6" title="6">        <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb239-7" title="7">        <span class="dt">border =</span> <span class="st">&quot;lightblue&quot;</span>)</a>
<a class="sourceLine" id="cb239-8" title="8">bar_alder &lt;-<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table_alder,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb239-9" title="9">                     <span class="dt">ylab =</span> <span class="st">&quot;Procent (%)&quot;</span>,   </a>
<a class="sourceLine" id="cb239-10" title="10">                     <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb239-11" title="11">                     <span class="dt">border =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb239-12" title="12">                     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>))</a>
<a class="sourceLine" id="cb239-13" title="13"><span class="kw">text</span>(<span class="dt">x=</span>bar_alder, <span class="dt">y=</span> <span class="dv">100</span><span class="op">*</span>prop_table_alder <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table_alder,<span class="dv">1</span>), <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
</div>
</div>
<p></br></p>
<p>Vad man bör har i åtanke när man skapar stapeldiagram är huruvida kategorierna avstånd bör vara korrekt representerade i figuren. Består kategorierna av nominal eller ordinalskala är avståndet oviktigt och ofta har man då, per automatik, samma avstånd. Om variabeln däremot är diskret eller till exempel är årtal eller datum måste avståndet mellan staplarna överensstämma med kategoriernas avstånd. Detta görs automatiskt i stolpdiagram.</p>
<p>Vi illustrerar nedan med variabeln <strong>mat</strong> som mäter antalet matinköp i veckan. När vi undersöker variabeln upptäcker vi att ingen har gjort 6 eller 7 inköp, däremot har 7 stycken svarat 8 gånger. Vi måste alltså skapa en figur som korrekt representerar avståndet mellan 5 och 8 gånger när frekvenserna för dessa antal redovisas.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1"><span class="co"># Version 1</span></a>
<a class="sourceLine" id="cb240-2" title="2"><span class="co"># Matematiskt korrekt figur, men ej estetiskt tilltalande </span></a>
<a class="sourceLine" id="cb240-3" title="3"> freq_table_mat &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>mat)</a>
<a class="sourceLine" id="cb240-4" title="4"> <span class="kw">plot</span>(freq_table_mat,      <span class="co"># Tabell</span></a>
<a class="sourceLine" id="cb240-5" title="5">      <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>,      <span class="co"># Namn på y-axel</span></a>
<a class="sourceLine" id="cb240-6" title="6">      <span class="dt">bty =</span><span class="st">&quot;l&quot;</span>,            <span class="co"># Ta bort delar av box-kring figur</span></a>
<a class="sourceLine" id="cb240-7" title="7">      <span class="dt">xlab =</span> <span class="st">&quot;Antal matinköp per vecka&quot;</span>)  <span class="co"># Namn på x-axel</span></a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-211-1.png" width="384" /></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1"><span class="co"># Version 2</span></a>
<a class="sourceLine" id="cb241-2" title="2"><span class="co"># Skapa faktornivåer från minsta till största värdet med min(df$mat):max(df$mat)</span></a>
<a class="sourceLine" id="cb241-3" title="3"> df<span class="op">$</span>mat_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>mat, <span class="dt">levels=</span><span class="kw">min</span>(df<span class="op">$</span>mat)<span class="op">:</span><span class="kw">max</span>(df<span class="op">$</span>mat))  </a>
<a class="sourceLine" id="cb241-4" title="4"><span class="co"># Skapa en frekvenstabell</span></a>
<a class="sourceLine" id="cb241-5" title="5"> freq_table_mat &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>mat_cat)</a>
<a class="sourceLine" id="cb241-6" title="6"><span class="co"># Använder barplot för att skapa en semi-korrekt figur, men som är estetiskt tilltalande. Här finns extra kod  </span></a>
<a class="sourceLine" id="cb241-7" title="7"> <span class="kw">barplot</span>(freq_table_mat, </a>
<a class="sourceLine" id="cb241-8" title="8">        <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>,    <span class="co"># Ta bort linje som annars syns för kategori 6 och 7</span></a>
<a class="sourceLine" id="cb241-9" title="9">        <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,   <span class="co"># Byt färg</span></a>
<a class="sourceLine" id="cb241-10" title="10">        <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>,      <span class="co"># Namn på y-axel</span></a>
<a class="sourceLine" id="cb241-11" title="11">        <span class="dt">xlab =</span> <span class="st">&quot;Antal matinköp per vecka&quot;</span>)  <span class="co"># Namn på x-axel</span></a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-211-2.png" width="384" /></p>
<p>En vanlig typ av kategorivariabel är variabler med <strong>likertskala</strong> som är en skala vilken mäter olika attityder hos respondenten. Ofta är det önsvärt att för flera sådana ge en samlad översikt. Med hjälp av en tabell kan vi beskriva tre likertvariabler som finns i datasetet som mäter attityder till förbud av cigaretter, cannabis och alkohol.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="co"># Skapa faktorer av de likertskalorna </span></a>
<a class="sourceLine" id="cb242-2" title="2"> df<span class="op">$</span>cigaretter_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>cigaretter, <span class="dt">levels =</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb242-3" title="3"> <span class="kw">levels</span>(df<span class="op">$</span>cigaretter_cat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mycket positiv&quot;</span>, <span class="st">&quot;Ganska positiv&quot;</span>, <span class="st">&quot;Varken positiv eller negativ&quot;</span>,<span class="st">&quot; Ganska negativ&quot;</span>, <span class="st">&quot;Mycket negativ&quot;</span>) </a>
<a class="sourceLine" id="cb242-4" title="4"> df<span class="op">$</span>cannabis_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>cannabis, <span class="dt">levels =</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb242-5" title="5"> <span class="kw">levels</span>(df<span class="op">$</span>cannabis_cat ) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mycket positiv&quot;</span>, <span class="st">&quot;Ganska positiv&quot;</span>, <span class="st">&quot;Varken positiv eller negativ&quot;</span>,<span class="st">&quot; Ganska negativ&quot;</span>, <span class="st">&quot;Mycket negativ&quot;</span>) </a>
<a class="sourceLine" id="cb242-6" title="6"></a>
<a class="sourceLine" id="cb242-7" title="7"> df<span class="op">$</span>alkohol_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>alkohol, <span class="dt">levels =</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb242-8" title="8"> <span class="kw">levels</span>(df<span class="op">$</span>alkohol_cat ) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mycket positiv&quot;</span>, <span class="st">&quot;Ganska positiv&quot;</span>, <span class="st">&quot;Varken positiv eller negativ&quot;</span>,<span class="st">&quot; Ganska negativ&quot;</span>, <span class="st">&quot;Mycket negativ&quot;</span>)</a>
<a class="sourceLine" id="cb242-9" title="9"><span class="co"># Skapa frekvenstabeller för varje likert-skala</span></a>
<a class="sourceLine" id="cb242-10" title="10"> freq_table_cigaretter &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>cigaretter_cat)</a>
<a class="sourceLine" id="cb242-11" title="11"> freq_table_cannabis &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>cannabis_cat)</a>
<a class="sourceLine" id="cb242-12" title="12"> freq_table_alkohol &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>alkohol_cat)</a>
<a class="sourceLine" id="cb242-13" title="13"> freq_table_ban &lt;-<span class="st"> </span><span class="kw">rbind</span>(freq_table_alkohol,</a>
<a class="sourceLine" id="cb242-14" title="14">                         freq_table_cannabis,</a>
<a class="sourceLine" id="cb242-15" title="15">                         freq_table_cigaretter)</a>
<a class="sourceLine" id="cb242-16" title="16"> <span class="kw">rownames</span>(freq_table_ban) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;alkoholförbud?&quot;</span>, <span class="st">&quot;cannabisförbud?&quot;</span>, <span class="st">&quot;rökförbud?&quot;</span>)</a>
<a class="sourceLine" id="cb242-17" title="17"><span class="co"># Skapa en tabell innehållande procent för alla likertskalor </span></a>
<a class="sourceLine" id="cb242-18" title="18"> likert_tabell &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(freq_table_alkohol), <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb242-19" title="19">                  <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(freq_table_cannabis), <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb242-20" title="20">                  <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(freq_table_cigaretter), <span class="dv">1</span>) )</a>
<a class="sourceLine" id="cb242-21" title="21"> <span class="kw">rownames</span>(likert_tabell) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;alkohol?&quot;</span>, <span class="st">&quot;cannabis?&quot;</span>, <span class="st">&quot;cigaretter?&quot;</span>)</a></code></pre></div>
<p>Vi erhåller följande två tabeller som beskriver dessa attitydfrågor.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" title="1"><span class="co"># Likertvariablerna presenteras med radvisa antal</span></a>
<a class="sourceLine" id="cb243-2" title="2"> freq_table_ban</a>
<a class="sourceLine" id="cb243-3" title="3"><span class="op">&gt;</span><span class="st">                 </span>Mycket positiv Ganska positiv Varken positiv eller negativ</a>
<a class="sourceLine" id="cb243-4" title="4"><span class="op">&gt;</span><span class="st"> </span>alkoholförbud?              <span class="dv">14</span>             <span class="dv">13</span>                           <span class="dv">18</span></a>
<a class="sourceLine" id="cb243-5" title="5"><span class="op">&gt;</span><span class="st"> </span>cannabisförbud?            <span class="dv">114</span>             <span class="dv">61</span>                           <span class="dv">46</span></a>
<a class="sourceLine" id="cb243-6" title="6"><span class="op">&gt;</span><span class="st"> </span>rökförbud?                  <span class="dv">45</span>             <span class="dv">62</span>                           <span class="dv">49</span></a>
<a class="sourceLine" id="cb243-7" title="7"><span class="op">&gt;</span><span class="st">                  </span>Ganska negativ Mycket negativ</a>
<a class="sourceLine" id="cb243-8" title="8"><span class="op">&gt;</span><span class="st"> </span>alkoholförbud?               <span class="dv">50</span>            <span class="dv">185</span></a>
<a class="sourceLine" id="cb243-9" title="9"><span class="op">&gt;</span><span class="st"> </span>cannabisförbud?              <span class="dv">31</span>             <span class="dv">28</span></a>
<a class="sourceLine" id="cb243-10" title="10"><span class="op">&gt;</span><span class="st"> </span>rökförbud?                   <span class="dv">58</span>             <span class="dv">66</span></a>
<a class="sourceLine" id="cb243-11" title="11"><span class="co"># Likertvariablerna presentera med radvisa procent </span></a>
<a class="sourceLine" id="cb243-12" title="12"> likert_tabell</a>
<a class="sourceLine" id="cb243-13" title="13"><span class="op">&gt;</span><span class="st">             </span>Mycket positiv Ganska positiv Varken positiv eller negativ</a>
<a class="sourceLine" id="cb243-14" title="14"><span class="op">&gt;</span><span class="st"> </span>alkohol?               <span class="fl">5.0</span>            <span class="fl">4.6</span>                          <span class="fl">6.4</span></a>
<a class="sourceLine" id="cb243-15" title="15"><span class="op">&gt;</span><span class="st"> </span>cannabis?             <span class="fl">40.7</span>           <span class="fl">21.8</span>                         <span class="fl">16.4</span></a>
<a class="sourceLine" id="cb243-16" title="16"><span class="op">&gt;</span><span class="st"> </span>cigaretter?           <span class="fl">16.1</span>           <span class="fl">22.1</span>                         <span class="fl">17.5</span></a>
<a class="sourceLine" id="cb243-17" title="17"><span class="op">&gt;</span><span class="st">              </span>Ganska negativ Mycket negativ</a>
<a class="sourceLine" id="cb243-18" title="18"><span class="op">&gt;</span><span class="st"> </span>alkohol?               <span class="fl">17.9</span>           <span class="fl">66.1</span></a>
<a class="sourceLine" id="cb243-19" title="19"><span class="op">&gt;</span><span class="st"> </span>cannabis?              <span class="fl">11.1</span>           <span class="fl">10.0</span></a>
<a class="sourceLine" id="cb243-20" title="20"><span class="op">&gt;</span><span class="st"> </span>cigaretter?            <span class="fl">20.7</span>           <span class="fl">23.6</span></a></code></pre></div>
<p>På motsvarande sätt som i tabellform är det önskvärt att i en och samma figur redovisa attitydfrågorna. Koden för att göra detta är omfattande, framförallt på grund av att få procentenheter på staplarna. Du behöver dock inte förstå alla delar av koden, däremot kan du försöka modifiera den och se vad som händer. Du kan återkomma till koden när du läst figurkapitlet.</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-214-1.png" width="864" /></p>
<button title="likert" type="button" onclick="if(document.getElementById(&#39;likert&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;likert&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;likert&#39;) .style.display=&#39;none&#39;}">
Visa kod för figur
</button>
<div id="likert" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="co"># Skapa tillräckligt stora marginaler</span></a>
<a class="sourceLine" id="cb244-2" title="2"> <span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">12</span>,<span class="dv">4</span>,<span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb244-3" title="3"><span class="co"># Skapa tabellobjekt</span></a>
<a class="sourceLine" id="cb244-4" title="4"> mybar &lt;-<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">t</span>(likert_tabell),   <span class="co"># Tabellen måste transponeras (vridas) med t() för att ge kolumnprocent </span></a>
<a class="sourceLine" id="cb244-5" title="5">                 <span class="dt">main =</span> <span class="st">&quot;Hur ställer Du dig till att i Sverige ha ett totalt förbud mot att sälja...&quot;</span>,   <span class="co"># Lämplig titel</span></a>
<a class="sourceLine" id="cb244-6" title="6">                 <span class="dt">horiz =</span> <span class="ot">TRUE</span>,                                             <span class="co"># Horisontella stapeldiagram</span></a>
<a class="sourceLine" id="cb244-7" title="7">                 <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;brown3&quot;</span>, <span class="st">&quot;brown1&quot;</span>, <span class="st">&quot;lightyellow&quot;</span>, <span class="st">&quot;cadetblue2&quot;</span>, <span class="st">&quot;cadetblue4&quot;</span>),  <span class="co"># Kategorifärger</span></a>
<a class="sourceLine" id="cb244-8" title="8">                 <span class="dt">xlab=</span><span class="st">&quot;Procent (%)&quot;</span>,          <span class="co"># Namn på x-axeln</span></a>
<a class="sourceLine" id="cb244-9" title="9">                 <span class="dt">las=</span><span class="dv">1</span>,                       <span class="co"># Vänd nämnen för x-axeln</span></a>
<a class="sourceLine" id="cb244-10" title="10">                 <span class="dt">cex.names=</span><span class="fl">1.5</span>,               <span class="co"># Storlek på olika texter i figur</span></a>
<a class="sourceLine" id="cb244-11" title="11">                 <span class="dt">cex.axis=</span><span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb244-12" title="12">                 <span class="dt">cex.lab =</span><span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb244-13" title="13">                 <span class="dt">cex.main=</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb244-14" title="14"><span class="co"># En vertikal linje vid 50%</span></a>
<a class="sourceLine" id="cb244-15" title="15"><span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(<span class="dv">50</span>))                        </a>
<a class="sourceLine" id="cb244-16" title="16"><span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, </a>
<a class="sourceLine" id="cb244-17" title="17">       <span class="dt">inset =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.9</span>),</a>
<a class="sourceLine" id="cb244-18" title="18">       <span class="kw">c</span>(<span class="st">&quot;Mycket positiv&quot;</span>, <span class="st">&quot;Ganska positiv&quot;</span>, <span class="st">&quot;Varken positiv eller negativ&quot;</span>,<span class="st">&quot; Ganska negativ&quot;</span>, <span class="st">&quot;Mycket negativ&quot;</span>), </a>
<a class="sourceLine" id="cb244-19" title="19">       <span class="dt">fill=</span> <span class="kw">c</span>(<span class="st">&quot;brown3&quot;</span>, <span class="st">&quot;brown1&quot;</span>, <span class="st">&quot;lightyellow&quot;</span>, <span class="st">&quot;cadetblue2&quot;</span>, <span class="st">&quot;cadetblue4&quot;</span>), </a>
<a class="sourceLine" id="cb244-20" title="20">       <span class="dt">horiz=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb244-21" title="21">       <span class="dt">cex=</span><span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb244-22" title="22">       <span class="dt">xpd =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb244-23" title="23">       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb244-24" title="24"></a>
<a class="sourceLine" id="cb244-25" title="25"><span class="co"># Skapa koordinater för att rita in procent i kategorierna</span></a>
<a class="sourceLine" id="cb244-26" title="26"><span class="co"># Likert 1</span></a>
<a class="sourceLine" id="cb244-27" title="27"><span class="co"># x-koordinat ges av följande kod</span></a>
<a class="sourceLine" id="cb244-28" title="28"> coord_x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">cumsum</span>(likert_tabell[<span class="dv">1</span>,]))</a>
<a class="sourceLine" id="cb244-29" title="29"> coord_x_<span class="dv">1</span> &lt;-<span class="st"> </span>coord_x_<span class="dv">1</span>[<span class="op">-</span><span class="kw">length</span>(coord_x_<span class="dv">1</span>)] <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(coord_x_<span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb244-30" title="30"><span class="co"># y-koordinat ges av följande kod</span></a>
<a class="sourceLine" id="cb244-31" title="31"> coord_y_<span class="dv">1</span> &lt;-<span class="st"> </span>mybar[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb244-32" title="32"> <span class="kw">text</span>(<span class="dt">x =</span> coord_x_<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb244-33" title="33">      <span class="dt">y =</span> coord_y_<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb244-34" title="34">      <span class="dt">labels =</span> <span class="kw">paste</span>(likert_tabell[<span class="dv">1</span>,], <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb244-35" title="35">      <span class="dt">cex =</span> <span class="fl">1.2</span>)   <span class="co"># Procentvärden hämtas från tabellen</span></a>
<a class="sourceLine" id="cb244-36" title="36"></a>
<a class="sourceLine" id="cb244-37" title="37"><span class="co"># Likert 2 </span></a>
<a class="sourceLine" id="cb244-38" title="38">coord_x_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">cumsum</span>(likert_tabell[<span class="dv">2</span>,]))</a>
<a class="sourceLine" id="cb244-39" title="39">coord_x_<span class="dv">2</span> &lt;-<span class="st"> </span>coord_x_<span class="dv">2</span>[<span class="op">-</span><span class="kw">length</span>(coord_x_<span class="dv">2</span>)] <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(coord_x_<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb244-40" title="40">coord_y_<span class="dv">2</span> &lt;-<span class="st"> </span>mybar[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb244-41" title="41"><span class="kw">text</span>(<span class="dt">x =</span> coord_x_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb244-42" title="42">     <span class="dt">y =</span> coord_y_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb244-43" title="43">     <span class="dt">labels =</span> <span class="kw">paste</span>(likert_tabell[<span class="dv">2</span>,], <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb244-44" title="44">     <span class="dt">cex =</span> <span class="fl">1.2</span>) </a>
<a class="sourceLine" id="cb244-45" title="45"></a>
<a class="sourceLine" id="cb244-46" title="46"><span class="co"># Likert 3 </span></a>
<a class="sourceLine" id="cb244-47" title="47">coord_x_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">cumsum</span>(likert_tabell[<span class="dv">3</span>,]))</a>
<a class="sourceLine" id="cb244-48" title="48">coord_x_<span class="dv">3</span> &lt;-<span class="st"> </span>coord_x_<span class="dv">3</span>[<span class="op">-</span><span class="kw">length</span>(coord_x_<span class="dv">3</span>)] <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(coord_x_<span class="dv">3</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb244-49" title="49">coord_y_<span class="dv">3</span> &lt;-<span class="st"> </span>mybar[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb244-50" title="50"><span class="kw">text</span>(<span class="dt">x =</span> coord_x_<span class="dv">3</span>, </a>
<a class="sourceLine" id="cb244-51" title="51">     <span class="dt">y =</span> coord_y_<span class="dv">3</span>, </a>
<a class="sourceLine" id="cb244-52" title="52">     <span class="dt">labels =</span> <span class="kw">paste</span>(likert_tabell[<span class="dv">3</span>,], <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb244-53" title="53">     <span class="dt">cex =</span> <span class="fl">1.2</span>) </a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="inferens-2" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Inferens</h3>
<p>Om vi har flera kategorier kan det vara av intressera att testa hypotetiskt fördelning av andelar i populationen. Då kan vi genomföra ett <em>goodness of fit-test (GOF)</em> som undersöker överstämmelsen mellan observerad data och denna hypotetiska population (som är vår fördelning). Anta att vi i ett OSU observerar en kategorivariabeln med <span class="math inline">\(k\)</span> kategorier. Hypoteserna kan då formuleras utifrån andelar i respektive kategori, dvs
+ <span class="math inline">\(H_0: p_1 = p_{1,H_0}, p_2 = p_{2,H_0}, \ldots, p_k = p_{k,H_0}\)</span>
+ <span class="math inline">\(H_1:\)</span> Minst en av andelarna inte överstämmer med värdet under nollhypotesen.</p>
<ul>
<li>Ett GOF-test kan genomföras med teststatistikan
<span class="math display">\[\chi^2 = \sum_{i=1}^k\dfrac{ (O_i - E_i)^2}{E_i}= \dfrac{ (O_1 - E_1)^2}{E_1}+ \dfrac{ (O_2 - E_2)^2}{E_2}+\ldots+ \dfrac{ (O_k - E_k)^2}{E_k}\]</span>
där <span class="math inline">\(O_i\)</span> är antalet observerade frekvenser i kategori <span class="math inline">\(i\)</span> och <span class="math inline">\(E_i\)</span> är antalet förväntade frekvenser, enligt nollhypotesen, i kategori <span class="math inline">\(i\)</span>. Teststatistikan är <span class="math inline">\(\chi^2\)</span>-fördelad med <span class="math inline">\(k-1\)</span> frihetsgrader givet att nollhypotesen är sann och ett OSU. Dessutom krävs att alla förväntade frekvenser är större än 5 (analogt med normalapproximation).</li>
</ul>
<p>För att genomföra <span class="math inline">\(\chi^2\)</span>-metoden i R används funktionen <strong>chisq.test()</strong>, som vi tillämpar på en frekvenstabell.</p>
<p><strong>Exempel: Åldersfördelning</strong></p>
<p><em>Vi spekulerar i att det i populationen finns 65% i ålderskategorin 18-49 år, 20% i ålderskategorin 50-64 år och 15% ålderskategorin 65-79 år. Målet är att jämföra stickprovets åldersfördelning med populationen. Eftersom det finns flera kategorier formuleras hypoteserna som
<span class="math display">\[H_0: p_1 = 0.3,p_2 = 0.45,p_3 = 0.25\]</span> mot
<span class="math display">\[H_1: \text{Minst en av andelarna inte överstämmer med värdet under nollhypotesen.}\]</span></em></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" title="1"><span class="co"># chitvå-test baserat på den tidigar frekvenstabellen</span></a>
<a class="sourceLine" id="cb245-2" title="2"> resultat &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table_alder,         <span class="co"># Frekvenstabell</span></a>
<a class="sourceLine" id="cb245-3" title="3">                        <span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.45</span>, <span class="fl">0.25</span>),   <span class="co"># Andelar under H0</span></a>
<a class="sourceLine" id="cb245-4" title="4">                        <span class="dt">correct =</span> <span class="ot">FALSE</span>)          <span class="co"># Ej kontuitetskorrektion</span></a>
<a class="sourceLine" id="cb245-5" title="5"><span class="co"># Frihetsgrader</span></a>
<a class="sourceLine" id="cb245-6" title="6"> resultat<span class="op">$</span>parameter</a>
<a class="sourceLine" id="cb245-7" title="7"><span class="op">&gt;</span><span class="st"> </span>df </a>
<a class="sourceLine" id="cb245-8" title="8"><span class="op">&gt;</span><span class="st">  </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb245-9" title="9"><span class="co"># X2obs </span></a>
<a class="sourceLine" id="cb245-10" title="10"> resultat<span class="op">$</span>statistic</a>
<a class="sourceLine" id="cb245-11" title="11"><span class="op">&gt;</span><span class="st"> </span>X<span class="op">-</span>squared </a>
<a class="sourceLine" id="cb245-12" title="12"><span class="op">&gt;</span><span class="st">  </span><span class="fl">8.942857</span></a>
<a class="sourceLine" id="cb245-13" title="13"><span class="co"># p-värde</span></a>
<a class="sourceLine" id="cb245-14" title="14"> resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb245-15" title="15"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.01143097</span></a></code></pre></div>
<p><em>Resultatet (<span class="math inline">\(\chi^2=8.94, fg=2\)</span>) ger ett lågt <span class="math inline">\(p\)</span>-värde (<span class="math inline">\(p=0.011\)</span>). Tolkningen är att om observerad data är slumpmässigt draget från befolkningen är det låg sannolikhet att observera en så stor skillnad eller större mellan de observerade värdena och de förväntade. Data stämmer således inte överens med nollhypotesen. Vad <span class="math inline">\(p\)</span>-värdet inte besvarar är varför överstämmelsen är låg. Antigen är vår nollhypotes fel, dvs fördelningen i populationen faktiskt är en annan, eller så innebär ett lågt <span class="math inline">\(p\)</span>-värde att urvalet inte är ett OSU.</em></p>
</div>
</div>
<div id="samband-mellan-kategorivariabler" class="section level2">
<h2><span class="header-section-number">5.4</span> Samband mellan kategorivariabler</h2>
<div id="tabeller-och-figurer-2" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Tabeller och figurer</h3>
<p>För att beskriva ett samband mellan två kategorivariabler används korstabeller på motsvarande sätt som för binära variabler. Det innebär att vi måste reflektera över om det är frekvenser eller andelar som är det relevanta att redovisa. Dessutom måste vi i funktionen <strong>prop.table()</strong> ange om andelarna ska beräknas radvis, kolumnvis eller baserat på totalen.</p>
<p>Vi illustrerar med att undersöka om det finns ett samband mellan ålder och uppfattningen om TV-reklam för spel bör vara tillåtet eller inte.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1"><span class="co"># Skapa en korstabell med frekvenser för ålder och reklam. </span></a>
<a class="sourceLine" id="cb246-2" title="2"><span class="co"># Vi antar i detta fall att ålder är oberoende variabler och reklam beroende och placerar därför</span></a>
<a class="sourceLine" id="cb246-3" title="3"><span class="co"># ålder kolumnvis och reklam radvis</span></a>
<a class="sourceLine" id="cb246-4" title="4"> freq_table_reklam_alder &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>reklam, df<span class="op">$</span>alder_cat) </a>
<a class="sourceLine" id="cb246-5" title="5"><span class="co"># Beräkna kolumnprocent för </span></a>
<a class="sourceLine" id="cb246-6" title="6"> prop_table_reklam_alder &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_reklam_alder, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb246-7" title="7"> prop_table_reklam_alder</a>
<a class="sourceLine" id="cb246-8" title="8"><span class="op">&gt;</span><span class="st">                         </span></a>
<a class="sourceLine" id="cb246-9" title="9"><span class="er">&gt;</span><span class="st">                           </span><span class="dv">18-49</span> år  <span class="dv">50-64</span> år  <span class="dv">65-79</span> år</a>
<a class="sourceLine" id="cb246-10" title="10"><span class="op">&gt;</span><span class="st">   </span>Har ej tagit ställning <span class="fl">0.4242424</span> <span class="fl">0.2933333</span> <span class="fl">0.4218750</span></a>
<a class="sourceLine" id="cb246-11" title="11"><span class="op">&gt;</span><span class="st">   </span>Ja                     <span class="fl">0.3484848</span> <span class="fl">0.3000000</span> <span class="fl">0.3750000</span></a>
<a class="sourceLine" id="cb246-12" title="12"><span class="op">&gt;</span><span class="st">   </span>Nej                    <span class="fl">0.2272727</span> <span class="fl">0.4066667</span> <span class="fl">0.2031250</span></a></code></pre></div>
<p>Resulatet visar att i stickprovet är den negativa uppfattningen om TV-reklam och spel störst i åldergruppen 50-64 år, där 41% menar att TV-reklam för spel ej bör vara tillåtet. I åldersgrupperna 18-49 år och 65-79 år har 42% inte tagit ställning.</p>
<p>Nu ska vi se om vi kan kombinera frekvenser och procent i samma figur.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1"><span class="co"># Skapa en tabell med procent </span></a>
<a class="sourceLine" id="cb247-2" title="2"> procent_table_reklam_alder &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table_reklam_alder,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb247-3" title="3"><span class="co"># Kombinera frekvenser och procent genom att ta varannan kolumn och kombinera dem</span></a>
<a class="sourceLine" id="cb247-4" title="4"> table_reklam_alder &lt;-<span class="st"> </span><span class="kw">cbind</span>(freq_table_reklam_alder[,<span class="dv">1</span>], <span class="kw">paste</span>(procent_table_reklam_alder[,<span class="dv">1</span>], <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb247-5" title="5">                             freq_table_reklam_alder[,<span class="dv">2</span>], <span class="kw">paste</span>(procent_table_reklam_alder[,<span class="dv">2</span>], <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb247-6" title="6">                             freq_table_reklam_alder[,<span class="dv">3</span>], <span class="kw">paste</span>(procent_table_reklam_alder[,<span class="dv">3</span>], <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb247-7" title="7"> <span class="kw">colnames</span>(table_reklam_alder)  &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="kw">levels</span>(df<span class="op">$</span>alder_cat)[<span class="dv">1</span>], <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb247-8" title="8">                                        <span class="kw">levels</span>(df<span class="op">$</span>alder_cat)[<span class="dv">2</span>], <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb247-9" title="9">                                        <span class="kw">levels</span>(df<span class="op">$</span>alder_cat)[<span class="dv">3</span>], <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb247-10" title="10"> table_reklam_alder</a>
<a class="sourceLine" id="cb247-11" title="11"><span class="op">&gt;</span><span class="st">                        </span><span class="dv">18-49</span> år         <span class="dv">50-64</span> år         <span class="dv">65-79</span> år        </a>
<a class="sourceLine" id="cb247-12" title="12"><span class="op">&gt;</span><span class="st"> </span>Har ej tagit ställning <span class="st">&quot;28&quot;</span>     <span class="st">&quot;42.4%&quot;</span> <span class="st">&quot;44&quot;</span>     <span class="st">&quot;29.3%&quot;</span> <span class="st">&quot;27&quot;</span>     <span class="st">&quot;42.2%&quot;</span></a>
<a class="sourceLine" id="cb247-13" title="13"><span class="op">&gt;</span><span class="st"> </span>Ja                     <span class="st">&quot;23&quot;</span>     <span class="st">&quot;34.8%&quot;</span> <span class="st">&quot;45&quot;</span>     <span class="st">&quot;30%&quot;</span>   <span class="st">&quot;24&quot;</span>     <span class="st">&quot;37.5%&quot;</span></a>
<a class="sourceLine" id="cb247-14" title="14"><span class="op">&gt;</span><span class="st"> </span>Nej                    <span class="st">&quot;15&quot;</span>     <span class="st">&quot;22.7%&quot;</span> <span class="st">&quot;61&quot;</span>     <span class="st">&quot;40.7%&quot;</span> <span class="st">&quot;13&quot;</span>     <span class="st">&quot;20.3%&quot;</span></a></code></pre></div>
<p>Vi ska nu för första gången i detta material se hur vi kan exportera en tabell. Vi kommer återkomma till detta i kapitlet om tabeller, men det kan vara bra att redan nu få ett enkelt exempel. För att exportera till ordbehandlingsprogram krävs ett paketet som heter <strong>xtable</strong>. Installera därför detta paket. Detta paket exporterar tabeller till antingen html-format eller till LaTeX. Eftersom vanliga ordbehandlingsprogram är vanligare exporterar vi här till html-format.</p>
<p>För att exportera krävs bara några rader koder som sparar tabellen i en fil. Vi kan alltså inte klippa och klistra direkt från R. Filen sparas i din working-directory. Använd <strong>getwd()</strong> om du är osäker på vilken denna är. Se till att spara tabellen så att du enkelt hittar den och att den hör samman med ditt projekt.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="co"># Exportera tabell till HTML-dokument table_reklam_alder.html</span></a>
<a class="sourceLine" id="cb248-2" title="2"> <span class="kw">library</span>(<span class="st">&quot;xtable&quot;</span>)</a>
<a class="sourceLine" id="cb248-3" title="3"> <span class="kw">print</span>(<span class="kw">xtable</span>(table_reklam_alder),         <span class="co"># Använd xtable()</span></a>
<a class="sourceLine" id="cb248-4" title="4">       <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>,                      <span class="co"># Skriv tabellen i html-formet</span></a>
<a class="sourceLine" id="cb248-5" title="5">       <span class="dt">file =</span> <span class="st">&quot;table_reklam_alder.html&quot;</span>)   <span class="co"># Spara tabellen</span></a></code></pre></div>
<p>Slutligen öppnar du html-filen i en webläsare, markera allt (ctrl+A på Windows och Kommando-A på MacOS), kopiera och klistra sedan in i ditt ordbehandlingsprogram. Nu har du en tabell du kan modifiera! Den stora vinsten här är att du slipper bekymra dig om felinmatningar, inte själv utformningen. Att förändra tabellen estetiskt kan du vänta med till rapporten närmar sig att bli klar.</p>
<p>För att redovisa samband mellan kategorivariabler används i regel stapeldiagram. Nedan redovisas sambandet mellan ålder och reklam med de olika alternativ som finns för stapeldiagram, dvs frekvenser eller andelar samt om stapeldiagrammen ska vara uppdelade eller ej. Av alternativen är D förmodligen att föredra om detta samband ska utvärderas, men notera att detta alternativ inte ger någon information om uppfattningen om antalet i grupperna. Då hade B fungerat bättre.</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-220-1.png" width="960" /></p>
<button title="barplots" type="button" onclick="if(document.getElementById(&#39;barplots&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;barplots&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;barplots&#39;) .style.display=&#39;none&#39;}">
Visa kod för figur
</button>
<div id="barplots" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1"><span class="co"># Funktion för att skapa 4 figurer i en. Introduceras i figur-kapitlet. </span></a>
<a class="sourceLine" id="cb249-2" title="2"><span class="co"># Du behöver INTE i detta avsnitt lära dig all kod nedan.</span></a>
<a class="sourceLine" id="cb249-3" title="3"> <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb249-4" title="4"><span class="co"># Funktion för att skapa större marginaler så vi </span></a>
<a class="sourceLine" id="cb249-5" title="5"> <span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb249-6" title="6"><span class="co"># Figur A</span></a>
<a class="sourceLine" id="cb249-7" title="7"> <span class="kw">barplot</span>(freq_table_reklam_alder, </a>
<a class="sourceLine" id="cb249-8" title="8">         <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>,</a>
<a class="sourceLine" id="cb249-9" title="9">         <span class="dt">main =</span> <span class="st">&quot;A&quot;</span>,</a>
<a class="sourceLine" id="cb249-10" title="10">         <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>))</a>
<a class="sourceLine" id="cb249-11" title="11"> <span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, </a>
<a class="sourceLine" id="cb249-12" title="12">        <span class="dt">xpd =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-13" title="13">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-14" title="14">        <span class="dt">inset =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb249-15" title="15">        <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">row.names</span>(freq_table_reklam_alder)),  </a>
<a class="sourceLine" id="cb249-16" title="16">        <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>),</a>
<a class="sourceLine" id="cb249-17" title="17">        <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb249-18" title="18"><span class="co"># Figur B</span></a>
<a class="sourceLine" id="cb249-19" title="19"> <span class="kw">barplot</span>(freq_table_reklam_alder, </a>
<a class="sourceLine" id="cb249-20" title="20">         <span class="dt">beside =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb249-21" title="21">         <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>, </a>
<a class="sourceLine" id="cb249-22" title="22">         <span class="dt">main =</span> <span class="st">&quot;B&quot;</span>,</a>
<a class="sourceLine" id="cb249-23" title="23">         <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>))</a>
<a class="sourceLine" id="cb249-24" title="24"> <span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, </a>
<a class="sourceLine" id="cb249-25" title="25">        <span class="dt">xpd =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-26" title="26">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-27" title="27">        <span class="dt">inset =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb249-28" title="28">        <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">row.names</span>(freq_table_reklam_alder)),  </a>
<a class="sourceLine" id="cb249-29" title="29">        <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>),</a>
<a class="sourceLine" id="cb249-30" title="30">        <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb249-31" title="31"><span class="co"># Figur C</span></a>
<a class="sourceLine" id="cb249-32" title="32"> <span class="kw">barplot</span>(prop_table_reklam_alder, </a>
<a class="sourceLine" id="cb249-33" title="33">         <span class="dt">ylab =</span> <span class="st">&quot;Andel&quot;</span>, </a>
<a class="sourceLine" id="cb249-34" title="34">         <span class="dt">main =</span> <span class="st">&quot;C&quot;</span>,</a>
<a class="sourceLine" id="cb249-35" title="35">         <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>))</a>
<a class="sourceLine" id="cb249-36" title="36"> <span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, </a>
<a class="sourceLine" id="cb249-37" title="37">        <span class="dt">xpd =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-38" title="38">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-39" title="39">        <span class="dt">inset =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb249-40" title="40">        <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">row.names</span>(freq_table_reklam_alder)),  </a>
<a class="sourceLine" id="cb249-41" title="41">        <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>),</a>
<a class="sourceLine" id="cb249-42" title="42">        <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb249-43" title="43"><span class="co"># Figur D</span></a>
<a class="sourceLine" id="cb249-44" title="44"> <span class="kw">barplot</span>(prop_table_reklam_alder, </a>
<a class="sourceLine" id="cb249-45" title="45">         <span class="dt">beside =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb249-46" title="46">         <span class="dt">ylab =</span> <span class="st">&quot;Andel&quot;</span>, </a>
<a class="sourceLine" id="cb249-47" title="47">         <span class="dt">main =</span> <span class="st">&quot;D&quot;</span>,</a>
<a class="sourceLine" id="cb249-48" title="48">         <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>))</a>
<a class="sourceLine" id="cb249-49" title="49"> <span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, </a>
<a class="sourceLine" id="cb249-50" title="50">        <span class="dt">xpd =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-51" title="51">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb249-52" title="52">        <span class="dt">inset =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb249-53" title="53">        <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">row.names</span>(freq_table_reklam_alder)),  </a>
<a class="sourceLine" id="cb249-54" title="54">        <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;coral2&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>),</a>
<a class="sourceLine" id="cb249-55" title="55">        <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="inferens-3" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Inferens</h3>
<p>Det finns ett antal metoder för att analysera samband mellan kategorivariabler. Utgångspunkten i detta kapitel är man genom att korstabulera variablerna erhåller en korstabell som innehåller frekvenser för kombinationerna av variablernas kategorier. I respektive cell finns således observerade frekvenser <span class="math inline">\(O_{ij}\)</span> i cellen på rad <span class="math inline">\(i\)</span> och kolumn <span class="math inline">\(j\)</span>. Tabellen nedan illustrerar.</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Kolumn 1</th>
<th align="center">Kolumn 2</th>
<th align="center"></th>
<th align="center">Kolumn k</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Rad 1</strong></td>
<td align="center"><span class="math inline">\(O_{11}\)</span></td>
<td align="center"><span class="math inline">\(O_{12}\)</span></td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center"><span class="math inline">\(O_{1k}\)</span></td>
<td align="center">Radsumma 1</td>
</tr>
<tr class="even">
<td align="center"><strong>Rad 2</strong></td>
<td align="center"><span class="math inline">\(O_{21}\)</span></td>
<td align="center"><span class="math inline">\(O_{22}\)</span></td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center"><span class="math inline">\(O_{2k}\)</span></td>
<td align="center">Radsumma 2</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\ddots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td align="center"><strong>Rad r</strong></td>
<td align="center"><span class="math inline">\(O_{r1}\)</span></td>
<td align="center"><span class="math inline">\(O_{r2}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(O_{rk}\)</span></td>
<td align="center">Radsumma r</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">Kolumnsumma 1</td>
<td align="center">Kolumnsumma 2</td>
<td align="center"><span class="math inline">\(\cdots\)</span></td>
<td align="center">Kolumnsumma k</td>
<td align="center">Totalsumma</td>
</tr>
</tbody>
</table>
<p>Tabellen kan användas för att genomföra ett oberoendetest där nollhypotesen är
<span class="math inline">\(H_0: \text{Variablerna är oberoende}\)</span> vs <span class="math inline">\(H_1: \text{Variablerna är beroende}\)</span>.
Notera att testet inte har någon riktning.</p>
<ul>
<li>Ett oberoendetest kan genomföras med teststatistikan
<span class="math display">\[\chi^2 = \sum_{i=1}^r\sum_{j=1}^k \dfrac{(O_{ij} - E_{ij})^2}{E_{ij}} = \dfrac{(O_{11} - E_{11})^2}{E_{11}}+ \dfrac{(O_{12} - E_{12})^2}{E_{12}}+\ldots+ \dfrac{ (O_{rk} - E_{rk})^2}{E_{rk}},\]</span>
där <span class="math inline">\(E_{ij} = \dfrac{\text{Radsumma i}\cdot \text{Kolumnsumma j}}{\text{Totalsumma}}\)</span> är de förväntade frekvenserna givet att variablerna är oberoende. Teststatistikan är <span class="math inline">\(\chi^2\)</span>-fördelad med <span class="math inline">\((r-1)(k-1)\)</span> frihetsgrader om <span class="math inline">\(H_0\)</span> är sann och om antalet förväntade frekvenser i alla celler är större än 5. Det framräknade värdet i stickprovet, <span class="math inline">\(\chi^2_{obs}\)</span>, jämförs sedan med denna fördelning. Genom att se hur extremt värdet är i högra svansen erhålls <span class="math inline">\(p\)</span>-värdet.</li>
</ul>
<p>Notera att denna typ av sambandsanalys inte tar någon hänsyn till om variablerna går att rangordna. Alltså använder vi eventuellt inte all tillgänglig information. För variabler på ordinalskala finns alternativa metoder som därför eventuellt har högre styrka, exempelvis Spearmans rangkorrelation. Detta faktum innebär dock inte att <span class="math inline">\(\chi^2\)</span>-metoden inte kan användas.</p>
<p>Vi illustrerar testet genom att studera sambandet mellan ålder och uppfattningen om TV-reklam för spel bör vara tillåtet eller inte. Baserat på en OSU bestående av <span class="math inline">\(n=280\)</span> testar vi nu om dessa variabler är oberoende.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="co"># Vi använder freq_table_reklam_alder från tidigare uppgift</span></a>
<a class="sourceLine" id="cb250-2" title="2"> test_reklam_alder &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table_reklam_alder, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb250-3" title="3"> test_reklam_alder</a>
<a class="sourceLine" id="cb250-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb250-5" title="5"><span class="er">&gt;</span><span class="st">   </span>Pearson<span class="st">&#39;s Chi-squared test</span></a>
<a class="sourceLine" id="cb250-6" title="6"><span class="st">&gt; </span></a>
<a class="sourceLine" id="cb250-7" title="7"><span class="st">&gt; data:  freq_table_reklam_alder</span></a>
<a class="sourceLine" id="cb250-8" title="8"><span class="st">&gt; X-squared = 12.265, df = 4, p-value = 0.01549</span></a></code></pre></div>
<p>Det låga <span class="math inline">\(p\)</span>-värdet <span class="math inline">\(p=0.015\)</span> säger att om variablerna är oberoende så är det låg sannolikhet att hitta så stora avvikelser som gör eller större. Data stämmer inte överens med nollhypotesen om inget beroende och vi lutar åt att faktiskt variablerna faktiskt är beroende.</p>
<p>En manuell version av testet ger exakt samma resultat.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1"><span class="co"># Chitvå-test manuellt</span></a>
<a class="sourceLine" id="cb251-2" title="2"> Oij &lt;-<span class="st"> </span>freq_table_reklam_alder</a>
<a class="sourceLine" id="cb251-3" title="3"> Ri &lt;-<span class="st"> </span><span class="kw">rowSums</span>(Oij)</a>
<a class="sourceLine" id="cb251-4" title="4"> Ki &lt;-<span class="st"> </span><span class="kw">colSums</span>(Oij)</a>
<a class="sourceLine" id="cb251-5" title="5"> Totalsumma &lt;-<span class="st"> </span><span class="kw">sum</span>(Oij)</a>
<a class="sourceLine" id="cb251-6" title="6"><span class="co"># Skapa en matrix med förväntade frekvenser </span></a>
<a class="sourceLine" id="cb251-7" title="7"> Eij &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="kw">dim</span>(Oij)[<span class="dv">1</span>], <span class="kw">dim</span>(Oij)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb251-8" title="8"> Eij[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">1</span>]<span class="op">*</span>Ki[<span class="dv">1</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-9" title="9"> Eij[<span class="dv">1</span>,<span class="dv">2</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">1</span>]<span class="op">*</span>Ki[<span class="dv">2</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-10" title="10"> Eij[<span class="dv">1</span>,<span class="dv">3</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">1</span>]<span class="op">*</span>Ki[<span class="dv">3</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-11" title="11"> Eij[<span class="dv">2</span>,<span class="dv">1</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">2</span>]<span class="op">*</span>Ki[<span class="dv">1</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-12" title="12"> Eij[<span class="dv">2</span>,<span class="dv">2</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">2</span>]<span class="op">*</span>Ki[<span class="dv">2</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-13" title="13"> Eij[<span class="dv">2</span>,<span class="dv">3</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">2</span>]<span class="op">*</span>Ki[<span class="dv">3</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-14" title="14"> Eij[<span class="dv">3</span>,<span class="dv">1</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">3</span>]<span class="op">*</span>Ki[<span class="dv">1</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-15" title="15"> Eij[<span class="dv">3</span>,<span class="dv">2</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">3</span>]<span class="op">*</span>Ki[<span class="dv">2</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-16" title="16"> Eij[<span class="dv">3</span>,<span class="dv">3</span>] &lt;-<span class="st">  </span>Ri[<span class="dv">3</span>]<span class="op">*</span>Ki[<span class="dv">3</span>]<span class="op">/</span>Totalsumma</a>
<a class="sourceLine" id="cb251-17" title="17"><span class="co"># Beräkna observerat chitvå-värde och p-värde</span></a>
<a class="sourceLine" id="cb251-18" title="18"> X2obs &lt;-<span class="st"> </span><span class="kw">sum</span>((Oij <span class="op">-</span><span class="st"> </span>Eij)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>Eij)</a>
<a class="sourceLine" id="cb251-19" title="19"> fg &lt;-<span class="st"> </span>(<span class="kw">dim</span>(Oij)[<span class="dv">1</span>] <span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">dim</span>(Oij)[<span class="dv">2</span>] <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb251-20" title="20"> p_value &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(X2obs, fg)</a></code></pre></div>
</div>
</div>
<div id="övningar-3" class="section level2">
<h2><span class="header-section-number">5.5</span> Övningar</h2>
<div id="övning-5.1" class="section level3 unnumbered">
<h3>Övning 5.1</h3>
<p>En undersökning ville testa jämföra andelen vänsterhänta bland män och kvinnor. I studien drogs ett OSU av med 30 kvinnor varav 6 var vänsterhänta samt ett OSU med 29 män varav 4 är vänsterhänta. Är andelen vänsterhänta mellan kvinnor och män samma? Redovisa p-värdet som du erhåller från ett test av nollhypotesen. Tolka resultatet.</p>
<button title="q501" type="button" onclick="if(document.getElementById(&#39;q501&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q501&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q501&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q501" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb252-2" title="2"> x_f &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb252-3" title="3"> n_f &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb252-4" title="4"> x_m &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb252-5" title="5"> n_m&lt;-<span class="st"> </span><span class="dv">29</span></a>
<a class="sourceLine" id="cb252-6" title="6"> <span class="kw">prop.test</span>(<span class="kw">c</span>(x_f,x_m), <span class="kw">c</span>(n_f, n_m), <span class="dt">correct =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb252-7" title="7"><span class="op">&gt;</span><span class="st"> </span>Warning <span class="cf">in</span> <span class="kw">prop.test</span>(<span class="kw">c</span>(x_f, x_m), <span class="kw">c</span>(n_f, n_m), <span class="dt">correct =</span> <span class="ot">FALSE</span>)<span class="op">:</span><span class="st"> </span>Chi<span class="op">-</span>squared</a>
<a class="sourceLine" id="cb252-8" title="8"><span class="op">&gt;</span><span class="st"> </span>approximation may be incorrect</a>
<a class="sourceLine" id="cb252-9" title="9"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-10" title="10"><span class="er">&gt;</span><span class="st">   </span><span class="dv">2</span><span class="op">-</span>sample test <span class="cf">for</span> equality of proportions without continuity</a>
<a class="sourceLine" id="cb252-11" title="11"><span class="op">&gt;</span><span class="st">   </span>correction</a>
<a class="sourceLine" id="cb252-12" title="12"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-13" title="13"><span class="er">&gt;</span><span class="st"> </span>data<span class="op">:</span><span class="st">  </span><span class="kw">c</span>(x_f, x_m) out of <span class="kw">c</span>(n_f, n_m)</a>
<a class="sourceLine" id="cb252-14" title="14"><span class="op">&gt;</span><span class="st"> </span>X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">0.40357</span>, df =<span class="st"> </span><span class="dv">1</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.5252</span></a>
<a class="sourceLine" id="cb252-15" title="15"><span class="op">&gt;</span><span class="st"> </span>alternative hypothesis<span class="op">:</span><span class="st"> </span>two.sided</a>
<a class="sourceLine" id="cb252-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb252-17" title="17"><span class="er">&gt;</span><span class="st">  </span><span class="fl">-0.1282953</span>  <span class="fl">0.2524333</span></a>
<a class="sourceLine" id="cb252-18" title="18"><span class="op">&gt;</span><span class="st"> </span>sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb252-19" title="19"><span class="er">&gt;</span><span class="st">   </span>prop <span class="dv">1</span>   prop <span class="dv">2</span> </a>
<a class="sourceLine" id="cb252-20" title="20"><span class="op">&gt;</span><span class="st"> </span><span class="fl">0.200000</span> <span class="fl">0.137931</span></a>
<a class="sourceLine" id="cb252-21" title="21"></a>
<a class="sourceLine" id="cb252-22" title="22"><span class="co"># Undersök om de förväntade frekvenserna är större än 5 i alla celler</span></a>
<a class="sourceLine" id="cb252-23" title="23"> freq_table &lt;-<span class="st"> </span><span class="kw">as.table</span>( <span class="kw">matrix</span>( <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">24</span>, <span class="dv">4</span>, <span class="dv">25</span>), <span class="dv">2</span>, <span class="dv">2</span>) )</a>
<a class="sourceLine" id="cb252-24" title="24"> test &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb252-25" title="25"><span class="op">&gt;</span><span class="st"> </span>Warning <span class="cf">in</span> <span class="kw">chisq.test</span>(freq_table, <span class="dt">correct =</span> <span class="ot">FALSE</span>)<span class="op">:</span><span class="st"> </span>Chi<span class="op">-</span>squared approximation</a>
<a class="sourceLine" id="cb252-26" title="26"><span class="op">&gt;</span><span class="st"> </span>may be incorrect</a>
<a class="sourceLine" id="cb252-27" title="27"> test</a>
<a class="sourceLine" id="cb252-28" title="28"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-29" title="29"><span class="er">&gt;</span><span class="st">   </span>Pearson<span class="st">&#39;s Chi-squared test</span></a>
<a class="sourceLine" id="cb252-30" title="30"><span class="st">&gt; </span></a>
<a class="sourceLine" id="cb252-31" title="31"><span class="st">&gt; data:  freq_table</span></a>
<a class="sourceLine" id="cb252-32" title="32"><span class="st">&gt; X-squared = 0.40357, df = 1, p-value = 0.5252</span></a>
<a class="sourceLine" id="cb252-33" title="33"><span class="st"> test$expected</span></a>
<a class="sourceLine" id="cb252-34" title="34"><span class="st">&gt;           A         B</span></a>
<a class="sourceLine" id="cb252-35" title="35"><span class="st">&gt; A  5.084746  4.915254</span></a>
<a class="sourceLine" id="cb252-36" title="36"><span class="st">&gt; B 24.915254 24.084746</span></a></code></pre></div>
<p><span class="math inline">\(\chi^2\)</span>-testet går alltså inte att använda! Förutsättningen om förväntade frekvenser större än 5 i alla celler är inte uppfylld. Det finns alternativa test som Fishers exakta test, men dessa ingår inte på kursen.</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.2" class="section level3 unnumbered">
<h3>Övning 5.2</h3>
<p>Raghubir &amp; Srivastava (2009) undersökte effekten av storleken på sedlar och mynt på i vilken utsträckning pengarna används. Ett experiment genomfördes där 46 studenter fick en endollarssedel och 43 stycken studenter fick 4 stycken amerikanska 25 cents mynt, så kallade quarters. Studenterna fick sedan välja mellan att spara pengarna eller spendera dem på tuggummi och mintpastiller.</p>
<p>Nedan redovisas en sammanfattning av studien.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">1 dollar sedel</th>
<th align="center">4 quarters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spenderade pengarna</td>
<td align="center">12</td>
<td align="center">27</td>
</tr>
<tr class="even">
<td>Sparade pengarna</td>
<td align="center">34</td>
<td align="center">16</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>Skapa en tabell som deskriptivt redovisar sambandet</p></li>
<li><p>Skapa en figur som deskriptivt redovisar sambandet</p></li>
<li><p>Skatta skillnaden i andelar som spenderar pengar tillsammans med tillhörande 90% konfidensintervall.</p></li>
<li><p>Beräkna <span class="math inline">\(p\)</span>-värdet om givet att det inte finns någon skillnad mellan grupperna vad gäller andelen som spenderar pengarna.</p></li>
<li><p>Ge en utförlig tolkning av resultaten.</p></li>
<li><p>Litar du på resultaten? Är förutsättningarna uppfyllda?</p></li>
</ol>
<button title="q502" type="button" onclick="if(document.getElementById(&#39;q502&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q502&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q502&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q502" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb253-2" title="2"><span class="co"># a)</span></a>
<a class="sourceLine" id="cb253-3" title="3"> freq_table &lt;-<span class="st"> </span><span class="kw">as.table</span>( <span class="kw">matrix</span>( <span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">16</span>), <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb253-4" title="4"> <span class="kw">colnames</span>(freq_table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1 endollarsedel&quot;</span>, <span class="st">&quot;4 quarters&quot;</span>)</a>
<a class="sourceLine" id="cb253-5" title="5"> <span class="kw">rownames</span>(freq_table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Spenderade pengarna&quot;</span>, <span class="st">&quot;Sparade pengarna&quot;</span>)</a>
<a class="sourceLine" id="cb253-6" title="6"> prop_table &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb253-7" title="7"> table_bill_spending &lt;-<span class="st"> </span><span class="kw">cbind</span>(freq_table[,<span class="dv">1</span>], <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table[,<span class="dv">1</span>], <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb253-8" title="8">                             freq_table[,<span class="dv">2</span>], <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table[,<span class="dv">2</span>], <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb253-9" title="9"> <span class="kw">colnames</span>(table_bill_spending) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1 endollarsedel (n)&quot;</span>, <span class="st">&quot;1 dollarsedel (%)&quot;</span>, <span class="st">&quot;4 quarters (n)&quot;</span>, <span class="st">&quot;4 quarters  (%)&quot;</span>)</a>
<a class="sourceLine" id="cb253-10" title="10"> <span class="kw">rownames</span>(table_bill_spending) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Spenderade pengarna&quot;</span>, <span class="st">&quot;Sparade pengarna&quot;</span>)</a>
<a class="sourceLine" id="cb253-11" title="11"> table_bill_spending</a>
<a class="sourceLine" id="cb253-12" title="12">                    <span class="dv">1</span> <span class="kw">endollarsedel</span> (n) <span class="dv">1</span> <span class="kw">dollarsedel</span> (%) <span class="dv">4</span> <span class="kw">quarters</span> (n)</a>
<a class="sourceLine" id="cb253-13" title="13">Spenderade pengarna                  <span class="dv">12</span>              <span class="fl">26.1</span>             <span class="dv">27</span></a>
<a class="sourceLine" id="cb253-14" title="14">Sparade pengarna                     <span class="dv">34</span>              <span class="fl">73.9</span>             <span class="dv">16</span></a>
<a class="sourceLine" id="cb253-15" title="15">                    <span class="dv">4</span> <span class="kw">quarters</span>  (%)</a>
<a class="sourceLine" id="cb253-16" title="16">Spenderade pengarna            <span class="fl">62.8</span></a>
<a class="sourceLine" id="cb253-17" title="17">Sparade pengarna               <span class="fl">37.2</span></a>
<a class="sourceLine" id="cb253-18" title="18"> </a>
<a class="sourceLine" id="cb253-19" title="19"><span class="co"># b)</span></a>
<a class="sourceLine" id="cb253-20" title="20"> percentages_spending&lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>prop_table[<span class="dv">1</span>,], <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb253-21" title="21"> my_bar &lt;-<span class="st"> </span><span class="kw">barplot</span>(  percentages_spending, </a>
<a class="sourceLine" id="cb253-22" title="22">                     <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;1 dollarsedel&quot;</span>, <span class="st">&quot;4 quarters&quot;</span>), </a>
<a class="sourceLine" id="cb253-23" title="23">                     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>), </a>
<a class="sourceLine" id="cb253-24" title="24">                     <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb253-25" title="25">                     <span class="dt">border =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb253-26" title="26">                     <span class="dt">ylab =</span> <span class="st">&quot;Spenderade pengarna (%)&quot;</span>)</a>
<a class="sourceLine" id="cb253-27" title="27"> <span class="kw">text</span>(<span class="dt">x =</span> my_bar, <span class="dt">y =</span> percentages_spending <span class="op">+</span><span class="st"> </span><span class="dv">6</span>, </a>
<a class="sourceLine" id="cb253-28" title="28">     <span class="dt">labels =</span> <span class="kw">paste</span>(percentages_spending, <span class="st">&quot;%&quot;</span>,  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)) </a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1"></a>
<a class="sourceLine" id="cb254-2" title="2"><span class="co"># c) </span></a>
<a class="sourceLine" id="cb254-3" title="3"><span class="co"># Version 1</span></a>
<a class="sourceLine" id="cb254-4" title="4"> x1 &lt;-<span class="st"> </span>freq_table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb254-5" title="5"> x0 &lt;-<span class="st"> </span>freq_table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb254-6" title="6"> n1 &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb254-7" title="7"> n0 &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb254-8" title="8"> resultat &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1, x0), <span class="kw">c</span>(n1, n0), <span class="dt">conf.level =</span> <span class="fl">0.9</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb254-9" title="9"> p_differens &lt;-<span class="st"> </span>resultat<span class="op">$</span>estimate[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>resultat<span class="op">$</span>estimate[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb254-10" title="10"> p_differens_KI &lt;-<span class="st"> </span>resultat<span class="op">$</span>conf.int</a>
<a class="sourceLine" id="cb254-11" title="11"> p_differens</a>
<a class="sourceLine" id="cb254-12" title="12">    prop <span class="dv">1</span> </a>
<a class="sourceLine" id="cb254-13" title="13"><span class="fl">-0.3670374</span> </a>
<a class="sourceLine" id="cb254-14" title="14"> p_differens_KI</a>
<a class="sourceLine" id="cb254-15" title="15">[<span class="dv">1</span>] <span class="fl">-0.5284105</span> <span class="fl">-0.2056644</span></a>
<a class="sourceLine" id="cb254-16" title="16"><span class="kw">attr</span>(,<span class="st">&quot;conf.level&quot;</span>)</a>
<a class="sourceLine" id="cb254-17" title="17">[<span class="dv">1</span>] <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb254-18" title="18"></a>
<a class="sourceLine" id="cb254-19" title="19"><span class="co"># Version 2</span></a>
<a class="sourceLine" id="cb254-20" title="20"> p1hat &lt;-<span class="st"> </span>x1<span class="op">/</span>n1</a>
<a class="sourceLine" id="cb254-21" title="21"> p0hat &lt;-<span class="st"> </span>x0<span class="op">/</span>n0</a>
<a class="sourceLine" id="cb254-22" title="22"> p_diff &lt;-<span class="st"> </span>p1hat <span class="op">-</span><span class="st"> </span>p0hat</a>
<a class="sourceLine" id="cb254-23" title="23"> vp_diff &lt;-<span class="st"> </span>p1hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p1hat)<span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span>p0hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0hat)<span class="op">/</span>n0</a>
<a class="sourceLine" id="cb254-24" title="24"> alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb254-25" title="25"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb254-26" title="26"> ll &lt;-<span class="st"> </span>p_diff <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vp_diff)</a>
<a class="sourceLine" id="cb254-27" title="27"> ul &lt;-<span class="st"> </span>p_diff <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vp_diff)</a>
<a class="sourceLine" id="cb254-28" title="28"> p_diff_KI &lt;-<span class="st"> </span><span class="kw">c</span>(ll, ul)</a>
<a class="sourceLine" id="cb254-29" title="29"> p_diff</a>
<a class="sourceLine" id="cb254-30" title="30">[<span class="dv">1</span>] <span class="fl">-0.3670374</span></a>
<a class="sourceLine" id="cb254-31" title="31"> p_diff_KI</a>
<a class="sourceLine" id="cb254-32" title="32">[<span class="dv">1</span>] <span class="fl">-0.5284105</span> <span class="fl">-0.2056644</span></a>
<a class="sourceLine" id="cb254-33" title="33"> </a>
<a class="sourceLine" id="cb254-34" title="34"><span class="co"># d)</span></a>
<a class="sourceLine" id="cb254-35" title="35"><span class="co"># Version 1</span></a>
<a class="sourceLine" id="cb254-36" title="36"> p_value_p_differens &lt;-<span class="st"> </span>resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb254-37" title="37"> p_value_p_differens</a>
<a class="sourceLine" id="cb254-38" title="38">[<span class="dv">1</span>] <span class="fl">0.0004877499</span></a>
<a class="sourceLine" id="cb254-39" title="39"></a>
<a class="sourceLine" id="cb254-40" title="40"><span class="co"># Version 2</span></a>
<a class="sourceLine" id="cb254-41" title="41"> pooled_phat &lt;-<span class="st"> </span>(n1<span class="op">*</span>p1hat <span class="op">+</span><span class="st"> </span>n0<span class="op">*</span>p0hat)<span class="op">/</span>(n1 <span class="op">+</span><span class="st"> </span>n0)</a>
<a class="sourceLine" id="cb254-42" title="42"> zobs &lt;-<span class="st"> </span>(p1hat <span class="op">-</span><span class="st"> </span>p0hat)<span class="op">/</span><span class="kw">sqrt</span>(pooled_phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pooled_phat)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>n0))</a>
<a class="sourceLine" id="cb254-43" title="43"> p_value_p_diff &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zobs)))</a>
<a class="sourceLine" id="cb254-44" title="44"> p_value_p_diff</a>
<a class="sourceLine" id="cb254-45" title="45">[<span class="dv">1</span>] <span class="fl">0.0004877499</span></a></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li><p>Se formuleringar ovan om andelar, differens av andelar, KI och p-värde.</p></li>
<li><p>OSU (experiment) och normalapproximation gäller. Jag litar på resultaten.</p></li>
</ol>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.3" class="section level3 unnumbered">
<h3>Övning 5.3</h3>
<p>Rosa et al. (1998) undersökte om en typ av ‘’healers’’ hade förmåga att känna mänskliga kroppars så kallade energifält. Forskarna besökte en mässa för alternativmedicin och gjorde där ett experiment som gick ut på att healers skulle identifiera om undersökarens vänstra eller högre hand var närmst healern. Händerna var dolda under ett tygstycke. Totalt genomfördes 130 försök och av dessa lyckades healers identifera rätt hand 53 gånger. Undersök det finns belägg för denna förmåga bland healers.</p>
<p>Tolka resultatet!</p>
<button title="q503" type="button" onclick="if(document.getElementById(&#39;q503&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q503&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q503&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q503" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb255-2" title="2"><span class="co"># Version 1</span></a>
<a class="sourceLine" id="cb255-3" title="3"> x &lt;-<span class="st"> </span><span class="dv">53</span></a>
<a class="sourceLine" id="cb255-4" title="4"> n &lt;-<span class="st"> </span><span class="dv">130</span></a>
<a class="sourceLine" id="cb255-5" title="5"> resultat &lt;-<span class="st">  </span><span class="kw">prop.test</span>(<span class="dv">53</span>, <span class="dv">130</span>, <span class="dt">p =</span> <span class="fl">0.5</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb255-6" title="6"> p_value &lt;-<span class="st"> </span>resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb255-7" title="7"> p_value </a>
<a class="sourceLine" id="cb255-8" title="8">[<span class="dv">1</span>] <span class="fl">0.0352966</span></a>
<a class="sourceLine" id="cb255-9" title="9"> </a>
<a class="sourceLine" id="cb255-10" title="10"><span class="co"># Version 2</span></a>
<a class="sourceLine" id="cb255-11" title="11">phat &lt;-<span class="st"> </span>x<span class="op">/</span>n</a>
<a class="sourceLine" id="cb255-12" title="12">pH0 &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb255-13" title="13">z &lt;-<span class="st"> </span>(phat <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)<span class="op">/</span><span class="kw">sqrt</span>(pH0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pH0)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb255-14" title="14">p_value_v2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(z)</a>
<a class="sourceLine" id="cb255-15" title="15">p_value_v2</a>
<a class="sourceLine" id="cb255-16" title="16">[<span class="dv">1</span>] <span class="fl">0.0352966</span></a></code></pre></div>
<p>Givet att healers inte är bättre än slumpen, dvs <span class="math inline">\(H_0: p = 0.5\)</span>, så är sannolikheten
<span class="math inline">\(p=0.035\)</span> att observera ett så extremt värde som det studien ger. Hur tolkar vi detta rent praktiskt?</p>
<ol style="list-style-type: decimal">
<li><p>För det första ser vi att om det vore så att det skulle finnas en förmåga så verkar det snarare vara i negativ riktning, dvs att healers presterar sämre än slumpen.</p></li>
<li><p>För det andra är detta ett exempel på hur man inte ska förlita sig på enskilda studier och hypotesprövning allena. <span class="math inline">\(p\)</span>-värdet är inte särskilt lågt och det är rimligt att tro att resultat helt enkelt är ett slumpfynd och att healers presterar varken bättre eller sämre än slumpen.</p></li>
</ol>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.4" class="section level3 unnumbered">
<h3>Övning 5.4</h3>
<p>Gerritsen et al. (1998) ville jämföra kiurgi med spjälning av handleden för att hantera det som kallas karpaltunnelsyndrom, dvs smärta till följd av att nerver kläms i handleden. Du erhåller följande datamaterial från studien.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">treatment =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;splint&quot;</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;splint&quot;</span>, <span class="dv">23</span>), <span class="kw">rep</span>(<span class="st">&quot;surgery&quot;</span>, <span class="dv">67</span>), <span class="kw">rep</span>(<span class="st">&quot;surgery&quot;</span>, <span class="dv">6</span>)), </a>
<a class="sourceLine" id="cb256-2" title="2">                 <span class="dt">y =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;succesful&quot;</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;unsucsessful&quot;</span>,<span class="dv">23</span>), <span class="kw">rep</span>(<span class="st">&quot;succesful&quot;</span>, <span class="dv">67</span>), <span class="kw">rep</span>(<span class="st">&quot;unsucsessful&quot;</span>,<span class="dv">6</span>)))</a></code></pre></div>
<p>Undersökarna vill beräkna kvoten av andelar lyckade behandlingar (relativ risk), där spjälning är referensgrupp. Eftersom forskarna vill fatta beslut vill man att en hypotesprövning genomförs på 5% signifikansnivå.</p>
<button title="q504" type="button" onclick="if(document.getElementById(&#39;q504&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q504&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q504&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q504" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb257-2" title="2"> df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">treatment =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;splint&quot;</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;splint&quot;</span>, <span class="dv">23</span>), <span class="kw">rep</span>(<span class="st">&quot;surgery&quot;</span>, <span class="dv">67</span>),  <span class="kw">rep</span>(<span class="st">&quot;surgery&quot;</span>, <span class="dv">6</span>)), </a>
<a class="sourceLine" id="cb257-3" title="3">                 <span class="dt">y =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;succesful&quot;</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;unsucsessful&quot;</span>,<span class="dv">23</span>), <span class="kw">rep</span>(<span class="st">&quot;succesful&quot;</span>, <span class="dv">67</span>),   <span class="kw">rep</span>(<span class="st">&quot;unsucsessful&quot;</span>,<span class="dv">6</span>)))</a>
<a class="sourceLine" id="cb257-4" title="4"> freq_table &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>y, df<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb257-5" title="5"> prop_table &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table, <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb257-6" title="6"> phat_splint &lt;-<span class="st"> </span>prop_table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb257-7" title="7"> phat_surgery &lt;-<span class="st"> </span>prop_table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb257-8" title="8"> p_kvot &lt;-<span class="st"> </span>phat_surgery<span class="op">/</span>phat_splint </a>
<a class="sourceLine" id="cb257-9" title="9"> resultat &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb257-10" title="10"> p_kvot</a>
<a class="sourceLine" id="cb257-11" title="11">[<span class="dv">1</span>] <span class="fl">1.269635</span></a>
<a class="sourceLine" id="cb257-12" title="12"> resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb257-13" title="13">[<span class="dv">1</span>] <span class="fl">0.001792853</span></a></code></pre></div>
<p>En patient har 27% (p = 0.002) större chans till lyckad behandling om patienten genomgår kirurgi istället för behandling. Eftersom <span class="math inline">\(p&lt;0.05\)</span> förkastar vi på 5% signifikansnivå nollhypotesen om att kirurgi och spjälning är lika effektiva.</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.5" class="section level3 unnumbered">
<h3>Övning 5.5</h3>
<p>En sjuksköterska är anklagad för att ha mördat ett antal patienter. Som bevis jämför man dödligheten på skift där den anklagade har arbetat med skift där den anklagade inte har arbetat. Anta nu att du är domare i det aktuella fallet. Ladda in nedanstående tabell. Ställ upp en nollhypotes och analysera data och bilda dig en uppfattning om den anklagade är oskyldig.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1">accused &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;accused was working&quot;</span>, <span class="dv">40</span>), </a>
<a class="sourceLine" id="cb258-2" title="2">             <span class="kw">rep</span>(<span class="st">&quot;accused was working&quot;</span>, <span class="dv">217</span>), </a>
<a class="sourceLine" id="cb258-3" title="3">             <span class="kw">rep</span>(<span class="st">&quot;accused was not working&quot;</span>, <span class="dv">34</span>), </a>
<a class="sourceLine" id="cb258-4" title="4">             <span class="kw">rep</span>(<span class="st">&quot;accused was not working&quot;</span>, <span class="dv">1350</span>)) </a>
<a class="sourceLine" id="cb258-5" title="5">death &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;shifts with a death&quot;</span>, <span class="dv">40</span>), </a>
<a class="sourceLine" id="cb258-6" title="6">           <span class="kw">rep</span>(<span class="st">&quot;shifts without a death&quot;</span>,<span class="dv">217</span>), </a>
<a class="sourceLine" id="cb258-7" title="7">           <span class="kw">rep</span>(<span class="st">&quot;shifts with a death&quot;</span>, <span class="dv">34</span>), </a>
<a class="sourceLine" id="cb258-8" title="8">           <span class="kw">rep</span>(<span class="st">&quot;shifts without a death&quot;</span>, <span class="dv">1350</span>))</a>
<a class="sourceLine" id="cb258-9" title="9"><span class="kw">table</span>(accused, death)</a></code></pre></div>
<button title="q505" type="button" onclick="if(document.getElementById(&#39;q505&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q505&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q505&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q505" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb259-2" title="2">accused &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;accused was working&quot;</span>, <span class="dv">40</span>), </a>
<a class="sourceLine" id="cb259-3" title="3">             <span class="kw">rep</span>(<span class="st">&quot;accused was working&quot;</span>, <span class="dv">217</span>), </a>
<a class="sourceLine" id="cb259-4" title="4">             <span class="kw">rep</span>(<span class="st">&quot;accused was not working&quot;</span>, <span class="dv">34</span>), </a>
<a class="sourceLine" id="cb259-5" title="5">             <span class="kw">rep</span>(<span class="st">&quot;accused was not working&quot;</span>, <span class="dv">1350</span>)) </a>
<a class="sourceLine" id="cb259-6" title="6">death &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;shifts with a death&quot;</span>, <span class="dv">40</span>), </a>
<a class="sourceLine" id="cb259-7" title="7">           <span class="kw">rep</span>(<span class="st">&quot;shifts without a death&quot;</span>,<span class="dv">217</span>), </a>
<a class="sourceLine" id="cb259-8" title="8">           <span class="kw">rep</span>(<span class="st">&quot;shifts with a death&quot;</span>, <span class="dv">34</span>), </a>
<a class="sourceLine" id="cb259-9" title="9">           <span class="kw">rep</span>(<span class="st">&quot;shifts without a death&quot;</span>, <span class="dv">1350</span>))</a>
<a class="sourceLine" id="cb259-10" title="10">freq_table &lt;-<span class="st"> </span><span class="kw">table</span>(accused, death)</a>
<a class="sourceLine" id="cb259-11" title="11">freq_table</a>
<a class="sourceLine" id="cb259-12" title="12">                         death</a>
<a class="sourceLine" id="cb259-13" title="13">accused                   shifts with a death shifts without a death</a>
<a class="sourceLine" id="cb259-14" title="14">  accused was not working                  <span class="dv">34</span>                   <span class="dv">1350</span></a>
<a class="sourceLine" id="cb259-15" title="15">  accused was working                      <span class="dv">40</span>                    <span class="dv">217</span></a>
<a class="sourceLine" id="cb259-16" title="16">resultat &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table)</a>
<a class="sourceLine" id="cb259-17" title="17">resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb259-18" title="18">[<span class="dv">1</span>] <span class="fl">6.489411e-20</span></a></code></pre></div>
<p>Givet att det finns det inte skiljer sig åt mellan den anklagades skift och andras skift är det mycket liten sannolikhet att observera så många döda som vi observerar eller mer extremt
($p &lt; 0.001).</p>
<p>Kristen Gilbert var en amerikansk sjuksköterska som fick smeknamnet “Angel Death” efter ett antal misstänkta dödsfall på psykiatriska avdelningar där hon arbetade. Hon blev så småningom dömd för mord och avtjänar numera livstids fängelsestraff utan möjlighet till benådning.</p>
<p>Det är mycket viktigt att komma ihåg vad en jämförelse innebär.</p>
<ul>
<li>Ett litet <span class="math inline">\(p\)</span>-värde tyder på något avvikande</li>
<li>Ett litet <span class="math inline">\(p\)</span>-värde talar inte om VARFÖR det avviken. För detta krävs antaganden. Till exempel randomiserades inte Gilbert till avdelningarna. Låt säg att ventilationen på hennes skift alltid var sämre, med högre partikelhalter. Då skulle detta vara orsaken. För att vara säker på att det är Gilbert som orsakat dödsfallen krävs att vissa förutsättningar är uppfyllda, t ex att skiften är slumpmässigt tilldelade. Domstolen beaktade därför inte statistiken som bevis. Vad som skedde var dock att statistiken avslöjade ett mönster som gjorde att man undersökte fallen ytterligare och därför kunde gripa Gilbert.</li>
</ul>
<p>Den intresserade kan läsa här om hur statistiken användes i just detta fall:
<a href="http://www.stat.ucla.edu/~nchristo/statistics100B/article.pdf" class="uri">http://www.stat.ucla.edu/~nchristo/statistics100B/article.pdf</a></p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.6" class="section level3 unnumbered">
<h3>Övning 5.6</h3>
<p>En studie 1980 undersökte homosexuellas situation Sverige. En del av denna studie utgjordes bland annat en enkätundersökning. Ladda ner Lilla Enkäten som är txt-fil som finns i zip-filen “Enkäterna i csv-format” på <a href="https://riksarkivet.se/psidata/livet-som-gay" class="uri">https://riksarkivet.se/psidata/livet-som-gay</a>. Utgå från att data är insamlat med OSU och besvara sedan följande frågor:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Har den svarande själv talat om för någon heterosexuell bekant (som
inte bara är arbetskamrat) att den svarande är homo/bisexuell? Variabeln heter <em>TALAT_OM</em>.</p></li>
<li><p>Finns ett samband mellan kön (<strong>KOEN</strong>) och fråga a)?</p></li>
<li><p>Undersök samband mellan att känna skam eller ångest (<strong>SKAM</strong>) och <em>TALAT_OM</em>? Redovisa bortfall. Redovisa en figur.</p></li>
</ol>
<button title="q506" type="button" onclick="if(document.getElementById(&#39;q506&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q506&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q506&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q506" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb260-2" title="2"> df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/Lilla_enkaeten.txt&quot;</span>)</a>
<a class="sourceLine" id="cb260-3" title="3"></a>
<a class="sourceLine" id="cb260-4" title="4"><span class="co"># Undersök variabeln och variabelkategorierna</span></a>
<a class="sourceLine" id="cb260-5" title="5"> <span class="kw">summary</span>(df<span class="op">$</span>TALAT_OM)</a>
<a class="sourceLine" id="cb260-6" title="6"><span class="op">&gt;</span><span class="st">                  </span>Ja, för en bekant              Ja, för flera bakanta </a>
<a class="sourceLine" id="cb260-7" title="7"><span class="op">&gt;</span><span class="st">                                 </span><span class="dv">92</span>                                <span class="dv">466</span> </a>
<a class="sourceLine" id="cb260-8" title="8"><span class="op">&gt;</span><span class="st"> </span>Jag har inga heterosexuella vänner                                Nej </a>
<a class="sourceLine" id="cb260-9" title="9"><span class="op">&gt;</span><span class="st">                                  </span><span class="dv">8</span>                                <span class="dv">181</span></a>
<a class="sourceLine" id="cb260-10" title="10"> <span class="kw">table</span>(df<span class="op">$</span>TALAT_OM, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb260-11" title="11"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-12" title="12"><span class="er">&gt;</span><span class="st">                  </span>Ja, för en bekant              Ja, för flera bakanta </a>
<a class="sourceLine" id="cb260-13" title="13"><span class="op">&gt;</span><span class="st">                                 </span><span class="dv">92</span>                                <span class="dv">466</span> </a>
<a class="sourceLine" id="cb260-14" title="14"><span class="op">&gt;</span><span class="st"> </span>Jag har inga heterosexuella vänner                                Nej </a>
<a class="sourceLine" id="cb260-15" title="15"><span class="op">&gt;</span><span class="st">                                  </span><span class="dv">8</span>                                <span class="dv">181</span></a>
<a class="sourceLine" id="cb260-16" title="16"> </a>
<a class="sourceLine" id="cb260-17" title="17"><span class="co"># Skapar en tom variabel och koda sedan alla nej till 1 och övriga till 0</span></a>
<a class="sourceLine" id="cb260-18" title="18"> df<span class="op">$</span>EJ_TALAT_OM_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb260-19" title="19"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Ja, för en bekant&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb260-20" title="20"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Ja, för flera bakanta&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb260-21" title="21"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Jag har inga heterosexuella vänner&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb260-22" title="22"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Nej&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb260-23" title="23"></a>
<a class="sourceLine" id="cb260-24" title="24"><span class="co"># a)    </span></a>
<a class="sourceLine" id="cb260-25" title="25"> freq_table_EJ_TALAT_OM &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>EJ_TALAT_OM_bin)</a>
<a class="sourceLine" id="cb260-26" title="26"> x &lt;-<span class="st"> </span>freq_table_EJ_TALAT_OM[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb260-27" title="27"> n &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_EJ_TALAT_OM)</a>
<a class="sourceLine" id="cb260-28" title="28"> resultat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">prop.test</span>(x, n, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb260-29" title="29"> resultat_<span class="dv">1</span></a>
<a class="sourceLine" id="cb260-30" title="30"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-31" title="31"><span class="er">&gt;</span><span class="st">   </span><span class="dv">1</span><span class="op">-</span>sample proportions test without continuity correction</a>
<a class="sourceLine" id="cb260-32" title="32"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-33" title="33"><span class="er">&gt;</span><span class="st"> </span>data<span class="op">:</span><span class="st">  </span>x out of n, null probability <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb260-34" title="34"><span class="op">&gt;</span><span class="st"> </span>X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">198.43</span>, df =<span class="st"> </span><span class="dv">1</span>, p<span class="op">-</span>value <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></a>
<a class="sourceLine" id="cb260-35" title="35"><span class="op">&gt;</span><span class="st"> </span>alternative hypothesis<span class="op">:</span><span class="st"> </span>true p is not equal to <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb260-36" title="36"><span class="op">&gt;</span><span class="st"> </span><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb260-37" title="37"><span class="er">&gt;</span><span class="st">  </span><span class="fl">0.2129447</span> <span class="fl">0.2742972</span></a>
<a class="sourceLine" id="cb260-38" title="38"><span class="op">&gt;</span><span class="st"> </span>sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb260-39" title="39"><span class="er">&gt;</span><span class="st">         </span>p </a>
<a class="sourceLine" id="cb260-40" title="40"><span class="op">&gt;</span><span class="st"> </span><span class="fl">0.2423025</span></a>
<a class="sourceLine" id="cb260-41" title="41"> </a>
<a class="sourceLine" id="cb260-42" title="42"><span class="co"># b) </span></a>
<a class="sourceLine" id="cb260-43" title="43"><span class="co"># Undersök variabeln kön</span></a>
<a class="sourceLine" id="cb260-44" title="44"> <span class="kw">summary</span>(df<span class="op">$</span>KOEN)</a>
<a class="sourceLine" id="cb260-45" title="45"><span class="op">&gt;</span><span class="st"> </span>Kvinna    Man </a>
<a class="sourceLine" id="cb260-46" title="46"><span class="op">&gt;</span><span class="st">     </span><span class="dv">34</span>    <span class="dv">713</span></a>
<a class="sourceLine" id="cb260-47" title="47"> <span class="kw">table</span>(df<span class="op">$</span>KOEN, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb260-48" title="48"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-49" title="49"><span class="er">&gt;</span><span class="st"> </span>Kvinna    Man </a>
<a class="sourceLine" id="cb260-50" title="50"><span class="op">&gt;</span><span class="st">     </span><span class="dv">34</span>    <span class="dv">713</span></a>
<a class="sourceLine" id="cb260-51" title="51"> </a>
<a class="sourceLine" id="cb260-52" title="52"><span class="co"># Skapa en korstabell av kön och ej talat om</span></a>
<a class="sourceLine" id="cb260-53" title="53"> freq_table_KOEN_EJ_TALAT_OM &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>EJ_TALAT_OM_bin, df<span class="op">$</span>KOEN)</a>
<a class="sourceLine" id="cb260-54" title="54"> x1 &lt;-<span class="st"> </span>freq_table_KOEN_EJ_TALAT_OM[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb260-55" title="55"> x0 &lt;-<span class="st"> </span>freq_table_KOEN_EJ_TALAT_OM[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb260-56" title="56"> n1 &lt;-<span class="kw">sum</span>(freq_table_KOEN_EJ_TALAT_OM[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb260-57" title="57"> n0 &lt;-<span class="kw">sum</span>(freq_table_KOEN_EJ_TALAT_OM[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb260-58" title="58"> p1hat &lt;-<span class="st"> </span>x1<span class="op">/</span>n1</a>
<a class="sourceLine" id="cb260-59" title="59"> p0hat &lt;-<span class="st"> </span>x0<span class="op">/</span>n0</a>
<a class="sourceLine" id="cb260-60" title="60"> resultat_KOEN_EJ_TALAT_OM &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1,x0), <span class="kw">c</span>(n1, n0), <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb260-61" title="61"> resultat_KOEN_EJ_TALAT_OM</a>
<a class="sourceLine" id="cb260-62" title="62"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-63" title="63"><span class="er">&gt;</span><span class="st">   </span><span class="dv">2</span><span class="op">-</span>sample test <span class="cf">for</span> equality of proportions without continuity</a>
<a class="sourceLine" id="cb260-64" title="64"><span class="op">&gt;</span><span class="st">   </span>correction</a>
<a class="sourceLine" id="cb260-65" title="65"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-66" title="66"><span class="er">&gt;</span><span class="st"> </span>data<span class="op">:</span><span class="st">  </span><span class="kw">c</span>(x1, x0) out of <span class="kw">c</span>(n1, n0)</a>
<a class="sourceLine" id="cb260-67" title="67"><span class="op">&gt;</span><span class="st"> </span>X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">3.0149</span>, df =<span class="st"> </span><span class="dv">1</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.0825</span></a>
<a class="sourceLine" id="cb260-68" title="68"><span class="op">&gt;</span><span class="st"> </span>alternative hypothesis<span class="op">:</span><span class="st"> </span>two.sided</a>
<a class="sourceLine" id="cb260-69" title="69"><span class="op">&gt;</span><span class="st"> </span><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb260-70" title="70"><span class="er">&gt;</span><span class="st">  </span><span class="fl">-0.24344443</span> <span class="fl">-0.01775514</span></a>
<a class="sourceLine" id="cb260-71" title="71"><span class="op">&gt;</span><span class="st"> </span>sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb260-72" title="72"><span class="er">&gt;</span><span class="st">    </span>prop <span class="dv">1</span>    prop <span class="dv">2</span> </a>
<a class="sourceLine" id="cb260-73" title="73"><span class="op">&gt;</span><span class="st"> </span><span class="fl">0.1176471</span> <span class="fl">0.2482468</span></a>
<a class="sourceLine" id="cb260-74" title="74"></a>
<a class="sourceLine" id="cb260-75" title="75"> <span class="co"># Kolla förutsättningarna</span></a>
<a class="sourceLine" id="cb260-76" title="76"> n1<span class="op">*</span>p1hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p1hat)</a>
<a class="sourceLine" id="cb260-77" title="77"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">3.529412</span></a>
<a class="sourceLine" id="cb260-78" title="78"> n0<span class="op">*</span>p0hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0hat)</a>
<a class="sourceLine" id="cb260-79" title="79"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">133.0603</span></a>
<a class="sourceLine" id="cb260-80" title="80"> </a>
<a class="sourceLine" id="cb260-81" title="81"> <span class="co"># c)  </span></a>
<a class="sourceLine" id="cb260-82" title="82"> <span class="co"># Undersök variabeln</span></a>
<a class="sourceLine" id="cb260-83" title="83"> <span class="kw">summary</span>(df<span class="op">$</span>SKAM)</a>
<a class="sourceLine" id="cb260-84" title="84"><span class="op">&gt;</span><span class="st">   </span><span class="dv">9</span>  Ja Nej </a>
<a class="sourceLine" id="cb260-85" title="85"><span class="op">&gt;</span><span class="st">  </span><span class="dv">10</span> <span class="dv">344</span> <span class="dv">393</span></a>
<a class="sourceLine" id="cb260-86" title="86"> <span class="kw">table</span>(df<span class="op">$</span>SKAM, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb260-87" title="87"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-88" title="88"><span class="er">&gt;</span><span class="st">   </span><span class="dv">9</span>  Ja Nej </a>
<a class="sourceLine" id="cb260-89" title="89"><span class="op">&gt;</span><span class="st">  </span><span class="dv">10</span> <span class="dv">344</span> <span class="dv">393</span></a>
<a class="sourceLine" id="cb260-90" title="90"> </a>
<a class="sourceLine" id="cb260-91" title="91"> <span class="co"># Skapa en korstabell</span></a>
<a class="sourceLine" id="cb260-92" title="92"> df<span class="op">$</span>skam_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb260-93" title="93"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> &quot;Ja&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb260-94" title="94"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> &quot;Nej&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb260-95" title="95"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb260-96" title="96"></a>
<a class="sourceLine" id="cb260-97" title="97"> freq_table_ej_talat_om_skam &lt;-<span class="st"> </span><span class="kw">table</span>( df<span class="op">$</span>EJ_TALAT_OM_bin,  df<span class="op">$</span>skam_bin)</a>
<a class="sourceLine" id="cb260-98" title="98"> <span class="kw">colnames</span>(freq_table_ej_talat_om_skam) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Ej skam&quot;</span>, <span class="st">&quot;Skam&quot;</span>)</a>
<a class="sourceLine" id="cb260-99" title="99"> <span class="kw">rownames</span>(freq_table_ej_talat_om_skam) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Ej talat om&quot;</span>, <span class="st">&quot;Talat om&quot;</span>)</a>
<a class="sourceLine" id="cb260-100" title="100"> prop_table_ej_talat_om_skam &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_ej_talat_om_skam, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb260-101" title="101"> </a>
<a class="sourceLine" id="cb260-102" title="102"> <span class="kw">barplot</span>( prop_table_ej_talat_om_skam[<span class="dv">2</span>,], </a>
<a class="sourceLine" id="cb260-103" title="103">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Ej skam&quot;</span>, <span class="st">&quot;Skam&quot;</span>), </a>
<a class="sourceLine" id="cb260-104" title="104">         <span class="dt">ylab =</span> <span class="st">&quot;Andel som tala om&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-231-1.png" width="960" /></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1"> </a>
<a class="sourceLine" id="cb261-2" title="2"> x1_<span class="dv">2</span> &lt;-<span class="st"> </span>freq_table_ej_talat_om_skam[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb261-3" title="3"> x0_<span class="dv">2</span> &lt;-<span class="st"> </span>freq_table_ej_talat_om_skam[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb261-4" title="4"> n1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_ej_talat_om_skam[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb261-5" title="5"> n0_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_ej_talat_om_skam[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb261-6" title="6"> p1hat_<span class="dv">2</span> &lt;-<span class="st"> </span>x1_<span class="dv">2</span><span class="op">/</span>n1_<span class="dv">2</span></a>
<a class="sourceLine" id="cb261-7" title="7"> p0hat_<span class="dv">2</span> &lt;-<span class="st"> </span>x0_<span class="dv">2</span><span class="op">/</span>n0_<span class="dv">2</span></a>
<a class="sourceLine" id="cb261-8" title="8"> p_kvot &lt;-<span class="st"> </span>p1hat_<span class="dv">2</span><span class="op">/</span>p0hat_<span class="dv">2</span></a>
<a class="sourceLine" id="cb261-9" title="9"> p_kvot</a>
<a class="sourceLine" id="cb261-10" title="10"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.9877362</span></a>
<a class="sourceLine" id="cb261-11" title="11"> resultat_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1_<span class="dv">2</span>, x0_<span class="dv">2</span>), <span class="kw">c</span>(n1_<span class="dv">2</span>, n0_<span class="dv">2</span>), <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Notera att förutsättningen är ej uppfylld för sambandsanalysen. Vi kan inte lita på testet.</p></li>
<li><p>10 värden är kodade som 9, som förmodligen vet ej eller bortfall. Vi sätter dem som NA. Dessa exkuderas ur analysen.</p></li>
</ol>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.7" class="section level3 unnumbered">
<h3>Övning 5.7</h3>
<p>En studie av Helsing, K. J., &amp; Comstock, G. W. (1977) undersökte faktorer som kan tänkas ha samband med bilbältesanvändning. Du erhåller följande data från studien.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1">antal_cigaretter &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">175</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">149</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">17</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">42</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">41</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb262-2" title="2">bilbalte &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">175</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">149</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">17</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">42</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">41</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>))</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Beskriv sambandet mellan rökning och bilbältesanvändning med en tabell.</p></li>
<li><p>Beskriv sambandet mellan rökning och bilbältesanvändning med en figur.</p></li>
<li><p>Genom ett statistiskt test för att undersöka sambandet mellan rökning och bilbältesanvändning.</p></li>
<li><p>Genomför ett statistisk test utan att använda någon inbyggd test-funktion i R.</p></li>
</ol>
<button title="q507" type="button" onclick="if(document.getElementById(&#39;q507&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q507&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q507&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q507" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb263-2" title="2">antal_cigaretter &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">175</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">149</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">17</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">42</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">41</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb263-3" title="3">antal_cigaretter_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(antal_cigaretter, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb263-4" title="4"><span class="kw">levels</span>(antal_cigaretter_cat)[<span class="kw">levels</span>(antal_cigaretter_cat) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;0&quot;</span></a>
<a class="sourceLine" id="cb263-5" title="5"><span class="kw">levels</span>(antal_cigaretter_cat)[<span class="kw">levels</span>(antal_cigaretter_cat) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> &quot;1-14&quot;</span></a>
<a class="sourceLine" id="cb263-6" title="6"><span class="kw">levels</span>(antal_cigaretter_cat)[<span class="kw">levels</span>(antal_cigaretter_cat) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> &quot;15-34&quot;</span></a>
<a class="sourceLine" id="cb263-7" title="7"><span class="kw">levels</span>(antal_cigaretter_cat)[<span class="kw">levels</span>(antal_cigaretter_cat) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> &quot;35-&quot;</span></a>
<a class="sourceLine" id="cb263-8" title="8"></a>
<a class="sourceLine" id="cb263-9" title="9">bilbalte &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">175</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">149</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">17</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">42</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">41</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb263-10" title="10">bilbalte_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(bilbalte)</a>
<a class="sourceLine" id="cb263-11" title="11"><span class="kw">levels</span>(bilbalte_cat)[<span class="kw">levels</span>(bilbalte_cat) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;Ja&quot;</span></a>
<a class="sourceLine" id="cb263-12" title="12"><span class="kw">levels</span>(bilbalte_cat)[<span class="kw">levels</span>(bilbalte_cat) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> &quot;Nej&quot;</span></a>
<a class="sourceLine" id="cb263-13" title="13"></a>
<a class="sourceLine" id="cb263-14" title="14"><span class="co"># a)</span></a>
<a class="sourceLine" id="cb263-15" title="15">freq_table &lt;-<span class="st"> </span><span class="kw">table</span>(bilbalte_cat, antal_cigaretter_cat)</a>
<a class="sourceLine" id="cb263-16" title="16">prop.table_cig_belt &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb263-17" title="17">prop.table_cig_belt</a>
<a class="sourceLine" id="cb263-18" title="18"><span class="op">&gt;</span><span class="st">             </span>antal_cigaretter_cat</a>
<a class="sourceLine" id="cb263-19" title="19"><span class="op">&gt;</span><span class="st"> </span>bilbalte_cat         <span class="dv">0</span>      <span class="dv">1-14</span>     <span class="dv">15-34</span>       <span class="dv">35</span><span class="op">-</span></a>
<a class="sourceLine" id="cb263-20" title="20"><span class="er">&gt;</span><span class="st">          </span>Ja  <span class="fl">0.5401235</span> <span class="fl">0.5405405</span> <span class="fl">0.5060241</span> <span class="fl">0.4000000</span></a>
<a class="sourceLine" id="cb263-21" title="21"><span class="op">&gt;</span><span class="st">          </span>Nej <span class="fl">0.4598765</span> <span class="fl">0.4594595</span> <span class="fl">0.4939759</span> <span class="fl">0.6000000</span></a>
<a class="sourceLine" id="cb263-22" title="22"></a>
<a class="sourceLine" id="cb263-23" title="23"><span class="co"># b)</span></a>
<a class="sourceLine" id="cb263-24" title="24"><span class="kw">barplot</span>(prop.table_cig_belt,</a>
<a class="sourceLine" id="cb263-25" title="25">         <span class="dt">ylab =</span> <span class="st">&quot;Andel&quot;</span>, </a>
<a class="sourceLine" id="cb263-26" title="26">         <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Bälte&quot;</span>, <span class="st">&quot;Ej bilbälte&quot;</span>), </a>
<a class="sourceLine" id="cb263-27" title="27">         <span class="dt">args.legend =</span>  <span class="kw">c</span>(<span class="dt">y =</span> <span class="fl">1.1</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, <span class="dt">bty =</span><span class="st">&#39;n&#39;</span>))</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-233-1.png" width="960" /></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1"></a>
<a class="sourceLine" id="cb264-2" title="2"><span class="co"># c)</span></a>
<a class="sourceLine" id="cb264-3" title="3"><span class="kw">chisq.test</span>(freq_table)</a>
<a class="sourceLine" id="cb264-4" title="4"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb264-5" title="5"><span class="er">&gt;</span><span class="st">   </span>Pearson<span class="st">&#39;s Chi-squared test</span></a>
<a class="sourceLine" id="cb264-6" title="6"><span class="st">&gt; </span></a>
<a class="sourceLine" id="cb264-7" title="7"><span class="st">&gt; data:  freq_table</span></a>
<a class="sourceLine" id="cb264-8" title="8"><span class="st">&gt; X-squared = 1.3582, df = 3, p-value = 0.7154</span></a>
<a class="sourceLine" id="cb264-9" title="9"></a>
<a class="sourceLine" id="cb264-10" title="10"><span class="st"># d)</span></a>
<a class="sourceLine" id="cb264-11" title="11"><span class="st"> Oij &lt;- freq_table</span></a>
<a class="sourceLine" id="cb264-12" title="12"><span class="st"> radsummor &lt;- rowSums(freq_table)</span></a>
<a class="sourceLine" id="cb264-13" title="13"><span class="st"> kolumnsummor &lt;- colSums(freq_table)</span></a>
<a class="sourceLine" id="cb264-14" title="14"><span class="st"> totalsumma &lt;- sum(freq_table)</span></a>
<a class="sourceLine" id="cb264-15" title="15"><span class="st"> r &lt;- dim(freq_table)[1]</span></a>
<a class="sourceLine" id="cb264-16" title="16"><span class="st"> k &lt;- dim(freq_table)[2]</span></a>
<a class="sourceLine" id="cb264-17" title="17"><span class="st"> Eij &lt;- matrix(NA, r, k)</span></a>
<a class="sourceLine" id="cb264-18" title="18"><span class="st"> Eij[1,1] &lt;- kolumnsummor[1]*radsummor[1]/totalsumma</span></a>
<a class="sourceLine" id="cb264-19" title="19"><span class="st"> Eij[1,2] &lt;- kolumnsummor[2]*radsummor[1]/totalsumma</span></a>
<a class="sourceLine" id="cb264-20" title="20"><span class="st"> Eij[1,3] &lt;- kolumnsummor[3]*radsummor[1]/totalsumma</span></a>
<a class="sourceLine" id="cb264-21" title="21"><span class="st"> Eij[1,4] &lt;- kolumnsummor[4]*radsummor[1]/totalsumma</span></a>
<a class="sourceLine" id="cb264-22" title="22"><span class="st"> Eij[2,1] &lt;- kolumnsummor[1]*radsummor[2]/totalsumma</span></a>
<a class="sourceLine" id="cb264-23" title="23"><span class="st"> Eij[2,2] &lt;- kolumnsummor[2]*radsummor[2]/totalsumma</span></a>
<a class="sourceLine" id="cb264-24" title="24"><span class="st"> Eij[2,3] &lt;- kolumnsummor[3]*radsummor[2]/totalsumma</span></a>
<a class="sourceLine" id="cb264-25" title="25"><span class="st"> Eij[2,4] &lt;- kolumnsummor[4]*radsummor[2]/totalsumma</span></a>
<a class="sourceLine" id="cb264-26" title="26"><span class="st"> X2obs &lt;- sum( (Oij - Eij)^2/Eij )</span></a>
<a class="sourceLine" id="cb264-27" title="27"><span class="st"> fg &lt;- (r-1)*(k-1)</span></a>
<a class="sourceLine" id="cb264-28" title="28"><span class="st"> p_value &lt;- 1 - pchisq(X2obs, fg)</span></a>
<a class="sourceLine" id="cb264-29" title="29"><span class="st"> X2obs</span></a>
<a class="sourceLine" id="cb264-30" title="30"><span class="st">&gt; [1] 1.358175</span></a>
<a class="sourceLine" id="cb264-31" title="31"><span class="st"> p_value</span></a>
<a class="sourceLine" id="cb264-32" title="32"><span class="st">&gt; [1] 0.7153672</span></a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.8" class="section level3 unnumbered">
<h3>Övning 5.8</h3>
<p>En studie 1980 undersökte homosexuellas situation Sverige. En del av denna studie utgjordes bland annat en enkätundersökning. Ladda ner Lilla Enkäten som är txt-fil som finns i zip-filen “Enkäterna i csv-format” på <a href="https://riksarkivet.se/psidata/livet-som-gay" class="uri">https://riksarkivet.se/psidata/livet-som-gay</a>. Utgå från att data är insamlat med OSU och besvara sedan följande frågor:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Har den svarande själv haft en önskan om att inte vara homosexuell? Redovisa med en tabell.</p></li>
<li><p>Undersök samband mellan önskan om att inte vara homosexuell och att känna skam eller ångest (<strong>SKAM</strong>)? Redovisa bortfall. Redovisa en figur.</p></li>
<li><p>Undersök samband mellan önskan om att inte vara homosexuell och att känna skam eller ångest (<strong>SKAM</strong>)? Redovisa bortfall. Redovisa en figur.</p></li>
</ol>
<button title="q508" type="button" onclick="if(document.getElementById(&#39;q508&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q508&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q508&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q508" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb265-2" title="2"><span class="co"># a)</span></a>
<a class="sourceLine" id="cb265-3" title="3"></a>
<a class="sourceLine" id="cb265-4" title="4"> df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/Lilla_enkaeten.txt&quot;</span>)</a>
<a class="sourceLine" id="cb265-5" title="5"> df<span class="op">$</span>skam_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb265-6" title="6"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> &quot;Ja&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb265-7" title="7"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> &quot;Nej&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb265-8" title="8"> </a>
<a class="sourceLine" id="cb265-9" title="9"> df<span class="op">$</span>onskan_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb265-10" title="10"> df<span class="op">$</span>onskan_bin[df<span class="op">$</span>OENSKAN <span class="op">==</span><span class="st"> &quot;Ja, det har jag gjort men jag önskar det inte nu&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb265-11" title="11">  df<span class="op">$</span>onskan_bin[df<span class="op">$</span>OENSKAN <span class="op">==</span><span class="st"> &quot;Ja, jag önskar nu att jag vore (helt) heterosexuell&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb265-12" title="12">   df<span class="op">$</span>onskan_bin[df<span class="op">$</span>OENSKAN <span class="op">==</span><span class="st"> &quot;Nej&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb265-13" title="13">freq_table &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>onskan_bin,  df<span class="op">$</span>skam_bin)</a>
<a class="sourceLine" id="cb265-14" title="14"><span class="kw">chisq.test</span>(freq_table)</a></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li><p>Se formuleringar ovan om andelar, differens av andelar, KI och p-värde.</p></li>
<li><p>OSU (experiment) och normalapproximation gäller. Jag litar på resultaten.</p></li>
</ol>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.9" class="section level3 unnumbered">
<h3>Övning 5.9</h3>
<p>År 2019 omkom 221 i trafiken. Uppdelat på månad</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Antal omkomna 2019</th>
<th align="center">Antal omkomna 2018</th>
<th align="center">Antal omkomna 2018</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Januari</td>
<td align="center">27</td>
<td align="center">13</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td>Februari</td>
<td align="center">17</td>
<td align="center">16</td>
<td align="center">14</td>
</tr>
<tr class="odd">
<td>Mars</td>
<td align="center">10</td>
<td align="center">22</td>
<td align="center">18</td>
</tr>
<tr class="even">
<td>April</td>
<td align="center">16</td>
<td align="center">17</td>
<td align="center">17</td>
</tr>
<tr class="odd">
<td>Maj</td>
<td align="center">19</td>
<td align="center">31</td>
<td align="center">24</td>
</tr>
<tr class="even">
<td>Juni</td>
<td align="center">19</td>
<td align="center">32</td>
<td align="center">27</td>
</tr>
<tr class="odd">
<td>Juli</td>
<td align="center">20</td>
<td align="center">44</td>
<td align="center">31</td>
</tr>
<tr class="even">
<td>Augusti</td>
<td align="center">25</td>
<td align="center">29</td>
<td align="center">34</td>
</tr>
<tr class="odd">
<td>September</td>
<td align="center">15</td>
<td align="center">21</td>
<td align="center">27</td>
</tr>
<tr class="even">
<td>Okober</td>
<td align="center">23</td>
<td align="center">25</td>
<td align="center">20</td>
</tr>
<tr class="odd">
<td>November</td>
<td align="center">13</td>
<td align="center">36</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td>December</td>
<td align="center">17</td>
<td align="center">38</td>
<td align="center">19</td>
</tr>
</tbody>
</table>
<p>Källa: Transportstyrelsen</p>
<p>Besvara om antalet omkomna är oberoende av månad.</p>
<button title="q509" type="button" onclick="if(document.getElementById(&#39;q509&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q509&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q509&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q509" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb266-2" title="2"><span class="co"># Version 1</span></a>
<a class="sourceLine" id="cb266-3" title="3">omkomna2019 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">27</span>, <span class="dv">17</span>, <span class="dv">10</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">13</span>, <span class="dv">17</span>)</a>
<a class="sourceLine" id="cb266-4" title="4">omkomna2018 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">22</span>, <span class="dv">17</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">44</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">36</span>, <span class="dv">38</span>)</a>
<a class="sourceLine" id="cb266-5" title="5">omkomna2017 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">31</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">19</span>)</a>
<a class="sourceLine" id="cb266-6" title="6">manad &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;Maj&quot;</span>, <span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Okt&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>)</a>
<a class="sourceLine" id="cb266-7" title="7"></a>
<a class="sourceLine" id="cb266-8" title="8"><span class="kw">barplot</span>(omkomna2019, <span class="dt">names.arg =</span> manad)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">chisq.test</span>(omkomna2019)</a>
<a class="sourceLine" id="cb267-2" title="2"></a>
<a class="sourceLine" id="cb267-3" title="3">    Chi<span class="op">-</span>squared test <span class="cf">for</span> given probabilities</a>
<a class="sourceLine" id="cb267-4" title="4"></a>
<a class="sourceLine" id="cb267-5" title="5">data<span class="op">:</span><span class="st">  </span>omkomna2019</a>
<a class="sourceLine" id="cb267-6" title="6">X<span class="op">-</span>squared =<span class="st"> </span><span class="fl">14.276</span>, df =<span class="st"> </span><span class="dv">11</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.2181</span></a>
<a class="sourceLine" id="cb267-7" title="7"></a>
<a class="sourceLine" id="cb267-8" title="8">O &lt;-<span class="st"> </span>omkomna2019</a>
<a class="sourceLine" id="cb267-9" title="9">E &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">sum</span>(omkomna2019)<span class="op">/</span><span class="dv">12</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb267-10" title="10">X2 &lt;-<span class="st"> </span><span class="kw">sum</span>( (O <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)</a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.10" class="section level3 unnumbered">
<h3>Övning 5.10</h3>
<p>BMI Nutritional status
Belåg 18.5</p>
<p>Underweight</p>
<p>18.5–24.9</p>
<p>Normal weight</p>
<p>25.0–29.9</p>
<p>Pre-obesity</p>
<p>30.0–34.9</p>
<p>Obesity class I</p>
<p>35.0–39.9</p>
<p>Obesity class II</p>
<p>Above 40</p>
<p>Obesity class III</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1">df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/conscriptiondata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb268-2" title="2">df<span class="op">$</span>bmi &lt;-<span class="st"> </span>df<span class="op">$</span>weight<span class="op">/</span>(df<span class="op">$</span>height<span class="op">/</span><span class="dv">100</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb268-3" title="3"><span class="kw">summary</span>(df<span class="op">$</span>bmi)</a>
<a class="sourceLine" id="cb268-4" title="4">df<span class="op">$</span>bmi_cat &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb268-5" title="5">df<span class="op">$</span>bmi_cat[df<span class="op">$</span>bmi <span class="op">&lt;</span><span class="st"> </span><span class="fl">18.5</span>] &lt;-<span class="st"> &quot;Undervikt&quot;</span></a>
<a class="sourceLine" id="cb268-6" title="6">df<span class="op">$</span>bmi_cat[(df<span class="op">$</span>bmi <span class="op">&gt;=</span><span class="st"> </span><span class="fl">18.5</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>bmi <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span>)] &lt;-<span class="st"> &quot;Normalvikt&quot;</span></a>
<a class="sourceLine" id="cb268-7" title="7">df<span class="op">$</span>bmi_cat[(df<span class="op">$</span>bmi <span class="op">&gt;=</span><span class="st"> </span><span class="dv">25</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>bmi <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) ] &lt;-<span class="st"> &quot;Övervikt&quot;</span></a>
<a class="sourceLine" id="cb268-8" title="8">df<span class="op">$</span>bmi_cat[(df<span class="op">$</span>bmi <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>bmi <span class="op">&lt;</span><span class="st"> </span><span class="dv">35</span>) ] &lt;-<span class="st"> &quot;Fetma klass I&quot;</span></a>
<a class="sourceLine" id="cb268-9" title="9">df<span class="op">$</span>bmi_cat[(df<span class="op">$</span>bmi <span class="op">&gt;=</span><span class="st"> </span><span class="dv">35</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>bmi <span class="op">&lt;</span><span class="st"> </span><span class="dv">40</span>) ] &lt;-<span class="st"> &quot;Fetma klass II&quot;</span></a>
<a class="sourceLine" id="cb268-10" title="10">df<span class="op">$</span>bmi_cat[(df<span class="op">$</span>bmi <span class="op">&gt;=</span><span class="st"> </span><span class="dv">40</span>)] &lt;-<span class="st"> &quot;Fetma klass III&quot;</span></a>
<a class="sourceLine" id="cb268-11" title="11">df<span class="op">$</span>bmi_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>bmi_cat, </a>
<a class="sourceLine" id="cb268-12" title="12">                     <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Undervikt&quot;</span>, <span class="st">&quot;Normalvikt&quot;</span>, <span class="st">&quot;Övervikt&quot;</span>, <span class="st">&quot;Fetma klass I&quot;</span>, <span class="st">&quot;Fetma klass II&quot;</span>, <span class="st">&quot;Fetma klass III&quot;</span>),</a>
<a class="sourceLine" id="cb268-13" title="13">                     <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb268-14" title="14">freq_table_bmi_cat &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>bmi_cat)</a>
<a class="sourceLine" id="cb268-15" title="15">prop_table_bmi_cat &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table)</a>
<a class="sourceLine" id="cb268-16" title="16"></a>
<a class="sourceLine" id="cb268-17" title="17"></a>
<a class="sourceLine" id="cb268-18" title="18"><span class="kw">barplot</span>(freq_table_bmi_cat)</a>
<a class="sourceLine" id="cb268-19" title="19"><span class="kw">barplot</span>(prop_table_bmi_cat)</a>
<a class="sourceLine" id="cb268-20" title="20"></a>
<a class="sourceLine" id="cb268-21" title="21">prop_bmi_year &lt;-<span class="st"> </span><span class="kw">prop.table</span>( <span class="kw">table</span>(df<span class="op">$</span>bmi_cat, df<span class="op">$</span>year), <span class="dv">2</span> )</a>
<a class="sourceLine" id="cb268-22" title="22"></a>
<a class="sourceLine" id="cb268-23" title="23"><span class="kw">barplot</span>(prop_bmi_year, <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb268-24" title="24"></a>
<a class="sourceLine" id="cb268-25" title="25"><span class="kw">chisq.test</span>(freq_table_bmi_cat)</a></code></pre></div>
<p>Vi kan konstatera att andelen överviktiga har ökat. Samtidigt har andelen underviktiga minskat.</p>
<p>Det finns ett beroende mellan år och bmi-kategori.</p>
<p>Undersökarna vill beräkna kvoten av andelar lyckade behandlingar (relativ risk), där spjälning är referensgrupp. Eftersom forskarna vill fatta beslut vill man att en hypotesprövning genomförs på 5% signifikansnivå.</p>
<button title="q510" type="button" onclick="if(document.getElementById(&#39;q510&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q510&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q510&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q510" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb269-2" title="2"> df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">treatment =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;splint&quot;</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;splint&quot;</span>, <span class="dv">23</span>), <span class="kw">rep</span>(<span class="st">&quot;surgery&quot;</span>, <span class="dv">67</span>),  <span class="kw">rep</span>(<span class="st">&quot;surgery&quot;</span>, <span class="dv">6</span>)), </a>
<a class="sourceLine" id="cb269-3" title="3">                 <span class="dt">y =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;succesful&quot;</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;unsucsessful&quot;</span>,<span class="dv">23</span>), <span class="kw">rep</span>(<span class="st">&quot;succesful&quot;</span>, <span class="dv">67</span>),   <span class="kw">rep</span>(<span class="st">&quot;unsucsessful&quot;</span>,<span class="dv">6</span>)))</a>
<a class="sourceLine" id="cb269-4" title="4"> freq_table &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>y, df<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb269-5" title="5"> prop_table &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table, <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb269-6" title="6"> phat_splint &lt;-<span class="st"> </span>prop_table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb269-7" title="7"> phat_surgery &lt;-<span class="st"> </span>prop_table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-8" title="8"> p_kvot &lt;-<span class="st"> </span>phat_surgery<span class="op">/</span>phat_splint </a>
<a class="sourceLine" id="cb269-9" title="9"> resultat &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(freq_table, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb269-10" title="10"> p_kvot</a>
<a class="sourceLine" id="cb269-11" title="11">[<span class="dv">1</span>] <span class="fl">1.269635</span></a>
<a class="sourceLine" id="cb269-12" title="12"> resultat<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb269-13" title="13">[<span class="dv">1</span>] <span class="fl">0.001792853</span></a></code></pre></div>
<p>En patient har 27% (p = 0.002) större chans till lyckad behandling om patienten genomgår kirurgi istället för behandling. Eftersom <span class="math inline">\(p&lt;0.05\)</span> förkastar vi på 5% signifikansnivå nollhypotesen om att kirurgi och spjälning är lika effektiva.</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.11" class="section level3 unnumbered">
<h3>Övning 5.11</h3>
<p>I riksdagsvalet 2018 blev mandatfördelningen följande. Skapa ett stapeldiagram och ett cirkeldiagram som redovisar mandatfördelningen. Argumentera varför det enda diagrammet är att föredra i detta fall.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Antal mandat i riksdagsvalet 2018</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Centerpartiet</td>
<td align="center">31</td>
</tr>
<tr class="even">
<td>Kristdemokraterna</td>
<td align="center">22</td>
</tr>
<tr class="odd">
<td>Liberalerna</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td>Miljöpartiet</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td>Moderaterna</td>
<td align="center">70</td>
</tr>
<tr class="even">
<td>Socialdemokraterna</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td>Sverigedemokraterna</td>
<td align="center">62</td>
</tr>
<tr class="even">
<td>Vänsterpartiet</td>
<td align="center">28</td>
</tr>
</tbody>
</table>
<button title="q511" type="button" onclick="if(document.getElementById(&#39;q511&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q511&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q511&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q511" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb270-2" title="2">parti &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Centerpartiet&quot;</span>, <span class="st">&quot;Kristdemokraterna&quot;</span>, <span class="st">&quot;Liberalerna&quot;</span>, <span class="st">&quot;Miljöpartiet&quot;</span>, <span class="st">&quot;Moderaterna&quot;</span>, <span class="st">&quot;Socialdemokraterna&quot;</span>, <span class="st">&quot;Sverigedemokraterna&quot;</span>, <span class="st">&quot;Vänsterpartiet&quot;</span>)</a>
<a class="sourceLine" id="cb270-3" title="3">partishort &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;KD&quot;</span>, <span class="st">&quot;L&quot;</span>, <span class="st">&quot;Mp&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;V&quot;</span>))</a>
<a class="sourceLine" id="cb270-4" title="4">particol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellåg&quot;</span>, <span class="st">&quot;darkred&quot;</span>)</a>
<a class="sourceLine" id="cb270-5" title="5">mandat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">70</span>, <span class="dv">100</span>, <span class="dv">62</span>, <span class="dv">28</span>)</a>
<a class="sourceLine" id="cb270-6" title="6">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">parti =</span> parti, <span class="dt">partishort =</span> partishort, <span class="dt">particol =</span> particol, <span class="dt">mandat =</span> mandat)</a>
<a class="sourceLine" id="cb270-7" title="7">df<span class="op">$</span>parti &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>parti, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Vänsterpartiet&quot;</span>, <span class="st">&quot;Socialdemokraterna&quot;</span>, <span class="st">&quot;Miljöpartiet&quot;</span>, <span class="st">&quot;Sverigedemokraterna&quot;</span>, <span class="st">&quot;Centerpartiet&quot;</span>, <span class="st">&quot;Liberalerna&quot;</span>, <span class="st">&quot;Kristdemokraterna&quot;</span>, <span class="st">&quot;Moderaterna&quot;</span>))</a>
<a class="sourceLine" id="cb270-8" title="8">df<span class="op">$</span>particol &lt;-<span class="st"> </span><span class="kw">as.character</span>(df<span class="op">$</span>particol)</a>
<a class="sourceLine" id="cb270-9" title="9">df_sorted &lt;-<span class="st"> </span>df[<span class="kw">order</span>(df<span class="op">$</span>parti),]</a>
<a class="sourceLine" id="cb270-10" title="10"></a>
<a class="sourceLine" id="cb270-11" title="11"><span class="co"># Stapeldiagram</span></a>
<a class="sourceLine" id="cb270-12" title="12"><span class="kw">barplot</span>(df_sorted<span class="op">$</span>mandat, </a>
<a class="sourceLine" id="cb270-13" title="13">        <span class="dt">names.arg =</span> df_sorted<span class="op">$</span>partishort, </a>
<a class="sourceLine" id="cb270-14" title="14">        <span class="dt">col =</span> df_sorted<span class="op">$</span>particol)</a>
<a class="sourceLine" id="cb270-15" title="15"></a>
<a class="sourceLine" id="cb270-16" title="16"><span class="co"># Cirkeldiagram</span></a>
<a class="sourceLine" id="cb270-17" title="17"> lbs &lt;-<span class="st">  </span><span class="kw">paste</span>(df_sorted<span class="op">$</span>partishort, <span class="st">&quot; &quot;</span>, <span class="st">&quot;(&quot;</span>, df_sorted<span class="op">$</span>mandat, <span class="st">&quot;)&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb270-18" title="18"> <span class="kw">pie</span>(df_sorted<span class="op">$</span>mandat, </a>
<a class="sourceLine" id="cb270-19" title="19">     <span class="dt">labels =</span> lbs,</a>
<a class="sourceLine" id="cb270-20" title="20">     <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;yellåg&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;blue&quot;</span>),</a>
<a class="sourceLine" id="cb270-21" title="21">     <span class="dt">clockwise =</span> <span class="ot">TRUE</span>, <span class="dt">radius =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Riksdagsvalet 2018: mandatfördelning&quot;</span>)</a>
<a class="sourceLine" id="cb270-22" title="22"></a>
<a class="sourceLine" id="cb270-23" title="23"></a>
<a class="sourceLine" id="cb270-24" title="24"><span class="co"># Hästskodiagram för att redovisa mandatfördelning. Överkurs. Installera</span></a>
<a class="sourceLine" id="cb270-25" title="25"><span class="co"># paketet ggplot2 och kör koden nedan. Till för att visa flexibiliten i R</span></a>
<a class="sourceLine" id="cb270-26" title="26"><span class="co"># och visualisering.</span></a>
<a class="sourceLine" id="cb270-27" title="27"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot&quot;</span>)</a>
<a class="sourceLine" id="cb270-28" title="28"><span class="kw">library</span>(<span class="st">&quot;ggparliament&quot;</span>)</a>
<a class="sourceLine" id="cb270-29" title="29">swedish_election_<span class="dv">2018</span> &lt;-<span class="st"> </span><span class="kw">parliament_data</span>(<span class="dt">election_data =</span> df_sorted,</a>
<a class="sourceLine" id="cb270-30" title="30">                                       <span class="dt">party_seats =</span> df_sorted<span class="op">$</span>mandat,</a>
<a class="sourceLine" id="cb270-31" title="31">                                       <span class="dt">parl_rows =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb270-32" title="32">                                       <span class="dt">type =</span> <span class="st">&quot;horseshoe&quot;</span>)</a>
<a class="sourceLine" id="cb270-33" title="33">swe &lt;-<span class="st"> </span><span class="kw">ggplot</span>(swedish_election_<span class="dv">2018</span>, <span class="kw">aes</span>(x, y, <span class="dt">colour =</span> partishort)) <span class="op">+</span></a>
<a class="sourceLine" id="cb270-34" title="34"><span class="st">    </span><span class="kw">geom_parliament_seats</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb270-35" title="35"><span class="st">    </span><span class="kw">theme_ggparliament</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb270-36" title="36"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb270-37" title="37">         <span class="dt">title =</span> <span class="st">&quot;Sveriges riksdag&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb270-38" title="38"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> particol, </a>
<a class="sourceLine" id="cb270-39" title="39">                        <span class="dt">limits =</span> partishort) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb270-40" title="40"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</a>
<a class="sourceLine" id="cb270-41" title="41">swe</a></code></pre></div>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.12" class="section level3 unnumbered">
<h3>Övning 5.12</h3>
<p>En studie 1980 undersökte homosexuellas situation Sverige. En del av denna studie utgjordes bland annat en enkätundersökning. Ladda ner Lilla Enkäten som är txt-fil som finns i zip-filen “Enkäterna i csv-format” på <a href="https://riksarkivet.se/psidata/livet-som-gay" class="uri">https://riksarkivet.se/psidata/livet-som-gay</a>. Utgå från att data är insamlat med OSU och besvara sedan följande frågor:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Har den svarande själv talat om för någon heterosexuell bekant (som
inte bara är arbetskamrat) att den svarande är homo/bisexuell? Variabeln heter <em>TALAT_OM</em>.</p></li>
<li><p>Finns ett samband mellan kön (<strong>KOEN</strong>) och fråga a)?</p></li>
<li><p>Undersök samband mellan att känna skam eller ångest (<strong>SKAM</strong>) och <em>TALAT_OM</em>? Redovisa bortfall. Redovisa en figur.</p></li>
</ol>
<button title="q512" type="button" onclick="if(document.getElementById(&#39;q512&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q512&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q512&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q512" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb271-2" title="2"> df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/Lilla_enkaeten.txt&quot;</span>)</a>
<a class="sourceLine" id="cb271-3" title="3"></a>
<a class="sourceLine" id="cb271-4" title="4"><span class="co"># Undersök variabeln och variabelkategorierna</span></a>
<a class="sourceLine" id="cb271-5" title="5"> <span class="kw">summary</span>(df<span class="op">$</span>TALAT_OM)</a>
<a class="sourceLine" id="cb271-6" title="6"> <span class="kw">table</span>(df<span class="op">$</span>TALAT_OM, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb271-7" title="7"> </a>
<a class="sourceLine" id="cb271-8" title="8"><span class="co"># Skapar en tom variabel och koda sedan alla nej till 1 och övriga till 0</span></a>
<a class="sourceLine" id="cb271-9" title="9"> df<span class="op">$</span>EJ_TALAT_OM_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb271-10" title="10"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Ja, för en bekant&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb271-11" title="11"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Ja, för flera bakanta&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb271-12" title="12"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Jag har inga heterosexuella vänner&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb271-13" title="13"> df<span class="op">$</span>EJ_TALAT_OM_bin[df<span class="op">$</span>TALAT_OM <span class="op">==</span><span class="st"> &quot;Nej&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb271-14" title="14"></a>
<a class="sourceLine" id="cb271-15" title="15"><span class="co"># a)    </span></a>
<a class="sourceLine" id="cb271-16" title="16"> freq_table_EJ_TALAT_OM &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>EJ_TALAT_OM_bin)</a>
<a class="sourceLine" id="cb271-17" title="17"> x &lt;-<span class="st"> </span>freq_table_EJ_TALAT_OM[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb271-18" title="18"> n &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_EJ_TALAT_OM)</a>
<a class="sourceLine" id="cb271-19" title="19"> resultat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">prop.test</span>(x, n, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb271-20" title="20"> resultat_<span class="dv">1</span></a>
<a class="sourceLine" id="cb271-21" title="21"> </a>
<a class="sourceLine" id="cb271-22" title="22"><span class="co"># b) </span></a>
<a class="sourceLine" id="cb271-23" title="23"><span class="co"># Undersök variabeln kön</span></a>
<a class="sourceLine" id="cb271-24" title="24"> <span class="kw">summary</span>(df<span class="op">$</span>KOEN)</a>
<a class="sourceLine" id="cb271-25" title="25"> <span class="kw">table</span>(df<span class="op">$</span>KOEN, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb271-26" title="26"> </a>
<a class="sourceLine" id="cb271-27" title="27"><span class="co"># Skapa en korstabell av kön och ej talat om</span></a>
<a class="sourceLine" id="cb271-28" title="28"> freq_table_KOEN_EJ_TALAT_OM &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>EJ_TALAT_OM_bin, df<span class="op">$</span>KOEN)</a>
<a class="sourceLine" id="cb271-29" title="29"> x1 &lt;-<span class="st"> </span>freq_table_KOEN_EJ_TALAT_OM[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb271-30" title="30"> x0 &lt;-<span class="st"> </span>freq_table_KOEN_EJ_TALAT_OM[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb271-31" title="31"> n1 &lt;-<span class="kw">sum</span>(freq_table_KOEN_EJ_TALAT_OM[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb271-32" title="32"> n0 &lt;-<span class="kw">sum</span>(freq_table_KOEN_EJ_TALAT_OM[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb271-33" title="33"> p1hat &lt;-<span class="st"> </span>x1<span class="op">/</span>n1</a>
<a class="sourceLine" id="cb271-34" title="34"> p0hat &lt;-<span class="st"> </span>x0<span class="op">/</span>n0</a>
<a class="sourceLine" id="cb271-35" title="35"> resultat_KOEN_EJ_TALAT_OM &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1,x0), <span class="kw">c</span>(n1, n0), <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb271-36" title="36"> resultat_KOEN_EJ_TALAT_OM</a>
<a class="sourceLine" id="cb271-37" title="37"></a>
<a class="sourceLine" id="cb271-38" title="38"> <span class="co"># Kolla förutsättningarna</span></a>
<a class="sourceLine" id="cb271-39" title="39"> n1<span class="op">*</span>p1hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p1hat)</a>
<a class="sourceLine" id="cb271-40" title="40"> n0<span class="op">*</span>p0hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0hat)</a>
<a class="sourceLine" id="cb271-41" title="41"> </a>
<a class="sourceLine" id="cb271-42" title="42"> <span class="co"># c)  </span></a>
<a class="sourceLine" id="cb271-43" title="43"> <span class="co"># Undersök variabeln</span></a>
<a class="sourceLine" id="cb271-44" title="44"> <span class="kw">summary</span>(df<span class="op">$</span>SKAM)</a>
<a class="sourceLine" id="cb271-45" title="45"> <span class="kw">table</span>(df<span class="op">$</span>SKAM, <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</a>
<a class="sourceLine" id="cb271-46" title="46"> </a>
<a class="sourceLine" id="cb271-47" title="47"> <span class="co"># Skapa en korstabell</span></a>
<a class="sourceLine" id="cb271-48" title="48"> df<span class="op">$</span>skam_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb271-49" title="49"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> &quot;Ja&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb271-50" title="50"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> &quot;Nej&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb271-51" title="51"> df<span class="op">$</span>skam_bin[df<span class="op">$</span>SKAM <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb271-52" title="52"></a>
<a class="sourceLine" id="cb271-53" title="53"> freq_table_ej_talat_om_skam &lt;-<span class="st"> </span><span class="kw">table</span>( df<span class="op">$</span>EJ_TALAT_OM_bin,  df<span class="op">$</span>skam_bin)</a>
<a class="sourceLine" id="cb271-54" title="54"> <span class="kw">colnames</span>(freq_table_ej_talat_om_skam) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Ej skam&quot;</span>, <span class="st">&quot;Skam&quot;</span>)</a>
<a class="sourceLine" id="cb271-55" title="55"> <span class="kw">rownames</span>(freq_table_ej_talat_om_skam) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Ej talat om&quot;</span>, <span class="st">&quot;Talat om&quot;</span>)</a>
<a class="sourceLine" id="cb271-56" title="56"> prop_table_ej_talat_om_skam &lt;-<span class="st"> </span><span class="kw">prop.table</span>(freq_table_ej_talat_om_skam, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb271-57" title="57"> </a>
<a class="sourceLine" id="cb271-58" title="58"> <span class="kw">barplot</span>( prop_table_ej_talat_om_skam[<span class="dv">2</span>,], </a>
<a class="sourceLine" id="cb271-59" title="59">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Ej skam&quot;</span>, <span class="st">&quot;Skam&quot;</span>), </a>
<a class="sourceLine" id="cb271-60" title="60">         <span class="dt">ylab =</span> <span class="st">&quot;Andel som tala om&quot;</span>)</a>
<a class="sourceLine" id="cb271-61" title="61"> </a>
<a class="sourceLine" id="cb271-62" title="62"> x1_<span class="dv">2</span> &lt;-<span class="st"> </span>freq_table_ej_talat_om_skam[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb271-63" title="63"> x0_<span class="dv">2</span> &lt;-<span class="st"> </span>freq_table_ej_talat_om_skam[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb271-64" title="64"> n1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_ej_talat_om_skam[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb271-65" title="65"> n0_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(freq_table_ej_talat_om_skam[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb271-66" title="66"> p1hat_<span class="dv">2</span> &lt;-<span class="st"> </span>x1_<span class="dv">2</span><span class="op">/</span>n1_<span class="dv">2</span></a>
<a class="sourceLine" id="cb271-67" title="67"> p0hat_<span class="dv">2</span> &lt;-<span class="st"> </span>x0_<span class="dv">2</span><span class="op">/</span>n0_<span class="dv">2</span></a>
<a class="sourceLine" id="cb271-68" title="68"> p_kvot &lt;-<span class="st"> </span>p1hat_<span class="dv">2</span><span class="op">/</span>p0hat_<span class="dv">2</span></a>
<a class="sourceLine" id="cb271-69" title="69"> p_kvot</a>
<a class="sourceLine" id="cb271-70" title="70"> resultat_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">prop.test</span>(<span class="kw">c</span>(x1_<span class="dv">2</span>, x0_<span class="dv">2</span>), <span class="kw">c</span>(n1_<span class="dv">2</span>, n0_<span class="dv">2</span>), <span class="dt">correct =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Notera att förutsättningen är ej uppfylld för sambandsanalysen. Vi kan inte lita på testet.</p></li>
<li><p>10 värden är kodade som 9, som förmodligen vet ej eller bortfall. Vi sätter dem som NA. Dessa exkuderas ur analysen.</p></li>
</ol>
</div>
</div>
<p></br></p>
</div>
<div id="övning-5.13" class="section level3 unnumbered">
<h3>Övning 5.13</h3>
<p>En marknadsundersökning genom ett slumpmässigt urval av konsumenter för undersöka
om färg har betydelse vad gäller val av mobiltelefon. Nedan presenterar data som du fått från företaget gällande vilken färg konsumenterna föredrar av tre möjligt:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Färg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cyberblå</td>
<td align="center">150</td>
</tr>
<tr class="even">
<td>Prestigeröd</td>
<td align="center">150</td>
</tr>
<tr class="odd">
<td>Supergrå</td>
<td align="center">200</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Har färgen någon betydelse?</li>
</ol>
<p>Dessutom fanns data uppdelat på kön.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Färg: Män</th>
<th align="center">Färg: Kvinnor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cyberblå</td>
<td align="center">100</td>
<td align="center">50</td>
</tr>
<tr class="even">
<td>Prestigeröd</td>
<td align="center">60</td>
<td align="center">90</td>
</tr>
<tr class="odd">
<td>Supergrå</td>
<td align="center">100</td>
<td align="center">100</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: lower-alpha">
<li>Finns det samband mellan kön och vilken färg konsumenterna föredrar?</li>
</ol>
<button title="q513" type="button" onclick="if(document.getElementById(&#39;q513&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q513&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q513) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q513" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb272-2" title="2"> df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/Lilla_enkaeten.txt&quot;</span>)</a></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Notera att förutsättningen är ej uppfylld för sambandsanalysen. Vi kan inte lita på testet.</p></li>
<li><p>10 värden är kodade som 9, som förmodligen vet ej eller bortfall. Vi sätter dem som NA. Dessa exkuderas ur analysen.</p></li>
</ol>
</div>
</div>
<p></br></p>
</div>
</div>
<div id="referenser-1" class="section level2">
<h2><span class="header-section-number">5.6</span> Referenser</h2>
<p>Gerritsen, A. A., De Vet, H. C., Scholten, R. J., Bertelsmann, F. W., De Krom, M. C., &amp; Bouter, L. M. (2002). Splinting vs surgery in the treatment of carpal tunnel syndrome: a randomized controlled trial. Jama, 288(10), 1245-1251.</p>
<p>Helsing, K. J., &amp; Comstock, G. W. (1977). What kinds of people do not use seat belts?. American Journal of Public Health, 67(11), 1043-1050.</p>
<p>Raghubir, P., &amp; Srivastava, J. (2009). <em>The denomination effect.</em> Journal of Consumer Research, 36(4), 701-713</p>
<p>Rosa, L., Rosa, E., Sarner, L., &amp; Barrett, S. (1998). A close look at therapeutic touch. Jama, 279(13), 1005-1010.</p>
<!--chapter:end:05-kategorivariabler.Rmd-->
<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}

</style>
</div>
</div>
<div id="kvantitativa-variabler-kommer-ej-uppdateras-ht20" class="section level1">
<h1><span class="header-section-number">6</span> Kvantitativa variabler (Kommer ej uppdateras HT20)</h1>
<!--chapter:end:06-kvantitativavariabler.Rmd-->
</div>
<div id="tabeller-1" class="section level1">
<h1><span class="header-section-number">7</span> Tabeller</h1>
<p>Att presentera resultat och samband med diskreta variabler och kategorivariabler är en viktig del av att arbeta med</p>
<ul>
<li>Frekvenstabeller i R, vilket beskrivs i kapitlet om kategorivariabler.</li>
<li>Korstabeller i R, vilket beskrivs i kapitlet om kategorivariabler.</li>
<li>Export av tabeller till Word.</li>
</ul>
<div id="exportera-tabeller-till-html" class="section level2">
<h2><span class="header-section-number">7.1</span> Exportera tabeller till html</h2>
<p>Det kan vara omständligt att exportera data från R till Word. En smidig lösning är att spara tabellerna i html-format, vilket gör tabellerna plattformsoberoende. Kom ihåg att det inte är nödvändigt att lägga in tabellerna i Word förrän manuset närmar sig att bli klart. Den stora fördelen är att man slipper för hand kopiera resultat, vilket både är tidsödande och för med sig en stor risk fel.</p>
<p>För att exportera tabeller gjorda med <strong>table()</strong> används paketet <strong>xtable</strong> och funktionen <strong>xtable()</strong> tillsammans med funktionen <strong>print()</strong> (som finns i basversionen av R). Installera därför nödvändigt paket</p>
<p><code>install.packages("xtable")</code></p>
<p>och kör sedan nedanstående kod med någon tabell som exempelvis skapat i kapitlet som kategorivariabler. Du måste ange i sökvägen var filen ska sparas.</p>
<p>För att sedan föra in tabellerna i ordbehandlingsprogram öppnas tabellen i en webläsare, du högerklickar någonstans i webläsaren och väljer <strong>markera allt</strong>, kopiera, och klistra in. Alternativt väljer du Ctrl+A i Windows eller Kommad-A på MacOS. Sedan tillkommer en del arbete med att fixa till tabellen i ordbehandlingsprogrammet.</p>
</div>
<div id="några-vanliga-tabeller" class="section level2">
<h2><span class="header-section-number">7.2</span> Några vanliga tabeller</h2>
<div id="tabell-för-att-beskriva-urvalet" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Tabell för att beskriva urvalet</h3>
<p>Alla rapporter eller vetenskapliga artiklar bör inkludera en beskrivning av urvalet, dvs variablerna fördelning i stickprovet. Frågan som då besvaras är ‘’Vilka är det vi vi undersöker?’’. Ibland är denna beskrivning placeread i början, ibland i en bilaga. Inom en del vetenskapliga artiklar benämns en sådan tabell <strong>Tabell 1</strong> eller <strong>Table 1</strong>.</p>
<p>Observera att syftet <strong>inte</strong> är att göra inferens utan enbart att beskriva urval. Detta innebär normalt sett att medelfel, konfidensintervall eller <span class="math inline">\(p\)</span>-värden inte redovisas i denna tabell.</p>
<p>För att skapa en sådan tabell är det enklast att i R skapa en tabell separat för kvantitativa variabler som redovisas medelvärde, standardavvikelse och evenuellt andra mått och en för kategorivariabler. Därefter kan man kombinera tabellerna i Word.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1"><span class="co"># I studien krävs en variabel som indikerar högt blodtryck.</span></a>
<a class="sourceLine" id="cb273-2" title="2"><span class="co"># För varje blodtrycksvariabel skapas 2 nya varibler till vårt dataset: </span></a>
<a class="sourceLine" id="cb273-3" title="3"><span class="co"># 1. en binär 0-1 variabel som är numerisk</span></a>
<a class="sourceLine" id="cb273-4" title="4"><span class="co"># 2. en binär variabel som R hanterar som en faktor med namngivna nivåer. </span></a>
<a class="sourceLine" id="cb273-5" title="5">df<span class="op">$</span>sbp_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb273-6" title="6">df<span class="op">$</span>sbp_bin[df<span class="op">$</span>sbp <span class="op">&gt;=</span><span class="st"> </span><span class="dv">130</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb273-7" title="7">df<span class="op">$</span>sbp_bin[df<span class="op">$</span>sbp <span class="op">&lt;</span><span class="st"> </span><span class="dv">130</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb273-8" title="8">df<span class="op">$</span>sbp_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>sbp_bin)</a>
<a class="sourceLine" id="cb273-9" title="9"><span class="kw">levels</span>(df<span class="op">$</span>sbp_cat)[<span class="kw">levels</span>(df<span class="op">$</span>sbp_cat) <span class="op">==</span><span class="st"> &quot;0&quot;</span>] &lt;-<span class="st"> &quot;Normalt&quot;</span> </a>
<a class="sourceLine" id="cb273-10" title="10"><span class="kw">levels</span>(df<span class="op">$</span>sbp_cat)[<span class="kw">levels</span>(df<span class="op">$</span>sbp_cat) <span class="op">==</span><span class="st"> &quot;1&quot;</span>] &lt;-<span class="st"> &quot;Högt&quot;</span> </a>
<a class="sourceLine" id="cb273-11" title="11">df<span class="op">$</span>dbp_bin &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb273-12" title="12">df<span class="op">$</span>dbp_bin[df<span class="op">$</span>dbp <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb273-13" title="13">df<span class="op">$</span>dbp_bin[df<span class="op">$</span>dbp <span class="op">&lt;</span><span class="st"> </span><span class="dv">80</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb273-14" title="14">df<span class="op">$</span>dbp_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>dbp_bin)</a>
<a class="sourceLine" id="cb273-15" title="15"><span class="kw">levels</span>(df<span class="op">$</span>dbp_cat)[<span class="kw">levels</span>(df<span class="op">$</span>dbp_cat) <span class="op">==</span><span class="st"> &quot;0&quot;</span>] &lt;-<span class="st"> &quot;Normalt&quot;</span> </a>
<a class="sourceLine" id="cb273-16" title="16"><span class="kw">levels</span>(df<span class="op">$</span>dbp_cat)[<span class="kw">levels</span>(df<span class="op">$</span>dbp_cat) <span class="op">==</span><span class="st"> &quot;1&quot;</span>] &lt;-<span class="st"> &quot;Högt&quot;</span> </a>
<a class="sourceLine" id="cb273-17" title="17"></a>
<a class="sourceLine" id="cb273-18" title="18"><span class="co"># Skapa Tabell 1a. Kvantitativa variabler</span></a>
<a class="sourceLine" id="cb273-19" title="19">xbar_height &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>height)</a>
<a class="sourceLine" id="cb273-20" title="20">Warning <span class="cf">in</span> <span class="kw">mean.default</span>(df<span class="op">$</span>height)<span class="op">:</span><span class="st"> </span>argument is not numeric or logical<span class="op">:</span></a>
<a class="sourceLine" id="cb273-21" title="21">returning <span class="ot">NA</span></a>
<a class="sourceLine" id="cb273-22" title="22">sd_height &lt;-<span class="st"> </span><span class="kw">sd</span>(df<span class="op">$</span>height)</a>
<a class="sourceLine" id="cb273-23" title="23">xbar_weight &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>weight)</a>
<a class="sourceLine" id="cb273-24" title="24">Warning <span class="cf">in</span> <span class="kw">mean.default</span>(df<span class="op">$</span>weight)<span class="op">:</span><span class="st"> </span>argument is not numeric or logical<span class="op">:</span></a>
<a class="sourceLine" id="cb273-25" title="25">returning <span class="ot">NA</span></a>
<a class="sourceLine" id="cb273-26" title="26">sd_weight &lt;-<span class="st"> </span><span class="kw">sd</span>(df<span class="op">$</span>weight)</a>
<a class="sourceLine" id="cb273-27" title="27">xbar_sbp &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>sbp)</a>
<a class="sourceLine" id="cb273-28" title="28">Warning <span class="cf">in</span> <span class="kw">mean.default</span>(df<span class="op">$</span>sbp)<span class="op">:</span><span class="st"> </span>argument is not numeric or logical<span class="op">:</span><span class="st"> </span>returning</a>
<a class="sourceLine" id="cb273-29" title="29"><span class="ot">NA</span></a>
<a class="sourceLine" id="cb273-30" title="30">sd_sbp&lt;-<span class="st"> </span><span class="kw">sd</span>(df<span class="op">$</span>sbp)</a>
<a class="sourceLine" id="cb273-31" title="31">xbar_dbp &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>dbp)</a>
<a class="sourceLine" id="cb273-32" title="32">Warning <span class="cf">in</span> <span class="kw">mean.default</span>(df<span class="op">$</span>dbp)<span class="op">:</span><span class="st"> </span>argument is not numeric or logical<span class="op">:</span><span class="st"> </span>returning</a>
<a class="sourceLine" id="cb273-33" title="33"><span class="ot">NA</span></a>
<a class="sourceLine" id="cb273-34" title="34">sd_dbp&lt;-<span class="st"> </span><span class="kw">sd</span>(df<span class="op">$</span>dbp)</a>
<a class="sourceLine" id="cb273-35" title="35">means &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(xbar_height, xbar_weight, xbar_sbp, xbar_dbp ), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb273-36" title="36">sds &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(sd_height, sd_weight, sd_sbp, sd_dbp), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb273-37" title="37">table1_cont_vars &lt;-<span class="st"> </span><span class="kw">cbind</span>(means, sds)</a>
<a class="sourceLine" id="cb273-38" title="38"><span class="kw">colnames</span>(table1_cont_vars) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Medelvärde&quot;</span>, <span class="st">&quot;SD&quot;</span>)</a>
<a class="sourceLine" id="cb273-39" title="39"><span class="kw">rownames</span>(table1_cont_vars) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Längd (cm)&quot;</span>, </a>
<a class="sourceLine" id="cb273-40" title="40">                               <span class="st">&quot;Vikt (kg)&quot;</span>,</a>
<a class="sourceLine" id="cb273-41" title="41">                               <span class="st">&quot;Systoliskt blodtryck (mmHg)&quot;</span>,</a>
<a class="sourceLine" id="cb273-42" title="42">                               <span class="st">&quot;Diastoliskt blodtryck (mmHg)&quot;</span>)</a>
<a class="sourceLine" id="cb273-43" title="43"></a>
<a class="sourceLine" id="cb273-44" title="44"><span class="co"># Skapa Tabell 1b. Kategorivariabler</span></a>
<a class="sourceLine" id="cb273-45" title="45">desc_sbp_bin &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">table</span>(df<span class="op">$</span>sbp_bin), <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>sbp_bin)))</a>
<a class="sourceLine" id="cb273-46" title="46">desc_dbp_bin &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">table</span>(df<span class="op">$</span>dbp_bin), <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>dbp_bin)))</a>
<a class="sourceLine" id="cb273-47" title="47">desc_psych_cat &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">table</span>(df<span class="op">$</span>psych), <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>psych)))</a>
<a class="sourceLine" id="cb273-48" title="48">table1_cat_vars &lt;-<span class="st"> </span><span class="kw">rbind</span>(desc_sbp_bin, desc_dbp_bin, desc_psych_cat)</a>
<a class="sourceLine" id="cb273-49" title="49"><span class="kw">colnames</span>(table1_cat_vars) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Antal&quot;</span>, <span class="st">&quot;%&quot;</span>)</a>
<a class="sourceLine" id="cb273-50" title="50"><span class="kw">rownames</span>(table1_cat_vars) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Systoliskt  blodtryck (mmHG &lt; 130)&quot;</span>,</a>
<a class="sourceLine" id="cb273-51" title="51">                      <span class="st">&quot;Systoliskt  blodtryck (mmHG &gt;= 130)&quot;</span>,</a>
<a class="sourceLine" id="cb273-52" title="52">                      <span class="st">&quot;Diastoliskt  blodtryck (mmHG &lt; 80)&quot;</span>,</a>
<a class="sourceLine" id="cb273-53" title="53">                      <span class="st">&quot;Diastoliskt  blodtryck (mmHG &gt;= 80)&quot;</span>,</a>
<a class="sourceLine" id="cb273-54" title="54">                      <span class="st">&quot;Psykologisk bedömning: Kat 1&quot;</span>, </a>
<a class="sourceLine" id="cb273-55" title="55">                      <span class="st">&quot;Psykologisk bedömning: Kat 2&quot;</span>, </a>
<a class="sourceLine" id="cb273-56" title="56">                      <span class="st">&quot;Psykologisk bedömning: Kat 3&quot;</span>, </a>
<a class="sourceLine" id="cb273-57" title="57">                      <span class="st">&quot;Psykologisk bedömning: Kat 4&quot;</span>, </a>
<a class="sourceLine" id="cb273-58" title="58">                      <span class="st">&quot;Psykologisk bedömning: Kat 5&quot;</span>, </a>
<a class="sourceLine" id="cb273-59" title="59">                      <span class="st">&quot;Psykologisk bedömning: Kat 6&quot;</span>, </a>
<a class="sourceLine" id="cb273-60" title="60">                      <span class="st">&quot;Psykologisk bedömning: Kat 7&quot;</span>, </a>
<a class="sourceLine" id="cb273-61" title="61">                      <span class="st">&quot;Psykologisk bedömning: Kat 8&quot;</span>, </a>
<a class="sourceLine" id="cb273-62" title="62">                      <span class="st">&quot;Psykologisk bedömning: Kat 9&quot;</span>) </a>
<a class="sourceLine" id="cb273-63" title="63">Error <span class="cf">in</span> <span class="kw">dimnames</span>(x) &lt;-<span class="st"> </span>dn<span class="op">:</span><span class="st"> </span>length of <span class="st">&#39;dimnames&#39;</span> [<span class="dv">1</span>] not equal to array extent</a></code></pre></div>
</div>
</div>
<div id="principer-för-tabeller" class="section level2">
<h2><span class="header-section-number">7.3</span> Principer för tabeller</h2>
<ul>
<li>Tabellrubriker placeras ovanför tabeller.</li>
<li>Tabellrubriker ska enkelt förklara för läsaren vad tabellen syftar till att beskriva, men ska inte nödvändigtvis innehålla detaljer. Detaljer gör sig oftast bättre i själva tabellen.</li>
<li>Tabellen ska vara självförklarande.</li>
<li>Tabellresultat ska alltid att beskrivas i text, med hänvisning till tabellen.</li>
<li>Undvik att ha alltför många linjer i tabeller. Ofta räcker faktiskt tre horisontella linjer - en ovanför kolumnnamnen, en under kolumnnamnen och en nedanför sista raden.</li>
</ul>
</div>
<div id="paket-för-tabeller" class="section level2">
<h2><span class="header-section-number">7.4</span> Paket för tabeller</h2>
<p>Du lär dig på denna kurs det som är nödvändigt för att lösa de uppgifter som krävs utifrån kursens mål och innehåll. Du gör detta utan att använda paket och det enda externa paket för tabeller som vi använder är <strong>xtable()</strong> som används för att exportera tabeller. För den intresserade kan det efter kursen vara värt att kika närmare på något eller några av följande paket:</p>
<ul>
<li>Table1</li>
<li>summartools</li>
<li>gt</li>
<li>tables</li>
<li>DescTool</li>
</ul>
<p>Det bör också nämnas att en anledningar till att R är populärt är just det stora antalet paket.</p>
<!--chapter:end:07-tabeller.Rmd-->
</div>
</div>
<div id="figurer-1" class="section level1">
<h1><span class="header-section-number">8</span> Figurer</h1>
<p>En figur kan vara ett diagram, ett foto, en skiss. Om tabeller ger detaljer, så är syftet med figurer att förmedla en överskådlig sammanfattning om det vi studerar. I detta avseende måste man alltid ställa sig frågan om en figur är nödvändig eller om den enbart kopierar information som redan återfinns i en tabell. En bra figur kan däremot leda till en lång diskussion förkortas och kan göra en rapport eller vetenskaplig artikel lättläst.</p>
<p>Eftersom figurerna ofta är det som läsaren av en vetenskaplig artikel eller en rapport först ser är det viktigt att figurerna är välgjorda. R ger tillgång till omfattande möjligheter för datavisualisering och en anledning till utvecklingen av R var behovet av ett verktyg för avancerad visualisering. Dels ger basutbudet i R stora möjligheter, dels finns det paket (exempelvis ggplot2 och lattice) som ger ytterligare möjligheter. Det bör nämnas att man ofta får prova sig fram när man skapar figurer i R och nybörjaren bör därför inte misströsta. Övning ger färdighet.</p>
<p>När vi ska skapa en figur är det viktigt att veta det primära syftet med figuren utifrån två alternativ:</p>
<p>Figurer primärt avsedda för en intern analys, dvs för dataanalytikern och andra involverade i analysen. Syften kan till exempel vara att studera data explorativt vid tvätt av data, kontrollera att förutsättningar är uppfyllda vid analyser eller förmedla preliminära resultat. Estetiska och pedagogiska aspekter hos sådana figurer är inte av någon större vikt. Däremot måste naturligtvis figurerna på ett korrekt sätt representera data.
Figurer avsedda att presenteras ëxternt, dvs figurer som presenteras i en rapport, vetenskaplig artikel eller ett bildspel. En sådan figur ska på ett tydligt och korrekt redovisa det väsentliga i en analys. Den ska även vara estetiskt fullgod. Dessutom måste figuren vara sparad i ett format som fungerar för det medium det ska publiceras i.
Beroende på syfte tar det olika lång tid att skapa figurer. Det kan vara bra att veta att även figurer avsedda för enbart internt bruk kan, om de är komplicerade, ta flera timmar att skapa. Dessutom kan det ta ännu fler timmar för att få data i ordning för att skapa figuren.</p>
<p>Vi kan klassificera figurer enligt fyra kategorier:</p>
<p>Ok.
Oestetisk, men korrekt.
Dålig, innebär att figuren är svårtolkad men principellt korrekt.
Felaktig.</p>
<p>R ger tillgång till omfattande möjligheter gällande datavisualisering. Dels ger basversionen i R stora möjlighet, dels finns det paket (exempelvis <strong>ggplot2</strong> och <strong>lattice</strong>) som ger ytterligare funktionalitet. När vi ska skapa en figur är det viktigt att fundera över det primära syftet med figuren. Det går att klassificera syftet med figurer enligt följande:</p>
<ul>
<li>Figurer primärt avsedda för att beskriva något internt, dvs för dataanalytikern och andra involverade i analysen. Syftet kan till exempel vara att studera data explorativt vid tvätt av data, kontrollera att förutsättningar är uppfyllda vid analyser och förmedla preliminära resultat. Estetiska och pedagogiska aspekter hos sådana figurer är inte av någon större vikt. Däremot måste naturligtvis figurerna på ett korrekt sätt representera data.<br />
</li>
<li>Figurer avsedda att presenteras ëxternt, dvs figurer som presenteras i en rapport, vetenskaplig artikel eller ett bildspel. En sådan figur ska på ett tydligt och korrekt redovisa det väsentliga i en analys. Den ska även vara estetiskt fullgod. Dessutom måste figuren vara sparad i ett format som fungerar för det medium det ska publiceras i.</li>
</ul>
<p>Beroende på syfte tar det olika lång tid att skapa figurer. Det kan vara bra att veta att även figurer avsedda för enbart internt bruk kan, om de är komplicerade, ta flera timmar att skapa.</p>
<ul>
<li>Ok.</li>
<li>Oestetisk, men korrekt.</li>
<li>Dålig, innebär att figuren är svårtolkad men principellt korrekt.</li>
<li>Felaktig.</li>
</ul>
<p>DDen första figuren är OK eftersom den redovisar stapeldiagramen utan felaktigheter. Den andra figuren är oestetisk beträffande färgval och har hjälplinjer som löper över staplarna istället för bakom. Figuren som klassas som dålig är korrekt, men det är svårt att urskilja detaljer i den. Dessutom är namnen på kategorierna otydliga och kan förväxlas med poäng. Den felaktiga figuren visar staplarna, men det finns ingen information som gör figuren möjlig att tolka.</p>
<p>Notera att distinktionen oestetisk-dålig-felaktig är flytande. Att ha olika färger på staplar innebär att tolkningen av innebär att läsaren kan föranledas att tro att det ytterligare information som inte finns. En korrekt figur som är dålig, kanske är så dålig att den kan misstolkas vilket innebär att den egentligen är felaktig.</p>
<p>Forskare och andra som regelbundet arbetar med vetenskapliga rapporter brukar ofta ha en ganska bra uppfattning om vad som är en korrekt figur. Däremot saknas en känsla för estetiken i en figur. Å andra sidan är det inte ovanligt att se grafiker som skapar vackra figurer, men som inte tillfredställande korrekt sätt redovisar data.</p>
<button title="f1" type="button" onclick="if(document.getElementById(&#39;f1&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;f1&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;f1&#39;) .style.display=&#39;none&#39;}">
Visa figurkod
</button>
<div id="f1" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="co"># Läs in data</span></a>
<a class="sourceLine" id="cb274-2" title="2"> df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/conscriptiondata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb274-3" title="3"><span class="co"># Skapa kategorier av poängen på Test A</span></a>
<a class="sourceLine" id="cb274-4" title="4"> df<span class="op">$</span>testa_cat[df<span class="op">$</span>testa <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb274-5" title="5"> df<span class="op">$</span>testa_cat[(df<span class="op">$</span>testa <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>testa <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>)] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb274-6" title="6"> df<span class="op">$</span>testa_cat[(df<span class="op">$</span>testa <span class="op">&gt;=</span><span class="st"> </span><span class="dv">20</span>) <span class="op">&amp;</span><span class="st"> </span>(df<span class="op">$</span>testa <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>)] &lt;-<span class="st"> </span><span class="dv">3</span>  </a>
<a class="sourceLine" id="cb274-7" title="7"> df<span class="op">$</span>testa_cat[(df<span class="op">$</span>testa <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>)] &lt;-<span class="st"> </span><span class="dv">4</span>  </a>
<a class="sourceLine" id="cb274-8" title="8"> df<span class="op">$</span>testa_cat &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>testa_cat)</a>
<a class="sourceLine" id="cb274-9" title="9"><span class="co"># Skapa ett tabellobjekt </span></a>
<a class="sourceLine" id="cb274-10" title="10"> freqtable_testa &lt;-<span class="st"> </span><span class="kw">table</span>(df<span class="op">$</span>testa_cat)</a>
<a class="sourceLine" id="cb274-11" title="11"></a>
<a class="sourceLine" id="cb274-12" title="12"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb274-13" title="13"><span class="co"># OK figur</span></a>
<a class="sourceLine" id="cb274-14" title="14">  <span class="kw">barplot</span>(freqtable_testa<span class="op">/</span><span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb274-15" title="15">          <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, </a>
<a class="sourceLine" id="cb274-16" title="16">          <span class="dt">main=</span><span class="st">&quot;OK&quot;</span>, </a>
<a class="sourceLine" id="cb274-17" title="17">          <span class="dt">ylab=</span><span class="st">&quot;Antal (tusental)&quot;</span>, </a>
<a class="sourceLine" id="cb274-18" title="18">          <span class="dt">xlab =</span> <span class="st">&quot;Poäng test A&quot;</span>,</a>
<a class="sourceLine" id="cb274-19" title="19">          <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">350</span>), </a>
<a class="sourceLine" id="cb274-20" title="20">          <span class="dt">border=</span><span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb274-21" title="21">          <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;0-9&quot;</span>, <span class="st">&quot;10-19&quot;</span>, <span class="st">&quot;20-29&quot;</span>, <span class="st">&quot;30-40&quot;</span>))</a>
<a class="sourceLine" id="cb274-22" title="22"><span class="co"># Oestetisk figur</span></a>
<a class="sourceLine" id="cb274-23" title="23"> <span class="kw">barplot</span>(freqtable_testa<span class="op">/</span><span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb274-24" title="24">         <span class="dt">main=</span><span class="st">&quot;Oestetisk&quot;</span>, </a>
<a class="sourceLine" id="cb274-25" title="25">         <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb274-26" title="26">         <span class="dt">xlab =</span> <span class="st">&quot;Poäng test A&quot;</span>, </a>
<a class="sourceLine" id="cb274-27" title="27">         <span class="dt">ylab=</span><span class="st">&quot;Antal (tusental)&quot;</span>,</a>
<a class="sourceLine" id="cb274-28" title="28">         <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">350</span>), </a>
<a class="sourceLine" id="cb274-29" title="29">         <span class="dt">border=</span><span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb274-30" title="30">         <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;0-9&quot;</span>, <span class="st">&quot;10-19&quot;</span>, <span class="st">&quot;20-29&quot;</span>, <span class="st">&quot;30-40&quot;</span>))</a>
<a class="sourceLine" id="cb274-31" title="31"> <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb274-32" title="32"> <span class="co"># Dålig figur</span></a>
<a class="sourceLine" id="cb274-33" title="33"> <span class="kw">barplot</span>(freqtable_testa, </a>
<a class="sourceLine" id="cb274-34" title="34">         <span class="dt">main=</span><span class="st">&quot;Dålig&quot;</span>, </a>
<a class="sourceLine" id="cb274-35" title="35">         <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb274-36" title="36">         <span class="dt">ylab=</span><span class="st">&quot;Antal&quot;</span>, </a>
<a class="sourceLine" id="cb274-37" title="37">         <span class="dt">xlab =</span> <span class="st">&quot;Poängkategori test A&quot;</span>,</a>
<a class="sourceLine" id="cb274-38" title="38">         <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">350000</span>), </a>
<a class="sourceLine" id="cb274-39" title="39">         <span class="dt">border=</span><span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb274-40" title="40"> <span class="co"># Felaktig figur </span></a>
<a class="sourceLine" id="cb274-41" title="41"> <span class="kw">barplot</span>(freqtable_testa, </a>
<a class="sourceLine" id="cb274-42" title="42">         <span class="dt">main=</span><span class="st">&quot;Felaktig&quot;</span>, </a>
<a class="sourceLine" id="cb274-43" title="43">         <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb274-44" title="44">         <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb274-45" title="45">         <span class="dt">xlab =</span> <span class="st">&quot;Test&quot;</span>,</a>
<a class="sourceLine" id="cb274-46" title="46">         <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">800000</span>), </a>
<a class="sourceLine" id="cb274-47" title="47">         <span class="dt">border=</span><span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb274-48" title="48">         <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>, </a>
<a class="sourceLine" id="cb274-49" title="49">         <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>)</a></code></pre></div>
</div>
</div>
<p></br></p>
<p><img src="dpk_files/figure-html/unnamed-chunk-244-1.png" width="768" /></p>
<div id="grundläggande-figurhantering" class="section level2">
<h2><span class="header-section-number">8.1</span> Grundläggande figurhantering</h2>
<p>Det finns ofta uppsättning figurer som ofta används. Vi kommer gå igenom de vanligaste som räcker för de absolut flesta situationer. Utöver dessa finns till exempel figurer som visar 3D-dimensionella samband, kartor och specialdiagram. Innan vi presenterar några vanlig typer av figurer ska vi gå igenom ett några grundläggande funktioner som en användare ska känna till när man konstruerar figurer.</p>
<p>För det första bygger R på att man med hjälp av en figur-funktion, t ex <strong>plot()</strong>, skapar en canvas/målarduk. Det går sedan att med olika argument i flera steg måla på denna målarduk. Vi illusterar detta sätt att arbeta med figurer genom att först med funktionen <strong>plot()</strong> skapa en figur. Sedan används funktionen <strong>lines()</strong> för rita en regressionslinje figuren i figuren.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1"><span class="co"># Läs in data för figurer</span></a>
<a class="sourceLine" id="cb275-2" title="2"> x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb275-3" title="3"> x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb275-4" title="4"> x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb275-5" title="5"> x4 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb275-6" title="6"> y1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">8.04</span>, <span class="fl">6.95</span>, <span class="fl">7.58</span>, <span class="fl">8.81</span>, <span class="fl">8.33</span>, <span class="fl">9.96</span>, <span class="fl">7.24</span>, <span class="fl">4.26</span>, <span class="fl">10.84</span>, <span class="fl">4.82</span>, <span class="fl">5.68</span>)</a>
<a class="sourceLine" id="cb275-7" title="7"> y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">9.14</span>, <span class="fl">8.14</span>, <span class="fl">8.74</span>, <span class="fl">8.77</span>, <span class="fl">9.26</span>, <span class="fl">8.10</span>, <span class="fl">6.13</span>, <span class="fl">3.10</span>, <span class="fl">9.13</span>, <span class="fl">7.26</span>, <span class="fl">4.74</span>)</a>
<a class="sourceLine" id="cb275-8" title="8"> y3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">7.46</span>, <span class="fl">6.77</span>, <span class="fl">12.74</span>, <span class="fl">7.11</span>, <span class="fl">7.81</span>, <span class="fl">8.84</span>, <span class="fl">6.08</span>, <span class="fl">5.39</span>, <span class="fl">8.15</span>, <span class="fl">6.42</span>, <span class="fl">5.73</span>)</a>
<a class="sourceLine" id="cb275-9" title="9"> y4 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">6.58</span>, <span class="fl">5.76</span>, <span class="fl">7.71</span>, <span class="fl">8.84</span>, <span class="fl">8.47</span>, <span class="fl">7.04</span>, <span class="fl">5.25</span>, <span class="fl">12.50</span>, <span class="fl">5.56</span>, <span class="fl">7.91</span>, <span class="fl">6.89</span>)</a>
<a class="sourceLine" id="cb275-10" title="10"></a>
<a class="sourceLine" id="cb275-11" title="11"><span class="co"># Regressionlinje </span></a>
<a class="sourceLine" id="cb275-12" title="12"> x &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">14</span></a>
<a class="sourceLine" id="cb275-13" title="13"> Ey &lt;-<span class="st"> </span><span class="fl">3.00</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.500</span><span class="op">*</span>x</a>
<a class="sourceLine" id="cb275-14" title="14"></a>
<a class="sourceLine" id="cb275-15" title="15"><span class="co"># Skapa en figur för x1 och y1. Ritar sedan en regressionslinje med lines()</span></a>
<a class="sourceLine" id="cb275-16" title="16"> <span class="kw">plot</span>(x1, y1)</a>
<a class="sourceLine" id="cb275-17" title="17"> <span class="kw">lines</span>(x, Ey)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-245-1.png" width="384" /></p>
<p>För det andra omges målarduken av en ram, så kallade marginaler. Genom att använda funktionen <strong>par(mar = c(5.1, 4.1, 4.1, 2.1))</strong>, värdena är default-inställningen på marginalernas storlek, kan vi enkelt ändra marginalernas storlek. Figuren nedan illusterar målarduken i mitten med marginalerna omkring. Ordningen på värdena korresponderar till respektive marginals position. Det finns en nedre marginal (1), en vänstermarginal (2), en övre marginal (3) och en högermarginal (4).</p>
<p><img src="docs/images/margins.jpg" width="70%" style="background-color: #414244 ; padding:1px; display: inline-block;" /></p>
<p>Genom att ändra värdena ser vi ser att marginalernas storlek ändras. Det är mycket vanligt att Justera marginalernas storlek eftersom onödiga vita ytor inte är önsvärda i en figur. Det kan också vara så atte marginalers storlek måste utökas på grund att delar i figuren, t ex namn, annars inte får plats. I exemplet nedan hamnar exempelvis x-axelns namn utanför figuren och syns inte.</p>
<p>För det tredje är det vanligt att kombinera flera diagram i en figur. Detta är möjligt med <strong>par()</strong> funktionen, fast nu med argumentet <strong>mfrow = c(antalrader, antalkolumner)</strong> som innehåller två värden, en som anger antalet rader och anger antalet kolumner.</p>
<p>Exemplet nedan hur fyra diagram över samband kan illustereras i en och samma figur. De fyra datamaterialen kallas för Anscombes kvartett (Anscombe, 1973) och är berömd illustration av hur viktig datavisualisering är. Alla fyra datamaterial har nämligen samma medelvärde, standardavvikelse, korrelation och regressionlinje. Men en grafisk jämförelse visar hur olika egenskaper de olika datamaterialen har!</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1"><span class="co"># Skapa fyra diagram i en figur, 2 rader och 2 kolumner. Fyller på med lines i varje diagram.</span></a>
<a class="sourceLine" id="cb276-2" title="2"> <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb276-3" title="3"> <span class="kw">plot</span>(x1, y1, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb276-4" title="4"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb276-5" title="5"> <span class="kw">plot</span>(x2, y2, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb276-6" title="6"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb276-7" title="7"> <span class="kw">plot</span>(x3, y3, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb276-8" title="8"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb276-9" title="9"> <span class="kw">plot</span>(x4, y4, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb276-10" title="10"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-247-1.png" width="576" /></p>
<p>Vi är dock inte helt nöjda med ovanstående figur, utan vi tycker det finns för mycket vit yta mellan diagrammen. Vi kombineras de bägge argumenten i par() med målet att ha fyra diagram i en figur, men med mindre marginaler. Nu ser det bättre ut!</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1"><span class="co"># Skapa fyra diagram i en figur. Fyller på med en linje med lines()</span></a>
<a class="sourceLine" id="cb277-2" title="2"> <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb277-3" title="3"> <span class="kw">plot</span>(x1, y1, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb277-4" title="4"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb277-5" title="5"> <span class="kw">plot</span>(x2, y2, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb277-6" title="6"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb277-7" title="7"> <span class="kw">plot</span>(x3, y3, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb277-8" title="8"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb277-9" title="9"> <span class="kw">plot</span>(x4, y4, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb277-10" title="10"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-248-1.png" width="576" /></p>
</div>
<div id="färger-och-figurer" class="section level2">
<h2><span class="header-section-number">8.2</span> Färger och figurer</h2>
<ul>
<li>Om färgen representerar olika kategorier som inte går att rangordna bör det vara olika färger</li>
<li>Om färgen regresenterar en kvantitativ variabel kan man ha olika nyanser på samma färger för att visa magnituden på variabeln.</li>
</ul>
<div id="presentation-av-aggregerade-data" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Presentation av aggregerade data</h3>
<p>Aggregerade data (summor, antal, medelvärden, andelar) presenteras ofta i</p>
<ul>
<li>stapeldiagram, där R använder funktionen <strong>barplot()</strong>.</li>
<li>punktdiagram, där R använder funktionen <strong>dotchart()</strong>.</li>
</ul>
<p>I princip kan samma information redovisas i en tabell, men en grafisk presentation blir enklare att avläsa. På grund av relationen mellan stapeldiagram och tabeller används i R ofta skapat tabellobjekt, men det går också att använda enskilda variabler från en data frame. Vad som dock är viktigt när man skapar figurer i R är att användaren först måste skapa data i ett format som kan analyseras, sedan skapas figuren.</p>
<p>Ett vanligt exemplet är om vi vill för olika kategorier vill redovisa medelvärden eller antal. Genom att använda funktionen <strong>aggregate()</strong> kan skapa en dataframe med nödvändigt information. Därefter tillämpar vi barplot.</p>
<p>Vi exemplifierar med att vi vill för varje kategori (1-9) av psykologisk bedömning (enligt pyskolog från en intervju med den mönstrande) beskriva medelvärdet för Test A. Kategorinamnen är långa och detta kan hanteras på två sätt. Antingen skapar vi nya kortare namn och förtydligande med argumentet xlabs eller så roteras kategorinamnen med argumentet las. Av dessa två alternativ rekommenderas generellt det första eftersom man som läsaren annars tvingas vrida huvudet och överskådligheten minskar.</p>
<p>Vi ska nu skapa en figur för filmers intäkter 2019. Jämför de olika figurerna nedan och fundera på varför den ena är bättre än den andra.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1">boxoffice2019 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">title =</span> <span class="kw">c</span>(<span class="st">&quot;Aladdin&quot;</span>,  <span class="st">&quot;Avengers: Endgame&quot;</span>, <span class="st">&quot;Captain Marvel&quot;</span>, <span class="st">&quot;Frozen II&quot;</span>, <span class="st">&quot;IT Chapter Two&quot;</span>, <span class="st">&quot;Joker&quot;</span>, <span class="st">&quot;Spider-Man: Far from Home&quot;</span>, <span class="st">&quot;Star Wars: Episode IX&quot;</span>, <span class="st">&quot;The Lion King&quot;</span>, <span class="st">&quot;Toy Story 4&quot;</span>),</a>
<a class="sourceLine" id="cb278-2" title="2"><span class="dt">amount =</span> <span class="kw">c</span>(<span class="dv">355772511</span>, <span class="dv">858373000</span>, <span class="dv">426829839</span>, <span class="dv">430144682</span>, <span class="dv">211593228</span>,<span class="dv">333772511</span>,<span class="dv">390532085</span>,  <span class="dv">390706234</span>,<span class="dv">543638043</span>,<span class="dv">434038008</span>))</a>
<a class="sourceLine" id="cb278-3" title="3"><span class="kw">barplot</span>(boxoffice2019<span class="op">$</span>amount, </a>
<a class="sourceLine" id="cb278-4" title="4">        <span class="dt">names.arg=</span>boxoffice2019<span class="op">$</span>title)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-249-1.png" width="768" /></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1"><span class="kw">barplot</span>(boxoffice2019<span class="op">$</span>amount, </a>
<a class="sourceLine" id="cb279-2" title="2">        <span class="dt">names.arg=</span>boxoffice2019<span class="op">$</span>title, </a>
<a class="sourceLine" id="cb279-3" title="3">        <span class="dt">las=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-249-2.png" width="768" /></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb280-2" title="2"><span class="kw">barplot</span>(boxoffice2019<span class="op">$</span>amount, </a>
<a class="sourceLine" id="cb280-3" title="3">        <span class="dt">names.arg=</span>boxoffice2019<span class="op">$</span>title, </a>
<a class="sourceLine" id="cb280-4" title="4">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb280-5" title="5">        <span class="dt">las=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-249-3.png" width="768" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb281-2" title="2">boxoffice2019_decreasing  &lt;-<span class="st"> </span>boxoffice2019[<span class="kw">order</span>(boxoffice2019[,<span class="dv">2</span>], <span class="dt">decreasing=</span><span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb281-3" title="3"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb281-4" title="4"><span class="kw">barplot</span>(boxoffice2019_decreasing<span class="op">$</span>amount<span class="op">/</span><span class="dv">1000000</span>, </a>
<a class="sourceLine" id="cb281-5" title="5">        <span class="dt">names.arg=</span>boxoffice2019_decreasing<span class="op">$</span>title, </a>
<a class="sourceLine" id="cb281-6" title="6">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb281-7" title="7">        <span class="dt">las=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb281-8" title="8">        <span class="dt">xlab =</span> <span class="st">&quot;Miljoner USD&quot;</span>,</a>
<a class="sourceLine" id="cb281-9" title="9">        <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb281-10" title="10">        <span class="dt">border =</span><span class="st">&quot;white&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-249-4.png" width="768" /></p>
<p>När man har mångra kategorier lämpar sig dotcharts bättre. Vi ska se ett exempel på detta. I paketet dslabs fick datasetet gapminder. Vi läser in detta dataset för att jämföra europeiska förväntade livslängd. Vi ser också här ett exempel på när olika färger kan tillföra information gällande kategoritillhörighet.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1"><span class="kw">library</span>(<span class="st">&quot;dslabs&quot;</span>)</a>
<a class="sourceLine" id="cb282-2" title="2">gapminderEurope2015 &lt;-<span class="st"> </span>gapminder[(gapminder<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gapminder<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>), ]</a>
<a class="sourceLine" id="cb282-3" title="3">gapminderEurope2015<span class="op">$</span>color &lt;-<span class="st"> </span><span class="kw">factor</span>(gapminderEurope2015<span class="op">$</span>region)</a>
<a class="sourceLine" id="cb282-4" title="4"><span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color)[<span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color) <span class="op">==</span><span class="st"> &quot;Eastern Europe&quot;</span>] &lt;-<span class="st"> &quot;coral2&quot;</span></a>
<a class="sourceLine" id="cb282-5" title="5"><span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color)[<span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color) <span class="op">==</span><span class="st"> &quot;Western Europe&quot;</span>] &lt;-<span class="st"> &quot;palegreen2&quot;</span></a>
<a class="sourceLine" id="cb282-6" title="6"><span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color)[<span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color) <span class="op">==</span><span class="st"> &quot;Southern Europe&quot;</span>] &lt;-<span class="st"> &quot;tan2&quot;</span></a>
<a class="sourceLine" id="cb282-7" title="7"><span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color)[<span class="kw">levels</span>(gapminderEurope2015<span class="op">$</span>color) <span class="op">==</span><span class="st"> &quot;Northern Europe&quot;</span>] &lt;-<span class="st"> &quot;deepskyblue2&quot;</span></a>
<a class="sourceLine" id="cb282-8" title="8">gapminderEurope2015decreasing &lt;-<span class="st"> </span>gapminderEurope2015[<span class="kw">order</span>(gapminderEurope2015<span class="op">$</span>life_expectancy),]</a>
<a class="sourceLine" id="cb282-9" title="9"></a>
<a class="sourceLine" id="cb282-10" title="10"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb282-11" title="11"><span class="kw">barplot</span>(gapminderEurope2015decreasing<span class="op">$</span>life_expectancy, </a>
<a class="sourceLine" id="cb282-12" title="12">        <span class="dt">names.arg =</span> gapminderEurope2015decreasing<span class="op">$</span>country,  </a>
<a class="sourceLine" id="cb282-13" title="13">        <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb282-14" title="14">        <span class="dt">las =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb282-15" title="15">        <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">90</span>), </a>
<a class="sourceLine" id="cb282-16" title="16">        <span class="dt">xlab =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>,</a>
<a class="sourceLine" id="cb282-17" title="17">        <span class="dt">col =</span> <span class="kw">as.character</span>(gapminderEurope2015<span class="op">$</span>color),</a>
<a class="sourceLine" id="cb282-18" title="18">        <span class="dt">border =</span><span class="st">&quot;white&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-250-1.png" width="768" /></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb283-2" title="2"><span class="kw">dotchart</span>(gapminderEurope2015<span class="op">$</span>life_expectancy, </a>
<a class="sourceLine" id="cb283-3" title="3">        <span class="dt">labels=</span> gapminderEurope2015<span class="op">$</span>country,  </a>
<a class="sourceLine" id="cb283-4" title="4">        <span class="dt">las =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb283-5" title="5">        <span class="dt">cex =</span> <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb283-6" title="6">        <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb283-7" title="7">        <span class="dt">xlab =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)</a>
<a class="sourceLine" id="cb283-8" title="8"></a>
<a class="sourceLine" id="cb283-9" title="9"><span class="kw">dotchart</span>(gapminderEurope2015decreasing<span class="op">$</span>life_expectancy, </a>
<a class="sourceLine" id="cb283-10" title="10">        <span class="dt">labels=</span> gapminderEurope2015decreasing<span class="op">$</span>country,  </a>
<a class="sourceLine" id="cb283-11" title="11">        <span class="dt">las =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb283-12" title="12">        <span class="dt">cex =</span> <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb283-13" title="13">        <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb283-14" title="14">        <span class="dt">xlab =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-250-2.png" width="768" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="kw">dotchart</span>(gapminderEurope2015decreasing<span class="op">$</span>life_expectancy, </a>
<a class="sourceLine" id="cb284-2" title="2">        <span class="dt">labels=</span> gapminderEurope2015decreasing<span class="op">$</span>country,  </a>
<a class="sourceLine" id="cb284-3" title="3">        <span class="dt">las =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb284-4" title="4">        <span class="dt">cex =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb284-5" title="5">        <span class="dt">xlab =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>,<span class="dt">col =</span> <span class="kw">as.character</span>(gapminderEurope2015<span class="op">$</span>color))</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-250-3.png" width="768" /></p>
</div>
</div>
<div id="cirkeldigram" class="section level2">
<h2><span class="header-section-number">8.3</span> Cirkeldigram</h2>
<p>R-manualen avråder från cirkeldiagram.</p>
<ul>
<li>Det finns om man vill se om en grupp kategorier överstiger en andel (t ex 50% eller 25%)</li>
</ul>
</div>
<div id="figurer-för-fördelningar" class="section level2">
<h2><span class="header-section-number">8.4</span> Figurer för fördelningar</h2>
<p>Histogram används för att visualisera en kontinuerlig variabel. Funktionen hist() skapar ett histogram. Nackdelen med histogram är att den är känslig för antalet klasser. Testa därför olika antal klasser.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb285-2" title="2"><span class="kw">hist</span>(df<span class="op">$</span>gripstrength, <span class="dt">xlab=</span><span class="st">&quot;Greppstyrka (Newton)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Antal&quot;</span>, <span class="dt">breaks=</span><span class="dv">7</span>, <span class="dt">main=</span><span class="st">&quot;7 klasser&quot;</span>)</a>
<a class="sourceLine" id="cb285-3" title="3"><span class="kw">hist</span>(df<span class="op">$</span>gripstrength, <span class="dt">xlab=</span><span class="st">&quot;Greppstyrka (Newton)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Antal&quot;</span>, <span class="dt">breaks=</span><span class="dv">14</span>, <span class="dt">main=</span><span class="st">&quot;14 klasser&quot;</span>)</a>
<a class="sourceLine" id="cb285-4" title="4"><span class="kw">hist</span>(df<span class="op">$</span>gripstrength, <span class="dt">xlab=</span><span class="st">&quot;Greppstyrka (Newton)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Antal&quot;</span>, <span class="dt">breaks=</span><span class="dv">28</span>, <span class="dt">main=</span><span class="st">&quot;28 klasser&quot;</span>)</a>
<a class="sourceLine" id="cb285-5" title="5"><span class="kw">hist</span>(df<span class="op">$</span>gripstrength, <span class="dt">xlab=</span><span class="st">&quot;Greppstyrka (Newton)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Antal&quot;</span>, <span class="dt">breaks=</span><span class="dv">56</span>, <span class="dt">main=</span><span class="st">&quot;56 klasser&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-251-1.png" width="768" /></p>
</div>
<div id="lådagram" class="section level2">
<h2><span class="header-section-number">8.5</span> Lådagram</h2>
<p>Lådagram används främst när vi ska jämföra fördelningar uppdelat på kategorier.
Att använda lådagram för en enda variabel är inte optimalt, utan histogram ger då mer information.</p>
<p>Vi vill studera testresultat uppdelat på psykologisk bedämning</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="kw">boxplot</span>(df<span class="op">$</span>gripstrength<span class="op">~</span>df<span class="op">$</span>psych, <span class="dt">xlab=</span><span class="st">&quot;Psykologisk bedömning (1-9)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Greppstyrka (Newton)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
</div>
<div id="spridningsdiagram" class="section level2">
<h2><span class="header-section-number">8.6</span> Spridningsdiagram</h2>
<p>Den vanligaste funktionen i R för att skapa figurer är <strong>plot</strong>. Det finns många argument och i de närmaste obegränsade möjligher att anpassa figurerna. Nedan visar vi ett problem som kan uppkomma med spridningsdiagram, nämligen när vi har väldigt många datapunkter. Det första diagrammet redovisar de 500 första individerna i INSARK. Det andra diagrammet redovisar data från alla 709869 individer.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1"><span class="kw">plot</span>(df<span class="op">$</span>legstrength[<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>], df<span class="op">$</span>armstrength[<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>], <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Armstyrka (Newton)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-253-1.png" width="672" /></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1"><span class="kw">plot</span>(df<span class="op">$</span>legstrength, df<span class="op">$</span>armstrength, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Armstyrka (Newton)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-253-2.png" width="672" /></p>
</div>
<div id="exportera-figurer" class="section level2">
<h2><span class="header-section-number">8.7</span> Exportera figurer</h2>
<p>Det finns ett antal olika format att exportera figurer till. Det absolut enklaste är använda <strong>Export</strong> i fliken <strong>Plots</strong>. Här väljer du antingen <em>Save as image…</em> eller <em>Save as PDF…</em></p>
<ul>
<li>PDF är ett bra format om man ska skriva ut. Det är vektorbaserat vilket innebär att det går bra att zooma in i bilden utan att upplösningen blir dålig. Figuren tar inte mycket minne.</li>
<li>Formatet png är bitmap-baserat format som är utmärkt för webben. Ofta krävs, tyvärr, också png för ordbehandlingsprogram, vilket gör exxport av figurer med hög kvalitet krångligare, jämfört med PDF. Använd aldrig jpg, som är alternativet.</li>
</ul>
<p>Det finns dock ganska få inställningar i Export. Ett alternativ som ger mer flexibilitet är att skapa en PDF eller png från R och sen rita figuren på denna. Vi tittar på två exempel nedan, först ett för PDF och sedan ett för png.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1"><span class="co"># Skapa en PDF att rita. Storleken anges med width och height och dimensionen är tum. </span></a>
<a class="sourceLine" id="cb289-2" title="2"><span class="kw">pdf</span>(<span class="st">&quot;data/rplot.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">height =</span> <span class="dv">6</span>) </a>
<a class="sourceLine" id="cb289-3" title="3"><span class="co"># Börja rita figuren på filen</span></a>
<a class="sourceLine" id="cb289-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb289-5" title="5"> <span class="kw">plot</span>(x1, y1, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb289-6" title="6"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb289-7" title="7"> <span class="kw">plot</span>(x2, y2, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb289-8" title="8"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb289-9" title="9"> <span class="kw">plot</span>(x3, y3, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb289-10" title="10"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb289-11" title="11"> <span class="kw">plot</span>(x4, y4, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb289-12" title="12"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb289-13" title="13"><span class="co"># Stänger plot och sparar. Den sparas enligt sökvägen ovan.</span></a>
<a class="sourceLine" id="cb289-14" title="14"> <span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1"><span class="co"># Skapar en png att rita på. Storleken anges med width och height och dimensionen är cm (units). </span></a>
<a class="sourceLine" id="cb290-2" title="2"><span class="co"># Upplösningen (dpi) är viktig för en bitmap-baserad fil. Förslagsvis används res = 1200 för utskrift och res = 72 webben eller skärmen. type = &quot;cairo&quot; anger att kantutjämning (antialias) ska användas, vilket ger snyggare utseende.</span></a>
<a class="sourceLine" id="cb290-3" title="3"><span class="kw">png</span>(<span class="st">&quot;data/rplot.png&quot;</span>, <span class="dt">width =</span> <span class="dv">18</span>, <span class="dt">height =</span> <span class="dv">14</span>, <span class="dt">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="dt">res =</span> <span class="dv">1200</span>, <span class="dt">type=</span><span class="st">&#39;cairo&#39;</span>)</a>
<a class="sourceLine" id="cb290-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb290-5" title="5"> <span class="kw">plot</span>(x1, y1, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb290-6" title="6"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb290-7" title="7"> <span class="kw">plot</span>(x2, y2, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb290-8" title="8"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb290-9" title="9"> <span class="kw">plot</span>(x3, y3, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb290-10" title="10"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb290-11" title="11"> <span class="kw">plot</span>(x4, y4, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">13</span>))</a>
<a class="sourceLine" id="cb290-12" title="12"> <span class="kw">lines</span>(x, Ey, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb290-13" title="13"><span class="kw">dev.off</span>()</a></code></pre></div>
<p>Avslutningsvis några tips:</p>
<ul>
<li>Bestäm bredd-höjd-relationen (aspect ratio) redan när du skapar figuren i R. Stretcha inte figuren efter att du skapat figuren! Kvaliteten kan försämras betydligt. Du kan dock eventuellt förminska och förstora figuren, så länge bredd-höjd-relationen bibehålls.</li>
<li>Om det finns mycket vit yta, minska marginalerna med argumentet <strong>mar</strong> i <strong>par()</strong>funktionen.</li>
<li>Om du skapar en stor figur, då måste du med t ex <strong>cex</strong>-argument i figuren öka storleken på text. Ofta måste man prova sig fram. Var beredd på att ändra storlek på text och siffror i figuren.</li>
</ul>
<!--chapter:end:08-figurer.Rmd-->
</div>
</div>
<div id="urvalsmetoder" class="section level1">
<h1><span class="header-section-number">9</span> Urvalsmetoder</h1>
<p><img src="docs/images/hat.png" width="25%" style="background-color: #414244 ; padding:1px; display: inline-block;" /></p>
<p>Detta kapitel utgår från vi önskar beskriva en ändlig population vars värden betraktas som fixa och ej slumpmässiga. Om hela populationen är känd finns ingen osäkerhet, men av olika anledningar kan inte hela populationen undersökas. Vi är därför hänvisade till att genomföra ett slumpmässigt urval. Detta är en del i ett <strong>designbaserat ramverk</strong> där slumpmässigheten beror på själva urvalsdesignen.</p>
<p>En alternativ sätt att betrakta slumpmässigheten är utgå från ett <strong>modellbaserat ramverk</strong> där populationen är en statistisk matematisk modell. Målet kan då vara att skatta parametrarna i denna modell för exempelvis kunna beskriva modellen eller använda modellen för prediktion.</p>
<p>utgångspunkten här är emellertid det designbaserade ramverket och en ändlig population bestående av <span class="math inline">\(N\)</span> element (objekt). Beteckna element <span class="math inline">\(k\)</span> med sitt nummer <span class="math inline">\(k\)</span>. Elementen i den ändliga populationen <span class="math inline">\(U\)</span> kan listas
<span class="math display">\[U=\left\{1,2,\ldots,k,\ldots,N\right\}.\]</span>
Låt <span class="math inline">\(x\)</span> beteckna en variabel av intresse och låt <span class="math inline">\(x_k\)</span> vara det värdet som element <span class="math inline">\(k\)</span> har.</p>
<p>En  är en konstant som beskriver en variabel i populationen <span class="math inline">\(U\)</span> och i en ändlig population kan en sådan formuleras utifrån populationens fixa värden. Parametern populationsmedelvärdet är exempelvis</p>
<p><span class="math display">\[\mu = \dfrac{x_1+x_2+\cdots+x_N}{N} = \dfrac{1}{N}\sum_{i=1}^N x_i\]</span></p>
<p>Andra vanliga parametrar är andelen, <span class="math inline">\(p\)</span>, totalen, <span class="math inline">\(\tau\)</span>, och variansen, <span class="math inline">\(\sigma^2\)</span>:</p>
<p><span class="math display">\[p=\frac{x}{n},\,\,\,\text{där}\, x \,\text{är antal händelser},\,\,\,\,\,\,\,\,\,\tau = \sum_{i=1}^N x_i = N\mu, \,\,\,\,\,\,\,\,\,\sigma^2 = \dfrac{1}{N}\sum_{i=1}^N (x_i - \mu)^2=\sum_i^N x_i^2-\mu^2.\]</span></p>
<p>Observera att parametrarna inte är slumpvariabler eftersom populationens värden är fixa.
Slumpmässigheten beror på den slumpmässiga urvalsdesignen som används. Målet med detta kapitel är att beskriva några olika urvalsdesigner och dess betydelse för skattning av några parametrar i populationerna.</p>
<p>För att exemplifiera de olika urvalsmetoderna i R kommer följande data att användas. Läs därför in följande dataframe om du ska replikera exempel.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1"><span class="co"># Töm minnet</span></a>
<a class="sourceLine" id="cb291-2" title="2"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb291-3" title="3"><span class="co"># Börja med att läsa in data till uppgiften</span></a>
<a class="sourceLine" id="cb291-4" title="4"> df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">500</span><span class="op">:</span><span class="dv">919</span>,</a>
<a class="sourceLine" id="cb291-5" title="5">                  <span class="dt">inkomst =</span> <span class="kw">c</span>(<span class="dv">21612</span>,<span class="dv">26831</span>,<span class="dv">29068</span>,<span class="dv">41121</span>,<span class="dv">26601</span>,<span class="dv">10495</span>,<span class="dv">32891</span>,<span class="dv">23065</span>,<span class="dv">20098</span>,<span class="dv">27192</span>,<span class="dv">10864</span>,<span class="dv">33128</span>,<span class="dv">25951</span>,<span class="dv">13931</span>,<span class="dv">42063</span>,<span class="dv">20053</span>,<span class="dv">16979</span>,<span class="dv">18457</span>,<span class="dv">13727</span>,<span class="dv">12289</span>,<span class="dv">18474</span>,<span class="dv">29347</span>,<span class="dv">6172</span>,<span class="dv">62354</span>,<span class="dv">26727</span>,<span class="dv">40591</span>,<span class="dv">32350</span>,<span class="dv">15695</span>,<span class="dv">39887</span>,<span class="dv">36051</span>,<span class="dv">27667</span>,<span class="dv">32995</span>,<span class="dv">16711</span>,<span class="dv">29466</span>,<span class="dv">46706</span>,<span class="dv">15008</span>,<span class="dv">16223</span>,<span class="dv">12420</span>,<span class="dv">29185</span>,<span class="dv">21492</span>,<span class="dv">32746</span>,<span class="dv">36412</span>,<span class="dv">18635</span>,<span class="dv">9407</span>,<span class="dv">42185</span>,<span class="dv">18270</span>,<span class="dv">60093</span>,<span class="dv">43245</span>,<span class="dv">26905</span>,<span class="dv">47235</span>,<span class="dv">23508</span>,<span class="dv">29302</span>,<span class="dv">33199</span>,<span class="dv">16940</span>,<span class="dv">14905</span>,<span class="dv">18904</span>,<span class="dv">8200</span>,<span class="dv">10823</span>,<span class="dv">13540</span>,<span class="dv">32811</span>,<span class="dv">35465</span>,<span class="dv">19754</span>,<span class="dv">17484</span>,<span class="dv">19823</span>,<span class="dv">31397</span>,<span class="dv">26130</span>,<span class="dv">22034</span>,<span class="dv">20491</span>,<span class="dv">25759</span>,<span class="dv">84710</span>,<span class="dv">18300</span>,<span class="dv">29405</span>,<span class="dv">18801</span>,<span class="dv">14813</span>,<span class="dv">20879</span>,<span class="dv">24499</span>,<span class="dv">16288</span>,<span class="dv">40533</span>,<span class="dv">39616</span>,<span class="dv">25343</span>,<span class="dv">40417</span>,<span class="dv">11639</span>,<span class="dv">42591</span>,<span class="dv">29613</span>,<span class="dv">49918</span>,<span class="dv">24015</span>,<span class="dv">7917</span>,<span class="dv">48072</span>,<span class="dv">23721</span>,<span class="dv">40454</span>,<span class="dv">22857</span>,<span class="dv">24890</span>,<span class="dv">26873</span>,<span class="dv">25733</span>,<span class="dv">31870</span>,<span class="dv">22394</span>,<span class="dv">28161</span>,<span class="dv">40196</span>,<span class="dv">7263</span>,<span class="dv">9187</span>,<span class="dv">30253</span>,<span class="dv">6462</span>,<span class="dv">37143</span>,<span class="dv">31732</span>,<span class="dv">12895</span>,<span class="dv">41056</span>,<span class="dv">19258</span>,<span class="dv">24978</span>,<span class="dv">25309</span>,<span class="dv">19061</span>,<span class="dv">30371</span>,<span class="dv">22022</span>,<span class="dv">30063</span>,<span class="dv">44522</span>,<span class="dv">26037</span>,<span class="dv">29028</span>,<span class="dv">10030</span>,<span class="dv">24272</span>,<span class="dv">11394</span>,<span class="dv">18576</span>,<span class="dv">20376</span>,<span class="dv">31086</span>,<span class="dv">11700</span>,<span class="dv">17003</span>,<span class="dv">34196</span>,<span class="dv">19755</span>,<span class="dv">44144</span>,<span class="dv">23741</span>,<span class="dv">35294</span>,<span class="dv">41388</span>,<span class="dv">16435</span>,<span class="dv">18644</span>,<span class="dv">15322</span>,<span class="dv">51665</span>,<span class="dv">23378</span>,<span class="dv">50478</span>,<span class="dv">34808</span>,<span class="dv">20447</span>,<span class="dv">41233</span>,<span class="dv">17311</span>,<span class="dv">13941</span>,<span class="dv">39664</span>,<span class="dv">13168</span>,<span class="dv">28809</span>,<span class="dv">55952</span>,<span class="dv">12495</span>,<span class="dv">20185</span>,<span class="dv">38094</span>,<span class="dv">13822</span>,<span class="dv">32932</span>,<span class="dv">22205</span>,<span class="dv">36625</span>,<span class="dv">51575</span>,<span class="dv">21508</span>,<span class="dv">33509</span>,<span class="dv">26322</span>,<span class="dv">15392</span>,<span class="dv">21626</span>,<span class="dv">18837</span>,<span class="dv">24299</span>,<span class="dv">38921</span>,<span class="dv">38951</span>,<span class="dv">18360</span>,<span class="dv">32974</span>,<span class="dv">14131</span>,<span class="dv">28463</span>,<span class="dv">38232</span>,<span class="dv">20072</span>,<span class="dv">24300</span>,<span class="dv">40883</span>,<span class="dv">9090</span>,<span class="dv">30565</span>,<span class="dv">32935</span>,<span class="dv">32589</span>,<span class="dv">14408</span>,<span class="dv">33223</span>,<span class="dv">20177</span>,<span class="dv">32574</span>,<span class="dv">30640</span>,<span class="dv">16255</span>,<span class="dv">24056</span>,<span class="dv">18365</span>,<span class="dv">22039</span>,<span class="dv">32859</span>,<span class="dv">13595</span>,<span class="dv">10514</span>,<span class="dv">19490</span>,<span class="dv">30075</span>,<span class="dv">29849</span>,<span class="dv">14371</span>,<span class="dv">15076</span>,<span class="dv">18983</span>,<span class="dv">26641</span>,<span class="dv">14967</span>,<span class="dv">38646</span>,<span class="dv">27197</span>,<span class="dv">15314</span>,<span class="dv">9058</span>,<span class="dv">10275</span>,<span class="dv">19248</span>,<span class="dv">33629</span>,<span class="dv">16039</span>,<span class="dv">15302</span>,<span class="dv">8363</span>,<span class="dv">29178</span>,<span class="dv">29565</span>,<span class="dv">35454</span>,<span class="dv">25673</span>,<span class="dv">25116</span>,<span class="dv">21695</span>,<span class="dv">12594</span>,<span class="dv">31860</span>,<span class="dv">48489</span>,<span class="dv">37977</span>,<span class="dv">20106</span>,<span class="dv">45531</span>,<span class="dv">27277</span>,<span class="dv">15418</span>,<span class="dv">18315</span>,<span class="dv">20529</span>,<span class="dv">24322</span>,<span class="dv">9509</span>,<span class="dv">22487</span>,<span class="dv">14443</span>,<span class="dv">30287</span>,<span class="dv">33711</span>,<span class="dv">28788</span>,<span class="dv">38495</span>,<span class="dv">43640</span>,<span class="dv">21820</span>,<span class="dv">12945</span>,<span class="dv">29219</span>,<span class="dv">26099</span>,<span class="dv">53993</span>,<span class="dv">18370</span>,<span class="dv">13513</span>,<span class="dv">34515</span>,<span class="dv">39675</span>,<span class="dv">24622</span>,<span class="dv">10069</span>,<span class="dv">42460</span>,<span class="dv">21113</span>,<span class="dv">32073</span>,<span class="dv">40741</span>,<span class="dv">25925</span>,<span class="dv">48530</span>,<span class="dv">37672</span>,<span class="dv">16809</span>,<span class="dv">53412</span>,<span class="dv">28576</span>,<span class="dv">20974</span>,<span class="dv">53895</span>,<span class="dv">17485</span>,<span class="dv">9382</span>,<span class="dv">26977</span>,<span class="dv">37076</span>,<span class="dv">34885</span>,<span class="dv">24809</span>,<span class="dv">12793</span>,<span class="dv">18749</span>,<span class="dv">22223</span>,<span class="dv">27462</span>,<span class="dv">33319</span>,<span class="dv">25212</span>,<span class="dv">19846</span>,<span class="dv">36005</span>,<span class="dv">22765</span>,<span class="dv">25484</span>,<span class="dv">5710</span>,<span class="dv">22545</span>,<span class="dv">26475</span>,<span class="dv">50017</span>,<span class="dv">10044</span>,<span class="dv">28683</span>,<span class="dv">28379</span>,<span class="dv">36793</span>,<span class="dv">37007</span>,<span class="dv">43140</span>,<span class="dv">11389</span>,<span class="dv">28621</span>,<span class="dv">8074</span>,<span class="dv">18887</span>,<span class="dv">8729</span>,<span class="dv">34029</span>,<span class="dv">22957</span>,<span class="dv">25761</span>,<span class="dv">21928</span>,<span class="dv">23366</span>,<span class="dv">21629</span>,<span class="dv">29325</span>,<span class="dv">17545</span>,<span class="dv">34121</span>,<span class="dv">9780</span>,<span class="dv">34344</span>,<span class="dv">15565</span>,<span class="dv">35821</span>,<span class="dv">22192</span>,<span class="dv">24715</span>,<span class="dv">29730</span>,<span class="dv">36446</span>,<span class="dv">19315</span>,<span class="dv">18764</span>,<span class="dv">30303</span>,<span class="dv">44705</span>,<span class="dv">24113</span>,<span class="dv">24773</span>,<span class="dv">13433</span>,<span class="dv">21116</span>,<span class="dv">22444</span>,<span class="dv">17098</span>,<span class="dv">27646</span>,<span class="dv">29356</span>,<span class="dv">11167</span>,<span class="dv">39386</span>,<span class="dv">46786</span>,<span class="dv">20476</span>,<span class="dv">32806</span>,<span class="dv">8196</span>,<span class="dv">20299</span>,<span class="dv">11016</span>,<span class="dv">28822</span>,<span class="dv">34008</span>,<span class="dv">36611</span>,<span class="dv">40839</span>,<span class="dv">38823</span>,<span class="dv">27474</span>,<span class="dv">21803</span>,<span class="dv">23579</span>,<span class="dv">24328</span>,<span class="dv">26289</span>,<span class="dv">34776</span>,<span class="dv">42902</span>,<span class="dv">5958</span>,<span class="dv">20928</span>,<span class="dv">8996</span>,<span class="dv">14684</span>,<span class="dv">19391</span>,<span class="dv">14105</span>,<span class="dv">24321</span>,<span class="dv">31704</span>,<span class="dv">40910</span>,<span class="dv">14725</span>,<span class="dv">25166</span>,<span class="dv">33578</span>,<span class="dv">21071</span>,<span class="dv">37265</span>,<span class="dv">21827</span>,<span class="dv">17284</span>,<span class="dv">16401</span>,<span class="dv">38311</span>,<span class="dv">10416</span>,<span class="dv">16634</span>,<span class="dv">32329</span>,<span class="dv">18411</span>,<span class="dv">11388</span>,<span class="dv">22741</span>,<span class="dv">45799</span>,<span class="dv">24504</span>,<span class="dv">18190</span>,<span class="dv">9708</span>,<span class="dv">9590</span>,<span class="dv">10068</span>,<span class="dv">15552</span>,<span class="dv">34781</span>,<span class="dv">17205</span>,<span class="dv">12180</span>,<span class="dv">31054</span>,<span class="dv">19803</span>,<span class="dv">34321</span>,<span class="dv">28206</span>,<span class="dv">13392</span>,<span class="dv">25659</span>,<span class="dv">13679</span>,<span class="dv">10817</span>,<span class="dv">48137</span>,<span class="dv">16057</span>,<span class="dv">30680</span>,<span class="dv">28931</span>,<span class="dv">8746</span>,<span class="dv">51031</span>,<span class="dv">15530</span>,<span class="dv">21598</span>,<span class="dv">12816</span>,<span class="dv">39388</span>,<span class="dv">36873</span>,<span class="dv">10815</span>,<span class="dv">26335</span>,<span class="dv">8332</span>,<span class="dv">25860</span>,<span class="dv">12491</span>,<span class="dv">26264</span>,<span class="dv">17914</span>,<span class="dv">13240</span>,<span class="dv">51238</span>,<span class="dv">18080</span>,<span class="dv">28812</span>,<span class="dv">40576</span>,<span class="dv">33316</span>,<span class="dv">3978</span>,<span class="dv">32843</span>,<span class="dv">14942</span>,<span class="dv">33416</span>,<span class="dv">11274</span>,<span class="dv">14775</span>,<span class="dv">25466</span>,<span class="dv">15959</span>,<span class="dv">21031</span>,<span class="dv">12042</span>,<span class="dv">9518</span>,<span class="dv">38184</span>,<span class="dv">10007</span>,<span class="dv">8226</span>,<span class="dv">11975</span>,<span class="dv">29364</span>,<span class="dv">57382</span>,<span class="dv">11814</span>,<span class="dv">28760</span>,<span class="dv">19193</span>,<span class="dv">24117</span>,<span class="dv">35747</span>),</a>
<a class="sourceLine" id="cb291-6" title="6">                  <span class="dt">alder =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb291-7" title="7">                  <span class="dt">postnr  =</span> <span class="kw">c</span>(<span class="dv">85466</span>,<span class="dv">15111</span>,<span class="dv">1111</span>,<span class="dv">42520</span>,<span class="dv">7655</span>,<span class="dv">4434</span>,<span class="dv">113231</span>,<span class="dv">5520</span>,<span class="dv">112233</span>,<span class="dv">7854</span>,<span class="dv">4520</span>,<span class="dv">85466</span>,<span class="dv">4520</span>,<span class="dv">5520</span>,<span class="dv">15111</span>,<span class="dv">4343</span>,<span class="dv">9866</span>,<span class="dv">222</span>,<span class="dv">64267</span>,<span class="dv">55220</span>,<span class="dv">7655</span>,<span class="dv">222</span>,<span class="dv">42520</span>,<span class="dv">85466</span>,<span class="dv">4520</span>,<span class="dv">4434</span>,<span class="dv">42520</span>,<span class="dv">5554</span>,<span class="dv">1111</span>,<span class="dv">222</span>,<span class="dv">4520</span>,<span class="dv">7854</span>,<span class="dv">15111</span>,<span class="dv">3133</span>,<span class="dv">7854</span>,<span class="dv">1111</span>,<span class="dv">5554</span>,<span class="dv">77664</span>,<span class="dv">1131</span>,<span class="dv">42520</span>,<span class="dv">85466</span>,<span class="dv">112233</span>,<span class="dv">42520</span>,<span class="dv">1111</span>,<span class="dv">453</span>,<span class="dv">14520</span>,<span class="dv">453</span>,<span class="dv">453</span>,<span class="dv">4434</span>,<span class="dv">77664</span>,<span class="dv">85466</span>,<span class="dv">5520</span>,<span class="dv">15111</span>,<span class="dv">5554</span>,<span class="dv">7854</span>,<span class="dv">3467</span>,<span class="dv">3133</span>,<span class="dv">5520</span>,<span class="dv">15111</span>,<span class="dv">4434</span>,<span class="dv">112233</span>,<span class="dv">15111</span>,<span class="dv">112233</span>,<span class="dv">85466</span>,<span class="dv">1111</span>,<span class="dv">1111</span>,<span class="dv">7655</span>,<span class="dv">4343</span>,<span class="dv">85466</span>,<span class="dv">55220</span>,<span class="dv">113231</span>,<span class="dv">55220</span>,<span class="dv">15111</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">453</span>,<span class="dv">9866</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">85466</span>,<span class="dv">1131</span>,<span class="dv">4434</span>,<span class="dv">77664</span>,<span class="dv">9866</span>,<span class="dv">3467</span>,<span class="dv">5520</span>,<span class="dv">14520</span>,<span class="dv">85466</span>,<span class="dv">113231</span>,<span class="dv">4520</span>,<span class="dv">4343</span>,<span class="dv">85466</span>,<span class="dv">4520</span>,<span class="dv">222</span>,<span class="dv">85466</span>,<span class="dv">1111</span>,<span class="dv">4520</span>,<span class="dv">4343</span>,<span class="dv">85466</span>,<span class="dv">14520</span>,<span class="dv">55220</span>,<span class="dv">3467</span>,<span class="dv">42520</span>,<span class="dv">64267</span>,<span class="dv">85466</span>,<span class="dv">7655</span>,<span class="dv">1111</span>,<span class="dv">113231</span>,<span class="dv">112233</span>,<span class="dv">3133</span>,<span class="dv">3133</span>,<span class="dv">453</span>,<span class="dv">3133</span>,<span class="dv">9866</span>,<span class="dv">4520</span>,<span class="dv">7854</span>,<span class="dv">222</span>,<span class="dv">453</span>,<span class="dv">112233</span>,<span class="dv">7854</span>,<span class="dv">64267</span>,<span class="dv">222</span>,<span class="dv">222</span>,<span class="dv">4520</span>,<span class="dv">1111</span>,<span class="dv">7854</span>,<span class="dv">3467</span>,<span class="dv">1111</span>,<span class="dv">7655</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">4520</span>,<span class="dv">453</span>,<span class="dv">5520</span>,<span class="dv">4343</span>,<span class="dv">3133</span>,<span class="dv">42520</span>,<span class="dv">4343</span>,<span class="dv">4520</span>,<span class="dv">1111</span>,<span class="dv">85466</span>,<span class="dv">55220</span>,<span class="dv">453</span>,<span class="dv">9866</span>,<span class="dv">55220</span>,<span class="dv">3467</span>,<span class="dv">112233</span>,<span class="dv">9866</span>,<span class="dv">4434</span>,<span class="dv">222</span>,<span class="dv">64267</span>,<span class="dv">7854</span>,<span class="dv">85466</span>,<span class="dv">3467</span>,<span class="dv">85466</span>,<span class="dv">15111</span>,<span class="dv">85466</span>,<span class="dv">4343</span>,<span class="dv">85466</span>,<span class="dv">77664</span>,<span class="dv">77664</span>,<span class="dv">113231</span>,<span class="dv">85466</span>,<span class="dv">3467</span>,<span class="dv">85466</span>,<span class="dv">4343</span>,<span class="dv">15111</span>,<span class="dv">4434</span>,<span class="dv">1131</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">7854</span>,<span class="dv">5520</span>,<span class="dv">453</span>,<span class="dv">15111</span>,<span class="dv">113231</span>,<span class="dv">9866</span>,<span class="dv">85466</span>,<span class="dv">113231</span>,<span class="dv">42520</span>,<span class="dv">85466</span>,<span class="dv">14520</span>,<span class="dv">55220</span>,<span class="dv">7655</span>,<span class="dv">85466</span>,<span class="dv">64267</span>,<span class="dv">9866</span>,<span class="dv">4434</span>,<span class="dv">4434</span>,<span class="dv">4520</span>,<span class="dv">3467</span>,<span class="dv">55220</span>,<span class="dv">15111</span>,<span class="dv">3467</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">4343</span>,<span class="dv">85466</span>,<span class="dv">222</span>,<span class="dv">85466</span>,<span class="dv">453</span>,<span class="dv">9866</span>,<span class="dv">4343</span>,<span class="dv">4434</span>,<span class="dv">4343</span>,<span class="dv">7854</span>,<span class="dv">5554</span>,<span class="dv">7854</span>,<span class="dv">7655</span>,<span class="dv">5554</span>,<span class="dv">1131</span>,<span class="dv">9866</span>,<span class="dv">9866</span>,<span class="dv">9866</span>,<span class="dv">64267</span>,<span class="dv">3467</span>,<span class="dv">4343</span>,<span class="dv">1131</span>,<span class="dv">4520</span>,<span class="dv">7854</span>,<span class="dv">113231</span>,<span class="dv">7655</span>,<span class="dv">55220</span>,<span class="dv">1131</span>,<span class="dv">85466</span>,<span class="dv">113231</span>,<span class="dv">9866</span>,<span class="dv">1111</span>,<span class="dv">7655</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">453</span>,<span class="dv">9866</span>,<span class="dv">9866</span>,<span class="dv">15111</span>,<span class="dv">9866</span>,<span class="dv">7854</span>,<span class="dv">85466</span>,<span class="dv">1131</span>,<span class="dv">7854</span>,<span class="dv">7854</span>,<span class="dv">5520</span>,<span class="dv">14520</span>,<span class="dv">77664</span>,<span class="dv">7854</span>,<span class="dv">1131</span>,<span class="dv">113231</span>,<span class="dv">9866</span>,<span class="dv">3467</span>,<span class="dv">77664</span>,<span class="dv">113231</span>,<span class="dv">4520</span>,<span class="dv">4343</span>,<span class="dv">112233</span>,<span class="dv">9866</span>,<span class="dv">4343</span>,<span class="dv">1111</span>,<span class="dv">453</span>,<span class="dv">453</span>,<span class="dv">112233</span>,<span class="dv">55220</span>,<span class="dv">4520</span>,<span class="dv">85466</span>,<span class="dv">222</span>,<span class="dv">4434</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">15111</span>,<span class="dv">3467</span>,<span class="dv">112233</span>,<span class="dv">1131</span>,<span class="dv">3133</span>,<span class="dv">4343</span>,<span class="dv">7854</span>,<span class="dv">4434</span>,<span class="dv">85466</span>,<span class="dv">77664</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">85466</span>,<span class="dv">5520</span>,<span class="dv">4434</span>,<span class="dv">85466</span>,<span class="dv">5520</span>,<span class="dv">5554</span>,<span class="dv">15111</span>,<span class="dv">9866</span>,<span class="dv">3467</span>,<span class="dv">112233</span>,<span class="dv">222</span>,<span class="dv">7854</span>,<span class="dv">85466</span>,<span class="dv">453</span>,<span class="dv">4343</span>,<span class="dv">7854</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">64267</span>,<span class="dv">4520</span>,<span class="dv">14520</span>,<span class="dv">453</span>,<span class="dv">3467</span>,<span class="dv">4343</span>,<span class="dv">453</span>,<span class="dv">1111</span>,<span class="dv">14520</span>,<span class="dv">222</span>,<span class="dv">15111</span>,<span class="dv">112233</span>,<span class="dv">7655</span>,<span class="dv">7854</span>,<span class="dv">85466</span>,<span class="dv">64267</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">55220</span>,<span class="dv">15111</span>,<span class="dv">77664</span>,<span class="dv">77664</span>,<span class="dv">222</span>,<span class="dv">7854</span>,<span class="dv">3467</span>,<span class="dv">77664</span>,<span class="dv">64267</span>,<span class="dv">15111</span>,<span class="dv">85466</span>,<span class="dv">113231</span>,<span class="dv">77664</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">85466</span>,<span class="dv">112233</span>,<span class="dv">1131</span>,<span class="dv">7854</span>,<span class="dv">64267</span>,<span class="dv">7854</span>,<span class="dv">4343</span>,<span class="dv">222</span>,<span class="dv">85466</span>,<span class="dv">64267</span>,<span class="dv">85466</span>,<span class="dv">4520</span>,<span class="dv">1111</span>,<span class="dv">3467</span>,<span class="dv">5520</span>,<span class="dv">113231</span>,<span class="dv">3467</span>,<span class="dv">1111</span>,<span class="dv">4520</span>,<span class="dv">42520</span>,<span class="dv">85466</span>,<span class="dv">1131</span>,<span class="dv">1131</span>,<span class="dv">3467</span>,<span class="dv">3133</span>,<span class="dv">15111</span>,<span class="dv">85466</span>,<span class="dv">15111</span>,<span class="dv">9866</span>,<span class="dv">14520</span>,<span class="dv">3133</span>,<span class="dv">85466</span>,<span class="dv">112233</span>,<span class="dv">85466</span>,<span class="dv">3467</span>,<span class="dv">7854</span>,<span class="dv">453</span>,<span class="dv">1131</span>,<span class="dv">4343</span>,<span class="dv">85466</span>,<span class="dv">9866</span>,<span class="dv">42520</span>,<span class="dv">113231</span>,<span class="dv">1111</span>,<span class="dv">112233</span>,<span class="dv">5520</span>,<span class="dv">113231</span>,<span class="dv">9866</span>,<span class="dv">7655</span>,<span class="dv">453</span>,<span class="dv">5520</span>,<span class="dv">55220</span>,<span class="dv">5520</span>,<span class="dv">85466</span>,<span class="dv">55220</span>,<span class="dv">85466</span>,<span class="dv">5554</span>,<span class="dv">453</span>,<span class="dv">55220</span>,<span class="dv">7655</span>,<span class="dv">453</span>,<span class="dv">1131</span>,<span class="dv">222</span>,<span class="dv">42520</span>,<span class="dv">9866</span>,<span class="dv">1111</span>,<span class="dv">15111</span>,<span class="dv">4520</span>,<span class="dv">4520</span>,<span class="dv">85466</span>,<span class="dv">3467</span>,<span class="dv">5554</span>,<span class="dv">55220</span>,<span class="dv">4520</span>,<span class="dv">1131</span>,<span class="dv">85466</span>,<span class="dv">5520</span>,<span class="dv">4434</span>,<span class="dv">4434</span>,<span class="dv">64267</span>,<span class="dv">1111</span>,<span class="dv">1111</span>,<span class="dv">14520</span>,<span class="dv">5554</span>,<span class="dv">42520</span>,<span class="dv">85466</span>,<span class="dv">7854</span>,<span class="dv">4343</span>))</a></code></pre></div>
<div id="obundet-slumpmässigt-urval-utan-återläggning" class="section level2">
<h2><span class="header-section-number">9.1</span> Obundet slumpmässigt urval utan återläggning</h2>
<p><img src="docs/images/osu.jpg" width="25%" style="background-color: #414244 ; padding:1px; display: inline-block;" /></p>
<p>Vid OSU med återläggning (OSU-MÅ) från en ändlig populationen med storleken <span class="math inline">\(N\)</span> riskerar samma element väljas flera gånger. Alternativet är OSU utan återläggning (OSU-UÅ). Om urvalstorleken är <span class="math inline">\(n\)</span> finns vid OSU-UÅ
<span class="math display">\[\binom{N}{n}=\dfrac{N!}{n!(N-n)!}\]</span>
möjliga urval. Alla urval har samma sannolikhet att väljas. Vid ett OSU-UÅ har således varje objekt samma inklusionssannolikhet, <span class="math inline">\(n/N\)</span>.</p>
<p>OSU-MÅ respektive OSU-UÅ är de två urvalsmetoder som är grunden för mycket av den inferens som vi gör.
OSU-MÅ kan illustreras med att lappar dras slumpmässigt från en hatt och varje gång en lapp dragits så läggs den tillbaka i hatten efter att värdet noterats, medan OSU-UÅ innebär att lappar dras slumpmässigt från en hatt, utan att lapparna läggs tillbaka. En mer formell analogi är att OSU-MÅ är som dragning från en binomialfördelning medan OSU-UÅ är som dragning från en hypergeometrisk fördelning.</p>
<p>Om urvalsstorleken <span class="math inline">\(n\)</span> är liten relativt populationsstorleken <span class="math inline">\(N\)</span>, låt säg <span class="math inline">\(n/N &lt; 0.01\)</span> saknar det dock praktisk betydelse om vi väljer OSU-MÅ eller OSU-UÅ.</p>
<p>Nedan illustreras de bägge urvalsmetoderna OSU-MÅ och OSU-UÅ i R.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1"><span class="co"># Använd sample() för att dra urval från populationsvektorn x_pop med storleken N = 4</span></a>
<a class="sourceLine" id="cb292-2" title="2"> x_pop &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb292-3" title="3"><span class="co"># Dra ett osu med återläggning med n = 2</span></a>
<a class="sourceLine" id="cb292-4" title="4"> x_osu_ma &lt;-<span class="st"> </span><span class="kw">sample</span>(x_pop, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb292-5" title="5"> x_osu_ma</a>
<a class="sourceLine" id="cb292-6" title="6"><span class="co"># Dra ett osu utan återläggning med n = 2</span></a>
<a class="sourceLine" id="cb292-7" title="7"> x_osu_ua &lt;-<span class="st"> </span><span class="kw">sample</span>(x_pop, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb292-8" title="8"> x_osu_ua</a></code></pre></div>
<p>I praktiken måste vi inte bara dra ett OSU-UÅ från en vektor, utan i regel består en urvalsram av exempelvis kontaktuppgifter. Vi illusterar därför hur ett urval från en dataframe kan genomföras i R.</p>
<p>Först dras unika identifieringsnummer. Därefter matchas identifieringsnummer till rader. Det logiska kommandot <span class="math inline">\(==\)</span> går ej att tillämpa eftersom <span class="math inline">\(id\)</span> och <span class="math inline">\(idnr\_ous\_ua\)</span> har olika storlek. Istället används operatorn <span class="math inline">\(\%in\%\)</span> för att finna de element som matchar mellan två vektorer. Med indexeringar väljs sedan de rader ut där matcher är funna (TRUE).</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1"><span class="co"># Vi konstruerar en urvalsram nedan.</span></a>
<a class="sourceLine" id="cb293-2" title="2"> ram &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">44</span>,<span class="dv">41</span>,<span class="dv">99</span>,<span class="dv">101</span>,<span class="dv">6</span>), </a>
<a class="sourceLine" id="cb293-3" title="3">                   <span class="dt">namn =</span> <span class="kw">c</span>(<span class="st">&quot;Alex&quot;</span>, <span class="st">&quot;Robin&quot;</span>, <span class="st">&quot;Kim&quot;</span>, <span class="st">&quot;Charlie&quot;</span>, <span class="st">&quot;Tintin&quot;</span>, <span class="st">&quot;Lo&quot;</span>, <span class="st">&quot;Kim&quot;</span>), </a>
<a class="sourceLine" id="cb293-4" title="4">                   <span class="dt">tfn =</span> <span class="kw">c</span>(<span class="dv">4443344</span>,<span class="dv">633223</span>,<span class="dv">3335664</span>,<span class="dv">322112</span>,<span class="dv">73344</span>,<span class="dv">42224</span>,<span class="dv">5435732</span>), </a>
<a class="sourceLine" id="cb293-5" title="5">                   <span class="dt">adress =</span>  <span class="kw">c</span>(<span class="st">&quot;Storgatan 1&quot;</span>, <span class="st">&quot;Kungsgatan 4&quot;</span>, <span class="st">&quot;Drottninggatan 6&quot;</span>, <span class="st">&quot;Backvägen 33&quot;</span>, <span class="st">&quot;Storgatan 7&quot;</span>, <span class="st">&quot;Lillgränd 6&quot;</span>, <span class="st">&quot;Skogsvägen 90&quot;</span>))</a>
<a class="sourceLine" id="cb293-6" title="6"><span class="co"># Urvalsstorleken sätts till n=3. Välj 3 idnr med OSU-UÅ och spara i idnr_ous_ua  </span></a>
<a class="sourceLine" id="cb293-7" title="7"> n &lt;-<span class="st"> </span><span class="dv">3</span> </a>
<a class="sourceLine" id="cb293-8" title="8"> idnr_ous_ua &lt;-<span class="st"> </span><span class="kw">sample</span>(ram<span class="op">$</span>id, n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)  </a>
<a class="sourceLine" id="cb293-9" title="9"><span class="co"># Välj rader i data frame (ramen) som korresponderar till slumpmässigt valda idnr.</span></a>
<a class="sourceLine" id="cb293-10" title="10"> osu_ua &lt;-<span class="st"> </span>ram[ram<span class="op">$</span>id <span class="op">%in%</span><span class="st"> </span>idnr_ous_ua, ]</a>
<a class="sourceLine" id="cb293-11" title="11"> osu_ua</a></code></pre></div>
<p>Det finns även alternativa sätt att dra urval från en dataframe, exempelvis där användaren först skapar skapar en variabel med radnummer, <em>1:N</em>, från vilken radnummer väljs slumpmässigt. Därefter rader väljas från en dataframe göras med indexinering. En sådan metod bygger dock på sorteringen i dataframet bibehålls.</p>
<p>Oavsett metod förutsätter vi att alla element förekommer endast en gång i urvalsramen. Funktionen <strong>anyDuplicated()</strong> kan användas för att undersöka om värden på identifieringsvariabeln förekommer flera gånger.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1"><span class="kw">anyDuplicated</span>(ram<span class="op">$</span>id)</a></code></pre></div>
<div id="inferens-för-populationsmedelvärdet-mu" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Inferens för populationsmedelvärdet, <span class="math inline">\(\mu\)</span></h3>
<p>Givet ett OSU-UÅ med storleken <span class="math inline">\(n\)</span> gäller följande:</p>
<ul>
<li>Stickprovsmedelvärdet, <span class="math display">\[\bar{x} = \dfrac{1}{n}\sum_{i=1}^n x_i\]</span> är
en väntevärdesriktig skattning av <span class="math inline">\(\mu\)</span>.</li>
<li>Stickprovsmedelvärdets varians är <span class="math display">\[V(\bar{x}) = \left(\dfrac{N-n}{N-1}\right)\dfrac{\sigma^2}{n},\]</span> vilken skattas med
<span class="math display">\[\hat{V}(\bar{x}) = \left(1 - \dfrac{n}{N}\right)\dfrac{s^2_x}{n},\]</span> där <span class="math inline">\(s^2\)</span> är stickprovsvariansen. I praktiken skattas alltid <span class="math inline">\(V(\bar{x})\)</span>.</li>
<li>Om stickprovsstorleken är tillräckligt stor är stickprovsmedelvärdets samplingfördelning approximativt normalfördelad på grund av centrala gränsvärdessatsen (CGS).</li>
<li>Om stickprovsstorleken är tillräckligt stor (ofta <span class="math inline">\(n&gt;30\)</span>) ges ett konfidensintervall för <span class="math inline">\(\mu\)</span> av
<span class="math display">\[
\bar{x}\pm z_{\alpha/2}\sqrt{\hat{V}(\bar{x})}
\]</span>
där <span class="math inline">\(1-\alpha\)</span> är konfidensgraden och <span class="math inline">\(z_{\alpha/2}\)</span> är det <span class="math inline">\(z\)</span>-värde som erhålls om svanssannolikheten <span class="math inline">\(\alpha/2\)</span> läggs i högra svansen. För mindre stickprov används <span class="math inline">\(t\)</span>-fördelningen med <span class="math inline">\(n-1\)</span> frihetsgrader, under förutsättningen att <span class="math inline">\(x\)</span> är normalfördelad.</li>
<li>För statistiska test krävs en nollhypotes, en mothypotes, en testfunktion samt data. Om stickprovsstorleken är tillräckligt stor och om nollhypotesen <span class="math inline">\(H_0:\mu=\mu_0\)</span> är sann är testfunktionen
<span class="math display">\[z = \dfrac{\bar{x} - \mu_0}{\sqrt{\hat{V}(\bar{x})}}\]</span>
approximativt <span class="math inline">\(N(0,1)\)</span>. Vi beräknar <span class="math inline">\(z_{obs}\)</span> och undersöker, baserat på om mothypotesen är ensidig eller tvåsidig, hur extremt det observerade värdet är i denna fördelning. För mindre stickprov används <span class="math inline">\(t\)</span>-fördelningen med <span class="math inline">\(n-1\)</span> frihetsgrader, under förutsättningen att <span class="math inline">\(x\)</span> är normalfördelad.</li>
</ul>
<p><strong>Exempel 1: Inkomst</strong></p>
<p><em>Kommunen A önskar att med 95% konfidensgrad skatta medelinkomsten i kommunen. Målpopulationen är invånare i åldern 18-67 år och rampopulationen är en lista med 11200 individer från registret över totalbefolkningen. Vi utgår från att det inte finns någon övertäckning eller undertäckning och drar ett OSU-UÅ bestående av 420 individer från rampopulationen. Individerna kontaktas och data samlas in utan bortfall. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1"><span class="co"># Utgå från det inlästa datasetet df.</span></a>
<a class="sourceLine" id="cb295-2" title="2"><span class="co"># Börja med att läsa in data till uppgiften och titta på data!</span></a>
<a class="sourceLine" id="cb295-3" title="3"> <span class="kw">hist</span>(df<span class="op">$</span>inkomst, </a>
<a class="sourceLine" id="cb295-4" title="4">      <span class="dt">breaks =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb295-5" title="5">      <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb295-6" title="6">      <span class="dt">xlab =</span> <span class="st">&quot;Inkomst (SEK/månad)&quot;</span>,</a>
<a class="sourceLine" id="cb295-7" title="7">      <span class="dt">ylab =</span> <span class="st">&quot;Antal&quot;</span>,</a>
<a class="sourceLine" id="cb295-8" title="8">      <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-262-1.png" width="50%" /></p>
<p><em>Data verkar inte komma från en normalfördelning, men fördelningen är inte heller väldigt skev.</em></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1"><span class="co"># Populationsstorlek </span></a>
<a class="sourceLine" id="cb296-2" title="2"> N &lt;-<span class="st"> </span><span class="dv">11200</span></a>
<a class="sourceLine" id="cb296-3" title="3"><span class="co"># Stickprovsstorlek  </span></a>
<a class="sourceLine" id="cb296-4" title="4"> n &lt;-<span class="st"> </span><span class="dv">420</span></a>
<a class="sourceLine" id="cb296-5" title="5"><span class="co"># Medelvärde  </span></a>
<a class="sourceLine" id="cb296-6" title="6"> xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>inkomst) </a>
<a class="sourceLine" id="cb296-7" title="7"><span class="co"># Stickprovsvarians  </span></a>
<a class="sourceLine" id="cb296-8" title="8"> s2 &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>inkomst)</a>
<a class="sourceLine" id="cb296-9" title="9"><span class="co"># Skattningen av stickprovsmedelvärdets varians vid OSU-UÅ  </span></a>
<a class="sourceLine" id="cb296-10" title="10"> vhatxbar &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>(s2<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb296-11" title="11"><span class="co"># Konfidensintervall med konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb296-12" title="12"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb296-13" title="13"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb296-14" title="14"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb296-15" title="15"> ll_mu &lt;-<span class="st"> </span>xbar <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar)</a>
<a class="sourceLine" id="cb296-16" title="16"> ul_mu &lt;-<span class="st"> </span>xbar <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar)</a>
<a class="sourceLine" id="cb296-17" title="17"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb296-18" title="18"> resultat_mu &lt;-<span class="st"> </span><span class="kw">c</span>(xbar, ll_mu, ul_mu)</a>
<a class="sourceLine" id="cb296-19" title="19"> resultat_mu  </a></code></pre></div>
<pre><code>## [1] 25593.58 24500.23 26686.93</code></pre>
<p><em>Medelinkomsten i kommunen skattas till 25594 kr/mån. Med 95% säkerhet täcker intervallet 24500 kr/mån till 26687 kr/mån medelinkomsten i kommunen. Vi har ett OSU-UÅ vilket ger väntevärdesriktiga skattningar och eftersom urvalet är stort kan även skatta ett konfidensintervall eftersom vi på grund av CGS kan använda normalapproximationen.</em></p>
<p><strong>Exempel 2: Inkomst</strong></p>
<p><em>Kommunen A önskar testa om skatta medelinkomsten i kommunen är mer än 25000. Genom att påvisa att medelinkomsten är större än 25000, vilket innebär mer skatteintäkter, vågar kommunen göra en satsning på en ny idrottsanlägning. För mer information, se Exempel 1. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1"><span class="co"># Använd uppgifter från tidigare exempel</span></a>
<a class="sourceLine" id="cb298-2" title="2"><span class="co"># z-test</span></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="co"># Nollhypotesen </span></a>
<a class="sourceLine" id="cb298-4" title="4"> mu0 &lt;-<span class="st"> </span><span class="dv">25000</span></a>
<a class="sourceLine" id="cb298-5" title="5"><span class="co"># Observera z-värde </span></a>
<a class="sourceLine" id="cb298-6" title="6"> zobs &lt;-<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span>mu0)<span class="op">/</span><span class="kw">sqrt</span>(vhatxbar)</a>
<a class="sourceLine" id="cb298-7" title="7"><span class="co"># Beräkna p-värde utifrån att H1: mu &gt; mu0 </span></a>
<a class="sourceLine" id="cb298-8" title="8"> p_value &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(zobs)</a>
<a class="sourceLine" id="cb298-9" title="9"> p_value  </a></code></pre></div>
<pre><code>## [1] 0.1436514</code></pre>
<p><em>Medelinkomsten i kommunen skattas till 25594 kr/mån. Vi kan på 5% signifikansnivå inte påvisa att medelinkomsten i kommunen är större 25000 (<span class="math inline">\(p=0.144\)</span>). Då data stämmer relativt väl överens med nollhypotesen väljer kommunen att inte att investera i en ny idrottsanläggning. Vi har ett OSU-UÅ vilket ger väntevärdesriktiga skattningar och eftersom urvalet är stort kan vi använda ett approximativt <span class="math inline">\(z\)</span>-test eftersom vi på grund av CGS kan använda normalapproximationen.</em></p>
<hr />
<p><img src="docs/images/important.png" width="5%" /></p>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> Normalfördelning eller <span class="math inline">\(t\)</span>-fördelning? </font></p>
<p>Det går att argumentera för att <span class="math inline">\(t\)</span>-fördelningen bör användas i beräkning av konfidensintervall och test även vid användning av approximativ normalfördelning på grund av CGS. Anledningen är att variansen i den approximativa normalfördelningen är <em>okänd</em> och därmed skattas denna varians. Om vi förlitar oss på CGS har dock valet mellan normal- och <span class="math inline">\(t\)</span>-fördelning liten betydelse eftersom dessa fördelningar är snarlika i stora stickprov. Använd följande Shiny-app och jämför standardnormalfördelningen med t-fördelningar med olika frihetsgrader, där antalet frihetgrader beror på stickprovsstorleken.
<a href="https://jetty.im.uu.se/shiny/Dist/" class="uri">https://jetty.im.uu.se/shiny/Dist/</a></p>
</div>
<hr />
<p><img src="docs/images/important.png" width="5%" /></p>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> Ensidig eller tvåsidig mothypotes? </font></p>
<p>I många situationer är enbart ena svansen av intresse och då leder en tvåsidig mothypotes till att vi slösar
bort signifikans i en för ändamålet ointressant svans. Nedan följer ett exempel på när <em>ensidig mothypotes</em> är rimlig:</p>
<ul>
<li>En miljöorganisation vill undersöka om miljöfarliga ämnen i en sjö överstiger ett gränsvärde. Om så är fallet kommer åtgärder vidtas. Inga förändringar kommer dock göras om det miljöfarliga ämnet inte överstiger gränsvärdet.</li>
</ul>
<p>Vanligast är dock en tvåsidig mothypotes och är man osäker och inte kan motivera en ensidig mothypotes ska en sådan användas. Nedan följer ett exempel på när en <em>tvåsidig mothypotes</em> är rimlig:</p>
<ul>
<li>Ett experiment genomförs för att jämföra en ny arbetsmarknadsåtgärd med ett ordinarie åtgärdsprogram och syftet är att jämföra återgång till arbete bland långtidsarbetslösa. Även om man kanske hoppas på att den nya arbetsmarknadsåtgärden leder till att fler återgår till arbete så vore det även värdefullt att konstatera att det motsatta råder, dvs att det nya programmet istället leder till en försämring vad gäller återgång till arbete.</li>
</ul>
<p><strong>Valet av ensidig eller tvåsidig mothypotes får ALDRIG göras baserat på vad som observeras i stickprovet utan måste göras i förhand.</strong></p>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<p><span class="math inline">\(p\)</span>-värdet är sannolikheten att observera ett minst lika extremt värde som det observerade givet att nollhypotesen är sann. Beroende på hur hypoteserna är formulerade är <span class="math inline">\(p\)</span>-värdet något av följande sannolikheter:</p>
<ol style="list-style-type: decimal">
<li>För en händelse i höger svans, dvs <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span> är <span class="math display">\[p-value=\Pr(Z \geq z|H_0\,\,\text{sann})\]</span></li>
<li>För en händelse i vänster svans, <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span>
<span class="math display">\[p-value=\Pr(Z \leq z|H_0\,\,\text{sann})\]</span></li>
<li>För en två-sidig <span class="math inline">\(H_1:\mu\neq \mu_0\)</span>
<span class="math display">\[p-value=2 \cdot \min \left\{ \Pr(Z \leq z|H_0\,\,\text{sann}), \Pr(Z \geq z|H_0\,\,\text{sann}) \right\} \]</span></li>
</ol>
<p>Om möjligt, beräkna alltid <span class="math inline">\(p\)</span>-värdet istället för att enbart jämföra testfunktionens observerade värde med en kritisk punkt. Det går nämligen att tolka <span class="math inline">\(p\)</span>-värdet som ett kontinuerligt mått på bevis mot nollhypotesen eller formulerat som i vilken utsträckning data stämmer överens med nollhypotesen. Ett lågt <span class="math inline">\(p\)</span>-värde indikerar att data har låg överensstämmelse med nollhypoytesen. Om målet med studien trots allt innebär att ett beslut måste fattas kan <span class="math inline">\(p\)</span>-värdet då enkelt relateras till vald signifikansnivå. Understiger <span class="math inline">\(p\)</span>-värdet signifikansnivå så förkastas nollhypotesen, i annat fall kan nollhypotesen inte förkastas. Tänk på att signifikansnivån i dessa fall måste väljas i förväg.</p>
</div>
<hr />
</div>
<div id="inferens-för-populationsandelen-p" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Inferens för populationsandelen, <span class="math inline">\(p\)</span></h3>
<p>Anta nu att <span class="math inline">\(x\)</span> är binär. Givet OSU-UÅ gäller med storleken <span class="math inline">\(n\)</span> gäller att:</p>
<ul>
<li>Stickprovsandelen <span class="math inline">\(\hat{p}\)</span> är en väntevärdesriktig skattning av populationsandelen <span class="math inline">\(p\)</span>.</li>
<li>Andelsestimatorns varians <span class="math display">\[V(\hat{p}) = \left(\dfrac{N-n}{N-1}\right)\dfrac{p(1-p)}{n}\]</span> skattas med
<span class="math display">\[\hat{V}(\hat{p}) = \left(1 - \dfrac{n}{N}\right)\dfrac{\hat{p}(1-\hat{p})}{n-1}\]</span>.</li>
<li>Om <span class="math inline">\(np(1-p)&gt;5\)</span> är <span class="math inline">\(\hat{p} \underset{approx}{\sim} N(p,V(p))\)</span>.</li>
<li>Givet normalapproximation ges ett konfidensintervall för <span class="math inline">\(p\)</span> av
<span class="math display">\[
\hat{p}\pm z_{\alpha/2}\sqrt{\hat{V}(\hat{p})}
\]</span>
där <span class="math inline">\(1-\alpha\)</span> är konfidensgraden och <span class="math inline">\(z_{\alpha/2}\)</span> är det <span class="math inline">\(z\)</span>-värde som erhålls om svanssannolikheten <span class="math inline">\(\alpha/2\)</span> läggs i högra svansen. För mindre stickprov kan exakta konfidensintervall användas.</li>
<li>Givet normalapproximation och nollhypotesen <span class="math inline">\(H_0:p=p_0\)</span> är sann är testfunktionen
<span class="math display">\[z = \dfrac{\hat{p} - p_0}{\sqrt{V(\hat{p})}}\]</span>
approximativt <span class="math inline">\(N(0,1)\)</span>. Eftersom vi utgår från är <span class="math inline">\(H_0\)</span> är sann används inte den skattade variansen i testfunktionen. Vi beräknar <span class="math inline">\(z_{obs}\)</span> och undersöker hur extremt det observerade värdet är i denna fördelning. Detta görs utifrån om mothypotesen är ensidig eller tvåsidig. För mindre stickprov kan exakta test användas.</li>
</ul>
<p><strong>Exempel 3: Inkomst mer än 30000</strong></p>
<p><em>Kommunen A önskar att med 95% konfidensgrad skatta andelen i kommunen som har en inkomst över 30000. För mer information, se Exempel 1. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet. </em></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="co"># Använd uppgifter från tidigare exempel</span></a>
<a class="sourceLine" id="cb300-2" title="2"><span class="co"># Inkomst mer än 30000  </span></a>
<a class="sourceLine" id="cb300-3" title="3"> df<span class="op">$</span>inkomst_<span class="dv">30000</span> &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb300-4" title="4"> df<span class="op">$</span>inkomst_<span class="dv">30000</span>[df<span class="op">$</span>inkomst <span class="op">&gt;</span><span class="st"> </span><span class="dv">30000</span>] &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb300-5" title="5"> df<span class="op">$</span>inkomst_<span class="dv">30000</span>[df<span class="op">$</span>inkomst <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30000</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb300-6" title="6"> x &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>inkomst_<span class="dv">30000</span>)</a>
<a class="sourceLine" id="cb300-7" title="7"> phat &lt;-<span class="st"> </span>x<span class="op">/</span>n  <span class="co"># Använd n givet att vi inte har bortfall!</span></a>
<a class="sourceLine" id="cb300-8" title="8"><span class="co"># Skattningen av andelsestimatorns varians vid OSU-UÅ  </span></a>
<a class="sourceLine" id="cb300-9" title="9"> vhatphat &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>(phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">/</span>(n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb300-10" title="10"><span class="co"># Konfidensintervall med konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb300-11" title="11"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb300-12" title="12"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb300-13" title="13"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb300-14" title="14"> ll_p &lt;-<span class="st"> </span>phat <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphat)</a>
<a class="sourceLine" id="cb300-15" title="15"> ul_p &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphat)</a>
<a class="sourceLine" id="cb300-16" title="16"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb300-17" title="17"> resultat_p &lt;-<span class="st"> </span><span class="kw">c</span>(phat, ll_p, ul_p)</a>
<a class="sourceLine" id="cb300-18" title="18"> resultat_p  </a></code></pre></div>
<pre><code>## [1] 0.3214286 0.2775572 0.3653000</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1"><span class="co"># Koll av CGS</span></a>
<a class="sourceLine" id="cb302-2" title="2"> n<span class="op">*</span>phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)</a></code></pre></div>
<pre><code>## [1] 91.60714</code></pre>
<p><em>Andelen i kommunen med en inkomst över 30000 kr/mån skattas 0.32. Med 95% säkerhet täcker intervallet 0.28 till 0.37 andelen i kommunen som har en medelinkomsten som är över 30000 kr/mån. Vi har ett OSU-UÅ vilket ger väntevärdesriktiga skattningar och förutsättningarna för att på grund av CGS kan använda normalapproximationen är uppfylld.</em></p>
<p><strong>Exempel 4: Inkomst mer än 30000</strong></p>
<p><em>Kommunen A önskar testa om 50% i kommunen har en inkomst över 30000. För mer information, se Exempel 1. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet. </em></p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1"><span class="co"># Använd uppgifter från tidigare exempel</span></a>
<a class="sourceLine" id="cb304-2" title="2"><span class="co"># z-test</span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="co"># Nollhypotes </span></a>
<a class="sourceLine" id="cb304-4" title="4"> pH0 &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb304-5" title="5"><span class="co"># Observerat z-värde </span></a>
<a class="sourceLine" id="cb304-6" title="6"> zobs &lt;-<span class="st"> </span>(phat <span class="op">-</span><span class="st"> </span>pH0)<span class="op">/</span><span class="kw">sqrt</span>(pH0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pH0)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb304-7" title="7"><span class="co"># Beräkna p-värde utifrån att H1: p != pH0 </span></a>
<a class="sourceLine" id="cb304-8" title="8"> p_value_pH0 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zobs)))</a>
<a class="sourceLine" id="cb304-9" title="9"> p_value_pH0  </a></code></pre></div>
<pre><code>## [1] 2.493561e-13</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1"><span class="co"># Test av CGS</span></a>
<a class="sourceLine" id="cb306-2" title="2"> n<span class="op">*</span>pH0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pH0)</a></code></pre></div>
<pre><code>## [1] 105</code></pre>
<p><em>Andelen i kommunen med en inkomst över 30000 kr/mån skattas till 0.32. Vi kan på 5% signifikansnivå påvisa att andelen med inkomst över 30000 i kommunen inte är 0.50 (<span class="math inline">\(p&lt;0.001\)</span>). Data stämmer inte överens med nollhypotesen. Vi har ett OSU-UÅ vilket ger väntevärdesriktiga skattningar och förutsättningarna för att, på grund av CGS, använda normalapproximationen är uppfylld.</em></p>
<hr />
<p><img src="docs/images/warning.png" width="5%" /></p>
<style>
div.green{ background-color:#abd4b3; border-radius: 5px; padding: 20px;}
</style>
<div class="green">
<p><font size="5"> Centrala gränsvärdessatsen och inferens om <span class="math inline">\(p\)</span> </font></p>
<p>Tumregeln <span class="math inline">\(np(1-p)&gt;5\)</span> är dålig om andelen i populationen är nära 0 eller 1. Om andelen i populationen är nära 0 eller 1 krävs stort stickprov för att konfidensgraden ska vara rätt. Det finns dock så kallade exakta alternativ för att skapa konfidensintervall och genomföra test.</p>
</div>
<hr />
</div>
<div id="inferens-för-populationstotalen-tau" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Inferens för populationstotalen, <span class="math inline">\(\tau\)</span></h3>
<p>Givet OSU-UÅ med storleken <span class="math inline">\(n\)</span> gäller att</p>
<ul>
<li>Totalestimatorn <span class="math inline">\(\hat{\tau} = N\bar{x}\)</span> är en väntevärdesriktig skattning av <span class="math inline">\(\tau\)</span>. Om <span class="math inline">\(x\)</span> är binär gäller att <span class="math inline">\(\hat{\tau} = N\hat{p}\)</span>.</li>
<li>Totalestimatorns varians är <span class="math inline">\(V(\hat{\tau}) = N^2V(\bar{x})\)</span>, vilken skattas med
<span class="math inline">\(\hat{V}(\hat{\tau}) = N^2\hat{V}(\bar{x})\)</span>. Om <span class="math inline">\(x\)</span> är binär gäller att andelsestimatorns varians är <span class="math inline">\(V(\hat{\tau}) = N^2V(\hat{p})\)</span>, vilken skattas med och <span class="math inline">\(\hat{V}(\hat{\tau}) = N^2\hat{V}(\hat{p})\)</span>.</li>
<li>Samplingfördelningen följer samma regler som för <span class="math inline">\(\bar{x}\)</span> respektive <span class="math inline">\(\hat{p}\)</span>.</li>
<li>För konfidensintervall och test av <span class="math inline">\(H_0:\tau=\tau_0\)</span> gäller samma förutsättningar som för <span class="math inline">\(\mu\)</span> och <span class="math inline">\(p\)</span>.</li>
</ul>
<p><strong>Exempel 5: Inkomst mer än 30000</strong></p>
<p><em>Kommunen A önskar att med 95% konfidensgrad skatta antalet i kommunen som har en inkomst över 30000. För mer information, se Exempel 1. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="co"># Använd uppgifter från tidigare exempel</span></a>
<a class="sourceLine" id="cb308-2" title="2"> tauhat &lt;-<span class="st"> </span>N<span class="op">*</span>phat</a>
<a class="sourceLine" id="cb308-3" title="3"><span class="co"># Skattningen av totalestimatorns varians vid OSU-UÅ  </span></a>
<a class="sourceLine" id="cb308-4" title="4"> vhattauhat &lt;-<span class="st"> </span>N<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatphat</a>
<a class="sourceLine" id="cb308-5" title="5"><span class="co"># Konfidensintervall med konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb308-6" title="6"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb308-7" title="7"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb308-8" title="8"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb308-9" title="9"> ll_tau &lt;-<span class="st"> </span>tauhat <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattauhat)</a>
<a class="sourceLine" id="cb308-10" title="10"> ul_tau &lt;-<span class="st"> </span>tauhat <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattauhat)</a>
<a class="sourceLine" id="cb308-11" title="11"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb308-12" title="12"> resultat_tau &lt;-<span class="st"> </span><span class="kw">c</span>(tauhat, ll_tau, ul_tau)</a>
<a class="sourceLine" id="cb308-13" title="13"> resultat_tau </a></code></pre></div>
<pre><code>## [1] 3600.00 3108.64 4091.36</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="co"># Koll av CGS</span></a>
<a class="sourceLine" id="cb310-2" title="2"> n<span class="op">*</span>phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)</a></code></pre></div>
<pre><code>## [1] 91.60714</code></pre>
<p><em>Antalet i kommunen med en inkomst över 30000 skattas till 3600 stycken. Med 95% säkerhet täcker intervallet 3109 till 4091 antalet i kommunen med en inkomst över 30000. Vi har ett OSU-UÅ vilket ger väntevärdesriktiga skattningar och förutsättningarna för att, på grund av CGS, använda normalapproximationen är uppfylld.</em></p>
</div>
<div id="beräkningar-av-stickprovstorlek" class="section level3">
<h3><span class="header-section-number">9.1.4</span> Beräkningar av stickprovstorlek</h3>
<p>Låt <span class="math inline">\(\hat{\theta}\)</span> vara en estimator. Tre vanliga precisionskrav är att</p>
<ul>
<li><span class="math inline">\(\text{medelfel}=\sqrt{V(\hat{\theta})},\)</span></li>
<li><span class="math inline">\(\text{felmarginal}=tabellvärde\cdot \sqrt{V(\hat{\theta})}\)</span> eller</li>
<li><span class="math inline">\(\text{KIbredd}=2\cdot tabellvärde \cdot \sqrt{V(\hat{\theta})}\)</span></li>
</ul>
<p>får högst vara av en viss storlek. Storleken beror på vilken nogrannhet som krävs i en undersökning, vilket i sin tur beror på tillämpningen. En opinionsundersökning om partisympatier har kanske lägre krav på precision än urvalsundersökning som syftar till att undersöka halten av miljögifter i en sjö. Mer konkret kan formulera precisionskrav som följer:</p>
<ul>
<li>Kan vi i en partisympatiundersökning acceptera en felmarginal på 10 procentenheter när vi skattar andelen i väljarkåren som sympatiserar med Socialdemokraterna?</li>
<li>Kan vi vid en skattning av andelen individer med antikroppar från Covid-19 acceptera ett konfidensintervall med längden 3 procentenheter?</li>
</ul>
<p>Precisionskravet beror sedan på variansen för vald estimator samt eventuellt ett tabellvärde som beror på samplingfördelningen. För att sedan beräkna urvalsstorleken <span class="math inline">\(n\)</span> stoppar vi in kända parametervärden i precisionskravet, till exempel populationsvariansen, <span class="math inline">\(\sigma^2\)</span> och populationsstorleken <span class="math inline">\(N\)</span>. Slutligen löser vi ut urvalstorleken <span class="math inline">\(n\)</span>.
Om en algebraisk lösning är svår att genomföra kan en iterativ lösning göras i R.</p>
<p>Notera att det finns precisionkrav som utgår från Typ-I-fel (signifikansnivå) och Typ-II-fel (styrka), men detta ingår inte i detta kapitel om urvalsmetoder</p>
<p><strong>Exempel 6: Beräkning av stickprovsstorlek</strong></p>
<p><em>Grannkommunen B önskar genomföra en undersökning för att skatta medelinkomsten i kommun B. För att planera stickprovsstorleken utgår man från att standardavvikelsen i kommun A är <span class="math inline">\(11652.95\)</span> kr/mån, och antar att denna är samma i kommun B. Vidare nöjer man sig med ett konfidensintervall som har längden 1000 kr/mån. Man avser sedan genomföra ett OSU-UÅ på motsvarande sätt som kommun A. I kommun B finns rampopulationen 21000 individer och det finns inget problem med övertäckning och undertäckning.</em></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="co"># Bestäm spridningen i populationen, sätter 1 som default</span></a>
<a class="sourceLine" id="cb312-2" title="2"> sigma2 &lt;-<span class="st"> </span><span class="fl">11652.95</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb312-3" title="3"><span class="co"># Känd populationsstorlek</span></a>
<a class="sourceLine" id="cb312-4" title="4"> N &lt;-<span class="st"> </span><span class="dv">21000</span></a>
<a class="sourceLine" id="cb312-5" title="5"><span class="co"># Bestäm konfidensgrad eller signifikansnivå, sätter 95%/5% som default</span></a>
<a class="sourceLine" id="cb312-6" title="6"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb312-7" title="7"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb312-8" title="8"><span class="co"># Lista olika stickprovsstorlekar, sätter 1 till 1000 som default</span></a>
<a class="sourceLine" id="cb312-9" title="9"> n &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4000</span></a>
<a class="sourceLine" id="cb312-10" title="10"><span class="co"># Beräkna (teoretiska) variansen för stickprovsmedelvärdet för olika n</span></a>
<a class="sourceLine" id="cb312-11" title="11"> vxbar &lt;-<span class="st"> </span>((N<span class="op">-</span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>sigma2<span class="op">/</span>n </a>
<a class="sourceLine" id="cb312-12" title="12"><span class="co"># Beräkna konfidensintervallets bredd för olika stickprovsstorlekar</span></a>
<a class="sourceLine" id="cb312-13" title="13"> xbar_KIbredd &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vxbar) </a>
<a class="sourceLine" id="cb312-14" title="14"><span class="co"># Välj stickprovsstorlek utifrån valt precisionskra, sätter 0.2 som default</span></a>
<a class="sourceLine" id="cb312-15" title="15"> precisionskrav &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb312-16" title="16"><span class="co"># Välj den minsta stickprovsstorlek som uppnår precisionskravet. </span></a>
<a class="sourceLine" id="cb312-17" title="17"> <span class="kw">min</span>(n[xbar_KIbredd <span class="op">&lt;=</span><span class="st"> </span>precisionskrav])</a>
<a class="sourceLine" id="cb312-18" title="18"><span class="co"># Studera precisionskrav som en funktion av stickprovstorleken</span></a>
<a class="sourceLine" id="cb312-19" title="19"> <span class="kw">plot</span>(n, xbar_KIbredd, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb312-20" title="20"> <span class="kw">abline</span>(<span class="dt">h =</span> precisionskrav)</a></code></pre></div>
<p><em>För att ett 95% konfidensintervall ska få vara högst 1000 kr/mån krävs en urvalsstorlek på 1899 individer. Detta är givet att urvalet är ett OSU-UÅ från populationen med 21000 individer samt att populationens standardavvikelse är 11652.95 kr/mån.</em></p>
</div>
</div>
<div id="stratifierat-urval" class="section level2">
<h2><span class="header-section-number">9.2</span> Stratifierat urval</h2>
<p><img src="docs/images/stratum.jpg" width="30%" style="background-color: #414244 ; padding:1px; display: inline-block;" /></p>
<p>Populationen indelas nu i <span class="math inline">\(K\)</span> stycken disjunkta strata. Populationsstorlekan i stratum <span class="math inline">\(j\)</span> betecknas <span class="math inline">\(N_j\)</span> och den totala populationsstorleken är därmed <span class="math inline">\(N=N_1 + \dots + N_K\)</span>. Vidare betecknar <span class="math inline">\(\mu_j\)</span>, <span class="math inline">\(p_j\)</span> och <span class="math inline">\(\sigma^2_j\)</span> populationsmedelvärdet, populationsandelen respektive populationsvariansen i stratum <span class="math inline">\(j\)</span>. Parametrarna av intresse kan nu formuleras baserat på den stratifierade populationen:</p>
<p><span class="math display">\[\mu = \dfrac{N_1}{N}\mu_1 + \dfrac{N_2}{N}\mu_2 + \cdots + \dfrac{N_K}{N}\mu_K = \sum_{j=1}^K\dfrac{N_j}{N}\mu_j,\]</span>
<span class="math display">\[\tau = N\mu = N_1\mu_1 + N_2\mu_2 + \cdots + N_K\mu_K = \sum_{j=1}^KN_j\mu_j,  \]</span></p>
<p><span class="math display">\[p = \dfrac{N_1}{N}p_1 + \dfrac{N_2}{N}p_2 + \cdots + \dfrac{p_K}{N}\mu_K = \sum_{j=1}^K\dfrac{N_j}{N}p_j.\]</span></p>
<p>Från respektive stratum dras ett urval. Den stratumspecifika urvalsstorleken betecknas <span class="math inline">\(n_j\)</span> och den totala urvalsstorleken i undersökningen är därmed <span class="math inline">\(n=n_1+\cdots+n_K\)</span>.</p>
<div id="inferens-för-mu" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Inferens för <span class="math inline">\(\mu\)</span></h3>
<p>Givet ett OSU-UÅ från respektive stratum är:</p>
<ul>
<li>Stickprovsmedelvärdet vid stratifierat urval, <span class="math display">\[\bar{x}_{st} = \dfrac{N_1}{N}\bar{x}_1 + \dfrac{N_2}{N}\bar{x}_2 + \cdots \dfrac{N_K}{N}\bar{x}_K =\sum_{j=1}^K\dfrac{N_j}{N}\bar{x}_j\]</span> är
en väntevärdesriktig skattning av <span class="math inline">\(\mu\)</span>, där <span class="math inline">\(\bar{x}_{j}\)</span> betecknar stickprovsmedelvärdet i stratum <span class="math inline">\(j\)</span>.</li>
<li>Stickprovsmedelvärdets varians är <span class="math display">\[V(\bar{x}_{st}) = \sum_{j=1}^K \left(\dfrac{N_j}{N}\right)^2 V(\bar{x}_j)\]</span> där stickprovsmedelvärdets varians betecknas
<span class="math display">\[V(\bar{x}_j) = \left(\dfrac{N_j-n_j}{N_j-1}\right)\dfrac{\sigma^2_j}{n_j}\]</span>.
Ovanstående skattas med
<span class="math display">\[\hat{V}(\bar{x}_{st}) = \left(\dfrac{N_1}{N}\right)^2\hat{V}(\bar{x}_1) + \left(\dfrac{N_2}{N}\right)^2\hat{V}(\bar{x}_2) + \cdots + \left(\dfrac{N_K}{N}\right)^2\hat{V}(\bar{x}_K) = \sum_{j=1}^K \left(\dfrac{N_j}{N}\right)^2\hat{V}(\bar{x}_j)\]</span>
där
<span class="math display">\[\hat{V}(\bar{x}_j) = \left(1 - \dfrac{n_j}{N_j}\right)\dfrac{s^2_j}{n_j}\]</span>
och <span class="math inline">\(s^2_j\)</span> är stickprovsvariansen i stratum <span class="math inline">\(j\)</span>.</li>
<li>Om stickprovsstorleken är tillräckligt stor i respektive stratum, (<span class="math inline">\(n_j &gt; 20\)</span>), är <span class="math inline">\(\bar{x}_{st}\)</span> approximativt normalfördelad.</li>
<li>För konfidensintervall för <span class="math inline">\(\mu\)</span> och test av <span class="math inline">\(H_0:\mu=\mu_0\)</span> gäller samma formler som tidigare baserat på normalapproximationen.</li>
</ul>
<p><strong>Exempel 7: Inkomst</strong></p>
<p><em>Kommunen A önskar att med 90% konfidensgrad skatta medelinkomsten i kommunen. Målpopulationen är invånare i åldern 18-67 år och rampopulationen är en lista med 11200 individer från registret över totalbefolkningen. Eftersom inkomst är relaterad till ålder genomförs en stratifiering utifrån ålderskategorierna 18-34 år (4000 individer), 35-49 år (4200 individer) och 50-67 år (3000 individer). Vi utgår från att det inte finns någon övertäckning eller undertäckning och drar från respektive stratum ett OSU-UÅ. Individerna kontaktas och data samlas in utan bortfall. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet. </em></p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="co"># Vi inleder med att ordna data så att stratifieringsvariabeln är tydligare namngiven. </span></a>
<a class="sourceLine" id="cb313-2" title="2"><span class="co"># Dessutom anger vi relevanta parametrar från undersökningen samt delar upp datamaterial i stratumspecifika data. </span></a>
<a class="sourceLine" id="cb313-3" title="3"><span class="co"># Det är inte nödvändigt att göra den indelningen, utan det finns alternativa sätt att koda</span></a>
<a class="sourceLine" id="cb313-4" title="4"><span class="co"># NOTERA ATT 1 = 18-34 år, 2 = 35-49 år, 3 = 50-67 år</span></a>
<a class="sourceLine" id="cb313-5" title="5"> df<span class="op">$</span>age &lt;-<span class="st"> </span><span class="kw">factor</span>(df<span class="op">$</span>alder)</a>
<a class="sourceLine" id="cb313-6" title="6"> <span class="kw">levels</span>(df<span class="op">$</span>age)[<span class="kw">levels</span>(df<span class="op">$</span>age) <span class="op">==</span><span class="st"> &quot;1&quot;</span>] &lt;-<span class="st"> &quot;18-34 år&quot;</span></a>
<a class="sourceLine" id="cb313-7" title="7"> <span class="kw">levels</span>(df<span class="op">$</span>age)[<span class="kw">levels</span>(df<span class="op">$</span>age) <span class="op">==</span><span class="st"> &quot;2&quot;</span>] &lt;-<span class="st"> &quot;35-49 år&quot;</span></a>
<a class="sourceLine" id="cb313-8" title="8"> <span class="kw">levels</span>(df<span class="op">$</span>age)[<span class="kw">levels</span>(df<span class="op">$</span>age) <span class="op">==</span><span class="st"> &quot;3&quot;</span>] &lt;-<span class="st"> &quot;50-67 år&quot;</span></a>
<a class="sourceLine" id="cb313-9" title="9"><span class="co"># Populationsstorlekar från uppgiften</span></a>
<a class="sourceLine" id="cb313-10" title="10"> N_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">3000</span></a>
<a class="sourceLine" id="cb313-11" title="11"> N_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">4200</span></a>
<a class="sourceLine" id="cb313-12" title="12"> N_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="dv">4000</span></a>
<a class="sourceLine" id="cb313-13" title="13"> N &lt;-<span class="st"> </span>N_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>N_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>N_<span class="dv">3</span></a>
<a class="sourceLine" id="cb313-14" title="14"> <span class="co"># Stickprovsstorlekar. Räkna hur många som inte är NA i respektive stratum </span></a>
<a class="sourceLine" id="cb313-15" title="15"> n_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;18-34 år&quot;</span>]))</a>
<a class="sourceLine" id="cb313-16" title="16"> n_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;35-49 år&quot;</span>]))</a>
<a class="sourceLine" id="cb313-17" title="17"> n_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;50-67 år&quot;</span>]))</a>
<a class="sourceLine" id="cb313-18" title="18"> n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">3</span></a>
<a class="sourceLine" id="cb313-19" title="19"><span class="co"># Medelvärde  </span></a>
<a class="sourceLine" id="cb313-20" title="20"> xbar_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;18-34 år&quot;</span>])</a>
<a class="sourceLine" id="cb313-21" title="21"> xbar_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;35-49 år&quot;</span>])</a>
<a class="sourceLine" id="cb313-22" title="22"> xbar_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;50-67 år&quot;</span>])</a>
<a class="sourceLine" id="cb313-23" title="23"> xbar_st &lt;-<span class="st"> </span>(N_<span class="dv">1</span><span class="op">/</span>N)<span class="op">*</span>xbar_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(N_<span class="dv">2</span><span class="op">/</span>N)<span class="op">*</span>xbar_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(N_<span class="dv">3</span><span class="op">/</span>N)<span class="op">*</span>xbar_<span class="dv">3</span></a>
<a class="sourceLine" id="cb313-24" title="24"><span class="co"># Stickprovsvarians  </span></a>
<a class="sourceLine" id="cb313-25" title="25"> s2_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;18-34 år&quot;</span>])</a>
<a class="sourceLine" id="cb313-26" title="26"> s2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;35-49 år&quot;</span>])  </a>
<a class="sourceLine" id="cb313-27" title="27"> s2_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;50-67 år&quot;</span>])</a>
<a class="sourceLine" id="cb313-28" title="28"><span class="co"># Skattningen av stickprovsmedelvärdets varians vid stratifierat urval</span></a>
<a class="sourceLine" id="cb313-29" title="29"> vhatxbar_<span class="dv">1</span> &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n_<span class="dv">1</span><span class="op">/</span>N_<span class="dv">1</span>)<span class="op">*</span>(s2_<span class="dv">1</span><span class="op">/</span>n_<span class="dv">1</span>)  </a>
<a class="sourceLine" id="cb313-30" title="30"> vhatxbar_<span class="dv">2</span> &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n_<span class="dv">2</span><span class="op">/</span>N_<span class="dv">2</span>)<span class="op">*</span>(s2_<span class="dv">2</span><span class="op">/</span>n_<span class="dv">2</span>)    </a>
<a class="sourceLine" id="cb313-31" title="31"> vhatxbar_<span class="dv">3</span> &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n_<span class="dv">3</span><span class="op">/</span>N_<span class="dv">3</span>)<span class="op">*</span>(s2_<span class="dv">3</span><span class="op">/</span>n_<span class="dv">3</span>)  </a>
<a class="sourceLine" id="cb313-32" title="32"> vhatxbar_st &lt;-<span class="st"> </span>(N_<span class="dv">1</span><span class="op">/</span>N)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatxbar_<span class="dv">1</span> <span class="op">+</span>(N_<span class="dv">2</span><span class="op">/</span>N)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatxbar_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(N_<span class="dv">3</span><span class="op">/</span>N)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatxbar_<span class="dv">3</span></a>
<a class="sourceLine" id="cb313-33" title="33"><span class="co"># Konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb313-34" title="34"> alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb313-35" title="35"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb313-36" title="36"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb313-37" title="37"> ll_mu_st &lt;-<span class="st"> </span>xbar_st <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar_st)</a>
<a class="sourceLine" id="cb313-38" title="38"> ul_mu_st &lt;-<span class="st"> </span>xbar_st <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar_st)</a>
<a class="sourceLine" id="cb313-39" title="39"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb313-40" title="40"> resultat_mu_st &lt;-<span class="st"> </span><span class="kw">c</span>(xbar_st, ll_mu_st, ul_mu_st)</a>
<a class="sourceLine" id="cb313-41" title="41"> resultat_mu_st</a></code></pre></div>
<pre><code>## [1] 25853.41 24830.77 26876.04</code></pre>
<p><em>Medelinkomsten i kommunen skattas till 27703 kr/mån. Med 90% säkerhet täcker intervallet 24759 kr/mån till 26647 kr/mån medelinkomsten i kommunen. Vi har ett STOSU vilket ger väntevärdesriktiga skattningar och eftersom alla stratumspecifika urval är stort kan vi även skatta ett konfidensintervall eftersom vi på grund av CGS kan använda normalapproximationen.</em></p>
<p>Det är ofta illustrativt att även redovisa stratumspecifik beskrivande statistik i respektive stratum och även att undersöka variabelns fördelning i respektive stratum. En sådan tabell samt figurer bör konstrueras i praktiken, men ni förväntas inte genomföra detta på alla uppgifter som ni ska lösa.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1">  <span class="co"># Beskrivning av stratumspecifik statistik    </span></a>
<a class="sourceLine" id="cb315-2" title="2">  stratum_tabell &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(N_<span class="dv">1</span>,N_<span class="dv">2</span>,N_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb315-3" title="3">                              n_<span class="dv">1</span>,n_<span class="dv">2</span>,n_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb315-4" title="4">                              xbar_<span class="dv">1</span>,xbar_<span class="dv">2</span>,xbar_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb315-5" title="5">                              s2_<span class="dv">1</span>,s2_<span class="dv">2</span>,s2_<span class="dv">3</span>), <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb315-6" title="6">  <span class="kw">colnames</span>(stratum_tabell) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Nj&quot;</span>, <span class="st">&quot;nj&quot;</span>, <span class="st">&quot;xbarj&quot;</span>, <span class="st">&quot;s2j&quot;</span>)</a>
<a class="sourceLine" id="cb315-7" title="7">  <span class="kw">rownames</span>(stratum_tabell) &lt;-<span class="st"> </span><span class="kw">levels</span>(df<span class="op">$</span>age)</a>
<a class="sourceLine" id="cb315-8" title="8">  stratum_tabell</a>
<a class="sourceLine" id="cb315-9" title="9"><span class="co"># Stratumspecifika fördelningar</span></a>
<a class="sourceLine" id="cb315-10" title="10"> <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb315-11" title="11">  <span class="kw">hist</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;18-34 år&quot;</span>], </a>
<a class="sourceLine" id="cb315-12" title="12">      <span class="dt">breaks =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb315-13" title="13">      <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb315-14" title="14">      <span class="dt">xlab =</span> <span class="st">&quot;Inkomst (SEK/månad) bland 18-34 år&quot;</span>,</a>
<a class="sourceLine" id="cb315-15" title="15">      <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>,</a>
<a class="sourceLine" id="cb315-16" title="16">      <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb315-17" title="17">      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">85000</span>),</a>
<a class="sourceLine" id="cb315-18" title="18">      <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb315-19" title="19"> <span class="kw">hist</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;35-49 år&quot;</span>], </a>
<a class="sourceLine" id="cb315-20" title="20">      <span class="dt">breaks =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb315-21" title="21">      <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb315-22" title="22">      <span class="dt">xlab =</span> <span class="st">&quot;Inkomst (SEK/månad) bland 35-49 år&quot;</span>,</a>
<a class="sourceLine" id="cb315-23" title="23">      <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>,</a>
<a class="sourceLine" id="cb315-24" title="24">      <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb315-25" title="25">      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">85000</span>),</a>
<a class="sourceLine" id="cb315-26" title="26">      <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb315-27" title="27"> <span class="kw">hist</span>(df<span class="op">$</span>inkomst[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;50-67 år&quot;</span>], </a>
<a class="sourceLine" id="cb315-28" title="28">      <span class="dt">breaks =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb315-29" title="29">      <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb315-30" title="30">      <span class="dt">xlab =</span> <span class="st">&quot;Inkomst (SEK/månad) bland 50-67 år&quot;</span>,</a>
<a class="sourceLine" id="cb315-31" title="31">      <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>,</a>
<a class="sourceLine" id="cb315-32" title="32">      <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb315-33" title="33">      <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">85000</span>),</a>
<a class="sourceLine" id="cb315-34" title="34">      <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb315-35" title="35">  <span class="kw">boxplot</span>(df<span class="op">$</span>inkomst <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>age,</a>
<a class="sourceLine" id="cb315-36" title="36">           <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, </a>
<a class="sourceLine" id="cb315-37" title="37">           <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb315-38" title="38">           <span class="dt">ylab =</span> <span class="st">&quot;Inkomst (kr/mån)&quot;</span>)</a></code></pre></div>
<pre><code>##            Nj  nj    xbarj       s2j
## 18-34 år 3000 200 25002.49 131305562
## 35-49 år 4200 120 25669.14 116515782
## 50-67 år 4000 100 26685.07 168804297</code></pre>
<p><img src="dpk_files/figure-html/unnamed-chunk-275-1.png" width="432" /></p>
</div>
<div id="inferens-för-p" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Inferens för <span class="math inline">\(p\)</span></h3>
<p>Anta att <span class="math inline">\(x\)</span> är binär. Givet ett OSU-UÅ från respektive stratum är:</p>
<ul>
<li>Stickprovsandelen <span class="math inline">\(\hat{p}_{st}=\sum_{j=1}^K\dfrac{N}{N_j}\hat{p}_j\)</span> är en väntevärdesriktig skattning av <span class="math inline">\(p\)</span>, där den stratumspecifka stickprovsandelen är <span class="math inline">\(\hat{p}_j\)</span>.</li>
<li>Stickprovsandelens varians <span class="math display">\[V(\hat{p}_{st}) = \sum_{j=1}^K\left(\dfrac{N_j}{N}\right)^2V(\hat{p}_j)\]</span> skattas med
<span class="math display">\[\hat{V}(\hat{p}_{st}) = \sum_{j=1}^K\left(\dfrac{N_j}{N} \right)^2\hat{V}(\hat{p}_j),\]</span> där
<span class="math display">\[\left(1 - \dfrac{n_j}{N_j}\right)\dfrac{\hat{p}_j(1-\hat{p}_j)}{n_j-1}.\]</span></li>
<li>Om <span class="math inline">\(n_jp_j(1-p_j)&gt;5\)</span> i alla stratum <span class="math inline">\(j\)</span> är <span class="math inline">\(\hat{p}_{st}\)</span> approximativt normalfördelad.</li>
<li>Hypotesprövning för andelen i populationen med stratifierat urval ingår inte på kursen!</li>
</ul>
<p><strong>Exempel 8: Inkomst över 30000 kr/mån</strong>
<em>Kommunen A önskar att med 90% konfidensgrad skatta andelen i kommunen med en inkomst över 30000 kr/mån. För mer information, se Exempel 7. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1"><span class="co"># Uppgifter från tidigare exempel</span></a>
<a class="sourceLine" id="cb317-2" title="2"><span class="co"># Andelar (givet att det inte finns bortfall!)</span></a>
<a class="sourceLine" id="cb317-3" title="3"> x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>inkomst_<span class="dv">30000</span>[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;18-34 år&quot;</span>])</a>
<a class="sourceLine" id="cb317-4" title="4"> x_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>inkomst_<span class="dv">30000</span>[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;35-49 år&quot;</span>])</a>
<a class="sourceLine" id="cb317-5" title="5"> x_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>inkomst_<span class="dv">30000</span>[df<span class="op">$</span>age <span class="op">==</span><span class="st"> &quot;50-67 år&quot;</span>])</a>
<a class="sourceLine" id="cb317-6" title="6"> phat_<span class="dv">1</span> &lt;-<span class="st"> </span>x_<span class="dv">1</span><span class="op">/</span>n_<span class="dv">1</span></a>
<a class="sourceLine" id="cb317-7" title="7"> phat_<span class="dv">2</span> &lt;-<span class="st"> </span>x_<span class="dv">2</span><span class="op">/</span>n_<span class="dv">2</span></a>
<a class="sourceLine" id="cb317-8" title="8"> phat_<span class="dv">3</span> &lt;-<span class="st"> </span>x_<span class="dv">3</span><span class="op">/</span>n_<span class="dv">3</span></a>
<a class="sourceLine" id="cb317-9" title="9"> phat_st &lt;-<span class="st"> </span>(N_<span class="dv">1</span><span class="op">/</span>N)<span class="op">*</span>phat_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(N_<span class="dv">2</span><span class="op">/</span>N)<span class="op">*</span>phat_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(N_<span class="dv">3</span><span class="op">/</span>N)<span class="op">*</span>phat_<span class="dv">3</span></a>
<a class="sourceLine" id="cb317-10" title="10"><span class="co"># Skattningen av stickprovsmedelvärdets varians vid stratifierat urval</span></a>
<a class="sourceLine" id="cb317-11" title="11"> vhatphat_<span class="dv">1</span> &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n_<span class="dv">1</span><span class="op">/</span>N_<span class="dv">1</span>)<span class="op">*</span>(phat_<span class="dv">1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat_<span class="dv">1</span>)<span class="op">/</span>(n_<span class="dv">1-1</span>))  </a>
<a class="sourceLine" id="cb317-12" title="12"> vhatphat_<span class="dv">2</span> &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n_<span class="dv">2</span><span class="op">/</span>N_<span class="dv">2</span>)<span class="op">*</span>(phat_<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">2-1</span>))     </a>
<a class="sourceLine" id="cb317-13" title="13"> vhatphat_<span class="dv">3</span> &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n_<span class="dv">3</span><span class="op">/</span>N_<span class="dv">3</span>)<span class="op">*</span>(phat_<span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat_<span class="dv">3</span>)<span class="op">/</span>(n_<span class="dv">3-1</span>))  </a>
<a class="sourceLine" id="cb317-14" title="14"> vhatphat_st &lt;-<span class="st"> </span>(N_<span class="dv">1</span><span class="op">/</span>N)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatphat_<span class="dv">1</span> <span class="op">+</span>(N_<span class="dv">2</span><span class="op">/</span>N)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatphat_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(N_<span class="dv">3</span><span class="op">/</span>N)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatphat_<span class="dv">3</span></a>
<a class="sourceLine" id="cb317-15" title="15"><span class="co"># Konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb317-16" title="16"> alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb317-17" title="17"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb317-18" title="18"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb317-19" title="19"> ll_p_st &lt;-<span class="st"> </span>phat_st <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphat_st)</a>
<a class="sourceLine" id="cb317-20" title="20"> ul_p_st &lt;-<span class="st"> </span>phat_st <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphat_st)</a>
<a class="sourceLine" id="cb317-21" title="21"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb317-22" title="22"> resultat_p_st &lt;-<span class="st"> </span><span class="kw">c</span>(phat_st, ll_p_st, ul_p_st)</a>
<a class="sourceLine" id="cb317-23" title="23"> resultat_p_st</a>
<a class="sourceLine" id="cb317-24" title="24"><span class="co"># Koll av förutsättningar </span></a>
<a class="sourceLine" id="cb317-25" title="25"> n_<span class="dv">1</span><span class="op">*</span>phat_<span class="dv">1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb317-26" title="26"> n_<span class="dv">2</span><span class="op">*</span>phat_<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb317-27" title="27"> n_<span class="dv">3</span><span class="op">*</span>phat_<span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat_<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.3267857 0.2863618 0.3672096</code></pre>
<pre><code>## [1] 42.395</code></pre>
<pre><code>## [1] 27.59167</code></pre>
<pre><code>## [1] 21.39</code></pre>
<p><em>Andelen i kommunen med en inkomst över 30000 kr/mån skattas 0.337. Med 90% säkerhet är andelen i kommunen med en inkomst över 30000 kr/mån mellan 0.286 och 0.367. Vi har ett OSU-UÅ vilket ger väntevärdesriktiga skattningar och förutsättningarna för att använda normalapproximationen är uppfylld.</em></p>
<p>Vi presenterar också en sammanställning av stratumspecfika kvantiteter.</p>
<pre><code>##            Nj  nj     phatj
## 18-34 år 3000 200 0.3050000
## 35-49 år 4200 120 0.3583333
## 50-67 år 4000 100 0.3100000</code></pre>
</div>
<div id="inferens-för-tau" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Inferens för <span class="math inline">\(\tau\)</span></h3>
<p>Givet ett OSU-UÅ från respektive stratum är:</p>
<ul>
<li>Totalestimatorn <span class="math inline">\(\hat{\tau}_{st} = N\bar{x}_{st}\)</span> är en väntevärdesriktig skattning av <span class="math inline">\(\tau\)</span>. Om <span class="math inline">\(x\)</span> är binär gäller att <span class="math inline">\(\hat{\tau}_{st} = N\hat{p}_{st}\)</span></li>
<li>Totalestimatorns varians är <span class="math inline">\(V(\hat{\tau}_{st}) = N^2V(\bar{x}_{st})\)</span>, vilken skattas med <span class="math inline">\(\hat{V}(\hat{\tau}_{st}) = N^2\hat{V}(\bar{x}_{st})\)</span>. Om <span class="math inline">\(x\)</span> är binär är <span class="math inline">\(V(\hat{\tau}_{st}) = N^2V(\hat{p}_{st})\)</span>, vilken skattas med <span class="math inline">\(\hat{V}(\hat{\tau}_{st}) = N^2\hat{V}(\hat{p}_{st})\)</span>.</li>
<li>Samplingfördelningen följer samma regler som för <span class="math inline">\(\bar{x}_{st}\)</span> respektive <span class="math inline">\(\hat{p}_{st}\)</span>.</li>
<li>Samma principer gäller för inferens om <span class="math inline">\(\mu\)</span> respektive <span class="math inline">\(p\)</span>.</li>
</ul>
<p><strong>Exempel 9: Inkomst över 30000 kr/mån</strong></p>
<p><em>Kommunen A önskar att med 90% konfidensgrad skatta antalet i kommunen med en inkomst över 30000 kr/mån. För mer information, se Exempel 7. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet. </em></p>
<pre><code>## [1] 3660.000 3207.252 4112.748</code></pre>
<pre><code>## [1] 42.395</code></pre>
<pre><code>## [1] 27.59167</code></pre>
<pre><code>## [1] 21.39</code></pre>
<p><em>Antalet i kommunen med en inkomst över 30000 skattas till 3660 stycken. Med 95% säkerhet täcker intervallet 3207 till 4113 antalet i kommunen med en inkomst över 30000. Vi har ett OSU-UÅ från respektive stratum vilket ger väntevärdesriktiga skattningar och förutsättningarna för att, på grund av CGS, använda normalapproximationen är uppfylld.</em></p>
</div>
<div id="allokering-av-n" class="section level3">
<h3><span class="header-section-number">9.2.4</span> Allokering av <span class="math inline">\(n\)</span></h3>
<p>Utgå från att vi har budget för en viss urvalsstorlek. Vid stratifierat urval ska denna urvalsstorlek allokeras till olika strata.</p>
<ul>
<li>Neyman-allokering innebär hänsyn tas till variation och populationsstorlek:
<span class="math display">\[n_j=\dfrac{\sigma_jN_j}{\sum_{j=1}^K \sigma_j N_j}\]</span></li>
<li>Proportionell allokering tar enbart hänsyn till de stratumspecifika populationsstorlekarna. Därmed försvinner <span class="math inline">\(\sigma_j\)</span> från allokeringsformeln. Proportionell allokering är visserligen mindre effektiv än Neyman-allokering, men kan ändå väljas på grund av ett eller flera av följande skäl: (i) Varianserna antas vara lika varandra i olika stratum och Neyman-allokering skulle innebära en mycket låg precisionsvinst.</li>
</ul>
<ol start="2" style="list-style-type: lower-roman">
<li>Det saknas information om de stratumspecifika varianserna.</li>
<li>Inferensen blir enklare med proportionell allokering eftersom det leder till ett så kallat självvägt urval (alla element i populationen har samma inklusionssannolikhet).</li>
</ol>
<ul>
<li>Lika allokering innebär att <span class="math inline">\(n_j=n/K\)</span>.</li>
</ul>
<p><strong>Exempel 10</strong>
<em>Anta att du har en stickprovsstorlek på 980 observationer som du vill allokera till fyra strata. Du har fyra stratumspecifika populationsvarianser <span class="math inline">\(\sigma^2_1 = 9, \sigma^2_2 = 4, \sigma^2_3 = 1, \sigma^2_4 = 25\)</span> och fyra stratumspecifika populationsstorlekar <span class="math inline">\(N_1 = 7000, N_2 = 15000, N_3 = 40000, N_4 = 1300\)</span>. Genom för allokering av stickprovsstorleken.</em></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1"> sigma2_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">9</span></a>
<a class="sourceLine" id="cb327-2" title="2"> sigma2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb327-3" title="3"> sigma2_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb327-4" title="4"> sigma2_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb327-5" title="5"> N_<span class="dv">1</span>_allok &lt;-<span class="st"> </span><span class="dv">7000</span></a>
<a class="sourceLine" id="cb327-6" title="6"> N_<span class="dv">2</span>_allok &lt;-<span class="st"> </span><span class="dv">15000</span></a>
<a class="sourceLine" id="cb327-7" title="7"> N_<span class="dv">3</span>_allok &lt;-<span class="st"> </span><span class="dv">40000</span></a>
<a class="sourceLine" id="cb327-8" title="8"> N_<span class="dv">4</span>_allok &lt;-<span class="st"> </span><span class="dv">1300</span></a>
<a class="sourceLine" id="cb327-9" title="9"> n_size &lt;-<span class="st"> </span><span class="dv">980</span></a>
<a class="sourceLine" id="cb327-10" title="10"> denominomator &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sigma2_<span class="dv">1</span>)<span class="op">*</span>N_<span class="dv">1</span>_allok <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(sigma2_<span class="dv">2</span>)<span class="op">*</span>N_<span class="dv">2</span>_allok <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb327-11" title="11"><span class="st">                  </span><span class="kw">sqrt</span>(sigma2_<span class="dv">3</span>)<span class="op">*</span>N_<span class="dv">3</span>_allok <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(sigma2_<span class="dv">4</span>)<span class="op">*</span>N_<span class="dv">4</span>_allok</a>
<a class="sourceLine" id="cb327-12" title="12"> nj &lt;-<span class="st"> </span>n_size<span class="op">*</span><span class="kw">c</span>(<span class="kw">sqrt</span>(sigma2_<span class="dv">1</span>)<span class="op">*</span>N_<span class="dv">1</span>_allok, </a>
<a class="sourceLine" id="cb327-13" title="13">                <span class="kw">sqrt</span>(sigma2_<span class="dv">2</span>)<span class="op">*</span>N_<span class="dv">2</span>_allok, </a>
<a class="sourceLine" id="cb327-14" title="14">                <span class="kw">sqrt</span>(sigma2_<span class="dv">3</span>)<span class="op">*</span>N_<span class="dv">3</span>_allok,</a>
<a class="sourceLine" id="cb327-15" title="15">                <span class="kw">sqrt</span>(sigma2_<span class="dv">4</span>)<span class="op">*</span>N_<span class="dv">4</span>_allok)<span class="op">/</span>denominomator</a>
<a class="sourceLine" id="cb327-16" title="16"> nj</a></code></pre></div>
<pre><code>## [1] 211.07692 301.53846 402.05128  65.33333</code></pre>
<p><em>Du allokerar 211 observationer till stratum ett, 302 till stratum två, 402 till stratum tre och 65 till stratum fyra.</em></p>
<hr />
<p><img src="docs/images/warning.png" width="5%" /></p>
<hr />
</div>
</div>
<div id="gruppurval" class="section level2">
<h2><span class="header-section-number">9.3</span> Gruppurval</h2>
<p><img src="docs/images/gruppurval.jpg" width="30%" style="background-color: #414244 ; padding:1px; display: inline-block;" /></p>
<p>Utgå från en population bestående av <span class="math inline">\(N\)</span> grupper (kluster). Varje grupp populationen består av <span class="math inline">\(M_i\)</span> element och totalt finns i populationen <span class="math inline">\(M\)</span> element, dvs <span class="math inline">\(\sum_{i=1}^NM_i\)</span>. Låt <span class="math inline">\(x_{ij}\)</span> beteckna värdet som element <span class="math inline">\(j\)</span> har i grupp <span class="math inline">\(i\)</span>. Totalvärdet för grupp <span class="math inline">\(i\)</span> är då <span class="math inline">\(x_i\)</span>, dvs <span class="math inline">\(x_i=\sum_{j=1}^{M_i} x_{ij}\)</span>. Vi formulerar medelvärdet för alla grupptotaler som <span class="math display">\[\bar{\mu} = \dfrac{1}{N}\sum_{i=1}^Nx_i\]</span>.
Det innebär att totalen för alla element i populationen kan skrivas:
<span class="math display">\[\tau = \sum_{i=1}^N\sum_{j=1}^{M_i}x_{ij}=\sum_{i=1}^N x_i = N\bar{\mu}\]</span>.
Därmed är medelvärdet för alla element i populationen
<span class="math display">\[\mu = \dfrac{1}{M}\sum_{i=1}^N\sum_{j=1}^{M_i}x_{ij} = \dfrac{1}{M} \sum_{i=1}^N x_i = \dfrac{N}{M}\bar{\mu}.\]</span></p>
<p>Om vi låter <span class="math inline">\(x_{ij}\)</span> anta värdena 0 och 1 kan andelen i populationen, <span class="math inline">\(p\)</span>, definieras på motsvarande sätt som medelvärdet.
Analogt med <span class="math inline">\(\bar{\mu}\)</span> kan vi definiera populationsvariansen för grupptotalerna</p>
<p><span class="math display">\[\sigma^2_u = \dfrac{1}{N}\sum_{i=1}^N (x_i - \bar{\mu})^2.\]</span></p>
<p>Från rampopulationen bestående av <span class="math inline">\(N\)</span> grupper genomförs ett OSU-UÅ av storleken <span class="math inline">\(n\)</span> grupper, där varje grupp består av <span class="math inline">\(m_i\)</span> element. Totalt består urvalet av <span class="math inline">\(m = \sum_{i=1}^n m_i\)</span> element.</p>
<p>Nedan exemplifieras de olika kvantiteterna i en population.</p>
<!-- ```{r, echo=TRUE, eval=FALSE, collapse=TRUE, prompt=FALSE, comment=''}  -->
<!-- # Populationens storlek (Antal grupper) -->
<!--  N <- 5 -->
<!-- # Fem grupper 5, 7, 10, 15, 18 -->
<!--  grupp_id <- c(5,5,5,5,7,7,7,7,7,7,10,10,10,10,10,10,15,15,15,15,15,15,15,18,18,18,18) -->
<!-- # Varje grupp består av ett antal element (Mi) -->
<!--  Mi <- table(grupp_id) -->
<!-- # Antalet element i populationen   -->
<!--  M <- sum(Mi) -->
<!--  M  -->
<!-- # Varje element har ett värde  -->
<!--  xij <- c(3,6,3,5,6,8,9,6,5,7,8,7,8,10,14,2,4,4,5,11,35,4,3,1,3,4,55) -->
<!-- # Varje grupp har ett totalvärde -->
<!--  grupp_xi <- aggregate(xij ~ grupp_id, FUN = sum) -->
<!--  grupp <- grupp_xi[,1] -->
<!--  xi <- grupp_xi[,2] -->
<!-- # Medelvärdet av alla grupp totaler  -->
<!--  mubar <- mean(xi) -->
<!-- # Totalvärde i populationen -->
<!--  tau <- sum(xi)  # jmf med  sum(xij) -->
<!-- # Medelvärdet för alla element populationen  -->
<!--  mu <- (N/M)*mubar  # jmf med  mean(xij) -->
<!-- ``` -->
<div id="inferens-för-mu-1" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Inferens för <span class="math inline">\(\mu\)</span></h3>
<p>Utgå från ett OSU-UÅ med <span class="math inline">\(n\)</span> grupper.</p>
<ul>
<li>En väntevärdesriktig estimator för <span class="math inline">\(\mu\)</span> är
<span class="math display">\[\bar{x}_{vvr}=\dfrac{N}{M} \hat{\bar{\mu}},\]</span>
där <span class="math inline">\(\hat{\bar{\mu}} = \dfrac{1}{n}\sum_{i=1}^n x_i\)</span> är medelvärdet för alla grupptotaler i stickprovet.<br />
</li>
<li>Estimatorns varians <span class="math inline">\(V(\bar{x}_{vvr})\)</span> skattas med
<span class="math display">\[\hat{V}(\bar{x}_{vvr}) = \left(\dfrac{N}{M}\right)^2\left(1 - \dfrac{n}{N}\right)\dfrac{s^2_u}{n}\]</span>
där <span class="math display">\[s^2_u = \dfrac{1}{n}\sum_{i=1}(x_i - \hat{\bar{\mu}})^2\]</span> är stickprovsvariansen av alla <span class="math inline">\(x_i\)</span>.</li>
<li>Estimatorn <span class="math inline">\(\bar{x}_{vvr}\)</span> är approx. <span class="math inline">\(N(\mu, V(\bar{x}_{vvr}))\)</span> om <span class="math inline">\(n&gt;20\)</span></li>
<li>För konfidensintervall för <span class="math inline">\(\mu\)</span> och test av <span class="math inline">\(H_0:\mu=\mu_0\)</span> gäller samma formler som tidigare baserat på normalapproximationen.</li>
</ul>
<p>En alternativ estimator om <span class="math inline">\(M\)</span> inte är tillgänglig är kvotestimatorn
<span class="math display">\[\bar{x}_{kvot}= \dfrac{\sum_{i=1}^n x_i}{\sum_{i=1}^n m_i} = \dfrac{n}{m}\hat{\bar{\mu}}\]</span>
där <span class="math inline">\(m_i\)</span> är antalet element i i en grupp i urvalet och <span class="math inline">\(m = \sum_{i=1}^N m_i\)</span> antalet element i urvalet. Notera att <span class="math inline">\(\dfrac{n}{m}\)</span> skattar <span class="math inline">\(\dfrac{N}{M}\)</span>. Denna estimator är dock inte väntevärdesriktig. Däremot har den en har lägre varians än <span class="math inline">\(\bar{x}_{vvr}\)</span> om <span class="math inline">\(x_i\)</span> är korrelerad med <span class="math inline">\(M_i\)</span>. Biasen kan ignoerar om <span class="math inline">\(n &gt; 20\)</span>. Variansen för denna estimator ingår inte på kursen, då den är komplicerad.</p>
<p><strong>Exempel 11. Inkomst</strong></p>
<p><em>Kommunen A önskar att med 95% konfidensgrad skatta medelinkomsten i kommunen. Målpopulationen är invånare i åldern 18-67 år. Rampopulationen är en lista med 610 postnummer i kommunen. Vi utgår från att det inte finns någon övertäckning eller undertäckning vad gäller postnummer och drar ett OSU-UÅ bestående av 23 postnummer från rampopulationen. Individerna som bor i dessa postnummerområden kontaktas och data samlas in utan bortfall. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1"><span class="co"># Antal grupp i populationen</span></a>
<a class="sourceLine" id="cb329-2" title="2"> N &lt;-<span class="st"> </span><span class="dv">610</span></a>
<a class="sourceLine" id="cb329-3" title="3"><span class="co"># Antal element i populationen</span></a>
<a class="sourceLine" id="cb329-4" title="4"> M &lt;-<span class="st"> </span><span class="dv">11200</span></a>
<a class="sourceLine" id="cb329-5" title="5"><span class="co"># Använd aggregate() för att summera inkomst för varje postnummer </span></a>
<a class="sourceLine" id="cb329-6" title="6"> grupp_xi &lt;-<span class="st"> </span><span class="kw">aggregate</span>(df<span class="op">$</span>inkomst <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>postnr, <span class="dt">FUN =</span> sum)</a>
<a class="sourceLine" id="cb329-7" title="7"><span class="co"># Grupptotaler i urvalet</span></a>
<a class="sourceLine" id="cb329-8" title="8"> xi &lt;-<span class="st"> </span>grupp_xi[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb329-9" title="9"><span class="co"># Antal grupper i urvalet </span></a>
<a class="sourceLine" id="cb329-10" title="10"> n &lt;-<span class="st"> </span><span class="kw">length</span>(xi)</a>
<a class="sourceLine" id="cb329-11" title="11"><span class="co"># Medelvärdet av alla grupptotaler (xi) i urvalet </span></a>
<a class="sourceLine" id="cb329-12" title="12"> mubarhat &lt;-<span class="st"> </span><span class="kw">mean</span>(xi)</a>
<a class="sourceLine" id="cb329-13" title="13"><span class="co"># Stickprovsvarians alla grupptotaler (xi) i urvalet  </span></a>
<a class="sourceLine" id="cb329-14" title="14"> s2u &lt;-<span class="st"> </span><span class="kw">var</span>(xi)</a>
<a class="sourceLine" id="cb329-15" title="15"><span class="co"># Medelvärdesskattning  </span></a>
<a class="sourceLine" id="cb329-16" title="16"> xbar_vvr &lt;-<span class="st"> </span>(N<span class="op">/</span>M)<span class="op">*</span>mubarhat</a>
<a class="sourceLine" id="cb329-17" title="17"><span class="co"># Skattningen av stickprovsmedelvärdets varians vid OSU-UÅ  </span></a>
<a class="sourceLine" id="cb329-18" title="18"> vhatxbar_vvr &lt;-<span class="st"> </span>(N<span class="op">/</span>M)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>(s2u<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb329-19" title="19"><span class="co"># Konfidensintervall med konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb329-20" title="20"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb329-21" title="21"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb329-22" title="22"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb329-23" title="23"> ll_mu_grupp &lt;-<span class="st"> </span>xbar_vvr <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar_vvr)</a>
<a class="sourceLine" id="cb329-24" title="24"> ul_mu_grupp &lt;-<span class="st"> </span>xbar_vvr <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar_vvr)</a>
<a class="sourceLine" id="cb329-25" title="25"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb329-26" title="26"> resultat_mu_grupp &lt;-<span class="st"> </span><span class="kw">c</span>(xbar_vvr, ll_mu_grupp, ul_mu_grupp)</a>
<a class="sourceLine" id="cb329-27" title="27"> resultat_mu_grupp  </a>
<a class="sourceLine" id="cb329-28" title="28">[<span class="dv">1</span>] <span class="fl">25454.48</span> <span class="fl">18976.56</span> <span class="fl">31932.41</span></a>
<a class="sourceLine" id="cb329-29" title="29"> </a>
<a class="sourceLine" id="cb329-30" title="30"><span class="co"># Alternativ estimator för medelvärdet om M är okänt </span></a>
<a class="sourceLine" id="cb329-31" title="31"> grupp_mi &lt;-<span class="st"> </span><span class="kw">aggregate</span>(df<span class="op">$</span>inkomst <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>postnr, <span class="dt">FUN =</span> length)</a>
<a class="sourceLine" id="cb329-32" title="32"><span class="co"># Antal element i respektive grupp </span></a>
<a class="sourceLine" id="cb329-33" title="33"> mi &lt;-<span class="st"> </span>grupp_mi[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb329-34" title="34"> xbar_kvot &lt;-<span class="st"> </span><span class="kw">sum</span>(xi)<span class="op">/</span><span class="kw">sum</span>(mi)</a>
<a class="sourceLine" id="cb329-35" title="35"> xbar_kvot</a>
<a class="sourceLine" id="cb329-36" title="36">[<span class="dv">1</span>] <span class="fl">25593.58</span></a></code></pre></div>
<p><em>Medelinkomsten i kommunen skattas till 25454 kr/mån. Med 95% säkerhet täcker intervallet 18977 kr/mån till 31932 kr/mån medelinkomsten i kommunen. Vi har ett OSU-UÅ av grupper vilket ger väntevärdesriktiga skattningar och eftersom urvalet är stort kan även skatta ett konfidensintervall eftersom vi på grund av CGS kan använda normalapproximationen. Notera hur mycket stor osäkerheten nu är jämfört med OSU-UÅ.</em></p>
<p><em>Med kvotestimatorn skattas medelinkomsten i kommunen till 25593 kr/mån.</em></p>
</div>
<div id="inferens-för-tau-1" class="section level3">
<h3><span class="header-section-number">9.3.2</span> Inferens för <span class="math inline">\(\tau\)</span></h3>
<p>Utgå från ett OSU-UÅ med <span class="math inline">\(n\)</span> grupper.</p>
<ul>
<li>En väntevärdesriktig estimator för <span class="math inline">\(\tau\)</span> är
<span class="math display">\[\hat{\tau}_{vvr}=N\hat{\bar{\mu}}.\]</span></li>
<li>Estimatorns varians, <span class="math inline">\(V(\hat{\tau}_{vvr})\)</span>, skattas med
<span class="math display">\[\hat{V}(\hat{\tau}_{vvr}) = N^2\left(1 - \dfrac{n}{N}\right)\dfrac{s^2_u}{n}\]</span></li>
<li>I övrigt samma egenskaper som <span class="math inline">\(\bar{x}_{vvr}.\)</span></li>
</ul>
<p><strong>Exempel 12. Inkomst</strong></p>
<p><em>Kommunen A önskar att med 95% konfidensgrad skatta den totala inkomsten i kommunen. Se information i Exempel 11. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1"><span class="co"># Totalskattning  </span></a>
<a class="sourceLine" id="cb330-2" title="2"> tauhau_vvr &lt;-<span class="st"> </span>N<span class="op">*</span>mubarhat</a>
<a class="sourceLine" id="cb330-3" title="3"><span class="co"># Skattningen av stickprovsmedelvärdets varians vid OSU-UÅ  </span></a>
<a class="sourceLine" id="cb330-4" title="4"> vhattau_vvr &lt;-<span class="st"> </span>N<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>(s2u<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb330-5" title="5"><span class="co"># Konfidensintervall med konfidensgraden 100(1-alpha)%.  </span></a>
<a class="sourceLine" id="cb330-6" title="6"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb330-7" title="7"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb330-8" title="8"><span class="co"># Konfidensintervallets gränser  </span></a>
<a class="sourceLine" id="cb330-9" title="9"> ll_tau_grupp &lt;-<span class="st"> </span>tauhau_vvr <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattau_vvr)</a>
<a class="sourceLine" id="cb330-10" title="10"> ul_tau_grupp &lt;-<span class="st"> </span>tauhau_vvr <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattau_vvr)</a>
<a class="sourceLine" id="cb330-11" title="11"><span class="co"># Resultat</span></a>
<a class="sourceLine" id="cb330-12" title="12"> resultat_tau_grupp &lt;-<span class="st"> </span><span class="kw">c</span>(tauhau_vvr, ll_tau_grupp, ul_tau_grupp)</a>
<a class="sourceLine" id="cb330-13" title="13"> resultat_tau_grupp  </a>
<a class="sourceLine" id="cb330-14" title="14">[<span class="dv">1</span>] <span class="dv">285090183</span> <span class="dv">212537429</span> <span class="dv">357642938</span></a></code></pre></div>
<p><em>Den totala inkomsten bland invånarna i kommunen skattas till 285090183 kr/mån. Med 95% säkerhet täcker intervallet 212537429 kr/mån till 357642938 kr/mån den totala inkomsten i kommunen. Vi har ett OSU-UÅ av grupper vilket ger väntevärdesriktiga skattningar och eftersom urvalet är stort kan även skatta ett konfidensintervall eftersom vi på grund av CGS kan använda normalapproximationen. Notera hur mycket stor osäkerheten nu är jämfört med OSU-UÅ.</em></p>
</div>
<div id="inferens-för-p-1" class="section level3">
<h3><span class="header-section-number">9.3.3</span> Inferens för <span class="math inline">\(p\)</span></h3>
<p>Anta att element <span class="math inline">\(x_{ij}\)</span> bara kan anta värdena 0 eller 1. Vi låter <span class="math inline">\(a_i\)</span> beteckna antalet ettor i en grupp och låter medelantalet ettor i grupperna i stickprovet vara <span class="math inline">\(\bar{a}=\dfrac{1}{n}\sum_{i=1}^n a_i\)</span>. Utgå från ett OSU-UÅ med <span class="math inline">\(n\)</span> grupper.</p>
<ul>
<li>En väntevärdesriktig skattning av andelen i populationen ges av
<span class="math display">\[\hat{p}_{vvr} = \dfrac{N}{M}\bar{a}.\]</span>
Om <span class="math inline">\(M\)</span> är okänd kan vi, under förutsättning att antalet grupper är tillräckligt stort (<span class="math inline">\(n&gt;20\)</span>), använda
<span class="math display">\[\hat{p}_{kvot} = \dfrac{\sum_{i=1}^n a_i}{\sum_{i=1}^n m_i} = \dfrac{n}{m}\bar{a}.\]</span></li>
<li>Varianser för <span class="math inline">\(\hat{p}_{vvr}\)</span> och <span class="math inline">\(\hat{p}_{kvot}\)</span> ingår inte på kursen.</li>
</ul>
<p><strong>Exempel 13. Inkomst över 30000</strong></p>
<p><em>Kommunen A önskar skatta andelen som har en jnkomst över 30000 i kommunen. Se information i Exempel 11. Besvara kommunens önskemål samt reflektera över om du kan lita på resultatet.</em></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" title="1"> grupp_xi &lt;-<span class="st"> </span><span class="kw">aggregate</span>(df<span class="op">$</span>inkomst_<span class="dv">30000</span> <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>postnr, <span class="dt">FUN =</span> sum)</a>
<a class="sourceLine" id="cb331-2" title="2"> ai &lt;-<span class="st"> </span>grupp_xi[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb331-3" title="3"> abar &lt;-<span class="st"> </span><span class="kw">mean</span>(ai)</a>
<a class="sourceLine" id="cb331-4" title="4"><span class="co"># Väntevärdesriktig medelvärdesskattning  </span></a>
<a class="sourceLine" id="cb331-5" title="5"> phat_vvr &lt;-<span class="st"> </span>(N<span class="op">/</span>M)<span class="op">*</span>abar</a>
<a class="sourceLine" id="cb331-6" title="6"> phat_vvr</a>
<a class="sourceLine" id="cb331-7" title="7">[<span class="dv">1</span>] <span class="fl">0.3196817</span></a></code></pre></div>
<p><em>Andelen invånare i åldersgruppen 18-67 år med en inkomst över 30 000 skattas till 0.32</em>.</p>
</div>
</div>
<div id="efterstratifiering" class="section level2">
<h2><span class="header-section-number">9.4</span> Efterstratifiering</h2>
<p>Efterstratifiering (poststratifiering) innebär att en stratifiering görs i efterhand. Anledningen är att hjälpvariabeln inte finns i urvalsramen och det är först efter datainsamlingen som elementens stratumtillhörigheter blir kända. En förutsättning för efterstratifiering är dock att information om hjälpvariabeln är känd på aggregerad nivå i populationen, dvs <span class="math inline">\(N_j\)</span> för respektive stratum måste vara känd.</p>
<p>Efterstratifiering leder till att de stratumspecifika stickprovsstorlekarna <span class="math inline">\(n_j\)</span> är slumpvariabler eftersom de stratumspecifika stickprovsstorlekarna beror de element som valts ut i urvalet. På detta vis skiljer sig efterstratifering från sedvanligt stratifierat urval där <span class="math inline">\(n_j\)</span> är konstanter som väljs i förväg. På grund av denna extra slumpmässighet är estimatorernas varianser vid efterstratifiering alltid <em>större än vid stratifierat urval</em>, dvs <span class="math inline">\(V(\bar{x}_{post}) &gt; V(\bar{x}_{st})\)</span>.</p>
<p>Dock minskar skillnaden mellan varianserna när <span class="math inline">\(n\)</span> är stort och all <span class="math inline">\(n_j\)</span> är relativt stora. Därför gäller att</p>
<ul>
<li>om <span class="math inline">\(n\)</span> är stort och alla <span class="math inline">\(n_j\)</span> är relativt stora används samma variansskattningar som vid stratifierat urval. En praktisk konsekvens är att man inte kan välja allt för många strata vid en efterstratifiering. Istället för att stratifiera utifrån nio eller tio ålderskategorier så måste vi nöja oss med två eller tre strata.</li>
<li>Undersökaren måste i förväg ha bestämt hur stratifiering ska göras, så att man inte letar efter en lämplig stratumindelning i efterhand.</li>
</ul>
<p>Efterstratifiering används ofta för korrigera för bortfall i en undersökning.</p>
</div>
<div id="övningar-4" class="section level2">
<h2><span class="header-section-number">9.5</span> Övningar</h2>
<p>Nedan följer ett antal övningsuppgifter tillhörande detta kapitel. De senare lösningarna kan ha en annan utformning än de inledande, gällande exempelvis beteckningar i R-kod. Ni får använda den kod som ni är mest bekväm med.</p>
<div id="övning-7.1" class="section level3 unnumbered">
<h3>Övning 7.1</h3>
<p>I ett nybyggt höghusområde önskade kommunen undersöka förskolebehovet. Kommunen gjorde därför ett obundet slumpmässigt urval utan återläggning av 100 hushåll. Frågan som ställdes var hur många platser som hushållen är i behov av. Totalt finns det 800 hushåll i området. Av de tillfrågade hushållen angav 56 inget behov, 34 hade behov av en plats, 7 hade behov av två platser och 3 hade behov av tre platser.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett 95 % konfidensintervall för det totala antalet önskade förskoleplatser i området. Tolka intervallet! Reflektera över förutsättningarna.</li>
<li>Beräkna ett 95 % KI för andelen hushåll i området som inte önskar någon förskoleplats. Tolka intervallet! Reflektera över förutsättningarna.</li>
</ol>
<button title="q701" type="button" onclick="if(document.getElementById(&#39;q701&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q701&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q701&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q701" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1"><span class="co"># Töm minnet </span></a>
<a class="sourceLine" id="cb332-2" title="2"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb332-3" title="3"><span class="co"># Läs in data från uppgift</span></a>
<a class="sourceLine" id="cb332-4" title="4">platsbehov &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">56</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> <span class="dv">34</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dt">times =</span> <span class="dv">7</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dt">times =</span> <span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb332-5" title="5"><span class="co"># Populationsstorlek </span></a>
<a class="sourceLine" id="cb332-6" title="6"> N &lt;-<span class="st"> </span><span class="dv">800</span></a>
<a class="sourceLine" id="cb332-7" title="7"><span class="co"># Stickprovsstorlek  </span></a>
<a class="sourceLine" id="cb332-8" title="8"> n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb332-9" title="9"><span class="co"># Skattning av populationstotalen</span></a>
<a class="sourceLine" id="cb332-10" title="10"> xbar &lt;-<span class="st">  </span><span class="kw">mean</span>(platsbehov)      </a>
<a class="sourceLine" id="cb332-11" title="11"> tauhat &lt;-<span class="st"> </span>N<span class="op">*</span>xbar</a>
<a class="sourceLine" id="cb332-12" title="12"><span class="co"># Stickprovsvariansen</span></a>
<a class="sourceLine" id="cb332-13" title="13"> s2 &lt;-<span class="st"> </span><span class="kw">var</span>(platsbehov)</a>
<a class="sourceLine" id="cb332-14" title="14"><span class="co"># Skattning av totalestimatorns varians</span></a>
<a class="sourceLine" id="cb332-15" title="15"> vhattauhat &lt;-<span class="st"> </span>N<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n <span class="op">/</span><span class="st"> </span>N)<span class="op">*</span>s2<span class="op">/</span>n </a>
<a class="sourceLine" id="cb332-16" title="16"><span class="co"># Konfidensintervall</span></a>
<a class="sourceLine" id="cb332-17" title="17"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb332-18" title="18"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb332-19" title="19"> ll_tau &lt;-<span class="st"> </span>tauhat <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattauhat)</a>
<a class="sourceLine" id="cb332-20" title="20"> ul_tau &lt;-<span class="st"> </span>tauhat <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattauhat) </a>
<a class="sourceLine" id="cb332-21" title="21"> resultat_tau &lt;-<span class="st"> </span><span class="kw">c</span>(tauhat, ll_tau, ul_tau)</a>
<a class="sourceLine" id="cb332-22" title="22"> resultat_tau</a>
<a class="sourceLine" id="cb332-23" title="23">[<span class="dv">1</span>] <span class="fl">456.0000</span> <span class="fl">345.1879</span> <span class="fl">566.8121</span></a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet <span class="math inline">\(345 &lt; \tau &lt; 567\)</span> det totala antalet önskade förskoleplatser i området. Vi har OSU-UÅ, vilket gör att vi kan skatta populationstotal och estimatorns varians. Dessutom kan vi beräkna ett konfidensintervall eftersom <span class="math inline">\(n&gt;30\)</span> tillåter normalapproximation pga CGS.</li>
</ul>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" title="1"><span class="co"># b)</span></a>
<a class="sourceLine" id="cb333-2" title="2"><span class="co"># Antal händelser</span></a>
<a class="sourceLine" id="cb333-3" title="3"> x &lt;-<span class="st"> </span><span class="kw">sum</span>(platsbehov <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb333-4" title="4"><span class="co"># Beräkning av stickprovsandelen</span></a>
<a class="sourceLine" id="cb333-5" title="5"> phat&lt;-<span class="st"> </span>x<span class="op">/</span>n  </a>
<a class="sourceLine" id="cb333-6" title="6"><span class="co"># Skattning av andelsestimatorns varians </span></a>
<a class="sourceLine" id="cb333-7" title="7"> vhatphat &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>(phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">/</span>(n<span class="dv">-1</span>) ) </a>
<a class="sourceLine" id="cb333-8" title="8"><span class="co"># Konfidensintervall</span></a>
<a class="sourceLine" id="cb333-9" title="9"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb333-10" title="10"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb333-11" title="11"> ll_p &lt;-<span class="st"> </span>phat <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphat)</a>
<a class="sourceLine" id="cb333-12" title="12"> ul_p &lt;-<span class="st"> </span>phat <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatphat) </a>
<a class="sourceLine" id="cb333-13" title="13"> resultat_p &lt;-<span class="st"> </span><span class="kw">c</span>(phat, ll_p, ul_p)</a>
<a class="sourceLine" id="cb333-14" title="14"> resultat_p</a>
<a class="sourceLine" id="cb333-15" title="15">[<span class="dv">1</span>] <span class="fl">0.560000</span> <span class="fl">0.468535</span> <span class="fl">0.651465</span></a>
<a class="sourceLine" id="cb333-16" title="16"><span class="co"># Kan vi lita på intervallet? Kolla CGS</span></a>
<a class="sourceLine" id="cb333-17" title="17"> n<span class="op">*</span>phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)</a>
<a class="sourceLine" id="cb333-18" title="18">[<span class="dv">1</span>] <span class="fl">24.64</span></a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet <span class="math inline">\(0.469 &lt; p &lt; 0.651\)</span> andelen i området som inte önskar någon förskoleplats. Vi har OSU-UÅ, vilket gör att vi kan skatta populationstotal och estimatorns varians. Dessutom kan vi beräkna ett konfidensintervall eftersom <span class="math inline">\(np(1-p)\)</span> förmodligen är större än 5, vilket tillåter normalapproximation pga CGS.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.2" class="section level3 unnumbered">
<h3>Övning 7.2</h3>
<p>Vid en marknadsundersökning i en kommun med <span class="math inline">\(8000\)</span> hushåll valdes 200 hushåll med OSU-UÅ. Hushållen tillfrågades genom brevenkät om åsikterna beträffande ett antal produkter. Efter påminnelser hade kommunen fått svar från samtliga 200 hushåll. De i urvalet ingående hushållens procentuella fördelning efter åsikt beträffande en viss produkt A blev följande: Utmärkt (U) 30%, Tillfredsställande (T) 50%, Dålig (D) 20%.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Beräkna ett 95% konfidensintervall för antalet hushåll i kommunen som anser att produkten är dålig. Tolka intervallet! Reflektera över förutsättningarna!</p></li>
<li><p>Hur stort är medelfelet för andelen hushåll i kommunen som anser att produkten är utmärkt? Tolka intervallet! Reflektera över förutsättningarna!</p></li>
</ol>
<button title="q702" type="button" onclick="if(document.getElementById(&#39;q702&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q702&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q702&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q702" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1"><span class="co"># Töm minnet</span></a>
<a class="sourceLine" id="cb334-2" title="2"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb334-3" title="3"><span class="co"># Skapa data enligt uppgift. </span></a>
<a class="sourceLine" id="cb334-4" title="4"> kommunprodukt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;U&quot;</span>, <span class="dt">times =</span> <span class="dv">60</span>), <span class="kw">rep</span>(<span class="st">&quot;T&quot;</span>, <span class="dt">times =</span> <span class="dv">100</span>), <span class="kw">rep</span>(<span class="st">&quot;D&quot;</span>, <span class="dt">times =</span> <span class="dv">40</span>))</a>
<a class="sourceLine" id="cb334-5" title="5"> N &lt;-<span class="st"> </span><span class="dv">8000</span></a>
<a class="sourceLine" id="cb334-6" title="6"> n &lt;-<span class="st">  </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb334-7" title="7"><span class="co"># Skapa en binär variabel (går också att lösa uppgiften med prop.table())</span></a>
<a class="sourceLine" id="cb334-8" title="8"> kommunprodukt_bin_D &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb334-9" title="9"> kommunprodukt_bin_D[kommunprodukt <span class="op">==</span><span class="st"> &quot;U&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb334-10" title="10"> kommunprodukt_bin_D[kommunprodukt <span class="op">==</span><span class="st"> &quot;T&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb334-11" title="11"> kommunprodukt_bin_D[kommunprodukt <span class="op">==</span><span class="st"> &quot;D&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb334-12" title="12"><span class="co"># Skatta populationstotalen</span></a>
<a class="sourceLine" id="cb334-13" title="13"> x &lt;-<span class="st"> </span><span class="kw">sum</span>(kommunprodukt_bin_D)</a>
<a class="sourceLine" id="cb334-14" title="14"> phat &lt;-<span class="st"> </span>x<span class="op">/</span>n</a>
<a class="sourceLine" id="cb334-15" title="15"> tauhat &lt;-<span class="st"> </span>N<span class="op">*</span>phat</a>
<a class="sourceLine" id="cb334-16" title="16"><span class="co"># Skatta variansen för totalestimatorn</span></a>
<a class="sourceLine" id="cb334-17" title="17"> vhatphat &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>phat<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>phat)<span class="op">/</span>( n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb334-18" title="18"> vhattuahat &lt;-<span class="st">  </span>N<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatphat</a>
<a class="sourceLine" id="cb334-19" title="19"><span class="co"># Konfidensintervall</span></a>
<a class="sourceLine" id="cb334-20" title="20"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb334-21" title="21"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb334-22" title="22"> ll_tau &lt;-<span class="st"> </span>tauhat <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattuahat) </a>
<a class="sourceLine" id="cb334-23" title="23"> ul_tau &lt;-<span class="st"> </span>tauhat <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhattuahat) </a>
<a class="sourceLine" id="cb334-24" title="24"> resultat &lt;-<span class="st"> </span><span class="kw">c</span>(tauhat, ll_tau, ul_tau)</a>
<a class="sourceLine" id="cb334-25" title="25"> resultat</a>
<a class="sourceLine" id="cb334-26" title="26">[<span class="dv">1</span>] <span class="fl">1600.000</span> <span class="fl">1160.991</span> <span class="fl">2039.009</span></a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet <span class="math inline">\(1161 &lt; \tau &lt; 2039\)</span> det totala antalet hushåll i kommunen som anser att produkten är dålig. Vi har OSU-UÅ, vilket gör att vi kan skatta populationstotal och estimatorns varians. Dessutom kan vi beräkna ett konfidensintervall eftersom <span class="math inline">\(n&gt;30\)</span> tillåter normalapproximation pga CGS.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" title="1"><span class="co"># Skapa en binär variabel</span></a>
<a class="sourceLine" id="cb335-2" title="2"> kommunprodukt_bin_U &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb335-3" title="3"> kommunprodukt_bin_U[kommunprodukt <span class="op">==</span><span class="st"> &quot;U&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb335-4" title="4"> kommunprodukt_bin_U[kommunprodukt <span class="op">==</span><span class="st"> &quot;T&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb335-5" title="5"> kommunprodukt_bin_U[kommunprodukt <span class="op">==</span><span class="st"> &quot;D&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb335-6" title="6"><span class="co"># Beräkna medelfelet </span></a>
<a class="sourceLine" id="cb335-7" title="7"> x_U &lt;-<span class="st"> </span><span class="kw">sum</span>(kommunprodukt_bin_U)</a>
<a class="sourceLine" id="cb335-8" title="8"> phat_U &lt;-<span class="st"> </span>x_U<span class="op">/</span>n</a>
<a class="sourceLine" id="cb335-9" title="9"> vhatphat_U &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>phat_U<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>phat_U)<span class="op">/</span>( n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb335-10" title="10"> se_phat_U &lt;-<span class="st"> </span><span class="kw">sqrt</span>(vhatphat_U)</a></code></pre></div>
<ul>
<li>Svar: Medelfelet (standardfelet, standard error) är 0.032 vilket är den skattade standardavvikelsen i stickprovsandelens samplingfördelning. OSU-UÅ gör att vi kan skatta medelfelet.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.3" class="section level3 unnumbered">
<h3>Övning 7.3</h3>
<p>Ett oljebolag är intresserat av att för ett äldre bostadsområde med <span class="math inline">\(2\,000\)</span> hus skatta andelen hus utan oljeeldning. Sakkunskapen säger att det sanna antalet hus utan oljeeldning är mellan 300 och 800 stycken. Precisionskravet är formulerat så att ett 95% konfidensintervall för andelen hus utan oljeeldning inte får
bli längre än 0.05 procentenheter.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Beräkna urvalsstorleken vid OSU om dragningen sker med återläggning.</p></li>
<li><p>Beräkna urvalsstorleken vid OSU om dragningen sker utan återläggning.</p></li>
</ol>
<button title="q703" type="button" onclick="if(document.getElementById(&#39;q703&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q703&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q703&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q703" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Precisionskravet är <span class="math inline">\(2z_\alpha/2\sqrt{V(\hat{p})}\)</span> där $ V()=$. Vi antar att <span class="math inline">\(p=\frac{800}{2000}=0,4\)</span> eftersom detta ger störst varians givet den information vi har.
Vi utgår från att <span class="math inline">\(np(1-p)&gt;5\)</span> kommer att vara uppfyllt. Vi måste sedan kontrollera att antagandet faktiskt är uppfyllt! Annars gäller inte CGS och approximativ normalfördelning.</p>
<p>Det går att ändra värdena på <span class="math inline">\(n\)</span> i R för att se vilket n som ger vår önskade minsta stickprovsstorlek. Vi vill att uttrycket nedan ska vara lika med eller mindre än 0.05.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1"><span class="co"># Töm minnet</span></a>
<a class="sourceLine" id="cb336-2" title="2"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb336-3" title="3"><span class="co"># Hypotetisk andel </span></a>
<a class="sourceLine" id="cb336-4" title="4"> p &lt;-<span class="st"> </span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb336-5" title="5"><span class="co"># Konfidensintervall som testas för olika värden för n </span></a>
<a class="sourceLine" id="cb336-6" title="6"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb336-7" title="7"><span class="co"># Test olika värden för n </span></a>
<a class="sourceLine" id="cb336-8" title="8"> n &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">:</span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb336-9" title="9"> KIbredd &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>((p<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p))<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb336-10" title="10"> n[KIbredd <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>]</a></code></pre></div>
<pre><code>##   [1] 1476 1477 1478 1479 1480 1481 1482 1483 1484 1485 1486 1487 1488 1489 1490
##  [16] 1491 1492 1493 1494 1495 1496 1497 1498 1499 1500 1501 1502 1503 1504 1505
##  [31] 1506 1507 1508 1509 1510 1511 1512 1513 1514 1515 1516 1517 1518 1519 1520
##  [46] 1521 1522 1523 1524 1525 1526 1527 1528 1529 1530 1531 1532 1533 1534 1535
##  [61] 1536 1537 1538 1539 1540 1541 1542 1543 1544 1545 1546 1547 1548 1549 1550
##  [76] 1551 1552 1553 1554 1555 1556 1557 1558 1559 1560 1561 1562 1563 1564 1565
##  [91] 1566 1567 1568 1569 1570 1571 1572 1573 1574 1575 1576 1577 1578 1579 1580
## [106] 1581 1582 1583 1584 1585 1586 1587 1588 1589 1590 1591 1592 1593 1594 1595
## [121] 1596 1597 1598 1599 1600 1601 1602 1603 1604 1605 1606 1607 1608 1609 1610
## [136] 1611 1612 1613 1614 1615 1616 1617 1618 1619 1620 1621 1622 1623 1624 1625
## [151] 1626 1627 1628 1629 1630 1631 1632 1633 1634 1635 1636 1637 1638 1639 1640
## [166] 1641 1642 1643 1644 1645 1646 1647 1648 1649 1650 1651 1652 1653 1654 1655
## [181] 1656 1657 1658 1659 1660 1661 1662 1663 1664 1665 1666 1667 1668 1669 1670
## [196] 1671 1672 1673 1674 1675 1676 1677 1678 1679 1680 1681 1682 1683 1684 1685
## [211] 1686 1687 1688 1689 1690 1691 1692 1693 1694 1695 1696 1697 1698 1699 1700
## [226] 1701 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711 1712 1713 1714 1715
## [241] 1716 1717 1718 1719 1720 1721 1722 1723 1724 1725 1726 1727 1728 1729 1730
## [256] 1731 1732 1733 1734 1735 1736 1737 1738 1739 1740 1741 1742 1743 1744 1745
## [271] 1746 1747 1748 1749 1750 1751 1752 1753 1754 1755 1756 1757 1758 1759 1760
## [286] 1761 1762 1763 1764 1765 1766 1767 1768 1769 1770 1771 1772 1773 1774 1775
## [301] 1776 1777 1778 1779 1780 1781 1782 1783 1784 1785 1786 1787 1788 1789 1790
## [316] 1791 1792 1793 1794 1795 1796 1797 1798 1799 1800 1801 1802 1803 1804 1805
## [331] 1806 1807 1808 1809 1810 1811 1812 1813 1814 1815 1816 1817 1818 1819 1820
## [346] 1821 1822 1823 1824 1825 1826 1827 1828 1829 1830 1831 1832 1833 1834 1835
## [361] 1836 1837 1838 1839 1840 1841 1842 1843 1844 1845 1846 1847 1848 1849 1850
## [376] 1851 1852 1853 1854 1855 1856 1857 1858 1859 1860 1861 1862 1863 1864 1865
## [391] 1866 1867 1868 1869 1870 1871 1872 1873 1874 1875 1876 1877 1878 1879 1880
## [406] 1881 1882 1883 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894 1895
## [421] 1896 1897 1898 1899 1900 1901 1902 1903 1904 1905 1906 1907 1908 1909 1910
## [436] 1911 1912 1913 1914 1915 1916 1917 1918 1919 1920 1921 1922 1923 1924 1925
## [451] 1926 1927 1928 1929 1930 1931 1932 1933 1934 1935 1936 1937 1938 1939 1940
## [466] 1941 1942 1943 1944 1945 1946 1947 1948 1949 1950 1951 1952 1953 1954 1955
## [481] 1956 1957 1958 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970
## [496] 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985
## [511] 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000</code></pre>
<p>Vi kan även lösa uppgiften algebraiskt genom att sätta in värden</p>
<p><span class="math display">\[
    0.05\geq 2\cdot 1.96\sqrt{\frac{0.4(1-0.4)}{n}}.
\]</span>
Kvadrera båda leden för att bli av med kvadratroten</p>
<p><span class="math display">\[0.05^2\geq 2^2\cdot 1.96^2 \cdot \frac{0.4(1-0.4)}{n}.\]</span><br />
Löser vi sedan ut <span class="math inline">\(n\)</span> landar vi på uttrycket
<span class="math display">\[n\geq \frac{4\cdot 1.96^2\cdot 0.24}{0.0025}=1475.174.\]</span></p>
<p>Svar: För att uppnå precisionskravet behövs ett stickprov med minst 1476 hus. Glöm inte att kontrollera CGS: <span class="math inline">\(np(1-p)=1476\cdot 0.4(1-0,4)=354.24 &gt; 5\)</span> så antagandet är uppfyllt.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Som a) men OSU-UÅ, dvs <span class="math inline">\(V(\hat{p})\)</span> vid OSU-UÅ ges av <span class="math inline">\(\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}\)</span> och vi har <span class="math inline">\(N=2000\)</span>.
Vi vill att uttrycket nedan ska vara lika med eller mindre än 0.05.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" title="1"> N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb338-2" title="2"> KIbredd_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(((N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>(p<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p))<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb338-3" title="3"> n[KIbredd_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>]</a></code></pre></div>
<pre><code>##    [1]  850  851  852  853  854  855  856  857  858  859  860  861  862  863
##   [15]  864  865  866  867  868  869  870  871  872  873  874  875  876  877
##   [29]  878  879  880  881  882  883  884  885  886  887  888  889  890  891
##   [43]  892  893  894  895  896  897  898  899  900  901  902  903  904  905
##   [57]  906  907  908  909  910  911  912  913  914  915  916  917  918  919
##   [71]  920  921  922  923  924  925  926  927  928  929  930  931  932  933
##   [85]  934  935  936  937  938  939  940  941  942  943  944  945  946  947
##   [99]  948  949  950  951  952  953  954  955  956  957  958  959  960  961
##  [113]  962  963  964  965  966  967  968  969  970  971  972  973  974  975
##  [127]  976  977  978  979  980  981  982  983  984  985  986  987  988  989
##  [141]  990  991  992  993  994  995  996  997  998  999 1000 1001 1002 1003
##  [155] 1004 1005 1006 1007 1008 1009 1010 1011 1012 1013 1014 1015 1016 1017
##  [169] 1018 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031
##  [183] 1032 1033 1034 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045
##  [197] 1046 1047 1048 1049 1050 1051 1052 1053 1054 1055 1056 1057 1058 1059
##  [211] 1060 1061 1062 1063 1064 1065 1066 1067 1068 1069 1070 1071 1072 1073
##  [225] 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 1084 1085 1086 1087
##  [239] 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 1100 1101
##  [253] 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115
##  [267] 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129
##  [281] 1130 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143
##  [295] 1144 1145 1146 1147 1148 1149 1150 1151 1152 1153 1154 1155 1156 1157
##  [309] 1158 1159 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169 1170 1171
##  [323] 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 1182 1183 1184 1185
##  [337] 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 1198 1199
##  [351] 1200 1201 1202 1203 1204 1205 1206 1207 1208 1209 1210 1211 1212 1213
##  [365] 1214 1215 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227
##  [379] 1228 1229 1230 1231 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241
##  [393] 1242 1243 1244 1245 1246 1247 1248 1249 1250 1251 1252 1253 1254 1255
##  [407] 1256 1257 1258 1259 1260 1261 1262 1263 1264 1265 1266 1267 1268 1269
##  [421] 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 1280 1281 1282 1283
##  [435] 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 1296 1297
##  [449] 1298 1299 1300 1301 1302 1303 1304 1305 1306 1307 1308 1309 1310 1311
##  [463] 1312 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325
##  [477] 1326 1327 1328 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339
##  [491] 1340 1341 1342 1343 1344 1345 1346 1347 1348 1349 1350 1351 1352 1353
##  [505] 1354 1355 1356 1357 1358 1359 1360 1361 1362 1363 1364 1365 1366 1367
##  [519] 1368 1369 1370 1371 1372 1373 1374 1375 1376 1377 1378 1379 1380 1381
##  [533] 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 1393 1394 1395
##  [547] 1396 1397 1398 1399 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409
##  [561] 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423
##  [575] 1424 1425 1426 1427 1428 1429 1430 1431 1432 1433 1434 1435 1436 1437
##  [589] 1438 1439 1440 1441 1442 1443 1444 1445 1446 1447 1448 1449 1450 1451
##  [603] 1452 1453 1454 1455 1456 1457 1458 1459 1460 1461 1462 1463 1464 1465
##  [617] 1466 1467 1468 1469 1470 1471 1472 1473 1474 1475 1476 1477 1478 1479
##  [631] 1480 1481 1482 1483 1484 1485 1486 1487 1488 1489 1490 1491 1492 1493
##  [645] 1494 1495 1496 1497 1498 1499 1500 1501 1502 1503 1504 1505 1506 1507
##  [659] 1508 1509 1510 1511 1512 1513 1514 1515 1516 1517 1518 1519 1520 1521
##  [673] 1522 1523 1524 1525 1526 1527 1528 1529 1530 1531 1532 1533 1534 1535
##  [687] 1536 1537 1538 1539 1540 1541 1542 1543 1544 1545 1546 1547 1548 1549
##  [701] 1550 1551 1552 1553 1554 1555 1556 1557 1558 1559 1560 1561 1562 1563
##  [715] 1564 1565 1566 1567 1568 1569 1570 1571 1572 1573 1574 1575 1576 1577
##  [729] 1578 1579 1580 1581 1582 1583 1584 1585 1586 1587 1588 1589 1590 1591
##  [743] 1592 1593 1594 1595 1596 1597 1598 1599 1600 1601 1602 1603 1604 1605
##  [757] 1606 1607 1608 1609 1610 1611 1612 1613 1614 1615 1616 1617 1618 1619
##  [771] 1620 1621 1622 1623 1624 1625 1626 1627 1628 1629 1630 1631 1632 1633
##  [785] 1634 1635 1636 1637 1638 1639 1640 1641 1642 1643 1644 1645 1646 1647
##  [799] 1648 1649 1650 1651 1652 1653 1654 1655 1656 1657 1658 1659 1660 1661
##  [813] 1662 1663 1664 1665 1666 1667 1668 1669 1670 1671 1672 1673 1674 1675
##  [827] 1676 1677 1678 1679 1680 1681 1682 1683 1684 1685 1686 1687 1688 1689
##  [841] 1690 1691 1692 1693 1694 1695 1696 1697 1698 1699 1700 1701 1702 1703
##  [855] 1704 1705 1706 1707 1708 1709 1710 1711 1712 1713 1714 1715 1716 1717
##  [869] 1718 1719 1720 1721 1722 1723 1724 1725 1726 1727 1728 1729 1730 1731
##  [883] 1732 1733 1734 1735 1736 1737 1738 1739 1740 1741 1742 1743 1744 1745
##  [897] 1746 1747 1748 1749 1750 1751 1752 1753 1754 1755 1756 1757 1758 1759
##  [911] 1760 1761 1762 1763 1764 1765 1766 1767 1768 1769 1770 1771 1772 1773
##  [925] 1774 1775 1776 1777 1778 1779 1780 1781 1782 1783 1784 1785 1786 1787
##  [939] 1788 1789 1790 1791 1792 1793 1794 1795 1796 1797 1798 1799 1800 1801
##  [953] 1802 1803 1804 1805 1806 1807 1808 1809 1810 1811 1812 1813 1814 1815
##  [967] 1816 1817 1818 1819 1820 1821 1822 1823 1824 1825 1826 1827 1828 1829
##  [981] 1830 1831 1832 1833 1834 1835 1836 1837 1838 1839 1840 1841 1842 1843
##  [995] 1844 1845 1846 1847 1848 1849 1850 1851 1852 1853 1854 1855 1856 1857
## [1009] 1858 1859 1860 1861 1862 1863 1864 1865 1866 1867 1868 1869 1870 1871
## [1023] 1872 1873 1874 1875 1876 1877 1878 1879 1880 1881 1882 1883 1884 1885
## [1037] 1886 1887 1888 1889 1890 1891 1892 1893 1894 1895 1896 1897 1898 1899
## [1051] 1900 1901 1902 1903 1904 1905 1906 1907 1908 1909 1910 1911 1912 1913
## [1065] 1914 1915 1916 1917 1918 1919 1920 1921 1922 1923 1924 1925 1926 1927
## [1079] 1928 1929 1930 1931 1932 1933 1934 1935 1936 1937 1938 1939 1940 1941
## [1093] 1942 1943 1944 1945 1946 1947 1948 1949 1950 1951 1952 1953 1954 1955
## [1107] 1956 1957 1958 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969
## [1121] 1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983
## [1135] 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997
## [1149] 1998 1999 2000</code></pre>
<p>Algebraisk lösning är att vi sätter in värden och löser ut <span class="math inline">\(n\)</span>.</p>
<p><span class="math display">\[\begin{equation}\label{eq:intbredd2}
0.05\geq 2\cdot 1.96\sqrt{\left(\frac{2000-n}{1999}\right)\frac{0.24}{n}}
\end{equation}\]</span></p>
<p><span class="math display">\[\left(\frac{0.05}{2\cdot 1.96}\right)^2 \geq \left(\frac{2000-n}{1999}\right)\frac{0.24}{n}\]</span></p>
<p><span class="math display">\[\left(\frac{0.05}{2\cdot 1.96}\right)^2 1999 \geq \left(\frac{2000}{n}-1\right)0.24\]</span></p>
<p><span class="math display">\[\left(\frac{0.05}{2\cdot 1.96}\right)^2 1999+0.24 \geq \frac{2000}{n}0.24.\]</span></p>
<p>Vi landar slutligen på uttrycket
<span class="math display">\[n \geq \frac{2000\cdot 0.24}{\left(\frac{0.05}{2\cdot 1.96}\right)^2 1999+0.24}\]</span>
vilket ger
<span class="math display">\[n \geq 849.22.\]</span></p>
<ul>
<li>Svar: Vi behöver ett urval bestående av minst 850 hushåll för att nå precisionskravet. Kontroll för CGS: <span class="math inline">\(np(1-)=204 &gt; 5\)</span>. OK!</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.4" class="section level3 unnumbered">
<h3>Övning 7.4</h3>
<p>Utgå från en population med <span class="math inline">\(N=5\)</span> element med värdena <span class="math inline">\(x_1=4, x_2=8, x_3=2, x_4=6, x_5=9\)</span>. Anta sedan att man inte kan undersöka hela populationen utan måste dra ett OSU-UÅ med stickprovsstorleken <span class="math inline">\(n=3\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna medelvärde i populationen <span class="math inline">\(\mu_x\)</span>, populationsmedianen <span class="math inline">\(md\)</span>, och populationsvariansen <span class="math inline">\(\sigma^2_x\)</span>.</li>
<li>Totalt finns det <span class="math inline">\(K\)</span> möjliga stickprov. Beräkna <span class="math inline">\(K\)</span>.</li>
<li>Beräkna medelvärdet, <span class="math inline">\(\bar{x}\)</span>, och medianen, <span class="math inline">\(\widehat{md}\)</span> i varje stickprov. Hint: Använd funktionen <strong>apply()</strong>.</li>
<li>Rita två stolpdiagram. Ett som beskriver fördelningen av medelvärdet, ett som beskriver fördelningen av medianen. Vad kallas dessa fördelningar?</li>
<li>Beräkna <span class="math inline">\(E(\bar{x})\)</span> och <span class="math inline">\(E(\widehat{md})\)</span>.</li>
<li>Beräkna <span class="math inline">\((1/K)(\sum_{k=1}^K(\bar{x}_k-E(\bar{x}))^2)\)</span> och <span class="math inline">\((1/K)\sum_{k=1}^K(\widehat{md}_k-E(\widehat{md}))^2\)</span>. Beräkna även <span class="math inline">\(V(\bar{x})=\left(\dfrac{N-n}{N-1}\right)\dfrac{\sigma^2_x}{n}\)</span> och jämför med de två tidigare värdena.</li>
<li>Beskriv med ord skillnaden mellan <span class="math inline">\(\sigma^2_x\)</span>, <span class="math inline">\(s^2_x\)</span>, <span class="math inline">\(V(\bar{x})\)</span>, <span class="math inline">\(\hat{V}(\bar{x})\)</span>, <span class="math inline">\(SE(\bar{x})\)</span>, <span class="math inline">\(V(\widehat{md})\)</span>, <span class="math inline">\(\hat{V}(\widehat{md})\)</span> samt <span class="math inline">\(SE(\widehat{md})\)</span>.
(Notera att <span class="math inline">\(\sigma^2_x\)</span> och <span class="math inline">\(s^2_x\)</span> ofta skrivs utan index, samt att <span class="math inline">\(V(\bar{x})\)</span> och <span class="math inline">\(\hat{V}(\bar{x})\)</span> alternativt kan skrivas <span class="math inline">\(\sigma^2_{\bar{x}}\)</span> och <span class="math inline">\(\hat{\sigma}^2_{\bar{x}}\)</span>.)</li>
<li>Om <span class="math inline">\(n\)</span> är stort och vi kan använda tumregeln <span class="math inline">\(n &gt; 30\)</span>, vilken varians och approximativ fördelning har <span class="math inline">\(\bar{x}\)</span>?</li>
<li>Vad kallas fördelningen för <span class="math inline">\(\bar{x}\)</span>? Förklara med ord hur denna fördelning uppkommer.</li>
<li>Om <span class="math inline">\(n\)</span> är stort och vi kan använda tumregeln <span class="math inline">\(n &gt; 30\)</span>, vilken varians och approximativ fördelning har <span class="math inline">\(\hat{\tau}=N\bar{x}\)</span>?</li>
</ol>
<button title="q704" type="button" onclick="if(document.getElementById(&#39;q704&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q704&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q704&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q704" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Vi beräknar populationsstorheterna på följande vis:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1"><span class="co"># Töm minnet </span></a>
<a class="sourceLine" id="cb340-2" title="2"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </a>
<a class="sourceLine" id="cb340-3" title="3"> x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">4</span>)  <span class="co"># vår population</span></a>
<a class="sourceLine" id="cb340-4" title="4"><span class="co"># Populationsstorlek</span></a>
<a class="sourceLine" id="cb340-5" title="5"> N &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb340-6" title="6"><span class="co"># Populationsmedelvärde</span></a>
<a class="sourceLine" id="cb340-7" title="7"> mu &lt;-<span class="st"> </span><span class="kw">mean</span>(x)                  </a>
<a class="sourceLine" id="cb340-8" title="8"> mu</a></code></pre></div>
<pre><code>## [1] 11.625</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1"><span class="co"># Populationsmedian</span></a>
<a class="sourceLine" id="cb342-2" title="2"> md &lt;-<span class="st"> </span><span class="kw">median</span>(x)      </a>
<a class="sourceLine" id="cb342-3" title="3"> md</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1"><span class="co"># Populationsvarians variant 1</span></a>
<a class="sourceLine" id="cb344-2" title="2"> sigma2 &lt;-<span class="st"> </span><span class="kw">mean</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)<span class="op">^</span><span class="dv">2</span>  <span class="co"># Baseras på E(x^2) - E(x^2) </span></a>
<a class="sourceLine" id="cb344-3" title="3"> sigma2</a></code></pre></div>
<pre><code>## [1] 216.9844</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1"><span class="co"># Populationsvarians variant 2</span></a>
<a class="sourceLine" id="cb346-2" title="2"> sigma2 &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>N)<span class="op">*</span><span class="kw">sum</span>( (x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span> )   <span class="co"># Baseras på E[(x - E(x))^2] som är kan skrivas om variant 1 </span></a></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Med <strong>choose()</strong> beräknas <span class="math inline">\(K={n \choose k}\)</span>.</li>
</ol>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb347-1" title="1"><span class="co"># Stickprovsstorlek </span></a>
<a class="sourceLine" id="cb347-2" title="2"> n &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb347-3" title="3"><span class="co"># Beräkna (5 över 3)</span></a>
<a class="sourceLine" id="cb347-4" title="4"> K &lt;-<span class="st"> </span><span class="kw">choose</span>(<span class="dt">n =</span> N, <span class="dt">k =</span> n)</a>
<a class="sourceLine" id="cb347-5" title="5"> K</a></code></pre></div>
<pre><code>## [1] 56</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Funkionen <strong>comb()</strong> ger alla möjliga kombinationer från de 5 x-värdena när vi väljer ut 3 av dem per gång.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" title="1"><span class="co"># Skapa alla möjligt stickprov aav storlek 3 från x och beräkna medelvärde och median i varje urval</span></a>
<a class="sourceLine" id="cb349-2" title="2"> urval &lt;-<span class="st"> </span><span class="kw">combn</span>(x, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb349-3" title="3"> xbars &lt;-<span class="st"> </span><span class="kw">apply</span>(urval, <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb349-4" title="4"> xbars</a></code></pre></div>
<pre><code>##  [1]  4.666667  6.000000  7.000000  7.333333 20.666667  5.333333  4.000000
##  [8]  5.000000  5.333333 18.666667  3.333333  6.333333  6.666667 20.000000
## [15]  4.666667  7.666667 21.000000  5.666667 21.333333  6.000000 19.333333
## [22]  5.333333  6.333333  6.666667 20.000000  4.666667  7.666667  8.000000
## [29] 21.333333  6.000000  9.000000 22.333333  7.000000 22.666667  7.333333
## [36] 20.666667  5.666667  6.000000 19.333333  4.000000  7.000000 20.333333
## [43]  5.000000 20.666667  5.333333 18.666667  8.333333 21.666667  6.333333
## [50] 22.000000  6.666667 20.000000 23.000000  7.666667 21.000000 21.333333</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" title="1"> medians &lt;-<span class="st"> </span><span class="kw">apply</span>(urval, <span class="dv">2</span>, median)</a>
<a class="sourceLine" id="cb351-2" title="2"> medians</a></code></pre></div>
<pre><code>##  [1]  4  6  8  8  8  4  4  4  4  4  4  6  6  6  4  9  9  4 10  4  4  6  8  8  8
## [26]  4  8  8  8  6  9  9  8 10  8  8  6  6  6  4  9  9  4 10  4  4  9  9  6 10
## [51]  6  6 10  9  9 10</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" title="1"><span class="co"># Stolpdiagram för medelvärdena</span></a>
<a class="sourceLine" id="cb353-2" title="2"> probs_xbars &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(xbars))</a>
<a class="sourceLine" id="cb353-3" title="3"> <span class="kw">plot</span>(probs_xbars)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-295-1.png" width="672" /></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" title="1"><span class="co"># Stolpdiagram för medianerna </span></a>
<a class="sourceLine" id="cb354-2" title="2"> probs_medians &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(medians))</a>
<a class="sourceLine" id="cb354-3" title="3"> <span class="kw">plot</span>(probs_medians)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-295-2.png" width="672" /></p>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" title="1"><span class="co"># Jämför mu och E(xbar)</span></a>
<a class="sourceLine" id="cb355-2" title="2"> mu</a></code></pre></div>
<pre><code>## [1] 11.625</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" title="1"> <span class="kw">mean</span>(xbars)</a></code></pre></div>
<pre><code>## [1] 11.625</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb359-1" title="1"><span class="co"># Jämför md och E(medians) </span></a>
<a class="sourceLine" id="cb359-2" title="2"> md</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb361-1" title="1"> <span class="kw">mean</span>(medians)</a></code></pre></div>
<pre><code>## [1] 6.821429</code></pre>
<p>Vi ser att medelvärdet är väntevärdesriktig skattning av medelvärdet.
Vi ser också att medianen är inte en väntevärdesriktig skattning av medianen i populationen. Konsekvensen av detta är dock inget som ni behöver bry er om i praktiken just nu, utan detta är en illustration över att det inte är uppenbart att en estimator alltid är väntevärdesriktig.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Insättning av värden ger i de tre formlerna ger:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb363-1" title="1"><span class="co"># Beräkning enligt formel.</span></a>
<a class="sourceLine" id="cb363-2" title="2"> (<span class="dv">1</span><span class="op">/</span>K)<span class="op">*</span><span class="kw">sum</span>((xbars <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(xbars))<span class="op">^</span><span class="dv">2</span> )  </a></code></pre></div>
<pre><code>## [1] 51.66295</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb365-1" title="1"> (<span class="dv">1</span><span class="op">/</span>K)<span class="op">*</span><span class="kw">sum</span>((medians <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(medians))<span class="op">^</span><span class="dv">2</span> )  </a></code></pre></div>
<pre><code>## [1] 4.646684</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" title="1"> ((N<span class="op">-</span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>sigma2<span class="op">/</span>n</a></code></pre></div>
<pre><code>## [1] 51.66295</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li></li>
</ol>
<ul>
<li><p><span class="math inline">\(\sigma_x^2\)</span> är variansen för <span class="math inline">\(x\)</span> i populationen som vi är intresserade av.</p></li>
<li><p><span class="math inline">\(s_x^2\)</span> är variansen för <span class="math inline">\(x\)</span> i stickprovet.</p></li>
<li><p><span class="math inline">\(V(\bar{x})\)</span> är variansen för stickprovsmedelvärdets fördelning som beräknas med populationsvariansen.</p></li>
<li><p><span class="math inline">\(\hat{V}(\bar{x})\)</span> är den skattade variansen för stickprovsmedelvädets fördelning som beräknas med stickprovsvariansen.</p></li>
<li><p><span class="math inline">\(SE(\bar{x})\)</span> är standardavvikelsen för stickprovsmedelvärdets fördelning.</p></li>
<li><p><span class="math inline">\(V(\widehat{md})\)</span> är variansen för stickprovsmedianens fördelning.</p></li>
<li><p><span class="math inline">\(\hat{V}(\widehat{md})\)</span> är den skattade variansen för stickprovsmedianens fördelning.</p></li>
<li><p><span class="math inline">\(SE(\widehat{md})\)</span> är standardavvikelsen för stickprovsmedianens fördelning.</p></li>
</ul>
<ol start="8" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Om <span class="math inline">\(n\)</span> är stort följer <span class="math inline">\(\bar{x}\)</span> approximativt fördelningen <span class="math inline">\(N(\mu; V(\bar{x}))\)</span>.</p>
<ol style="list-style-type: lower-roman">
<li>Samplingfördelningen för stickprovsmedelvärdet. Det är fördelningen för medelvärdena för alla olika stickprov vi kan dra från populationen.</li>
</ol>
<ol start="10" style="list-style-type: lower-alpha">
<li>Om <span class="math inline">\(n\)</span> är stort följer <span class="math inline">\(\hat{\tau}\)</span> approximativt fördelningen <span class="math inline">\(N(\mu; V(\hat{\tau}))\)</span>.</li>
</ol>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.5" class="section level3 unnumbered">
<h3>Övning 7.5</h3>
<p>Styrelsen i en mindre fackförening på 2000 medlemmar överväger att erbjuda medlemmarna en gruppförsäkring av typ ‘’liv och olycksfall’’. För att utröna slagkraften i ett inkommet erbjudande avser man att uppskatta genomsnittsvärdet av den årliga utgift medlemmarna för närvarande betalar för dylika försäkringar, genom ett urval. Precisionskravet formuleras så att längden av ett 95% konfidensintervall för medelutgiften
bland de 2000 medlemmarna inte får överstiga 50 kronor. Försäkringsbolaget hävdar att standardavvikelsen i populationen med största säkerhet inte överstiger 250 kronor.</p>
<ol style="list-style-type: lower-alpha">
<li>Bestäm tillräcklig stickprovsstorlek under förutsättningarna att den av bolaget angivna standardavvikelsen överensstämmer med populationens och att urvalet är ett OSU-UÅ.</li>
<li>Hur stort stickprov ska dras om precisionskravet istället är att felmarginalen får vara max 50 kronor?</li>
<li>Hur stort stickprov ska dras om precisionskravet istället är att medelfelet får vara max 50 kronor?</li>
</ol>
<button title="q705" type="button" onclick="if(document.getElementById(&#39;q705&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q705&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q705&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q705" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li>Vi vill bestämma nödvändig stickprovsstorlek <span class="math inline">\(n\)</span> om längden för ett 95% konfidensintervall för medelutgiften inte får överstiga 50 kronor. Vi utgår från att vi vet populationsstandardavvikelsen (250) samt att <span class="math inline">\(V(\bar{x})=\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}\)</span>.</li>
</ol>
<p>Längden för ett 95% konfidensintervall kan skrivas som</p>
<p><span class="math display">\[2\cdot z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Precisionskravet är <span class="math inline">\(50\geq 2\cdot z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}\)</span>.</p>
<p>Vi sätter in värden och löser ut <span class="math inline">\(n\)</span>.
<span class="math display">\[\begin{equation}\label{eq:intbredd3}
        50\geq 2\cdot 1,96\sqrt{\left(\frac{2000-n}{2000-1}\right)\frac{250^2}{n}}
\end{equation}\]</span></p>
<p><span class="math display">\[\left(\frac{50}{2\cdot 1.96}\right)^2\geq \left(\frac{2000-n}{1999}\right)\frac{250^2}{n}\]</span></p>
<p><span class="math display">\[\left(\frac{50}{2\cdot 1.96}\right)^2 1999 \geq \left(\frac{2000}{n}-1\right)250^2\]</span></p>
<p><span class="math display">\[\left(\frac{50}{2\cdot 1.96}\right)^2 1999+250^2 \geq \frac{2000}{n}250^2\]</span></p>
<p><span class="math display">\[n\geq \frac{2000\cdot 250^2}{\left(\frac{50}{2\cdot 1.96}\right)^2 1999+250^2}=322.40.\]</span></p>
<p>Man kan även testa sig fram i R:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" title="1"><span class="co"># Längden för att konfidensintevall får inte ska överskrida 50 kronor.</span></a>
<a class="sourceLine" id="cb369-2" title="2"> N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb369-3" title="3"> sigma2 &lt;-<span class="st"> </span><span class="dv">250</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb369-4" title="4"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb369-5" title="5"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb369-6" title="6"> n &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">:</span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb369-7" title="7"> KI_langd &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>( ((N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>(sigma2<span class="op">/</span>n))</a>
<a class="sourceLine" id="cb369-8" title="8"> n[KI_langd <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>]</a></code></pre></div>
<pre><code>##    [1]  323  324  325  326  327  328  329  330  331  332  333  334  335  336
##   [15]  337  338  339  340  341  342  343  344  345  346  347  348  349  350
##   [29]  351  352  353  354  355  356  357  358  359  360  361  362  363  364
##   [43]  365  366  367  368  369  370  371  372  373  374  375  376  377  378
##   [57]  379  380  381  382  383  384  385  386  387  388  389  390  391  392
##   [71]  393  394  395  396  397  398  399  400  401  402  403  404  405  406
##   [85]  407  408  409  410  411  412  413  414  415  416  417  418  419  420
##   [99]  421  422  423  424  425  426  427  428  429  430  431  432  433  434
##  [113]  435  436  437  438  439  440  441  442  443  444  445  446  447  448
##  [127]  449  450  451  452  453  454  455  456  457  458  459  460  461  462
##  [141]  463  464  465  466  467  468  469  470  471  472  473  474  475  476
##  [155]  477  478  479  480  481  482  483  484  485  486  487  488  489  490
##  [169]  491  492  493  494  495  496  497  498  499  500  501  502  503  504
##  [183]  505  506  507  508  509  510  511  512  513  514  515  516  517  518
##  [197]  519  520  521  522  523  524  525  526  527  528  529  530  531  532
##  [211]  533  534  535  536  537  538  539  540  541  542  543  544  545  546
##  [225]  547  548  549  550  551  552  553  554  555  556  557  558  559  560
##  [239]  561  562  563  564  565  566  567  568  569  570  571  572  573  574
##  [253]  575  576  577  578  579  580  581  582  583  584  585  586  587  588
##  [267]  589  590  591  592  593  594  595  596  597  598  599  600  601  602
##  [281]  603  604  605  606  607  608  609  610  611  612  613  614  615  616
##  [295]  617  618  619  620  621  622  623  624  625  626  627  628  629  630
##  [309]  631  632  633  634  635  636  637  638  639  640  641  642  643  644
##  [323]  645  646  647  648  649  650  651  652  653  654  655  656  657  658
##  [337]  659  660  661  662  663  664  665  666  667  668  669  670  671  672
##  [351]  673  674  675  676  677  678  679  680  681  682  683  684  685  686
##  [365]  687  688  689  690  691  692  693  694  695  696  697  698  699  700
##  [379]  701  702  703  704  705  706  707  708  709  710  711  712  713  714
##  [393]  715  716  717  718  719  720  721  722  723  724  725  726  727  728
##  [407]  729  730  731  732  733  734  735  736  737  738  739  740  741  742
##  [421]  743  744  745  746  747  748  749  750  751  752  753  754  755  756
##  [435]  757  758  759  760  761  762  763  764  765  766  767  768  769  770
##  [449]  771  772  773  774  775  776  777  778  779  780  781  782  783  784
##  [463]  785  786  787  788  789  790  791  792  793  794  795  796  797  798
##  [477]  799  800  801  802  803  804  805  806  807  808  809  810  811  812
##  [491]  813  814  815  816  817  818  819  820  821  822  823  824  825  826
##  [505]  827  828  829  830  831  832  833  834  835  836  837  838  839  840
##  [519]  841  842  843  844  845  846  847  848  849  850  851  852  853  854
##  [533]  855  856  857  858  859  860  861  862  863  864  865  866  867  868
##  [547]  869  870  871  872  873  874  875  876  877  878  879  880  881  882
##  [561]  883  884  885  886  887  888  889  890  891  892  893  894  895  896
##  [575]  897  898  899  900  901  902  903  904  905  906  907  908  909  910
##  [589]  911  912  913  914  915  916  917  918  919  920  921  922  923  924
##  [603]  925  926  927  928  929  930  931  932  933  934  935  936  937  938
##  [617]  939  940  941  942  943  944  945  946  947  948  949  950  951  952
##  [631]  953  954  955  956  957  958  959  960  961  962  963  964  965  966
##  [645]  967  968  969  970  971  972  973  974  975  976  977  978  979  980
##  [659]  981  982  983  984  985  986  987  988  989  990  991  992  993  994
##  [673]  995  996  997  998  999 1000 1001 1002 1003 1004 1005 1006 1007 1008
##  [687] 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018 1019 1020 1021 1022
##  [701] 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 1035 1036
##  [715] 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050
##  [729] 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1063 1064
##  [743] 1065 1066 1067 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078
##  [757] 1079 1080 1081 1082 1083 1084 1085 1086 1087 1088 1089 1090 1091 1092
##  [771] 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102 1103 1104 1105 1106
##  [785] 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116 1117 1118 1119 1120
##  [799] 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 1132 1133 1134
##  [813] 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 1148
##  [827] 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159 1160 1161 1162
##  [841] 1163 1164 1165 1166 1167 1168 1169 1170 1171 1172 1173 1174 1175 1176
##  [855] 1177 1178 1179 1180 1181 1182 1183 1184 1185 1186 1187 1188 1189 1190
##  [869] 1191 1192 1193 1194 1195 1196 1197 1198 1199 1200 1201 1202 1203 1204
##  [883] 1205 1206 1207 1208 1209 1210 1211 1212 1213 1214 1215 1216 1217 1218
##  [897] 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229 1230 1231 1232
##  [911] 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243 1244 1245 1246
##  [925] 1247 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257 1258 1259 1260
##  [939] 1261 1262 1263 1264 1265 1266 1267 1268 1269 1270 1271 1272 1273 1274
##  [953] 1275 1276 1277 1278 1279 1280 1281 1282 1283 1284 1285 1286 1287 1288
##  [967] 1289 1290 1291 1292 1293 1294 1295 1296 1297 1298 1299 1300 1301 1302
##  [981] 1303 1304 1305 1306 1307 1308 1309 1310 1311 1312 1313 1314 1315 1316
##  [995] 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327 1328 1329 1330
## [1009] 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341 1342 1343 1344
## [1023] 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355 1356 1357 1358
## [1037] 1359 1360 1361 1362 1363 1364 1365 1366 1367 1368 1369 1370 1371 1372
## [1051] 1373 1374 1375 1376 1377 1378 1379 1380 1381 1382 1383 1384 1385 1386
## [1065] 1387 1388 1389 1390 1391 1392 1393 1394 1395 1396 1397 1398 1399 1400
## [1079] 1401 1402 1403 1404 1405 1406 1407 1408 1409 1410 1411 1412 1413 1414
## [1093] 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425 1426 1427 1428
## [1107] 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439 1440 1441 1442
## [1121] 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453 1454 1455 1456
## [1135] 1457 1458 1459 1460 1461 1462 1463 1464 1465 1466 1467 1468 1469 1470
## [1149] 1471 1472 1473 1474 1475 1476 1477 1478 1479 1480 1481 1482 1483 1484
## [1163] 1485 1486 1487 1488 1489 1490 1491 1492 1493 1494 1495 1496 1497 1498
## [1177] 1499 1500 1501 1502 1503 1504 1505 1506 1507 1508 1509 1510 1511 1512
## [1191] 1513 1514 1515 1516 1517 1518 1519 1520 1521 1522 1523 1524 1525 1526
## [1205] 1527 1528 1529 1530 1531 1532 1533 1534 1535 1536 1537 1538 1539 1540
## [1219] 1541 1542 1543 1544 1545 1546 1547 1548 1549 1550 1551 1552 1553 1554
## [1233] 1555 1556 1557 1558 1559 1560 1561 1562 1563 1564 1565 1566 1567 1568
## [1247] 1569 1570 1571 1572 1573 1574 1575 1576 1577 1578 1579 1580 1581 1582
## [1261] 1583 1584 1585 1586 1587 1588 1589 1590 1591 1592 1593 1594 1595 1596
## [1275] 1597 1598 1599 1600 1601 1602 1603 1604 1605 1606 1607 1608 1609 1610
## [1289] 1611 1612 1613 1614 1615 1616 1617 1618 1619 1620 1621 1622 1623 1624
## [1303] 1625 1626 1627 1628 1629 1630 1631 1632 1633 1634 1635 1636 1637 1638
## [1317] 1639 1640 1641 1642 1643 1644 1645 1646 1647 1648 1649 1650 1651 1652
## [1331] 1653 1654 1655 1656 1657 1658 1659 1660 1661 1662 1663 1664 1665 1666
## [1345] 1667 1668 1669 1670 1671 1672 1673 1674 1675 1676 1677 1678 1679 1680
## [1359] 1681 1682 1683 1684 1685 1686 1687 1688 1689 1690 1691 1692 1693 1694
## [1373] 1695 1696 1697 1698 1699 1700 1701 1702 1703 1704 1705 1706 1707 1708
## [1387] 1709 1710 1711 1712 1713 1714 1715 1716 1717 1718 1719 1720 1721 1722
## [1401] 1723 1724 1725 1726 1727 1728 1729 1730 1731 1732 1733 1734 1735 1736
## [1415] 1737 1738 1739 1740 1741 1742 1743 1744 1745 1746 1747 1748 1749 1750
## [1429] 1751 1752 1753 1754 1755 1756 1757 1758 1759 1760 1761 1762 1763 1764
## [1443] 1765 1766 1767 1768 1769 1770 1771 1772 1773 1774 1775 1776 1777 1778
## [1457] 1779 1780 1781 1782 1783 1784 1785 1786 1787 1788 1789 1790 1791 1792
## [1471] 1793 1794 1795 1796 1797 1798 1799 1800 1801 1802 1803 1804 1805 1806
## [1485] 1807 1808 1809 1810 1811 1812 1813 1814 1815 1816 1817 1818 1819 1820
## [1499] 1821 1822 1823 1824 1825 1826 1827 1828 1829 1830 1831 1832 1833 1834
## [1513] 1835 1836 1837 1838 1839 1840 1841 1842 1843 1844 1845 1846 1847 1848
## [1527] 1849 1850 1851 1852 1853 1854 1855 1856 1857 1858 1859 1860 1861 1862
## [1541] 1863 1864 1865 1866 1867 1868 1869 1870 1871 1872 1873 1874 1875 1876
## [1555] 1877 1878 1879 1880 1881 1882 1883 1884 1885 1886 1887 1888 1889 1890
## [1569] 1891 1892 1893 1894 1895 1896 1897 1898 1899 1900 1901 1902 1903 1904
## [1583] 1905 1906 1907 1908 1909 1910 1911 1912 1913 1914 1915 1916 1917 1918
## [1597] 1919 1920 1921 1922 1923 1924 1925 1926 1927 1928 1929 1930 1931 1932
## [1611] 1933 1934 1935 1936 1937 1938 1939 1940 1941 1942 1943 1944 1945 1946
## [1625] 1947 1948 1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
## [1639] 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974
## [1653] 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988
## [1667] 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000</code></pre>
<ul>
<li>Svar: Vi behöver ett urval bestående av minst 323 medlemmar för att nå precisionskravet. Kontroll för CGS: <span class="math inline">\(323 &gt; 30\)</span>. OK!</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Felmarginalen utgör halva konfidensintervallets längd varpå en felmarginal på 50 kronor innebär en intervallängd på 100 kr. Vi kan ställa upp precisionskravet som</li>
</ol>
<p><span class="math display">\[50\geq z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}.\]</span>
Vi anpassar formeln för nödvändig stickprovsstorlek som härleddes i (a) vilket ger</p>
<p><span class="math display">\[n\geq \frac{2000\cdot 250^2}{\left(\frac{20}{1,96}\right)^2 1999+250^2}=91,68.\]</span></p>
<p>Vi kan även testa oss fram i R:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1"> felmarginal &lt;-<span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>( ((N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>(sigma2<span class="op">/</span>n))</a>
<a class="sourceLine" id="cb371-2" title="2"> n[felmarginal <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>]</a></code></pre></div>
<pre><code>##    [1]   92   93   94   95   96   97   98   99  100  101  102  103  104  105
##   [15]  106  107  108  109  110  111  112  113  114  115  116  117  118  119
##   [29]  120  121  122  123  124  125  126  127  128  129  130  131  132  133
##   [43]  134  135  136  137  138  139  140  141  142  143  144  145  146  147
##   [57]  148  149  150  151  152  153  154  155  156  157  158  159  160  161
##   [71]  162  163  164  165  166  167  168  169  170  171  172  173  174  175
##   [85]  176  177  178  179  180  181  182  183  184  185  186  187  188  189
##   [99]  190  191  192  193  194  195  196  197  198  199  200  201  202  203
##  [113]  204  205  206  207  208  209  210  211  212  213  214  215  216  217
##  [127]  218  219  220  221  222  223  224  225  226  227  228  229  230  231
##  [141]  232  233  234  235  236  237  238  239  240  241  242  243  244  245
##  [155]  246  247  248  249  250  251  252  253  254  255  256  257  258  259
##  [169]  260  261  262  263  264  265  266  267  268  269  270  271  272  273
##  [183]  274  275  276  277  278  279  280  281  282  283  284  285  286  287
##  [197]  288  289  290  291  292  293  294  295  296  297  298  299  300  301
##  [211]  302  303  304  305  306  307  308  309  310  311  312  313  314  315
##  [225]  316  317  318  319  320  321  322  323  324  325  326  327  328  329
##  [239]  330  331  332  333  334  335  336  337  338  339  340  341  342  343
##  [253]  344  345  346  347  348  349  350  351  352  353  354  355  356  357
##  [267]  358  359  360  361  362  363  364  365  366  367  368  369  370  371
##  [281]  372  373  374  375  376  377  378  379  380  381  382  383  384  385
##  [295]  386  387  388  389  390  391  392  393  394  395  396  397  398  399
##  [309]  400  401  402  403  404  405  406  407  408  409  410  411  412  413
##  [323]  414  415  416  417  418  419  420  421  422  423  424  425  426  427
##  [337]  428  429  430  431  432  433  434  435  436  437  438  439  440  441
##  [351]  442  443  444  445  446  447  448  449  450  451  452  453  454  455
##  [365]  456  457  458  459  460  461  462  463  464  465  466  467  468  469
##  [379]  470  471  472  473  474  475  476  477  478  479  480  481  482  483
##  [393]  484  485  486  487  488  489  490  491  492  493  494  495  496  497
##  [407]  498  499  500  501  502  503  504  505  506  507  508  509  510  511
##  [421]  512  513  514  515  516  517  518  519  520  521  522  523  524  525
##  [435]  526  527  528  529  530  531  532  533  534  535  536  537  538  539
##  [449]  540  541  542  543  544  545  546  547  548  549  550  551  552  553
##  [463]  554  555  556  557  558  559  560  561  562  563  564  565  566  567
##  [477]  568  569  570  571  572  573  574  575  576  577  578  579  580  581
##  [491]  582  583  584  585  586  587  588  589  590  591  592  593  594  595
##  [505]  596  597  598  599  600  601  602  603  604  605  606  607  608  609
##  [519]  610  611  612  613  614  615  616  617  618  619  620  621  622  623
##  [533]  624  625  626  627  628  629  630  631  632  633  634  635  636  637
##  [547]  638  639  640  641  642  643  644  645  646  647  648  649  650  651
##  [561]  652  653  654  655  656  657  658  659  660  661  662  663  664  665
##  [575]  666  667  668  669  670  671  672  673  674  675  676  677  678  679
##  [589]  680  681  682  683  684  685  686  687  688  689  690  691  692  693
##  [603]  694  695  696  697  698  699  700  701  702  703  704  705  706  707
##  [617]  708  709  710  711  712  713  714  715  716  717  718  719  720  721
##  [631]  722  723  724  725  726  727  728  729  730  731  732  733  734  735
##  [645]  736  737  738  739  740  741  742  743  744  745  746  747  748  749
##  [659]  750  751  752  753  754  755  756  757  758  759  760  761  762  763
##  [673]  764  765  766  767  768  769  770  771  772  773  774  775  776  777
##  [687]  778  779  780  781  782  783  784  785  786  787  788  789  790  791
##  [701]  792  793  794  795  796  797  798  799  800  801  802  803  804  805
##  [715]  806  807  808  809  810  811  812  813  814  815  816  817  818  819
##  [729]  820  821  822  823  824  825  826  827  828  829  830  831  832  833
##  [743]  834  835  836  837  838  839  840  841  842  843  844  845  846  847
##  [757]  848  849  850  851  852  853  854  855  856  857  858  859  860  861
##  [771]  862  863  864  865  866  867  868  869  870  871  872  873  874  875
##  [785]  876  877  878  879  880  881  882  883  884  885  886  887  888  889
##  [799]  890  891  892  893  894  895  896  897  898  899  900  901  902  903
##  [813]  904  905  906  907  908  909  910  911  912  913  914  915  916  917
##  [827]  918  919  920  921  922  923  924  925  926  927  928  929  930  931
##  [841]  932  933  934  935  936  937  938  939  940  941  942  943  944  945
##  [855]  946  947  948  949  950  951  952  953  954  955  956  957  958  959
##  [869]  960  961  962  963  964  965  966  967  968  969  970  971  972  973
##  [883]  974  975  976  977  978  979  980  981  982  983  984  985  986  987
##  [897]  988  989  990  991  992  993  994  995  996  997  998  999 1000 1001
##  [911] 1002 1003 1004 1005 1006 1007 1008 1009 1010 1011 1012 1013 1014 1015
##  [925] 1016 1017 1018 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029
##  [939] 1030 1031 1032 1033 1034 1035 1036 1037 1038 1039 1040 1041 1042 1043
##  [953] 1044 1045 1046 1047 1048 1049 1050 1051 1052 1053 1054 1055 1056 1057
##  [967] 1058 1059 1060 1061 1062 1063 1064 1065 1066 1067 1068 1069 1070 1071
##  [981] 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 1084 1085
##  [995] 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099
## [1009] 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113
## [1023] 1114 1115 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127
## [1037] 1128 1129 1130 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141
## [1051] 1142 1143 1144 1145 1146 1147 1148 1149 1150 1151 1152 1153 1154 1155
## [1065] 1156 1157 1158 1159 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169
## [1079] 1170 1171 1172 1173 1174 1175 1176 1177 1178 1179 1180 1181 1182 1183
## [1093] 1184 1185 1186 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197
## [1107] 1198 1199 1200 1201 1202 1203 1204 1205 1206 1207 1208 1209 1210 1211
## [1121] 1212 1213 1214 1215 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225
## [1135] 1226 1227 1228 1229 1230 1231 1232 1233 1234 1235 1236 1237 1238 1239
## [1149] 1240 1241 1242 1243 1244 1245 1246 1247 1248 1249 1250 1251 1252 1253
## [1163] 1254 1255 1256 1257 1258 1259 1260 1261 1262 1263 1264 1265 1266 1267
## [1177] 1268 1269 1270 1271 1272 1273 1274 1275 1276 1277 1278 1279 1280 1281
## [1191] 1282 1283 1284 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295
## [1205] 1296 1297 1298 1299 1300 1301 1302 1303 1304 1305 1306 1307 1308 1309
## [1219] 1310 1311 1312 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323
## [1233] 1324 1325 1326 1327 1328 1329 1330 1331 1332 1333 1334 1335 1336 1337
## [1247] 1338 1339 1340 1341 1342 1343 1344 1345 1346 1347 1348 1349 1350 1351
## [1261] 1352 1353 1354 1355 1356 1357 1358 1359 1360 1361 1362 1363 1364 1365
## [1275] 1366 1367 1368 1369 1370 1371 1372 1373 1374 1375 1376 1377 1378 1379
## [1289] 1380 1381 1382 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 1393
## [1303] 1394 1395 1396 1397 1398 1399 1400 1401 1402 1403 1404 1405 1406 1407
## [1317] 1408 1409 1410 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421
## [1331] 1422 1423 1424 1425 1426 1427 1428 1429 1430 1431 1432 1433 1434 1435
## [1345] 1436 1437 1438 1439 1440 1441 1442 1443 1444 1445 1446 1447 1448 1449
## [1359] 1450 1451 1452 1453 1454 1455 1456 1457 1458 1459 1460 1461 1462 1463
## [1373] 1464 1465 1466 1467 1468 1469 1470 1471 1472 1473 1474 1475 1476 1477
## [1387] 1478 1479 1480 1481 1482 1483 1484 1485 1486 1487 1488 1489 1490 1491
## [1401] 1492 1493 1494 1495 1496 1497 1498 1499 1500 1501 1502 1503 1504 1505
## [1415] 1506 1507 1508 1509 1510 1511 1512 1513 1514 1515 1516 1517 1518 1519
## [1429] 1520 1521 1522 1523 1524 1525 1526 1527 1528 1529 1530 1531 1532 1533
## [1443] 1534 1535 1536 1537 1538 1539 1540 1541 1542 1543 1544 1545 1546 1547
## [1457] 1548 1549 1550 1551 1552 1553 1554 1555 1556 1557 1558 1559 1560 1561
## [1471] 1562 1563 1564 1565 1566 1567 1568 1569 1570 1571 1572 1573 1574 1575
## [1485] 1576 1577 1578 1579 1580 1581 1582 1583 1584 1585 1586 1587 1588 1589
## [1499] 1590 1591 1592 1593 1594 1595 1596 1597 1598 1599 1600 1601 1602 1603
## [1513] 1604 1605 1606 1607 1608 1609 1610 1611 1612 1613 1614 1615 1616 1617
## [1527] 1618 1619 1620 1621 1622 1623 1624 1625 1626 1627 1628 1629 1630 1631
## [1541] 1632 1633 1634 1635 1636 1637 1638 1639 1640 1641 1642 1643 1644 1645
## [1555] 1646 1647 1648 1649 1650 1651 1652 1653 1654 1655 1656 1657 1658 1659
## [1569] 1660 1661 1662 1663 1664 1665 1666 1667 1668 1669 1670 1671 1672 1673
## [1583] 1674 1675 1676 1677 1678 1679 1680 1681 1682 1683 1684 1685 1686 1687
## [1597] 1688 1689 1690 1691 1692 1693 1694 1695 1696 1697 1698 1699 1700 1701
## [1611] 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711 1712 1713 1714 1715
## [1625] 1716 1717 1718 1719 1720 1721 1722 1723 1724 1725 1726 1727 1728 1729
## [1639] 1730 1731 1732 1733 1734 1735 1736 1737 1738 1739 1740 1741 1742 1743
## [1653] 1744 1745 1746 1747 1748 1749 1750 1751 1752 1753 1754 1755 1756 1757
## [1667] 1758 1759 1760 1761 1762 1763 1764 1765 1766 1767 1768 1769 1770 1771
## [1681] 1772 1773 1774 1775 1776 1777 1778 1779 1780 1781 1782 1783 1784 1785
## [1695] 1786 1787 1788 1789 1790 1791 1792 1793 1794 1795 1796 1797 1798 1799
## [1709] 1800 1801 1802 1803 1804 1805 1806 1807 1808 1809 1810 1811 1812 1813
## [1723] 1814 1815 1816 1817 1818 1819 1820 1821 1822 1823 1824 1825 1826 1827
## [1737] 1828 1829 1830 1831 1832 1833 1834 1835 1836 1837 1838 1839 1840 1841
## [1751] 1842 1843 1844 1845 1846 1847 1848 1849 1850 1851 1852 1853 1854 1855
## [1765] 1856 1857 1858 1859 1860 1861 1862 1863 1864 1865 1866 1867 1868 1869
## [1779] 1870 1871 1872 1873 1874 1875 1876 1877 1878 1879 1880 1881 1882 1883
## [1793] 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894 1895 1896 1897
## [1807] 1898 1899 1900 1901 1902 1903 1904 1905 1906 1907 1908 1909 1910 1911
## [1821] 1912 1913 1914 1915 1916 1917 1918 1919 1920 1921 1922 1923 1924 1925
## [1835] 1926 1927 1928 1929 1930 1931 1932 1933 1934 1935 1936 1937 1938 1939
## [1849] 1940 1941 1942 1943 1944 1945 1946 1947 1948 1949 1950 1951 1952 1953
## [1863] 1954 1955 1956 1957 1958 1959 1960 1961 1962 1963 1964 1965 1966 1967
## [1877] 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981
## [1891] 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
## [1905] 1996 1997 1998 1999 2000</code></pre>
<ul>
<li>Svar: Vi behöver ett urval bestånde av minst 92 medlemmar för att nå precisionskravet om en felmarginal på 50 kronor. Kontroll för CGS: <span class="math inline">\(92 &gt; 30\)</span>. OK!</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Vi behöver inte normalfördelning för att beräkna medelfelet. Medelfelet ges av</li>
</ol>
<p><span class="math display">\[SE(\bar{x})=\sqrt{V(\bar{x})}=\sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}.\]</span>
Precisionskravet kan skrivas som <span class="math display">\[50\geq \sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}\]</span> och insättning av värden ger
<span class="math display">\[50\geq \sqrt{\left(\frac{2000-n}{2000-1}\right)\frac{250^2}{n}}.\]</span>
Vi löser ut <span class="math inline">\(n\)</span> på motsvarande sätt som i (a) och landar på uttrycket
<span class="math display">\[n\geq \frac{2000\cdot250^2}{50^2\cdot1999+250^2}=24,70.\]</span>
Vi kan även testa oss fram i R:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1"> medelfel &lt;-<span class="st"> </span><span class="kw">sqrt</span>( ((N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>(sigma2<span class="op">/</span>n))</a>
<a class="sourceLine" id="cb373-2" title="2"> n[medelfel <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>]</a></code></pre></div>
<pre><code>##    [1]   25   26   27   28   29   30   31   32   33   34   35   36   37   38
##   [15]   39   40   41   42   43   44   45   46   47   48   49   50   51   52
##   [29]   53   54   55   56   57   58   59   60   61   62   63   64   65   66
##   [43]   67   68   69   70   71   72   73   74   75   76   77   78   79   80
##   [57]   81   82   83   84   85   86   87   88   89   90   91   92   93   94
##   [71]   95   96   97   98   99  100  101  102  103  104  105  106  107  108
##   [85]  109  110  111  112  113  114  115  116  117  118  119  120  121  122
##   [99]  123  124  125  126  127  128  129  130  131  132  133  134  135  136
##  [113]  137  138  139  140  141  142  143  144  145  146  147  148  149  150
##  [127]  151  152  153  154  155  156  157  158  159  160  161  162  163  164
##  [141]  165  166  167  168  169  170  171  172  173  174  175  176  177  178
##  [155]  179  180  181  182  183  184  185  186  187  188  189  190  191  192
##  [169]  193  194  195  196  197  198  199  200  201  202  203  204  205  206
##  [183]  207  208  209  210  211  212  213  214  215  216  217  218  219  220
##  [197]  221  222  223  224  225  226  227  228  229  230  231  232  233  234
##  [211]  235  236  237  238  239  240  241  242  243  244  245  246  247  248
##  [225]  249  250  251  252  253  254  255  256  257  258  259  260  261  262
##  [239]  263  264  265  266  267  268  269  270  271  272  273  274  275  276
##  [253]  277  278  279  280  281  282  283  284  285  286  287  288  289  290
##  [267]  291  292  293  294  295  296  297  298  299  300  301  302  303  304
##  [281]  305  306  307  308  309  310  311  312  313  314  315  316  317  318
##  [295]  319  320  321  322  323  324  325  326  327  328  329  330  331  332
##  [309]  333  334  335  336  337  338  339  340  341  342  343  344  345  346
##  [323]  347  348  349  350  351  352  353  354  355  356  357  358  359  360
##  [337]  361  362  363  364  365  366  367  368  369  370  371  372  373  374
##  [351]  375  376  377  378  379  380  381  382  383  384  385  386  387  388
##  [365]  389  390  391  392  393  394  395  396  397  398  399  400  401  402
##  [379]  403  404  405  406  407  408  409  410  411  412  413  414  415  416
##  [393]  417  418  419  420  421  422  423  424  425  426  427  428  429  430
##  [407]  431  432  433  434  435  436  437  438  439  440  441  442  443  444
##  [421]  445  446  447  448  449  450  451  452  453  454  455  456  457  458
##  [435]  459  460  461  462  463  464  465  466  467  468  469  470  471  472
##  [449]  473  474  475  476  477  478  479  480  481  482  483  484  485  486
##  [463]  487  488  489  490  491  492  493  494  495  496  497  498  499  500
##  [477]  501  502  503  504  505  506  507  508  509  510  511  512  513  514
##  [491]  515  516  517  518  519  520  521  522  523  524  525  526  527  528
##  [505]  529  530  531  532  533  534  535  536  537  538  539  540  541  542
##  [519]  543  544  545  546  547  548  549  550  551  552  553  554  555  556
##  [533]  557  558  559  560  561  562  563  564  565  566  567  568  569  570
##  [547]  571  572  573  574  575  576  577  578  579  580  581  582  583  584
##  [561]  585  586  587  588  589  590  591  592  593  594  595  596  597  598
##  [575]  599  600  601  602  603  604  605  606  607  608  609  610  611  612
##  [589]  613  614  615  616  617  618  619  620  621  622  623  624  625  626
##  [603]  627  628  629  630  631  632  633  634  635  636  637  638  639  640
##  [617]  641  642  643  644  645  646  647  648  649  650  651  652  653  654
##  [631]  655  656  657  658  659  660  661  662  663  664  665  666  667  668
##  [645]  669  670  671  672  673  674  675  676  677  678  679  680  681  682
##  [659]  683  684  685  686  687  688  689  690  691  692  693  694  695  696
##  [673]  697  698  699  700  701  702  703  704  705  706  707  708  709  710
##  [687]  711  712  713  714  715  716  717  718  719  720  721  722  723  724
##  [701]  725  726  727  728  729  730  731  732  733  734  735  736  737  738
##  [715]  739  740  741  742  743  744  745  746  747  748  749  750  751  752
##  [729]  753  754  755  756  757  758  759  760  761  762  763  764  765  766
##  [743]  767  768  769  770  771  772  773  774  775  776  777  778  779  780
##  [757]  781  782  783  784  785  786  787  788  789  790  791  792  793  794
##  [771]  795  796  797  798  799  800  801  802  803  804  805  806  807  808
##  [785]  809  810  811  812  813  814  815  816  817  818  819  820  821  822
##  [799]  823  824  825  826  827  828  829  830  831  832  833  834  835  836
##  [813]  837  838  839  840  841  842  843  844  845  846  847  848  849  850
##  [827]  851  852  853  854  855  856  857  858  859  860  861  862  863  864
##  [841]  865  866  867  868  869  870  871  872  873  874  875  876  877  878
##  [855]  879  880  881  882  883  884  885  886  887  888  889  890  891  892
##  [869]  893  894  895  896  897  898  899  900  901  902  903  904  905  906
##  [883]  907  908  909  910  911  912  913  914  915  916  917  918  919  920
##  [897]  921  922  923  924  925  926  927  928  929  930  931  932  933  934
##  [911]  935  936  937  938  939  940  941  942  943  944  945  946  947  948
##  [925]  949  950  951  952  953  954  955  956  957  958  959  960  961  962
##  [939]  963  964  965  966  967  968  969  970  971  972  973  974  975  976
##  [953]  977  978  979  980  981  982  983  984  985  986  987  988  989  990
##  [967]  991  992  993  994  995  996  997  998  999 1000 1001 1002 1003 1004
##  [981] 1005 1006 1007 1008 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018
##  [995] 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032
## [1009] 1033 1034 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046
## [1023] 1047 1048 1049 1050 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060
## [1037] 1061 1062 1063 1064 1065 1066 1067 1068 1069 1070 1071 1072 1073 1074
## [1051] 1075 1076 1077 1078 1079 1080 1081 1082 1083 1084 1085 1086 1087 1088
## [1065] 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102
## [1079] 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116
## [1093] 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130
## [1107] 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144
## [1121] 1145 1146 1147 1148 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158
## [1135] 1159 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169 1170 1171 1172
## [1149] 1173 1174 1175 1176 1177 1178 1179 1180 1181 1182 1183 1184 1185 1186
## [1163] 1187 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 1198 1199 1200
## [1177] 1201 1202 1203 1204 1205 1206 1207 1208 1209 1210 1211 1212 1213 1214
## [1191] 1215 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228
## [1205] 1229 1230 1231 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242
## [1219] 1243 1244 1245 1246 1247 1248 1249 1250 1251 1252 1253 1254 1255 1256
## [1233] 1257 1258 1259 1260 1261 1262 1263 1264 1265 1266 1267 1268 1269 1270
## [1247] 1271 1272 1273 1274 1275 1276 1277 1278 1279 1280 1281 1282 1283 1284
## [1261] 1285 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 1296 1297 1298
## [1275] 1299 1300 1301 1302 1303 1304 1305 1306 1307 1308 1309 1310 1311 1312
## [1289] 1313 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326
## [1303] 1327 1328 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340
## [1317] 1341 1342 1343 1344 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354
## [1331] 1355 1356 1357 1358 1359 1360 1361 1362 1363 1364 1365 1366 1367 1368
## [1345] 1369 1370 1371 1372 1373 1374 1375 1376 1377 1378 1379 1380 1381 1382
## [1359] 1383 1384 1385 1386 1387 1388 1389 1390 1391 1392 1393 1394 1395 1396
## [1373] 1397 1398 1399 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 1410
## [1387] 1411 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424
## [1401] 1425 1426 1427 1428 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438
## [1415] 1439 1440 1441 1442 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452
## [1429] 1453 1454 1455 1456 1457 1458 1459 1460 1461 1462 1463 1464 1465 1466
## [1443] 1467 1468 1469 1470 1471 1472 1473 1474 1475 1476 1477 1478 1479 1480
## [1457] 1481 1482 1483 1484 1485 1486 1487 1488 1489 1490 1491 1492 1493 1494
## [1471] 1495 1496 1497 1498 1499 1500 1501 1502 1503 1504 1505 1506 1507 1508
## [1485] 1509 1510 1511 1512 1513 1514 1515 1516 1517 1518 1519 1520 1521 1522
## [1499] 1523 1524 1525 1526 1527 1528 1529 1530 1531 1532 1533 1534 1535 1536
## [1513] 1537 1538 1539 1540 1541 1542 1543 1544 1545 1546 1547 1548 1549 1550
## [1527] 1551 1552 1553 1554 1555 1556 1557 1558 1559 1560 1561 1562 1563 1564
## [1541] 1565 1566 1567 1568 1569 1570 1571 1572 1573 1574 1575 1576 1577 1578
## [1555] 1579 1580 1581 1582 1583 1584 1585 1586 1587 1588 1589 1590 1591 1592
## [1569] 1593 1594 1595 1596 1597 1598 1599 1600 1601 1602 1603 1604 1605 1606
## [1583] 1607 1608 1609 1610 1611 1612 1613 1614 1615 1616 1617 1618 1619 1620
## [1597] 1621 1622 1623 1624 1625 1626 1627 1628 1629 1630 1631 1632 1633 1634
## [1611] 1635 1636 1637 1638 1639 1640 1641 1642 1643 1644 1645 1646 1647 1648
## [1625] 1649 1650 1651 1652 1653 1654 1655 1656 1657 1658 1659 1660 1661 1662
## [1639] 1663 1664 1665 1666 1667 1668 1669 1670 1671 1672 1673 1674 1675 1676
## [1653] 1677 1678 1679 1680 1681 1682 1683 1684 1685 1686 1687 1688 1689 1690
## [1667] 1691 1692 1693 1694 1695 1696 1697 1698 1699 1700 1701 1702 1703 1704
## [1681] 1705 1706 1707 1708 1709 1710 1711 1712 1713 1714 1715 1716 1717 1718
## [1695] 1719 1720 1721 1722 1723 1724 1725 1726 1727 1728 1729 1730 1731 1732
## [1709] 1733 1734 1735 1736 1737 1738 1739 1740 1741 1742 1743 1744 1745 1746
## [1723] 1747 1748 1749 1750 1751 1752 1753 1754 1755 1756 1757 1758 1759 1760
## [1737] 1761 1762 1763 1764 1765 1766 1767 1768 1769 1770 1771 1772 1773 1774
## [1751] 1775 1776 1777 1778 1779 1780 1781 1782 1783 1784 1785 1786 1787 1788
## [1765] 1789 1790 1791 1792 1793 1794 1795 1796 1797 1798 1799 1800 1801 1802
## [1779] 1803 1804 1805 1806 1807 1808 1809 1810 1811 1812 1813 1814 1815 1816
## [1793] 1817 1818 1819 1820 1821 1822 1823 1824 1825 1826 1827 1828 1829 1830
## [1807] 1831 1832 1833 1834 1835 1836 1837 1838 1839 1840 1841 1842 1843 1844
## [1821] 1845 1846 1847 1848 1849 1850 1851 1852 1853 1854 1855 1856 1857 1858
## [1835] 1859 1860 1861 1862 1863 1864 1865 1866 1867 1868 1869 1870 1871 1872
## [1849] 1873 1874 1875 1876 1877 1878 1879 1880 1881 1882 1883 1884 1885 1886
## [1863] 1887 1888 1889 1890 1891 1892 1893 1894 1895 1896 1897 1898 1899 1900
## [1877] 1901 1902 1903 1904 1905 1906 1907 1908 1909 1910 1911 1912 1913 1914
## [1891] 1915 1916 1917 1918 1919 1920 1921 1922 1923 1924 1925 1926 1927 1928
## [1905] 1929 1930 1931 1932 1933 1934 1935 1936 1937 1938 1939 1940 1941 1942
## [1919] 1943 1944 1945 1946 1947 1948 1949 1950 1951 1952 1953 1954 1955 1956
## [1933] 1957 1958 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970
## [1947] 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984
## [1961] 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998
## [1975] 1999 2000</code></pre>
<ul>
<li>Svar: Vi behöver ett urval på minst 25 medlemmar för att uppnå precisionskravet.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.6" class="section level3 unnumbered">
<h3>Övning 7.6</h3>
<p>För några år sedan annonserade Findus på följande sätt: ‘’Findus lagar fortfarande Sveriges populäraste köttbullar (näst efter hemlagade förstås)’’. Detta uttalande baserade Findus på en undersökning utförd av Skandinaviska Marknadsinstitutet. Där hade man låtit 200 konsumenter jämföra Findus köttbullar med Felix köttbullar. De 200 konsumenterna hade valts med OSU utan återläggning från en grupp bestående av <span class="math inline">\(5000\)</span> personer som ansågs representera svenska konsumenter.</p>
<p>På basis av undersökningen gjorde man ett konfidensintervall för
andelen som tyckte att Findus smakade bäst. Detta konfidensintervall tyckte man dock blev alltför brett. I stället ville man ha ett 95% konfidensintervall som skulle vara högst 6 procentenheter brett.</p>
<ul>
<li>Hur stort urval ur konsumentpanelen på <span class="math inline">\(5000\)</span> personer måste man göra för att uppfylla detta precisionskrav?</li>
</ul>
<button title="q706" type="button" onclick="if(document.getElementById(&#39;q706&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q706&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q706&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q706" style="display:none">
<div class="alert alert-info">
<p>Beräkna nödvändig stickprovsstorlek <span class="math inline">\(n\)</span> om längden för ett 95% konfidensintervall för andelen i populationen får vara max 6 procentenheter brett. Vi vet populationsstorleken och använder ändlighetskorrektion varpå <span class="math inline">\(\hat{V}(p)=\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}\)</span>. Vi vet inget om populationsandelen och använder därför 0.5 som ger störst varians. Vi utgår från att <span class="math inline">\(np(1-p)&gt;5\)</span> är uppfyllt för att CGS ska gälla men vi måste i efterhand kontrollera om så faktiskt är fallet.</p>
<p>Vi kan lösa uppgiften algebraiskt. Längden för ett 95% konfidensintervall kan skrivas som</p>
<p><span class="math display">\[2\cdot z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0.025}=1,96\)</span>. Vi sätter in värden givet precisionskravet och löser ut <span class="math inline">\(n\)</span>.</p>
<p><span class="math display">\[0,06\geq 2\cdot 1.96\sqrt{\left(\frac{5000-n}{5000-1}\right)\frac{0.5(1-0.5)}{n}}\]</span></p>
<p><span class="math display">\[\left(\frac{0.06}{2\cdot 1.96}\right)^2 \geq \left(\frac{5000-n}{4999}\right)\frac{0.25}{n}\]</span></p>
<p><span class="math display">\[\left(\frac{0.06}{2\cdot 1.96}\right)^2 4999 \geq \left(\frac{5000}{n}-1\right)0.25\]</span></p>
<p><span class="math display">\[\left(\frac{0.06}{2\cdot 1.96}\right)^2 4999+0.25 \geq \frac{5000}{n}0.25.\]</span></p>
<p>Vi landar slutligen på
<span class="math display">\[n \geq \frac{5000\cdot 0.25}{\left(\frac{0.06}{2\cdot1.96}\right)^2 4999+0.25}=879.57.\]</span>
Vi kan även testa oss fram i R:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" title="1"><span class="co"># Töm minnet</span></a>
<a class="sourceLine" id="cb375-2" title="2"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb375-3" title="3"> N &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb375-4" title="4"> p &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb375-5" title="5"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb375-6" title="6"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb375-7" title="7"> n &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">:</span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb375-8" title="8"> KI_langd &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(( (N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N<span class="dv">-1</span>))<span class="op">*</span>(p<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p))<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb375-9" title="9"> n[KI_langd <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.06</span>]</a></code></pre></div>
<pre><code>##    [1]  880  881  882  883  884  885  886  887  888  889  890  891  892  893
##   [15]  894  895  896  897  898  899  900  901  902  903  904  905  906  907
##   [29]  908  909  910  911  912  913  914  915  916  917  918  919  920  921
##   [43]  922  923  924  925  926  927  928  929  930  931  932  933  934  935
##   [57]  936  937  938  939  940  941  942  943  944  945  946  947  948  949
##   [71]  950  951  952  953  954  955  956  957  958  959  960  961  962  963
##   [85]  964  965  966  967  968  969  970  971  972  973  974  975  976  977
##   [99]  978  979  980  981  982  983  984  985  986  987  988  989  990  991
##  [113]  992  993  994  995  996  997  998  999 1000 1001 1002 1003 1004 1005
##  [127] 1006 1007 1008 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018 1019
##  [141] 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033
##  [155] 1034 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047
##  [169] 1048 1049 1050 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061
##  [183] 1062 1063 1064 1065 1066 1067 1068 1069 1070 1071 1072 1073 1074 1075
##  [197] 1076 1077 1078 1079 1080 1081 1082 1083 1084 1085 1086 1087 1088 1089
##  [211] 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102 1103
##  [225] 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116 1117
##  [239] 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131
##  [253] 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145
##  [267] 1146 1147 1148 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159
##  [281] 1160 1161 1162 1163 1164 1165 1166 1167 1168 1169 1170 1171 1172 1173
##  [295] 1174 1175 1176 1177 1178 1179 1180 1181 1182 1183 1184 1185 1186 1187
##  [309] 1188 1189 1190 1191 1192 1193 1194 1195 1196 1197 1198 1199 1200 1201
##  [323] 1202 1203 1204 1205 1206 1207 1208 1209 1210 1211 1212 1213 1214 1215
##  [337] 1216 1217 1218 1219 1220 1221 1222 1223 1224 1225 1226 1227 1228 1229
##  [351] 1230 1231 1232 1233 1234 1235 1236 1237 1238 1239 1240 1241 1242 1243
##  [365] 1244 1245 1246 1247 1248 1249 1250 1251 1252 1253 1254 1255 1256 1257
##  [379] 1258 1259 1260 1261 1262 1263 1264 1265 1266 1267 1268 1269 1270 1271
##  [393] 1272 1273 1274 1275 1276 1277 1278 1279 1280 1281 1282 1283 1284 1285
##  [407] 1286 1287 1288 1289 1290 1291 1292 1293 1294 1295 1296 1297 1298 1299
##  [421] 1300 1301 1302 1303 1304 1305 1306 1307 1308 1309 1310 1311 1312 1313
##  [435] 1314 1315 1316 1317 1318 1319 1320 1321 1322 1323 1324 1325 1326 1327
##  [449] 1328 1329 1330 1331 1332 1333 1334 1335 1336 1337 1338 1339 1340 1341
##  [463] 1342 1343 1344 1345 1346 1347 1348 1349 1350 1351 1352 1353 1354 1355
##  [477] 1356 1357 1358 1359 1360 1361 1362 1363 1364 1365 1366 1367 1368 1369
##  [491] 1370 1371 1372 1373 1374 1375 1376 1377 1378 1379 1380 1381 1382 1383
##  [505] 1384 1385 1386 1387 1388 1389 1390 1391 1392 1393 1394 1395 1396 1397
##  [519] 1398 1399 1400 1401 1402 1403 1404 1405 1406 1407 1408 1409 1410 1411
##  [533] 1412 1413 1414 1415 1416 1417 1418 1419 1420 1421 1422 1423 1424 1425
##  [547] 1426 1427 1428 1429 1430 1431 1432 1433 1434 1435 1436 1437 1438 1439
##  [561] 1440 1441 1442 1443 1444 1445 1446 1447 1448 1449 1450 1451 1452 1453
##  [575] 1454 1455 1456 1457 1458 1459 1460 1461 1462 1463 1464 1465 1466 1467
##  [589] 1468 1469 1470 1471 1472 1473 1474 1475 1476 1477 1478 1479 1480 1481
##  [603] 1482 1483 1484 1485 1486 1487 1488 1489 1490 1491 1492 1493 1494 1495
##  [617] 1496 1497 1498 1499 1500 1501 1502 1503 1504 1505 1506 1507 1508 1509
##  [631] 1510 1511 1512 1513 1514 1515 1516 1517 1518 1519 1520 1521 1522 1523
##  [645] 1524 1525 1526 1527 1528 1529 1530 1531 1532 1533 1534 1535 1536 1537
##  [659] 1538 1539 1540 1541 1542 1543 1544 1545 1546 1547 1548 1549 1550 1551
##  [673] 1552 1553 1554 1555 1556 1557 1558 1559 1560 1561 1562 1563 1564 1565
##  [687] 1566 1567 1568 1569 1570 1571 1572 1573 1574 1575 1576 1577 1578 1579
##  [701] 1580 1581 1582 1583 1584 1585 1586 1587 1588 1589 1590 1591 1592 1593
##  [715] 1594 1595 1596 1597 1598 1599 1600 1601 1602 1603 1604 1605 1606 1607
##  [729] 1608 1609 1610 1611 1612 1613 1614 1615 1616 1617 1618 1619 1620 1621
##  [743] 1622 1623 1624 1625 1626 1627 1628 1629 1630 1631 1632 1633 1634 1635
##  [757] 1636 1637 1638 1639 1640 1641 1642 1643 1644 1645 1646 1647 1648 1649
##  [771] 1650 1651 1652 1653 1654 1655 1656 1657 1658 1659 1660 1661 1662 1663
##  [785] 1664 1665 1666 1667 1668 1669 1670 1671 1672 1673 1674 1675 1676 1677
##  [799] 1678 1679 1680 1681 1682 1683 1684 1685 1686 1687 1688 1689 1690 1691
##  [813] 1692 1693 1694 1695 1696 1697 1698 1699 1700 1701 1702 1703 1704 1705
##  [827] 1706 1707 1708 1709 1710 1711 1712 1713 1714 1715 1716 1717 1718 1719
##  [841] 1720 1721 1722 1723 1724 1725 1726 1727 1728 1729 1730 1731 1732 1733
##  [855] 1734 1735 1736 1737 1738 1739 1740 1741 1742 1743 1744 1745 1746 1747
##  [869] 1748 1749 1750 1751 1752 1753 1754 1755 1756 1757 1758 1759 1760 1761
##  [883] 1762 1763 1764 1765 1766 1767 1768 1769 1770 1771 1772 1773 1774 1775
##  [897] 1776 1777 1778 1779 1780 1781 1782 1783 1784 1785 1786 1787 1788 1789
##  [911] 1790 1791 1792 1793 1794 1795 1796 1797 1798 1799 1800 1801 1802 1803
##  [925] 1804 1805 1806 1807 1808 1809 1810 1811 1812 1813 1814 1815 1816 1817
##  [939] 1818 1819 1820 1821 1822 1823 1824 1825 1826 1827 1828 1829 1830 1831
##  [953] 1832 1833 1834 1835 1836 1837 1838 1839 1840 1841 1842 1843 1844 1845
##  [967] 1846 1847 1848 1849 1850 1851 1852 1853 1854 1855 1856 1857 1858 1859
##  [981] 1860 1861 1862 1863 1864 1865 1866 1867 1868 1869 1870 1871 1872 1873
##  [995] 1874 1875 1876 1877 1878 1879 1880 1881 1882 1883 1884 1885 1886 1887
## [1009] 1888 1889 1890 1891 1892 1893 1894 1895 1896 1897 1898 1899 1900 1901
## [1023] 1902 1903 1904 1905 1906 1907 1908 1909 1910 1911 1912 1913 1914 1915
## [1037] 1916 1917 1918 1919 1920 1921 1922 1923 1924 1925 1926 1927 1928 1929
## [1051] 1930 1931 1932 1933 1934 1935 1936 1937 1938 1939 1940 1941 1942 1943
## [1065] 1944 1945 1946 1947 1948 1949 1950 1951 1952 1953 1954 1955 1956 1957
## [1079] 1958 1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971
## [1093] 1972 1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985
## [1107] 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999
## [1121] 2000</code></pre>
<ul>
<li>Svar: För att uppnå precisionskravet behövs ett stickprov på minst 880 personer. Kontroll av CGS: <span class="math inline">\(np(1-p)=880\cdot 0.5\cdot(1-0.5)=220&gt;5\)</span>. OK!</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.7" class="section level3 unnumbered">
<h3>Övning 7.7</h3>
<p>Låt <span class="math inline">\(\hat{\tau}\)</span> vara en estimator för totalen i en ändlig population där urvalet är ett OSU-UÅ. Utgå från att du känner till <span class="math inline">\(V(\bar{x})\)</span>.</p>
<ul>
<li>Visa att</li>
</ul>
<p><span class="math display">\[V(\hat{\tau})=N^2\left(\dfrac{N-n}{N-1}\right)\dfrac{\sigma^2}{n}.\]</span></p>
<button title="q707" type="button" onclick="if(document.getElementById(&#39;q707&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q707&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q707&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q707" style="display:none">
<div class="alert alert-info">
<p>Vi vill skatta populationstotalen <span class="math inline">\(\tau=N\mu\)</span> där <span class="math inline">\(N\)</span> är populationsstorleken och <span class="math inline">\(\mu\)</span> är populationsmedelvärdet.</p>
<p>Vi använder estimatorn <span class="math inline">\(\hat{\tau}=N\bar{x}\)</span>. Vi vet att <span class="math inline">\(V(\bar{x})=\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}\)</span> där <span class="math inline">\(\sigma^2\)</span> är populationsvariansen och <span class="math inline">\(n\)</span> är stickprovsstorleken. Vi kan nu skriva
<span class="math display">\[\begin{equation}\nonumber
V(\hat{\tau})=V(N\bar{x})=N^2V(\bar{x})=N^2\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}.
\end{equation}\]</span>
Likheten gäller eftersom <span class="math inline">\(N\)</span> är en konstant som kvadreras enligt regeln <span class="math inline">\(V(aX)=a^2V(X)\)</span> om <span class="math inline">\(X\)</span> är en slumpvariabel och <span class="math inline">\(a\)</span> är en konstant.</p>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.8" class="section level3 unnumbered">
<h3>Övning 7.8</h3>
<p>En grisuppfödare äger 150 svin som är utspridda i ett stall. Av
praktiska skäl är en totalundersökning inte möjlig. Hon gör därför ett urval
på 20 djur på ett sådant sätt att det kan betraktas som ett OSU-UÅ. Grisarnas vikt kan betraktas som normalfördelad.</p>
<p>Medelvikten för de 65 utvalda svinen visade sig vara 120 kg och
standardavvikelsen 15 kg.</p>
<ol style="list-style-type: lower-alpha">
<li>Bilda ett 95% konfidensintervall för svinens medelvikt. Tolka intervallet i ord! Reflektera över förutsättningarna.</li>
<li>Hur ser ändlighetskorrektionen i variansformeln ut? Vilket syfte har denna korrektion?</li>
<li>Hur stort stickprov hade behövts för att halvera konfidensintervallets längd i (a)?
Vi kan lösa uppgiften algebraiskt.</li>
</ol>
<button title="q708" type="button" onclick="if(document.getElementById(&#39;q708&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q708&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q708&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q708" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<ul>
<li><p>Mål: Intervallskatta medelvikten för svinen i stallet.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = medelvikten för samtliga svin i stallet.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = medelvikten för svinen i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N=150\)</span>. Urvalsstorlek: <span class="math inline">\(n=20\)</span>. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\bar{x})\)</span> med <span class="math inline">\(\hat{V}(\bar{x})=\left(1-\frac{n}{N}\right)\frac{s^2}{n}\)</span>.</li>
<li><span class="math inline">\(x\)</span> är normalfördelad så vi behöver inte förlita oss på CGS. Eftersom stickprovet är litet använder vi <span class="math inline">\(t\)</span>-fördelningen med <span class="math inline">\(n-1\)</span> frihetsgrader.</li>
</ol>
<ul>
<li>Beräkningar: först sammanställer vi våra värden från uppgiften.</li>
</ul>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1"><span class="co"># Töm minnet</span></a>
<a class="sourceLine" id="cb377-2" title="2"> <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb377-3" title="3"> xbar &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb377-4" title="4"> s =<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb377-5" title="5"> N &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb377-6" title="6"> n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb377-7" title="7"> vhatxbar &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>s<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb377-8" title="8"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb377-9" title="9"><span class="co"># t-fördelningen eftersom litet stickprov</span></a>
<a class="sourceLine" id="cb377-10" title="10"> t_alpha &lt;-<span class="st"> </span><span class="kw">qt</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>), <span class="dt">df =</span> n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb377-11" title="11"> ll_mu &lt;-<span class="st"> </span>xbar <span class="op">-</span><span class="st"> </span>t_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar)  </a>
<a class="sourceLine" id="cb377-12" title="12"> ul_mu &lt;-<span class="st"> </span>xbar <span class="op">+</span><span class="st"> </span>t_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar)  </a>
<a class="sourceLine" id="cb377-13" title="13"> resultat &lt;-<span class="st"> </span><span class="kw">c</span>(xbar, ll_mu, ul_mu)</a>
<a class="sourceLine" id="cb377-14" title="14"> resultat</a></code></pre></div>
<pre><code>## [1] 120.0000 113.5914 126.4086</code></pre>
<p>Ett 95% konfidensintervall för <span class="math inline">\(\mu\)</span> ges av</p>
<p><span class="math display">\[\bar{x}\pm t_{n-1; \alpha/2}\sqrt{\left(1-\frac{n}{N}\right)\frac{s^2}{n}}.\]</span></p>
<p>Konfidensintervallet skapas här nedanför. <strong>qt()</strong> fungerar som <strong>qnorm()</strong> fast för t-fördelningen. Vi måste specificera vilken kvantil vi söker samt hur många frihetsgrader vi har (dvs vilken hur t-fördelningen ser ut).</p>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 113.5 till 126.5 den genomsnittliga vikten för svinen i stallet.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p><span class="math inline">\(\left(1-\frac{n}{N}\right)\)</span>. Ändlighetskorrektionen tar hänsyn till den ökade precisionen om urvalet utgör en allt större andel av populationen.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Konfidensintervallets längd är
<span class="math display">\[2\cdot t_{n-1;\alpha/2}\sqrt{\left(1-\frac{n}{N}\right)\frac{s^2}{n}}=13.07.\]</span>
Om längden halveras ska intervallet vara <span class="math inline">\(13.07/2=6.535\)</span> enheter brett, d.v.s. <span class="math inline">\(2\cdot t_{n-1;\alpha/2}\sqrt{\left(1-\frac{n}{N}\right)\frac{s^2}{n}}=6.535\)</span>. Insättning av värden ger
<span class="math display">\[2\cdot 2.093 \sqrt{\left(1-\frac{n}{150}\right)\frac{15^2}{n}}=6.535\]</span>
<span class="math display">\[2^2\cdot 2.093^2\left(1-\frac{n}{150}\right)\frac{15^2}{n}=6.535^2\]</span>
<span class="math display">\[\left(1-\frac{n}{150}\right)\frac{15^2}{n}=\frac{6.535^2}{2^2\cdot 2.093^2}\]</span>
<span class="math display">\[\frac{15^2}{n}-\frac{15^2}{150}=\frac{6.535^2}{2^2\cdot 2.093^2}\]</span>
<span class="math display">\[\frac{15^2}{n}=\frac{6.535^2}{2^2\cdot 2.093^2}+\frac{15^2}{150}\]</span>
vilket ger uttrycket
<span class="math display">\[n=\frac{15^2}{\frac{6.535^2}{2^2\cdot 2.093^2}+\frac{15^2}{150}}=57.147.\]</span>
Vi avrundar uppåt eftersom vi vill som minst halvera intervallets längd varpå =58.</p>
<p>Vi kan även testa oss fram i R, med <strong>qt()</strong>. Prova själv.</p>
<ul>
<li>Svar: Vi behöver ett stickprov på minst 58 svin för att halvera intervallets längd.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.9" class="section level3 unnumbered">
<h3>Övning 7.9</h3>
<p>Ett fackförbundsdistrikt vill veta med hjälp av ett OSU-UÅ veta hur många av medlemmarna som ställer sig positiva till ett förslag. Distriktet har 3800 medlemmar.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna urvalsstorlek om felmarginalen får max vara 2 procentenheter.</li>
<li>Beräkna urvalsstorlek om konfidensintervallet får max vara 3 procentenheter.</li>
</ol>
<button title="q709" type="button" onclick="if(document.getElementById(&#39;q709&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q709&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q709&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q709" style="display:none">
<div class="alert alert-info">
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Beräkna nödvändig stickprovsstorlek <span class="math inline">\(n\)</span> om felmarginalen för andelen i populationen, <span class="math inline">\(p\)</span>, får vara max 2 procentenheter bred. Vi vet populationsstorleken och använder ändlighetskorrektion. <span class="math inline">\(V(p)=\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}\)</span>. Vi vet inte populationsandelen men utgår från att den är <span class="math inline">\(p=0,5\)</span> vilket ger störst varians. Vi antar att <span class="math inline">\(np(1-p)&gt;5\)</span> för att CGS ska gälla men måste kontrollera om det stämmer i slutet av uppgiften. Felmarginalen ges av</p>
<p><span class="math display">\[z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}}\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Vi sätter in precisionskrav och värden och löser ut <span class="math inline">\(n\)</span>:
<span class="math display">\[0.02\geq 1.96\sqrt{\left(\frac{3800-n}{3800-1}\right)\frac{0.5(1-0.5)}{n}}\]</span>
<span class="math display">\[\left(\frac{0.02}{1.96}\right)^2\geq \left(\frac{3800-n}{3799}\right)\frac{0.25}{n}\]</span>
<span class="math display">\[\left(\frac{0.02}{1.96}\right)^2 3799 \geq \left(\frac{3800}{n}-1\right)0.25\]</span>
<span class="math display">\[\left(\frac{0.02}{1.96}\right)^2 3799+0.25 \geq \left(\frac{3800}{n}\right)0.25\]</span>
vilket ger att
<span class="math display">\[n\geq \frac{3800\cdot 0.25}{\left(\frac{0.02}{1.96}\right)^2 3799+0.25}=1471.58.\]</span></p>
<p>Du kan även testa dig fram i R, enligt tidigare uppgifter.</p>
<ul>
<li>Svar: För att uppnå precisionskravet behövs ett stickprov med minst 1472 medlemmar. Kontroll av CGS: <span class="math inline">\(np(1-p)=386 &gt; 5\)</span> så antagandet är uppfyllt.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<p>Beräkna nödvändig stickprovsstorlek <span class="math inline">\(n\)</span> om ett 95 % konfidensintervall för andelen i populationen får vara max 3 procentenheter brett. Vi vet populationsstorleken och använder ändlighetskorrektion. <span class="math inline">\(V(p)=\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}\)</span>. Vi vet inte populationsandelen men utgår från att den är <span class="math inline">\(p=0,5\)</span> vilket ger störst varians. Vi antar att <span class="math inline">\(np(1-p)&gt;5\)</span> för att CGS ska gälla men måste kontrollera om det stämmer i slutet av uppgiften.
Längden för ett 95% konfidensintervall för <span class="math inline">\(p\)</span> ges av</p>
<p><span class="math display">\[2\cdot z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}}\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0.025}=1.96\)</span>. Vi sätter in värden givet precisionskravet
<span class="math display">\[0,03 \geq 2\cdot 1.96\sqrt{\left(\frac{3800-n}{3799}\right)\frac{0.25}{n}}.\]</span></p>
<p>På motsvarande sätt som i a) löser vi ut  och landar på</p>
<p><span class="math display">\[n \geq \frac{3800 \cdot 0.25}{\left(\frac{0.03}{2\cdot 1.96}\right)^23799+0.25}=2010.56.\]</span></p>
<p>Vi kan även testa oss fram i R motsvarande som i tidigare uppgifter.</p>
<ul>
<li>Svar: För att uppnå precisionskravet behövs ett stickprov på minst 2011 medlemmar.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.10" class="section level3 unnumbered">
<h3>Övning 7.10</h3>
<p>En forskare ville undersöka genomsnittlig IQ bland studenterna som går en kurs i statistik. På kursen går 70 studenter och forskaren drog ett OSU-UÅ bestående av 11 studenter fick genomföra ett IQ-test. Resultatet av testet blev:</p>
<p>98 121 124 105 104 102 102 128 96 92 94.</p>
<ul>
<li>Skatta medelfelet. Tolka medelfelet! Reflekta över förutsättningarna.</li>
</ul>
<button title="q710" type="button" onclick="if(document.getElementById(&#39;q710&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q710&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q710&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q710" style="display:none">
<div class="alert alert-info">
<ul>
<li><p>Mål: Skatta medelfelet för genomsnittlig IQ bland studenterna.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = genomsnittlig IQ för de 70 studenterna på kursen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = genomsnittlig IQ för de 11 studenterna i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N = 70\)</span>. Urvalsstorlek: <span class="math inline">\(n = 11\)</span>. Vi använder ändlighetskorrektion varpå <span class="math inline">\(V(\bar{x})\)</span> skattas med <span class="math inline">\(\hat{V}(\bar{x})=\left(1-\frac{n}{N}\right)\frac{s^2}{n}\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Medelfelet ges av</li>
</ul>
<p><span class="math display">\[SE(\bar{x})=\sqrt{\hat{V}(\bar{x})}=\sqrt{\left(1-\frac{n}{N}\right)\frac{s^2}{n}}.\]</span>
Vi gör beräkningar i R:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" title="1"><span class="co"># Töm minne</span></a>
<a class="sourceLine" id="cb379-2" title="2"> <span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb379-3" title="3"><span class="co"># Läs in data och nödvändiga parametrar</span></a>
<a class="sourceLine" id="cb379-4" title="4"> iq &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">98</span>, <span class="dv">121</span>, <span class="dv">124</span>, <span class="dv">105</span>, <span class="dv">104</span>, <span class="dv">102</span>, <span class="dv">102</span>, <span class="dv">128</span>, <span class="dv">96</span>, <span class="dv">92</span>, <span class="dv">94</span>)</a>
<a class="sourceLine" id="cb379-5" title="5"> N &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb379-6" title="6"> n &lt;-<span class="st"> </span><span class="dv">11</span></a>
<a class="sourceLine" id="cb379-7" title="7"><span class="co"># Beräkna medelfel</span></a>
<a class="sourceLine" id="cb379-8" title="8"> s2 &lt;-<span class="st"> </span><span class="kw">var</span>(iq)</a>
<a class="sourceLine" id="cb379-9" title="9"> vhatxbar &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>s2<span class="op">/</span>n</a>
<a class="sourceLine" id="cb379-10" title="10"> medelfel &lt;-<span class="st"> </span><span class="kw">sqrt</span>(vhatxbar)</a>
<a class="sourceLine" id="cb379-11" title="11"> medelfel</a></code></pre></div>
<pre><code>## [1] 3.472826</code></pre>
<ul>
<li>Svar: Medelfelet är 3.47 vilket är den skattade standardavvikelsen i stickprovsmedelvärdets samplingfördelning.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.11" class="section level3 unnumbered">
<h3>Övning 7.11</h3>
<p>En forskare ville undersöka genomsnittlig IQ bland studenterna som går en kurs i statistik. På kursen går 70 studenter och forskaren drog ett OSU-UÅ bestående av 11 studenter som fick genomföra ett IQ-test. IQ anses följa normalfördelning och är konstruerat så att standardavvikelsen är 15 (dvs den anses känd). Resultatet av testet blev:</p>
<p>98 121 124 105 104 102 102 128 96 92 94.</p>
<ul>
<li>Beräkna ett 90% konfidensintervall för genomsnittlig IQ i bland studenterna på kursen. Var noga med förutsättningar! Tolka intervallet!</li>
</ul>
<button title="q711" type="button" onclick="if(document.getElementById(&#39;q711&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q711&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q711&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q711" style="display:none">
<div class="alert alert-info">
<ul>
<li><p>Mål: Med ett 90% konfidensintervall skatta genomsnittlig IQ bland studenterna på kursen.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = genomsnittlig IQ för de 70 studenterna på kursen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = genomsnittlig IQ för de 11 studenterna i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 70. Urvalsstorlek: <span class="math inline">\(n\)</span> = 11. Vi använder ändlighetskorrektion och känner populationsstandardavvikelsen varpå <span class="math inline">\(V(\bar{x})=\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}\)</span>.</li>
<li>Vi är givna i uppgiften att IQ anses följa en normalfördelning.</li>
</ol>
<ul>
<li>Beräkning: Ett 90% konfidensintervall för <span class="math inline">\(\mu\)</span> ges av</li>
</ul>
<p><span class="math display">\[\bar{x}\pm z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,6449\)</span> och <span class="math inline">\(\bar{x}=106\)</span>. Insättning av värden i R ger:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" title="1"><span class="co"># Samma data som i uppg 118. I detta fall känner vi till populationsstandardavvikelsen och # #behöver därför ingen variansskattning.</span></a>
<a class="sourceLine" id="cb381-2" title="2"><span class="co"># Töm minne</span></a>
<a class="sourceLine" id="cb381-3" title="3"> <span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb381-4" title="4"><span class="co"># Läs in data och nödvändiga konstanter</span></a>
<a class="sourceLine" id="cb381-5" title="5"> iq &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">98</span>, <span class="dv">121</span>, <span class="dv">124</span>, <span class="dv">105</span>, <span class="dv">104</span>, <span class="dv">102</span>, <span class="dv">102</span>, <span class="dv">128</span>, <span class="dv">96</span>, <span class="dv">92</span>, <span class="dv">94</span>)</a>
<a class="sourceLine" id="cb381-6" title="6"> N &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb381-7" title="7"> n &lt;-<span class="st"> </span><span class="dv">11</span></a>
<a class="sourceLine" id="cb381-8" title="8"> sigma2 &lt;-<span class="st"> </span><span class="dv">15</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb381-9" title="9"><span class="co"># Skattningar</span></a>
<a class="sourceLine" id="cb381-10" title="10"> xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(iq)</a>
<a class="sourceLine" id="cb381-11" title="11"> s2 &lt;-<span class="st"> </span><span class="kw">var</span>(iq)</a>
<a class="sourceLine" id="cb381-12" title="12"> vxbar &lt;-<span class="st"> </span>((N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))<span class="op">*</span>sigma2<span class="op">/</span>n</a>
<a class="sourceLine" id="cb381-13" title="13"> alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb381-14" title="14"> z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb381-15" title="15"> ll &lt;-<span class="st"> </span>xbar <span class="op">-</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vxbar)</a>
<a class="sourceLine" id="cb381-16" title="16"> ul &lt;-<span class="st"> </span>xbar <span class="op">+</span><span class="st"> </span>z_alpha<span class="op">*</span><span class="kw">sqrt</span>(vxbar)</a>
<a class="sourceLine" id="cb381-17" title="17"> resultat &lt;-<span class="st"> </span><span class="kw">c</span>(xbar, ll, ul)</a>
<a class="sourceLine" id="cb381-18" title="18"> resultat</a></code></pre></div>
<pre><code>## [1] 106.00000  99.12103 112.87897</code></pre>
<ul>
<li>Svar: Med 90% säkerhet täcker intervallet 99 till 113 genomsnittlig IQ för studenterna på kursen.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.12" class="section level3 unnumbered">
<h3>Övning 7.12</h3>
<p>En barnmorska arbetar på en vårdcentral som har ett visst patientunderlag. Hon ville jämföra om nyfödda barns födelsevikt vid vårdcentralen är mindre än genomsnittsvikten i Sverige som är 3600 gram för pojkar. Hon valde med OSU-UÅ ut 20 pojkar av de totalt 190 spädbarn som var listade vid vårdcentralen. Hon frågade därefter föräldarna om godkännande och tittade sedan i barnens journaler. Födelsevikt kan betraktas som normalfördelad variabel. Följande födelsevikter erhölls:</p>
<p>3017 3523 2609 2518 2556 2659 3103 2657 3272 4153 3729 3711 3223 2668 3042 3545 3530 2209 2470</p>
<ul>
<li>Genomför en hypotesprövning på 5-procentsnivån för att undersöka om barnmorskan har belägg för sin misstanke.</li>
</ul>
<button title="q712" type="button" onclick="if(document.getElementById(&#39;q712&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q712&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q712&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q712" style="display:none">
<div class="alert alert-info">
<ul>
<li><p>Mål: Testa om nyfödda barns födelsevikt vid kliniken i genomsnitt är mindre än medelvikten i Sverige som är 3600 gram.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = medelvikten bland nyfödda i Sverige.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = medelvikten i stickprovet.</p></li>
<li><p>Hypoteser: <span class="math inline">\(H: \mu_0=3600\)</span> versus <span class="math inline">\(H_1: \mu&lt;3600\)</span></p></li>
<li><p>Signifikansnivå: <span class="math inline">\(\alpha=0.05\)</span>.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 190. Urvalsstorlek: <span class="math inline">\(n\)</span> = 20. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> och vi inte vet populationsstandardavvikelsen skattas <span class="math inline">\(V(\bar{x})\)</span> med <span class="math inline">\(\hat{V}(\bar{x})=\left(1-\frac{n}{N}\right)\frac{s^2}{n}\)</span>.</li>
<li>Vi är givna i uppgiften att födelsevikten kan betraktas som normalförderdelad.</li>
</ol>
<ul>
<li>Testfunktion:</li>
</ul>
<p><span class="math display">\[Z=\frac{\bar{x}-\mu_0}{\sqrt{\hat{V}(\bar{x})}}\]</span></p>
<p>som är approximativt <span class="math inline">\(N(0;1)\)</span> när nollhypotesen är sann.</p>
<ul>
<li><p>Beslutsregel: Vi har en ensidig mothypotes vilket ger <span class="math inline">\(z_{\alpha}=z_{0,05}=1,6449\)</span> så vi förkastar nollhypotesen om <span class="math inline">\(Z_{obs}&lt;-z_{0,05}=-1,6449\)</span>.</p></li>
<li><p>Beräkning: Först sammanställer vi data.</p></li>
</ul>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1"><span class="co"># Töm minnet</span></a>
<a class="sourceLine" id="cb383-2" title="2"> <span class="kw">rm</span>(<span class="dt">list =</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb383-3" title="3"> gram &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3017</span>, <span class="dv">3523</span>, <span class="dv">2609</span>, <span class="dv">2518</span>, <span class="dv">2556</span>, <span class="dv">2659</span>, <span class="dv">3103</span>, <span class="dv">2657</span>, <span class="dv">3272</span>, <span class="dv">4153</span>, <span class="dv">3729</span>, <span class="dv">3711</span>, <span class="dv">3223</span>,                   <span class="dv">2668</span>, <span class="dv">3042</span>, <span class="dv">3545</span>, <span class="dv">3530</span>, <span class="dv">2209</span>, <span class="dv">2470</span>, <span class="dv">3120</span>)</a>
<a class="sourceLine" id="cb383-4" title="4"> N =<span class="st"> </span><span class="dv">190</span></a>
<a class="sourceLine" id="cb383-5" title="5"> n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb383-6" title="6"> mu0 &lt;-<span class="st"> </span><span class="dv">3600</span></a>
<a class="sourceLine" id="cb383-7" title="7"><span class="co"># Skattningar </span></a>
<a class="sourceLine" id="cb383-8" title="8"> xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(gram)</a>
<a class="sourceLine" id="cb383-9" title="9"> s2 &lt;-<span class="st"> </span><span class="kw">var</span>(gram)</a>
<a class="sourceLine" id="cb383-10" title="10"> vhatxbar &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(n<span class="op">/</span>N))<span class="op">*</span>(s2<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb383-11" title="11"><span class="co"># Test </span></a>
<a class="sourceLine" id="cb383-12" title="12"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb383-13" title="13"> tobs &lt;-<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span>mu0)<span class="op">/</span><span class="kw">sqrt</span>(vhatxbar)</a>
<a class="sourceLine" id="cb383-14" title="14"> p_value &lt;-<span class="st"> </span><span class="kw">pt</span>(tobs, n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb383-15" title="15"> p_value</a></code></pre></div>
<pre><code>## [1] 5.336026e-05</code></pre>
<p>Medelvikten bland vårdcentralen är 534.3 lägre än genomsnittvikten i Sverige (<span class="math inline">\(p\leq 0.001\)</span>).</p>
<ul>
<li>Svar: Vi kan på 5% signifikansnivå påvisa att födelsevikten på kliniken är mindre än genomsnittet i Sverige. Urvalet är ett OSU-UÅ, vilket gör att punktskattningen och variansskattningen är väntevärdesriktiga. Dock är urvalet litet. Därför måste vi förlita oss på att variabeln födelsevikt är normalfördelad i populationen för att kunna göra testet. Eftersom populationsvariansen är okänd används <span class="math inline">\(t\)</span>-fördelningen.</li>
</ul>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.13" class="section level3 unnumbered">
<h3>Övning 7.13</h3>
<p>(Baserad på Mendelhall et al. (1996)) Vi vill undersöka situationen i tillverkningsindustrin
genom att få en preliminär uppfattning om antalet anställda ett
visst år. Anta att tillverkningsindustrin kan delas upp i 80 kategorier. Från
en lista med olika typer av tillverkningsindustrier gör vi därför ett systematiskt
urval, där var femte industri väljs. Genom att undersöka de valda industrierna
erhålls följande resultat:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1"><span class="co"># anställda 1987 (1000-tals)</span></a>
<a class="sourceLine" id="cb385-2" title="2"> data1987 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">72.4</span>, <span class="fl">45.4</span>, <span class="fl">57.9</span>, <span class="fl">129.1</span>, <span class="dv">110</span>, <span class="fl">53.2</span>, <span class="fl">31.7</span>, <span class="fl">16.1</span>, <span class="fl">384.7</span>, <span class="fl">80.9</span>, <span class="dv">64</span>, <span class="fl">151.9</span>, <span class="fl">112.3</span>,                  <span class="fl">389.1</span>, <span class="fl">166.7</span>, <span class="fl">88.9</span>)</a>
<a class="sourceLine" id="cb385-3" title="3"> <span class="co"># anställda 1997 (1000-tals)</span></a>
<a class="sourceLine" id="cb385-4" title="4"> data1991 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">65.5</span>, <span class="fl">49.3</span>, <span class="fl">54.7</span>, <span class="fl">130.3</span>, <span class="fl">110.6</span>, <span class="fl">46.3</span>, <span class="fl">36.6</span>, <span class="fl">16.4</span>, <span class="fl">388.9</span>, <span class="dv">77</span>, <span class="fl">56.3</span>, <span class="dv">126</span>, <span class="fl">94.1</span>,                   <span class="fl">369.9</span>, <span class="fl">135.8</span>, <span class="dv">78</span>)</a>
<a class="sourceLine" id="cb385-5" title="5"><span class="co"># tot. antal kategorier</span></a>
<a class="sourceLine" id="cb385-6" title="6"> N &lt;-<span class="st"> </span><span class="dv">80</span></a></code></pre></div>
<ul>
<li>Skatta den genomsnittliga förändringen i antalet anställda mellan 1987 och 1991. Beräkna felmarginalen.</li>
</ul>
<button title="q713" type="button" onclick="if(document.getElementById(&#39;q713&#39;) .style.display==&#39;none&#39;)
              {document.getElementById(&#39;q713&#39;) .style.display=&#39;&#39;}
            else{document.getElementById(&#39;q713&#39;) .style.display=&#39;none&#39;}">
Visa svar
</button>
<div id="q713" style="display:none">
<div class="alert alert-info">
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb386-1" title="1"> n &lt;-<span class="st"> </span><span class="dv">16</span></a>
<a class="sourceLine" id="cb386-2" title="2"> diffs &lt;-<span class="st"> </span>data1991 <span class="op">-</span><span class="st"> </span>data1987</a>
<a class="sourceLine" id="cb386-3" title="3"> xbar_diff &lt;-<span class="st"> </span><span class="kw">mean</span>(diffs)</a>
<a class="sourceLine" id="cb386-4" title="4"> s2 &lt;-<span class="st"> </span><span class="kw">var</span>(diffs)</a>
<a class="sourceLine" id="cb386-5" title="5"> vhatxbar_diff &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>n<span class="op">/</span>N)<span class="op">*</span>s2<span class="op">/</span>n</a>
<a class="sourceLine" id="cb386-6" title="6"> alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb386-7" title="7"> t_alpha  &lt;-<span class="st"> </span><span class="kw">qt</span>((<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>), <span class="dt">df =</span> (n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb386-8" title="8"> t_alpha<span class="op">*</span><span class="kw">sqrt</span>(vhatxbar_diff) </a></code></pre></div>
<pre><code>## [1] 5.226613</code></pre>
</div>
</div>
<p></br></p>
</div>
<div id="övning-7.14" class="section level3 unnumbered">
<h3>Övning 7.14</h3>
<p>En undersökning i USA vill undersöka andelen positiva till dödsstraff. Tidigare
studier visar att ungefär 60% i USA är positiva.</p>
<ol style="list-style-type: lower-alpha">
<li>Vilken stickprovsstorlek behövs vid ett OSU för att vi med 90% konfidensgrad ska ha som mest 3 procents felmarginal för andelen positiva?</li>
</ol>
<ul>
<li><p>Mål: Beräkna nödvändig stickprovsstorlek för ett 90% konfidensintervall för andelen positiva till dödsstraff i USA där felmarginalen får vara max tre procentenheter.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen positiva i USA.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}\)</span> = andelen positiva i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU ger att <span class="math inline">\(E(\hat{p})=p\)</span>.</li>
<li>Vi vet inte populationsstorleken men har en uppfattning om andelen i populationen. Därför skattas <span class="math inline">\(V(p)\)</span> med <span class="math inline">\(V(\hat{p})=\frac{p(1-p)}{n}\)</span>.</li>
<li>Vi utgår från att <span class="math inline">\(np(1-p)&gt;5\)</span> för att CGS ska gälla men måste kontrollera om antagandet är uppfyllt på slutet.</li>
</ol>
<ul>
<li>Beräkning: Felmarginalen ges av</li>
</ul>
<p><span class="math display">\[z_{\alpha/2}\sqrt{\frac{p(1-p)}{n}}\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,6449\)</span>. Vi sätter in värden.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb388-1" title="1"><span class="co"># vi har en stor population och kan approximera situationen som ett OSU-MÅ. Det går att ändra värdena på n för att se vilket n som ger vår önskade minsta stickprovsstorlek. Vi vill att uttrycket nedan ska vara lika med eller mindre än 0.03.</span></a>
<a class="sourceLine" id="cb388-2" title="2"></a>
<a class="sourceLine" id="cb388-3" title="3">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb388-4" title="4"></a>
<a class="sourceLine" id="cb388-5" title="5">p &lt;-<span class="st"> </span><span class="fl">0.6</span></a>
<a class="sourceLine" id="cb388-6" title="6"></a>
<a class="sourceLine" id="cb388-7" title="7">z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb388-8" title="8"></a>
<a class="sourceLine" id="cb388-9" title="9"></a>
<a class="sourceLine" id="cb388-10" title="10">z <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(  ( p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p) ) <span class="op">/</span><span class="st"> </span>n   )</a></code></pre></div>
<pre><code>## [1] 0.1801847</code></pre>
<ul>
<li>Svar: För att uppnå precisionskraven behövs ett stickprov på minst 722 individer. Kontroll av CGS: <span class="math inline">\(np(1-p)=173&gt;5\)</span> så antagandet är uppfyllt.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Anta nu att vill nu undersöka andelen positiva i den lilla staden Sigmaville med 3800 invånare där tidigare undersökningar också visat att andelen positiva är 60%. Vilken stickprovsstorlek behövs nu vid ett OSU för att vi med 90% konfidensgrad ska ha som mest 3 procents felmarginal för andelen positiva? Jämför med ovanstående undersökning med undersökningen för USA. Vad kan vi konstatera vad gäller betydelsen av populationens storlek för stickprovsstorleken?</li>
</ol>
<ul>
<li><p>Mål: Beräkna nödvändig stickprovsstorlek för ett 90% konfidensintervall för andelen positiva till dödsstraff i USA där felmarginalen får vara max tre procentenheter.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen positiva i USA.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}\)</span> = andelen positiva i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU ger att <span class="math inline">\(E(\hat{p})=p\)</span>.</li>
<li>Vi vet populationsstorleken och har en uppfattning om andelen i populationen. Därför skattas <span class="math inline">\(V(p)\)</span> mzed <span class="math inline">\(V(\hat{p})=\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}\)</span>.</li>
<li>Vi utgår från att <span class="math inline">\(np(1-p)&gt;5\)</span> för att CGS ska gälla men måste kontrollera om antagandet är uppfyllt på slutet.</li>
</ol>
<ul>
<li>Beräkning: Vi gör samma sak som i (a) men med ändlighetskorrektion. Felmarginalen för <span class="math inline">\(p\)</span> ges av</li>
</ul>
<p><span class="math display">\[ z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}}\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,6449\)</span>. Vi sätter in värden:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb390-1" title="1"><span class="co"># vi har OSU-UÅ. Det går att ändra värdena på n för att se vilket n som ger vår önskade minsta stickprovsstorlek. Vi vill att uttrycket nedan ska vara lika med eller mindre än 0.03.</span></a>
<a class="sourceLine" id="cb390-2" title="2"></a>
<a class="sourceLine" id="cb390-3" title="3">N &lt;-<span class="st"> </span><span class="dv">3800</span></a>
<a class="sourceLine" id="cb390-4" title="4"></a>
<a class="sourceLine" id="cb390-5" title="5">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb390-6" title="6"></a>
<a class="sourceLine" id="cb390-7" title="7">p &lt;-<span class="st"> </span><span class="fl">0.6</span></a>
<a class="sourceLine" id="cb390-8" title="8"></a>
<a class="sourceLine" id="cb390-9" title="9">z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb390-10" title="10"></a>
<a class="sourceLine" id="cb390-11" title="11"></a>
<a class="sourceLine" id="cb390-12" title="12">z <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>( ( (N <span class="op">-</span><span class="st"> </span>n)<span class="op">/</span>(N<span class="dv">-1</span>) ) <span class="op">*</span><span class="st"> </span>( p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p) ) <span class="op">/</span><span class="st"> </span>n   )</a></code></pre></div>
<pre><code>## [1] 0.05546698</code></pre>
<ul>
<li>Svar: När vi vet och tar hänsyn till populationsstorleken behövs ett stickprov på minst 607 individer för att uppnå precisionskraven. Kontroll för CGS: <span class="math inline">\(np(1-p)=146&gt;5\)</span> alltså är antagandet uppfyllt.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Anta nu att en undersökare i en helt annan undersökning är intresserad av att skatta den totala vikten bland kalvar som fått en ny sorts foder. Totalt finns det <span class="math inline">\(N = 1000\)</span> kalvar, men att väga varenda kalv skulle ta för mycket tid. Därför dras ett stickprov bestående av <span class="math inline">\(n\)</span> kalvar, där felmarginalen med konfidensgraden 95% får vara som mest 20 kg. Från tidigare studier vet vi att populationsvariansen är <span class="math inline">\(\sigma^2 = 900\)</span>. Hur stort ska stickprovet vara? Observera: Använd inte formlerna för beräkning av stickprovsstorlekar i formelsamlingen för att lösa uppgiften. Försök att antingen lösa ut stickprovsstorleken algebraiskt eller finn <span class="math inline">\(n\)</span> numeriskt genom att prova er fram på miniräknaren.</li>
</ol>
<ul>
<li><p>Mål: Beräkna hur stort stickprov som behövs när konfidensgraden är 95% och felmarginalen får vara max 20 kg.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau=N\mu\)</span> = den totala vikten bland kalvarna i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}=N\bar{x}\)</span> = den totala vikten bland kalvarna i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E(\hat{\tau})=NE(\bar{x})=N\mu=\tau\)</span>.</li>
<li>Vi känner populationsstorleken och populationsvariansen så <span class="math inline">\(V(\tau)\)</span> skattas med <span class="math inline">\(V(\hat{\tau})=N^2V(\bar{x})=N^2\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}\)</span>.</li>
<li>Vi utgår från att vikten är normalfördelad och resultatet bygger på antagandet.</li>
</ol>
<ul>
<li>Beräkning: Den statistiska felmarginalen ges av</li>
</ul>
<p><span class="math display">\[z_{\alpha/2}\sqrt{\left(\frac{N-n}{N-1}\right)\frac{\sigma^2}{n}}.\]</span></p>
<p>där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Vi sätter in värden:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb392-1" title="1"><span class="co"># Testa dig fram genom att ändra på n.</span></a>
<a class="sourceLine" id="cb392-2" title="2"></a>
<a class="sourceLine" id="cb392-3" title="3">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb392-4" title="4"></a>
<a class="sourceLine" id="cb392-5" title="5">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb392-6" title="6"></a>
<a class="sourceLine" id="cb392-7" title="7">sigma2 &lt;-<span class="st"> </span><span class="dv">900</span></a>
<a class="sourceLine" id="cb392-8" title="8"></a>
<a class="sourceLine" id="cb392-9" title="9">maxbredd &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb392-10" title="10"></a>
<a class="sourceLine" id="cb392-11" title="11">z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb392-12" title="12"></a>
<a class="sourceLine" id="cb392-13" title="13"></a>
<a class="sourceLine" id="cb392-14" title="14">z <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>( ((N<span class="op">-</span>n)<span class="op">/</span>(N<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>(sigma2<span class="op">/</span>n)   )</a></code></pre></div>
<pre><code>## [1] 13.02221</code></pre>
<ul>
<li>Svar: Med konfidensgraden 95% är den minsta stickprovsstorleken som ger en felmarginal på max 20 kg <span class="math inline">\(n=9\)</span>, givet att vikten är normalfördelad.</li>
</ul>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb394-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.15" class="section level3 unnumbered">
<h3>Övning 7.15</h3>
<p>En population består av 6000 företag. Ett företag är intresserat av att uppskatta medelvärdet och totalen i populationen. Företagen delades in i tre strata efter storlek. Ur populationen drogs sedan ett proportionellt stratifierat urval om sammanlagt 600 företag. Tabell 1 presenterar en sammanställning från undersökningen.</p>
<table>
<thead>
<tr class="header">
<th>Stratum</th>
<th><span class="math inline">\(N_j\)</span></th>
<th><span class="math inline">\(\bar{x}_j\)</span></th>
<th><span class="math inline">\(s_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Små företag</td>
<td>4000</td>
<td>50</td>
<td>5</td>
</tr>
<tr class="even">
<td>Medelstora företag</td>
<td>1700</td>
<td>100</td>
<td>12</td>
</tr>
<tr class="odd">
<td>Stora företag</td>
<td>300</td>
<td>1000</td>
<td>90</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett 95% konfidensintervall för medelvärdet i populationen.</li>
</ol>
<ul>
<li><p>Mål: Beräkna ett 95% konfidensintervall för medelvärdet i populationen.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = medelvärdet i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^{K}\frac{N_j}{N}\bar{x}_j\)</span> = medelvärdet i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi förutsätter att företagen i respektive stratum har dragits genom OSU har vi <span class="math inline">\(E(\bar{x}_{st})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 6000. Urvalsstorlek: $n = 600. <span class="math inline">\(\frac{n}{N}=0,1\)</span> men eftersom vi vet populationsstorleken använder vi ändlighetskorrektion. <span class="math inline">\(V(\bar{x}_{st})\)</span> skattas därför med <span class="math inline">\(\hat{V}(\bar{x}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Populationsfördelningen är okänd men vi har ett stort stickprov och kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Ett 95% konfidensintervall för medelvärdet i populationen ges av</li>
</ul>
<p><span class="math display">\[\bar{x}_{st}\pm z_{\alpha/2}\sqrt{\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Stratumstorlekarna erhålls genom att multiplicera den totala stickprovsstorleken med respektive populationsproportion. Små företag: 400, medelstora företag: 170, stora företag: 30. Vi behöver <span class="math inline">\(\bar{x}_{st}\)</span> som ges av
<span class="math display">\[\bar{x}_{st}=\sum_{j=1}^{K}\frac{N_j}{N}\bar{x}_j=\frac{4000}{6000}50+\frac{1700}{6000}100+\frac{300}{6000}1000=111,667,\]</span>
vilket vi också kan ta fram i R.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" title="1"><span class="co"># stratifierat urval. Vi kommer nu att få nytta av R:s förmåga att definiera variabler med flera värden i sig.</span></a>
<a class="sourceLine" id="cb395-2" title="2"><span class="co"># först skapar vi data.</span></a>
<a class="sourceLine" id="cb395-3" title="3"></a>
<a class="sourceLine" id="cb395-4" title="4">Ntot &lt;-<span class="st"> </span><span class="dv">6000</span>   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb395-5" title="5"></a>
<a class="sourceLine" id="cb395-6" title="6">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4000</span>, <span class="dv">1700</span>, <span class="dv">300</span>)  <span class="co"># storlekar på strata. Observera att sum(Nj) = 6000 = Ntot.</span></a>
<a class="sourceLine" id="cb395-7" title="7"></a>
<a class="sourceLine" id="cb395-8" title="8">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">400</span>, <span class="dv">170</span>, <span class="dv">30</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb395-9" title="9"></a>
<a class="sourceLine" id="cb395-10" title="10">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">1000</span>)  <span class="co"># stickprovsmedelvärden per stratum.</span></a>
<a class="sourceLine" id="cb395-11" title="11"></a>
<a class="sourceLine" id="cb395-12" title="12">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">90</span>)  <span class="co"># stickprovsstandardavvikelser per stratum.</span></a>
<a class="sourceLine" id="cb395-13" title="13"></a>
<a class="sourceLine" id="cb395-14" title="14"><span class="co"># beräkning av stickprovsmedelvärde vid stratifierat urval.</span></a>
<a class="sourceLine" id="cb395-15" title="15"></a>
<a class="sourceLine" id="cb395-16" title="16">x.bar.tot &lt;-<span class="st"> </span>(<span class="dv">4000</span><span class="op">/</span><span class="dv">6000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">50</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1700</span><span class="op">/</span><span class="dv">6000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">300</span><span class="op">/</span><span class="dv">6000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb395-17" title="17"></a>
<a class="sourceLine" id="cb395-18" title="18"><span class="co"># alternativt... använd R:s förmåga att hantera värden i variabler i en logisk följd.</span></a>
<a class="sourceLine" id="cb395-19" title="19"></a>
<a class="sourceLine" id="cb395-20" title="20">x.bar.tot &lt;-<span class="st"> </span><span class="kw">sum</span>( (Nj <span class="op">/</span><span class="st"> </span>Ntot) <span class="op">*</span><span class="st"> </span>x.bar.j    )</a></code></pre></div>
<p>Den skattade variansen för <span class="math inline">\(\bar{x}_{st}\)</span> ges av:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" title="1"><span class="co"># beräkning av varians för estimatorn.</span></a>
<a class="sourceLine" id="cb396-2" title="2"></a>
<a class="sourceLine" id="cb396-3" title="3">Var.hat.theta.hat &lt;-<span class="st"> </span>(<span class="dv">4000</span><span class="op">/</span><span class="dv">6000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">400</span><span class="op">/</span><span class="dv">4000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">400</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1700</span><span class="op">/</span><span class="dv">6000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">170</span><span class="op">/</span><span class="dv">1700</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">12</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">170</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">300</span><span class="op">/</span><span class="dv">6000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">30</span><span class="op">/</span><span class="dv">300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb396-4" title="4"></a>
<a class="sourceLine" id="cb396-5" title="5"><span class="co"># alternativt...</span></a>
<a class="sourceLine" id="cb396-6" title="6"></a>
<a class="sourceLine" id="cb396-7" title="7">Var.hat.theta.hat &lt;-<span class="st"> </span><span class="kw">sum</span>(  (Nj <span class="op">/</span><span class="st"> </span>Ntot)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(nj <span class="op">/</span><span class="st"> </span>Nj)   ) <span class="op">*</span><span class="st"> </span>(sj<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>nj))</a></code></pre></div>
<p>Konfidensintervallets gränser ges av:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1">lower.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a>
<a class="sourceLine" id="cb397-2" title="2">upper.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 110,31 till 113,03 medelvärdet i populationen.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Beräkna ett 99% konfidensintervall för totalen i populationen.</li>
</ol>
<ul>
<li><p>Mål: Beräkna ett 99% konfidensintervall för totalen i populationen.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = totalen i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}_{st}=\sum_{j=1}^{K}N_j\bar{x}_j\)</span> = totalen i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi förutsätter att företagen i respektive stratum har dragits genom OSU har vi <span class="math inline">\(E(\hat{\tau}_{st})=\tau\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 6000. Urvalsstorlek: <span class="math inline">\(n\)</span> = 600. <span class="math inline">\(\frac{n}{N}=0,1\)</span> men eftersom vi vet populationsstorleken använder vi ändlighetskorrektion. <span class="math inline">\(V(\tau)\)</span> skattas därför med <span class="math inline">\(\hat{V}(\hat{\tau}_{st})=\sum_{j=1}^{K}N_j^2\hat{V}(\bar{x}_j)=\sum_{j=1}^{K}N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Populationsfördelningen är okänd men vi har ett stort stickprov och kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Stickprovsstotalen ges av:</li>
</ul>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" title="1">tau.est &lt;-<span class="st"> </span><span class="dv">4000</span> <span class="op">*</span><span class="st"> </span><span class="dv">50</span> <span class="op">+</span><span class="st"> </span><span class="dv">1700</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span><span class="dv">300</span> <span class="op">*</span><span class="st"> </span><span class="dv">1000</span></a></code></pre></div>
<p>Den skattade variansen för <span class="math inline">\(\hat{\tau}_{st}\)</span> ges av</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1">Var.hat.theta.hat &lt;-<span class="st"> </span><span class="dv">4000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">400</span><span class="op">/</span><span class="dv">4000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">400</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1700</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">170</span><span class="op">/</span><span class="dv">1700</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">12</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">170</span>) <span class="op">+</span><span class="st"> </span><span class="dv">300</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">30</span><span class="op">/</span><span class="dv">300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">30</span>)</a></code></pre></div>
<p>Ett 99% konfidensintervall för populationstotalen ges av</p>
<p><span class="math display">\[\hat{\tau}_{st}\pm z_{\alpha/2}\sqrt{\sum_{j=1}^{K}N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,005}=2,5758\)</span>. Insättning av värden ger:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" title="1">lower.lim &lt;-<span class="st"> </span>tau.est <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a>
<a class="sourceLine" id="cb400-2" title="2"></a>
<a class="sourceLine" id="cb400-3" title="3">upper.lim &lt;-<span class="st"> </span>tau.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a></code></pre></div>
<ul>
<li>Svar: Med 99% säkerhet täcker intervallet 657146 till 682854 totalen i populationen.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Tror du att man skulle erhålla sämre eller bättre precision om man i stället dragit ett OSU om 600 företag? Motivera ditt svar!</li>
</ol>
<p>Om det finns en skillnad mellan olika strata med avseende på stratifieringsvariabeln ger ett stratifierat urval ofta bättre precision än ett OSU. Ett OSU motsvarar om det inte finns någon skillnad mellan olika strata vad gäller stratifieringsvariabeln. Därför skulle ett OSU antagligen ge sämre precision i det här fallet.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Om du vid en senare tidpunkt skulle genomföra en motsvarande undersökning med ett nytt stickprov om 600 företag ur samma population, skulle du då använda samma allokering som ovan? Om inte, beräkna den allokering som du då anser skulle vara bäst avseende skattningens precision.</li>
</ol>
<p>Eftersom storleken på respektive stratum skiljer sig så pass mycket skulle en lika allokering kunna ge bättre precision. Den proportionella allokeringen ger förhållandevis få stora företag. Med lika allokering skulle variansskattningen i (a) bli</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" title="1">var.lika.allokering.mu &lt;-<span class="st"> </span>(<span class="dv">4000</span><span class="op">/</span><span class="dv">6000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">4000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1700</span><span class="op">/</span><span class="dv">6000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">1700</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">12</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">300</span><span class="op">/</span><span class="dv">6000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>)   <span class="co"># denna varians är mindre än den vid prop. allokering.</span></a></code></pre></div>
<p>vilket är betydligt mindre än variansskattningen vid proportionell allokering som var 0,6937. Den skattade variansen i (b) skulle bli</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb402-1" title="1">var.lika.allokering.tau &lt;-<span class="st"> </span><span class="dv">4000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">4000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1700</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">1700</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">12</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>) <span class="op">+</span><span class="st"> </span><span class="dv">300</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>)</a></code></pre></div>
<p>som också är betydligt mindre än den skattade variansen vid proportionell allokering som var 24903200. Alltså ger lika allokering högre precision i det här fallet.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.16" class="section level3 unnumbered">
<h3>Övning 7.16</h3>
<p>Ett försäljningsdistrikt omfattade <span class="math inline">\(20\,000\)</span> hushåll i tätortsbebyggelsen och <span class="math inline">\(10\,000\)</span> från landsbygden. Till en marknadsundersökning drogs med ett OSU utan återläggning 250 hushåll från tätortsbebyggelsen. På samma sätt drogs från landsbygdshushållen 200 hushåll. Man studerade bl a hushållens konsumtion av en viss förbrukningsartikel under den senaste månaden. Resultaten från undersökningen återges i tabellen nedan.</p>
<table>
<thead>
<tr class="header">
<th>Stadsdel</th>
<th><span class="math inline">\(n_j\)</span></th>
<th><span class="math inline">\(\bar{x}_j\)</span></th>
<th><span class="math inline">\(s_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hushåll i tätortsbebyggelse</td>
<td>250</td>
<td>190 kr</td>
<td>90</td>
</tr>
<tr class="even">
<td>Landsbygdshushåll</td>
<td>200</td>
<td>150 kr</td>
<td>30</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett 95% konfidensintervall för den genomsnittliga förbrukningen per hushåll i populationen.</li>
</ol>
<ul>
<li><p>Mål: Skatta den genomsnittliga förbrukningen per hushåll av en viss artikel med 95% konfidens.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = den genomsnittliga förbrukningen i försäljningsdistriktet.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^K\frac{N_j}{N}\bar{x}_j\)</span> = den genomsnittliga förbrukningen bland de 450 hushållen i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU ger att <span class="math inline">\(E(\bar{x}_{st})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 30000. Urvalsstorlek: <span class="math inline">\(n\)</span> = 450. <span class="math inline">\(\frac{n}{N}&lt;0,1\)</span> men eftersom vi vet populationsstorleken använder vi ändlighetskorrektion. Vi känner inte populationsfördelningen så <span class="math inline">\(V(\bar{x}_{st})\)</span> skattas med <span class="math inline">\(\hat{V}(\bar{x}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Stickprovet är stort så vi kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Stickprovsmedelvärdet ges av</li>
</ul>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb404-1" title="1"><span class="co"># först skapar vi data.</span></a>
<a class="sourceLine" id="cb404-2" title="2"></a>
<a class="sourceLine" id="cb404-3" title="3">Ntot &lt;-<span class="st"> </span><span class="dv">30000</span>   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb404-4" title="4"></a>
<a class="sourceLine" id="cb404-5" title="5">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20000</span>, <span class="dv">10000</span>)  <span class="co"># storlekar på strata. Observera att sum(Nj) = 6000 = Ntot.</span></a>
<a class="sourceLine" id="cb404-6" title="6"></a>
<a class="sourceLine" id="cb404-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">250</span>, <span class="dv">200</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb404-8" title="8"></a>
<a class="sourceLine" id="cb404-9" title="9">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">190</span>, <span class="dv">150</span>)  <span class="co"># stickprovsmedelvärden per stratum.</span></a>
<a class="sourceLine" id="cb404-10" title="10"></a>
<a class="sourceLine" id="cb404-11" title="11">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">30</span>)  <span class="co"># stickprovsstandardavvikelser per stratum.</span></a>
<a class="sourceLine" id="cb404-12" title="12"></a>
<a class="sourceLine" id="cb404-13" title="13"><span class="co"># Se uppgift 124 för bekrivningar av steg. Jämförelse med formler i formelsamling för stratifierat urval uppmuntras!</span></a>
<a class="sourceLine" id="cb404-14" title="14"></a>
<a class="sourceLine" id="cb404-15" title="15">x.bar.tot &lt;-<span class="st"> </span>(<span class="dv">20000</span><span class="op">/</span><span class="dv">30000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">190</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">10000</span><span class="op">/</span><span class="dv">30000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">150</span></a></code></pre></div>
<p>Variansskattningen för <span class="math inline">\(\bar{x}_{st}\)</span> ges av</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" title="1">Var.hat.theta.hat.mu &lt;-<span class="st"> </span>(<span class="dv">20000</span><span class="op">/</span><span class="dv">30000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">250</span><span class="op">/</span><span class="dv">20000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">250</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">10000</span><span class="op">/</span><span class="dv">30000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">10000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">30</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>)</a></code></pre></div>
<p>Ett 95% konfidensintervall för medelvärdet i populationen ges av:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb406-1" title="1">lower.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a>
<a class="sourceLine" id="cb406-2" title="2"></a>
<a class="sourceLine" id="cb406-3" title="3">upper.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 169,15 till 184,19 den genomsnittliga konsumtionen i populationen.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Beräkna ett 95% konfidensintervall för den totala förbrukningen i kronor i populationen.</li>
</ol>
<ul>
<li><p>Mål: Skatta den totala förbrukningen i försäljningsdistriktet av en viss artikel med 95% konfidens.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = den totala förbrukningen i försäljningsdistriktet.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}_{st}=\sum_{j=1}^{K}N_j\bar{x}_j\)</span> = den totala förbrukningen i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU ger att <span class="math inline">\(E(\hat{\tau}_{st})=\tau\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 30000. Urvalsstorlek: <span class="math inline">\(n\)</span> = 450. <span class="math inline">\(\frac{n}{N}&lt;0,1\)</span> men eftersom vi vet populationsstorleken använder vi ändlighetskorrektion. Vi känner inte populationsfördelningen och <span class="math inline">\(V(\tau)\)</span> skattas därför med <span class="math inline">\(\hat{V}(\hat{\tau}_{st})=\sum_{j=1}^{K}N_j^2\hat{V}(\bar{x}_j)=\sum_{j=1}^{K}N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Populationsfördelningen är okänd men vi har ett stort stickprov och kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Stickprovstotalen ges av:</li>
</ul>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" title="1">tau.est &lt;-<span class="st"> </span><span class="dv">20000</span> <span class="op">*</span><span class="st"> </span><span class="dv">190</span> <span class="op">+</span><span class="st"> </span><span class="dv">10000</span> <span class="op">*</span><span class="st"> </span><span class="dv">150</span></a></code></pre></div>
<p>Variansskattning:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb408-1" title="1">Var.hat.theta.hat.tau &lt;-<span class="st"> </span><span class="dv">20000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">250</span><span class="op">/</span><span class="dv">20000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">250</span>) <span class="op">+</span><span class="st"> </span><span class="dv">10000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">10000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">30</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>)</a></code></pre></div>
<p>Ett 95% konfidensintervall för den totala förbrukningen ges av</p>
<p><span class="math display">\[\hat{\tau}_{st}\pm z_{\alpha/2}\sqrt{\sum_{j=1}^{K}N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Insättning av värden ger</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" title="1">lower.lim &lt;-<span class="st"> </span>tau.est <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.tau)</a>
<a class="sourceLine" id="cb409-2" title="2"></a>
<a class="sourceLine" id="cb409-3" title="3">upper.lim &lt;-<span class="st"> </span>tau.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.tau)</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 5074481 kronor till 5525519 kronor den totala förbrukningen i försäljningsdistriktet.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Med hjälp av informationen från undersökningen, vilken är din uppfattning om den ursprungliga allokeringen? Hade det, för precisionen i skattningarna, varit lämpligare med en annan allokering?
Låt oss testa med proportionell allokering. Då ska vi ha <span class="math inline">\(n_1\)</span> = 300 och <span class="math inline">\(n_2\)</span> = 150 eftersom vi har fler hushåll i tätortsbebyggelsen än från landsbygden.</li>
</ol>
<p>Vi antar att stickprovsmedelvärden och standradavvikelser inte förändras då vi inte har tillgång till rådata. Då fås följande data:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb410-1" title="1">Ntot &lt;-<span class="st"> </span><span class="dv">30000</span>   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb410-2" title="2"></a>
<a class="sourceLine" id="cb410-3" title="3">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20000</span>, <span class="dv">10000</span>)  <span class="co"># storlekar på strata.</span></a>
<a class="sourceLine" id="cb410-4" title="4"></a>
<a class="sourceLine" id="cb410-5" title="5">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">150</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb410-6" title="6"></a>
<a class="sourceLine" id="cb410-7" title="7">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">190</span>, <span class="dv">150</span>)  <span class="co"># stickprovsmedelvärden per stratum.</span></a>
<a class="sourceLine" id="cb410-8" title="8"></a>
<a class="sourceLine" id="cb410-9" title="9">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">30</span>)  <span class="co"># stickprovsstandardavvikelser per stratum.</span></a></code></pre></div>
<p>Variansen för medelvärdesestimatorn utifrån ett proportionellt urval beräknas. Variansen sjunker!</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" title="1">Var.hat.theta.hat.mu.prop &lt;-<span class="st"> </span>(<span class="dv">20000</span><span class="op">/</span><span class="dv">30000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">300</span><span class="op">/</span><span class="dv">20000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">10000</span><span class="op">/</span><span class="dv">30000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">10000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">30</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">150</span>)</a></code></pre></div>
<p>Variansen för totalestimatorn sjunker också!</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb412-1" title="1">Var.hat.theta.hat.tau.prop &lt;-<span class="st"> </span><span class="dv">20000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">300</span><span class="op">/</span><span class="dv">20000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>) <span class="op">+</span><span class="st"> </span><span class="dv">10000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">10000</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">30</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">150</span>)</a></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.16-1" class="section level3 unnumbered">
<h3>Övning 7.16</h3>
<p>För att få en uppfattning om relativa andelen körkortsinnehavare i ett militärområde i Sverige bestämmer man sig för att göra en intervjuundersökning. Befolkningen inom området indelas i tre strata, med åldern som stratifieringsvariabel. Urvalet sker enligt principen för proportionellt stratifierat urval. Sammanlagt 800 individer intervjuas och resultat presenteras nedan.</p>
<table>
<thead>
<tr class="header">
<th>Åldersgrupp</th>
<th><span class="math inline">\(n_j\)</span></th>
<th><span class="math inline">\(\hat{p}_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>18-34</td>
<td>200</td>
<td>0,5</td>
</tr>
<tr class="even">
<td>35-49</td>
<td>400</td>
<td>0,3</td>
</tr>
<tr class="odd">
<td>50 och över</td>
<td>200</td>
<td>0,1</td>
</tr>
</tbody>
</table>
<p>Kostnaderna för intervjuerna uppgår till 200 kr per individ, dvs 160 000 kr totalt. De administrativa kostnaderna i samband med stratifieringen belöper sig till 6 000 kr.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna hur stor besparing man lyckas uppnå genom proportionellt stratifierat urval i jämförelse med OSU, om man vill ha samma precision i skattningen, dvs samma standardavvikelse (medelfel) för skattningen. Folkmängden i området uppgår till 500 000. Förtydligande: Vid OSU blir det naturligtvis inga stratifieringskostnader. Utgå från att vi antar <span class="math inline">\(p=0.3\)</span> när stickprovsstorlek beräknas med OSU.</li>
</ol>
<ul>
<li><p>Mål: Beräkna hur stor besparing en lyckas uppnå genom proportionellt
stratifierat urval i jämförelse med OSU.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = populationsandelen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}\)</span> = stickprovsandelen.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU ger att <span class="math inline">\(E(\hat{p})=p\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Vi börjar med att beräkna medelfelet utifrån det stratifierade urvalet. Medelfelet för stickprovsandelen ges av</li>
</ul>
<p><span class="math display">\[SE(\hat{p}_{st})=\sqrt{\hat{V}(\hat{p}_{st})}=\sqrt{\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{\hat{p}(1-\hat{p})}{n_j - 1}}.\]</span>
Vi beräknar först variansskattningen:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" title="1"><span class="co"># vi börjar med att sammanställa våra data.</span></a>
<a class="sourceLine" id="cb414-2" title="2"></a>
<a class="sourceLine" id="cb414-3" title="3">Ntot &lt;-<span class="st"> </span><span class="dv">500000</span>   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb414-4" title="4"></a>
<a class="sourceLine" id="cb414-5" title="5">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">125000</span>, <span class="dv">250000</span>, <span class="dv">125000</span>)  <span class="co"># storlekar på strata.</span></a>
<a class="sourceLine" id="cb414-6" title="6"></a>
<a class="sourceLine" id="cb414-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">200</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb414-8" title="8"></a>
<a class="sourceLine" id="cb414-9" title="9">pj.hat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>) <span class="co"># skattade andelar.</span></a>
<a class="sourceLine" id="cb414-10" title="10"></a>
<a class="sourceLine" id="cb414-11" title="11"><span class="co"># vi beräknar sedan variansen för estimatorn vid prop. stratifierat urval.</span></a>
<a class="sourceLine" id="cb414-12" title="12"></a>
<a class="sourceLine" id="cb414-13" title="13">var.hat.theta.hat &lt;-<span class="st"> </span>(<span class="dv">125000</span> <span class="op">/</span><span class="st"> </span><span class="dv">500000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">125000</span>)) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.25</span><span class="op">/</span><span class="dv">199</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">250000</span> <span class="op">/</span><span class="st"> </span><span class="dv">500000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">400</span><span class="op">/</span><span class="dv">250000</span>)) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.21</span><span class="op">/</span><span class="dv">399</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">125000</span> <span class="op">/</span><span class="st"> </span><span class="dv">500000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">125000</span>)) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.09</span><span class="op">/</span><span class="dv">199</span>)</a></code></pre></div>
<p>Medelfelet blir då</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" title="1">se.propstrat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(var.hat.theta.hat)</a></code></pre></div>
<p>Vi beräknar sedan nödvändig stickprovsstorlek vid OSU för att uppnå samma medelfel. Medelfelet för stickprovsandelen vid OSU ges av
<span class="math display">\[SE(\hat{p})=\sqrt{\left(1-\frac{n}{N}\right)\frac{\hat{p}(1-\hat{p})}{n-1}}.\]</span>
Vi sätter in värden enligt precisionskravet och löser ut <span class="math inline">\(n\)</span>: <span class="math display">\[0,0154=\sqrt{\left(1-\frac{n}{500000}\right)\frac{0,3(1-0,3)}{n-1}}\]</span>
<span class="math display">\[0,0154^2(n-1)=\left(1-\frac{n}{500000}\right)0,21\]</span>
<span class="math display">\[n\left(0,0154^2+\frac{1}{500000}0,21\right)=0,21+0,0154^2\]</span>
<span class="math display">\[n=\frac{0,21+0,0154^2}{0,0154^2+\frac{0,21}{500000}}=884,91.\]</span></p>
<p>Vi kan även testa oss fram med R:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb416-1" title="1"><span class="co"># Testa olika värden på n. Som skattning av p använder vi estimatorn för p vid OSU-UÅ.</span></a>
<a class="sourceLine" id="cb416-2" title="2"></a>
<a class="sourceLine" id="cb416-3" title="3">p.hat &lt;-<span class="st"> </span>(<span class="dv">200</span><span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">400</span><span class="op">*</span><span class="fl">0.3</span> <span class="op">+</span><span class="st"> </span><span class="dv">200</span><span class="op">*</span><span class="fl">0.1</span>)<span class="op">/</span><span class="dv">800</span></a>
<a class="sourceLine" id="cb416-4" title="4"></a>
<a class="sourceLine" id="cb416-5" title="5">N &lt;-<span class="st"> </span><span class="dv">500000</span></a>
<a class="sourceLine" id="cb416-6" title="6"></a>
<a class="sourceLine" id="cb416-7" title="7">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb416-8" title="8"></a>
<a class="sourceLine" id="cb416-9" title="9"></a>
<a class="sourceLine" id="cb416-10" title="10"><span class="kw">sqrt</span>( (<span class="dv">1</span><span class="op">-</span>(n<span class="op">/</span>N)) <span class="op">*</span><span class="st"> </span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p.hat) )<span class="op">/</span>(n<span class="dv">-1</span>)  )</a></code></pre></div>
<pre><code>## [1] 0.1051294</code></pre>
<p>Vid OSU behövs alltså ett stickprov på 885 individer vilket ger kostnaden <span class="math inline">\(885\cdot200=177000\)</span> vilket är <span class="math inline">\(177000-166000=11000\)</span> kronor mer än vid stratifierat urval.</p>
<ul>
<li>Svar: Besparingen som uppnås genom att använda stratifierat urval med proportionell allokering jämfört med OSU är 11000 kronor.</li>
</ul>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb418-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.17" class="section level3 unnumbered">
<h3>Övning 7.17</h3>
<p>I en stad där det finns 5000 personer i åldern 20-24 år och 8000 i åldern 25-34 år, uttages genom OSU-UÅ 100 personer ur den första åldersgruppen och på samma sätt 200 personer ur den andra åldersgruppen. Genom intervjuer erhålls uppgifter om antalet inköpta veckotidningar per vecka och utgiften för dessa, vilka presenteras nedan.</p>
<table>
<thead>
<tr class="header">
<th>Antal inköpta veckotidningar</th>
<th>18-24</th>
<th>25-34</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>40</td>
<td>50</td>
</tr>
<tr class="even">
<td>1</td>
<td>25</td>
<td>80</td>
</tr>
<tr class="odd">
<td>2</td>
<td>12</td>
<td>36</td>
</tr>
<tr class="even">
<td>3</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="odd">
<td>4</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="even">
<td>5</td>
<td>5</td>
<td>11</td>
</tr>
<tr class="odd">
<td>6</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="even">
<td>Antal person</td>
<td>100</td>
<td>200</td>
</tr>
<tr class="odd">
<td>Medelutgift i kronor för veckotidningar</td>
<td><span class="math inline">\(\bar{x}=1,20\)</span></td>
<td><span class="math inline">\(\bar{y}=1,60\)</span></td>
</tr>
<tr class="even">
<td>Standardavvikelse för utgiften</td>
<td><span class="math inline">\(s_x=0,6\)</span></td>
<td><span class="math inline">\(s_{y}=0,8\)</span></td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Ange ett punktestimat för det totala antalet veckotidningar som inköps under en vecka av samtliga 13 000 personer i åldern 20-34 år.</li>
</ol>
<ul>
<li><p>Mål: Punktskatta det totala antalet veckotidningar som inköps under en vecka.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = det totala antalet veckotidningar som köps av populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}=N\bar{x}=N\frac{1}{n}\sum_{i=1}^{n}f_ix_i\)</span> = det totala antalet veckotidningar som köps av stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{\tau})=NE(\bar{x})=N\mu=\tau\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Vi börjar med att utöka tabellen</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Tidningar</th>
<th>Individer</th>
<th>Individer <span class="math inline">\(\cdot\)</span> tidningar</th>
<th>Individer <span class="math inline">\(\cdot\)</span> tidningar<span class="math inline">\(^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>90</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>105</td>
<td>105</td>
<td>105</td>
</tr>
<tr class="odd">
<td>2</td>
<td>48</td>
<td>96</td>
<td>192</td>
</tr>
<tr class="even">
<td>3</td>
<td>17</td>
<td>51</td>
<td>153</td>
</tr>
<tr class="odd">
<td>4</td>
<td>9</td>
<td>36</td>
<td>144</td>
</tr>
<tr class="even">
<td>5</td>
<td>16</td>
<td>80</td>
<td>400</td>
</tr>
<tr class="odd">
<td>6</td>
<td>13</td>
<td>78</td>
<td>468</td>
</tr>
<tr class="even">
<td>Summa</td>
<td></td>
<td>446</td>
<td>1462</td>
</tr>
</tbody>
</table>
<p>En punktskattning av populationstotalen ges av:</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" title="1"><span class="co"># vi börjar med att sammanställa data. Först betämmer vi tot. antal invider som köpt ett visst antal tidningar.</span></a>
<a class="sourceLine" id="cb419-2" title="2"></a>
<a class="sourceLine" id="cb419-3" title="3">individer &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">40</span><span class="op">+</span><span class="dv">50</span>, <span class="dv">25</span><span class="op">+</span><span class="dv">80</span>, <span class="dv">12</span><span class="op">+</span><span class="dv">36</span>, <span class="dv">8</span><span class="op">+</span><span class="dv">9</span>, <span class="dv">4</span><span class="op">+</span><span class="dv">5</span>, <span class="dv">5</span><span class="op">+</span><span class="dv">11</span>, <span class="dv">6</span><span class="op">+</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb419-4" title="4"></a>
<a class="sourceLine" id="cb419-5" title="5"><span class="co"># Sedan beräknar vi ett punktestimat för totala antalet inköpta veckotidningar. Vi har ett stickprov på tot. 300 observationer och en tot. populationsstorlek på 13000 individer. Vi börjar med att beräkna &#39;tidningar*individer&#39; för att få fram totala antalet inköpta tidningar.</span></a>
<a class="sourceLine" id="cb419-6" title="6"></a>
<a class="sourceLine" id="cb419-7" title="7">tidningar &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb419-8" title="8"></a>
<a class="sourceLine" id="cb419-9" title="9">individer.tidningar &lt;-<span class="st"> </span><span class="kw">sum</span>(individer <span class="op">*</span><span class="st"> </span>tidningar   )</a>
<a class="sourceLine" id="cb419-10" title="10"></a>
<a class="sourceLine" id="cb419-11" title="11">point.est &lt;-<span class="st"> </span><span class="dv">13000</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">300</span>) <span class="op">*</span><span class="st"> </span>individer.tidningar</a></code></pre></div>
<ul>
<li>Svar: Ett punktestimat för det totala antalet sålda veckotidningar är 19327.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Ange ett 99% KI för totalantalet inköpta veckotidningar i populationen.</li>
</ol>
<ul>
<li><p>Mål: Intervallskatta antalet inköpta veckotidningar i populationen med 99% konfidens.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = det totala antalet veckotidningar som köps av populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}=N\bar{x}=N\frac{1}{n}\sum_{i=1}^{n}f_ix_i\)</span> = det totala antalet veckotidningar som köps av stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{\tau})=NE(\bar{x})=N\mu=\tau\)</span>.</li>
<li>Populationsstorlek:  = 13000. Urvalsstorlek:  = 300. Vi känner populationsstorleken men inte populationsfördelningen varpå <span class="math inline">\(V(\tau)\)</span> skattas med <span class="math inline">\(\hat{V}(\hat{\tau})=N^2\hat{V}(\bar{x})=N^2\left(1-\frac{n}{N}\right)\frac{s^2}{n}\)</span>.</li>
<li>Populationsfördelningen är okänd men vi har ett stort stickprov och kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: För att beräkna stickprovsvariansen krävs att vi först använder R och beräknar ’tidningar*individer^2’.</li>
</ul>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" title="1">individer.tidningar2 &lt;-<span class="st"> </span><span class="kw">sum</span>(individer.tidningar<span class="op">^</span><span class="dv">2</span> )</a></code></pre></div>
<p>Stickprovsvariansen blir:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" title="1">s2 &lt;-<span class="st"> </span>( (individer.tidningar2 <span class="op">-</span><span class="st"> </span>( individer.tidningar2<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span> ) ) <span class="op">/</span><span class="st"> </span>(<span class="dv">300-1</span>)  )</a></code></pre></div>
<p>Den skattade variansen för punktskattningen av det totala antalet sålda tidningar är</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb422-1" title="1">var.hat.theta.hat &lt;-<span class="st"> </span><span class="dv">13000</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">300</span> <span class="op">/</span><span class="st"> </span><span class="dv">13000</span>)) <span class="op">*</span><span class="st"> </span>(s2 <span class="op">/</span><span class="st"> </span><span class="dv">300</span>)</a></code></pre></div>
<p>Ett 99% konfidensintervall för det totala antalet sålda tidningar ges av:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" title="1">lower.lim &lt;-<span class="st"> </span>point.est <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(var.hat.theta.hat)</a></code></pre></div>
<pre><code>## Warning in sqrt(var.hat.theta.hat): NaNs produced</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" title="1">upper.lim &lt;-<span class="st"> </span>point.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(var.hat.theta.hat)</a></code></pre></div>
<pre><code>## Warning in sqrt(var.hat.theta.hat): NaNs produced</code></pre>
<ul>
<li>Svar: Med 99% säkerhet täcker intervallet 16203 till 22451 det totala antalet sålda tidningar.</li>
</ul>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.18" class="section level3 unnumbered">
<h3>Övning 7.18</h3>
<p>En kommun ville undersöka en utgiftspost bland barnen i kommunens skolor. Populationen stratifierades därför utifrån åldersgrupp och sedan drogs ett OSU-UÅ från respektiva stratum. Undersökningen presenteras i tabellen nedan.</p>
<table>
<thead>
<tr class="header">
<th>Skolstadium</th>
<th><span class="math inline">\(N_j\)</span></th>
<th><span class="math inline">\(n_j\)</span></th>
<th><span class="math inline">\(\bar{x}_j\)</span></th>
<th><span class="math inline">\(s_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lågstadium</td>
<td>1300</td>
<td>140</td>
<td>95</td>
<td>28</td>
</tr>
<tr class="even">
<td>Mellanstadium</td>
<td>1800</td>
<td>240</td>
<td>75</td>
<td>22</td>
</tr>
<tr class="odd">
<td>Högstadium</td>
<td>1900</td>
<td>220</td>
<td>63</td>
<td>16</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Punktskatta populationens genomsnittliga utgift i kronor.</li>
</ol>
<ul>
<li><p>Mål: Punktskatta populationens genomsnittliga utgift i kronor.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = den genomsnittliga utgiften i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^K\frac{N_j}{N}\bar{x}_j\)</span> = den genomsnittliga utgiften i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x}_{st})=\mu\)</span>.</li>
</ol>
<ul>
<li>Beräkning: En punktskattning av populationens genomsnittliga utgift ges av:</li>
</ul>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1"><span class="co"># först skapar vi data.</span></a>
<a class="sourceLine" id="cb428-2" title="2"></a>
<a class="sourceLine" id="cb428-3" title="3">Ntot &lt;-<span class="st"> </span><span class="dv">50000</span>   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb428-4" title="4"></a>
<a class="sourceLine" id="cb428-5" title="5">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1300</span>, <span class="dv">1800</span>, <span class="dv">1900</span>)  <span class="co"># storlekar på strata.</span></a>
<a class="sourceLine" id="cb428-6" title="6"></a>
<a class="sourceLine" id="cb428-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">140</span>, <span class="dv">240</span>, <span class="dv">220</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb428-8" title="8"></a>
<a class="sourceLine" id="cb428-9" title="9">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">95</span>, <span class="dv">75</span>, <span class="dv">63</span>)  <span class="co"># stickprovsmedelvärden per stratum.</span></a>
<a class="sourceLine" id="cb428-10" title="10"></a>
<a class="sourceLine" id="cb428-11" title="11">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>, <span class="dv">22</span>, <span class="dv">16</span>)  <span class="co"># stickprovsstandardavvikelser per stratum.</span></a>
<a class="sourceLine" id="cb428-12" title="12"></a>
<a class="sourceLine" id="cb428-13" title="13"><span class="co"># (a) Se uppgift 124 för bekrivningar av steg. Jämförelse med formler i formelsamling för stratifierat urval uppmuntras!</span></a>
<a class="sourceLine" id="cb428-14" title="14"></a>
<a class="sourceLine" id="cb428-15" title="15">x.bar.tot &lt;-<span class="st"> </span>(<span class="dv">1300</span><span class="op">/</span><span class="dv">5000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">95</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1800</span><span class="op">/</span><span class="dv">5000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">75</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1900</span><span class="op">/</span><span class="dv">5000</span>) <span class="op">*</span><span class="st"> </span><span class="dv">63</span></a></code></pre></div>
<ul>
<li>Svar: Punktskattningen av populationens genomsnittliga utgift är 75,64 kronor.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Beräkna den statistiska felmarginalen för skattningen i (a).</li>
</ol>
<ul>
<li><p>Mål: Beräkna den statistiska felmarginalen för punktskattningen av populationens genomsnittliga utgift.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = den genomsnittliga utgiften i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^K\frac{N_j}{N}\bar{x}_j\)</span> = den genomsnittliga utgiften i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x}_{st})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 5000. Urvalsstorlek: <span class="math inline">\(n\)</span> = 600. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\bar{x}_{st})\)</span> med <span class="math inline">\(\hat{V}(\bar{x}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Vi har ett stort stickprov och kan förlita och på CGS.</li>
</ol>
<ul>
<li>Beräkning: Vi skattar först punktskattningens varians som ges av:</li>
</ul>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" title="1">Var.hat.theta.hat.mu &lt;-<span class="st"> </span>(<span class="dv">1300</span><span class="op">/</span><span class="dv">5000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">140</span><span class="op">/</span><span class="dv">1300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">28</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">140</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1800</span><span class="op">/</span><span class="dv">5000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">240</span><span class="op">/</span><span class="dv">1800</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">22</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">240</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1900</span><span class="op">/</span><span class="dv">5000</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">220</span><span class="op">/</span><span class="dv">1900</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">16</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">220</span>)</a></code></pre></div>
<p>Den statistiska felmarginalen för <span class="math inline">\(\bar{x}_{st}\)</span> med 95% konfidens ges av:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1"><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>Var.hat.theta.hat.mu</a></code></pre></div>
<pre><code>## [1] 1.397213</code></pre>
<ul>
<li>Svar: Den statistiska felmarginalen vid 95% konfidens för skattningen i (a) är 1,6549.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Skatta den totala utgiften för samtliga individer i populationen med ett 95% KI.</li>
</ol>
<ul>
<li><p>Mål: Skatta den totala utgiften för samtliga individer i populationen med konfidensgraden 95%.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = den totala utgiften för samtliga individer i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}_{st}=\sum_{j=1}^KN_j\bar{x}_j\)</span> = den totala utgiften för individerna i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{\tau})=NE(\bar{x})=N\mu=\tau\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 5000. Urvalsstorlek: <span class="math inline">\(n\)</span> = 6000. Vi känner populationsstorleken men inte populationsfördelningen varpå <span class="math inline">\(V(\tau)\)</span> skattas med <span class="math inline">\(\hat{V}(\hat{\tau}_{st})=\sum_{j=1}^{K}N_j^2\hat{V}(\bar{x}_j)=\sum_{j=1}^{K}N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Populationsfördelningen är okänd men vi har ett stort stickprov och kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: En punktskattning för den totala utgiften är <span class="math inline">\(\hat{\tau}=N\bar{x}_{st}=5000\cdot75,64=378200\)</span>. Den skattade variansen för punktskattningen ges av:</li>
</ul>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1">point.est &lt;-<span class="st"> </span>Ntot <span class="op">*</span><span class="st"> </span>x.bar.tot</a>
<a class="sourceLine" id="cb432-2" title="2"></a>
<a class="sourceLine" id="cb432-3" title="3"><span class="co"># variansskattning</span></a>
<a class="sourceLine" id="cb432-4" title="4"></a>
<a class="sourceLine" id="cb432-5" title="5">Var.hat.theta.hat.tau &lt;-<span class="st"> </span>(<span class="dv">1300</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">140</span><span class="op">/</span><span class="dv">1300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">28</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">140</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1800</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">240</span><span class="op">/</span><span class="dv">1800</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">22</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">240</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1900</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">220</span><span class="op">/</span><span class="dv">1900</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">16</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">220</span>)</a>
<a class="sourceLine" id="cb432-6" title="6"></a>
<a class="sourceLine" id="cb432-7" title="7"><span class="co">#konfidensintervallet.</span></a>
<a class="sourceLine" id="cb432-8" title="8"></a>
<a class="sourceLine" id="cb432-9" title="9">lower.lim &lt;-<span class="st"> </span>point.est <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.tau)</a>
<a class="sourceLine" id="cb432-10" title="10"></a>
<a class="sourceLine" id="cb432-11" title="11">upper.lim &lt;-<span class="st"> </span>point.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.tau)</a></code></pre></div>
<p>Variansskattning:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" title="1">Var.hat.theta.hat.tau &lt;-<span class="st"> </span>(<span class="dv">1300</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">140</span><span class="op">/</span><span class="dv">1300</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">28</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">140</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1800</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">240</span><span class="op">/</span><span class="dv">1800</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">22</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">240</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1900</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">220</span><span class="op">/</span><span class="dv">1900</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">16</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">220</span>)</a></code></pre></div>
<p>Ett 95% konfidensintervall ges av</p>
<p><span class="math display">\[\hat{\tau}_{st}\pm z_{\alpha/2}\sqrt{\hat{V}(\hat{\tau}_{st})}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Insättning av värden ger</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" title="1">lower.lim &lt;-<span class="st"> </span>point.est <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.tau)</a>
<a class="sourceLine" id="cb434-2" title="2"></a>
<a class="sourceLine" id="cb434-3" title="3">upper.lim &lt;-<span class="st"> </span>point.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.tau)</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 369926 till 386474 den totala utgiften för samtliga individer i populationen.</li>
</ul>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.19" class="section level3 unnumbered">
<h3>Övning 7.19</h3>
<p>För en undersökning av livsmedelsutgifterna per hushåll kunde en viss stad delas in i tre separata delar med
olika typer av bebyggelse och därmed i viss mån också med olika typer av hushåll. Med hjälp av
liknande undersökningar uppskattade man standardavvikelsen för livsmedelsutgifterna i var och en av stadsdelarna. I tabellen nedan ges nödvändig information.</p>
<table>
<thead>
<tr class="header">
<th>Stadsdel</th>
<th>Antal hushåll</th>
<th>Uppskattning av standardavvikelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3000</td>
<td>1000</td>
</tr>
<tr class="even">
<td>B</td>
<td>2700</td>
<td>2000</td>
</tr>
<tr class="odd">
<td>C</td>
<td>5000</td>
<td>800</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Beräkna hur ett stickprov på 1000 hushåll bör allokeras på de tre stadsdelarna för att medelfelet i skattningen av de genomsnittliga livsmedelsutgifterna ska bli så litet som möjligt.</li>
</ol>
<p>Vi sammanställer data och kan sedan testa oss fram med R:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" title="1">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3000</span>, <span class="dv">2700</span>, <span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb436-2" title="2"></a>
<a class="sourceLine" id="cb436-3" title="3">Ntot &lt;-<span class="st"> </span><span class="kw">sum</span>(Nj)</a>
<a class="sourceLine" id="cb436-4" title="4"></a>
<a class="sourceLine" id="cb436-5" title="5">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">800</span>)</a>
<a class="sourceLine" id="cb436-6" title="6"></a>
<a class="sourceLine" id="cb436-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)      <span class="co"># bestäm värden här. Testa dig fram! Obs: sum(nj) ska bli 1000. Alltså måste ursprungliga värden ändras.</span></a>
<a class="sourceLine" id="cb436-8" title="8"></a>
<a class="sourceLine" id="cb436-9" title="9"><span class="co"># Medelfelet. &#39;sum&#39; gör att vi beräknar uttrycket med de första elementen i variablerna som vi definierat, sedan med de andra elementen och till sist med de tredje elementen.</span></a>
<a class="sourceLine" id="cb436-10" title="10"></a>
<a class="sourceLine" id="cb436-11" title="11"><span class="kw">sum</span>( (Nj<span class="op">/</span>Ntot)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="st"> </span>(nj<span class="op">/</span>Nj)) <span class="op">*</span><span class="st"> </span>(sj<span class="op">/</span>nj)       )</a></code></pre></div>
<pre><code>## [1] 380.5363</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.20" class="section level3 unnumbered">
<h3>Övning 7.20</h3>
<p>Universitetsledningen ville undersöka hur många timmar i veckan som studenterna vid ett universitet lägger på att studera. Ledningen stratifierade utifrån program och drog ett OSU-UÅ från respektive stratum. Resultatet från undersökningen presenteras i tabellen nedan.</p>
<table>
<thead>
<tr class="header">
<th>Program</th>
<th>Antal på program</th>
<th>Antal i urval</th>
<th>Genomsnitt per vecka</th>
<th><span class="math inline">\(s_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>200</td>
<td>25</td>
<td>20</td>
<td>5</td>
</tr>
<tr class="even">
<td>B</td>
<td>150</td>
<td>21</td>
<td>23</td>
<td>5</td>
</tr>
<tr class="odd">
<td>C</td>
<td>80</td>
<td>22</td>
<td>40</td>
<td>6</td>
</tr>
<tr class="even">
<td>D</td>
<td>150</td>
<td>23</td>
<td>35</td>
<td>6</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett 90% KI för det genomsnittliga antalet timmar som studenterna vid universitet lägger ner på studierna varje vecka.</li>
</ol>
<ul>
<li><p>Mål: Skatta det genomsnittliga antalet timmar som studenterna lägger på studier varje vecka med 90% konfidens.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = det genomsnittliga antalet timmar i hela studentpopulationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^K\frac{N_j}{N}\bar{x}_j\)</span> = det genomsnittliga antalet timmar i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x}_{st})=\sum_{j=1}^K\frac{N_j}{N}E(\bar{x}_j)=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 580. Urvalsstorlek: <span class="math inline">\(n\)</span> = 91. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> och vi inte känner populationsfördelningen skattas <span class="math inline">\(V(\bar{x}_{st})\)</span> med <span class="math inline">\(\hat{V}(\bar{x}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Tumregeln för stratifierat urval att alla <span class="math inline">\(n_j&gt;20\)</span> är uppfylld så vi kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Vi börjar med att punktskatta det genomsnittliga antalet timmar:</li>
</ul>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" title="1"><span class="co"># Först sammanställer vi data</span></a>
<a class="sourceLine" id="cb439-2" title="2"></a>
<a class="sourceLine" id="cb439-3" title="3">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">80</span>, <span class="dv">150</span>)  <span class="co"># storlekar på strata. Observera att sum(Nj) = 6000 = Ntot.</span></a>
<a class="sourceLine" id="cb439-4" title="4"></a>
<a class="sourceLine" id="cb439-5" title="5">Ntot &lt;-<span class="st"> </span><span class="kw">sum</span>(Nj)   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb439-6" title="6"></a>
<a class="sourceLine" id="cb439-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb439-8" title="8"></a>
<a class="sourceLine" id="cb439-9" title="9">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">40</span>, <span class="dv">35</span>)  <span class="co"># stickprovsmedelvärden per stratum.</span></a>
<a class="sourceLine" id="cb439-10" title="10"></a>
<a class="sourceLine" id="cb439-11" title="11">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>)  <span class="co"># stickprovsstandardavvikelser per stratum.</span></a>
<a class="sourceLine" id="cb439-12" title="12"></a>
<a class="sourceLine" id="cb439-13" title="13"><span class="co"># punktskatttning. Jämförelse med formler i formelsamling för stratifierat urval uppmuntras!</span></a>
<a class="sourceLine" id="cb439-14" title="14"></a>
<a class="sourceLine" id="cb439-15" title="15">x.bar.tot &lt;-<span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">20</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">23</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">80</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">40</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">35</span></a></code></pre></div>
<p>Den skattade variansen för punktskattningen ges av</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" title="1">Var.hat.theta.hat.mu &lt;-<span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">25</span><span class="op">/</span><span class="dv">200</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">25</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">21</span><span class="op">/</span><span class="dv">150</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">21</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">80</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">22</span><span class="op">/</span><span class="dv">80</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">6</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">22</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">23</span><span class="op">/</span><span class="dv">150</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">6</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">23</span>)</a></code></pre></div>
<p>Ett 90% konfidensintervall för medelvärdet ges av</p>
<p><span class="math display">\[\bar{x}_{st}\pm z_{\alpha/2}\sqrt{\hat{V}(\bar{x}_{st})}.\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,6449\)</span>. Insättning av värden:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" title="1">lower.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a>
<a class="sourceLine" id="cb441-2" title="2"></a>
<a class="sourceLine" id="cb441-3" title="3">upper.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a></code></pre></div>
<ul>
<li>Svar: Med 90% säkerhet täcker intervallet 26,9 till 28,0 det genomsnittliga antalet timmar som studenterna vid universitet lägger på studier varje vecka.</li>
</ul>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.21" class="section level3 unnumbered">
<h3>Övning 7.21</h3>
<p>Universitetsledningen ville undersöka hur stor andel av studenterna vid ett universitet som studerar minst 30 timmar i veckan. Ledningen stratifierade utifrån program och drog ett OSU-UÅ från respektive stratum. Resultatet från undersökningen presenteras i tabellen nedan.</p>
<table>
<thead>
<tr class="header">
<th>Program</th>
<th>Antal på program</th>
<th>Antal i urval</th>
<th>Antal minst 30h/vecka</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>200</td>
<td>19</td>
<td>5</td>
</tr>
<tr class="even">
<td>B</td>
<td>150</td>
<td>25</td>
<td>7</td>
</tr>
<tr class="odd">
<td>C</td>
<td>80</td>
<td>16</td>
<td>6</td>
</tr>
<tr class="even">
<td>D</td>
<td>150</td>
<td>18</td>
<td>9</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Beräkna medelfelet för andelen som studerar minst 30 timmar i veckan.</li>
</ol>
<ul>
<li><p>Mål: Beräkna medelfelet för andelen studenter som studerar minst 30 timmar i veckan.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen studenter i populationen som studerar minst 30 timmar i veckan.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}_{st}\)</span> = andelen studenter i stickprovet som studerar minst 30 timmar i veckan.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{p}_{st})=\sum_{j=1}^K\frac{N_j}{N}E(\hat{p}_j)=p\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 580. Urvalsstorlek: $n$ = 78. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> och populationsfördelningen är okänd skattas <span class="math inline">\(V(\hat{p}_{st})\)</span> med <span class="math inline">\(\hat{V}(\hat{p}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{\hat{p}(1-\hat{p})}{n_j-1}\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Den skattade variansen för andelen som studerar minst 30 timmar i veckan är</li>
</ul>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" title="1"><span class="co"># Först sammanställer vi data</span></a>
<a class="sourceLine" id="cb443-2" title="2">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">80</span>, <span class="dv">150</span>)  <span class="co"># storlekar på strata. Observera att sum(Nj) = 6000 = Ntot.</span></a>
<a class="sourceLine" id="cb443-3" title="3"></a>
<a class="sourceLine" id="cb443-4" title="4">Ntot &lt;-<span class="st"> </span><span class="kw">sum</span>(Nj)   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb443-5" title="5"></a>
<a class="sourceLine" id="cb443-6" title="6">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb443-7" title="7"></a>
<a class="sourceLine" id="cb443-8" title="8">pj.hat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">19</span>, <span class="dv">7</span><span class="op">/</span><span class="dv">25</span>, <span class="dv">6</span><span class="op">/</span><span class="dv">16</span>, <span class="dv">9</span><span class="op">/</span><span class="dv">18</span>)</a>
<a class="sourceLine" id="cb443-9" title="9"></a>
<a class="sourceLine" id="cb443-10" title="10"><span class="co"># (a) variansskattning</span></a>
<a class="sourceLine" id="cb443-11" title="11"></a>
<a class="sourceLine" id="cb443-12" title="12">Var.hat.theta.hat.p &lt;-<span class="st"> </span>(<span class="dv">200</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">19</span><span class="op">/</span><span class="dv">200</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">5</span><span class="op">/</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">5</span><span class="op">/</span><span class="dv">19</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">18</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">25</span><span class="op">/</span><span class="dv">150</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">7</span><span class="op">/</span><span class="dv">25</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span><span class="op">/</span><span class="dv">25</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">24</span>)  <span class="op">+</span><span class="st"> </span>(<span class="dv">80</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">16</span><span class="op">/</span><span class="dv">80</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">6</span><span class="op">/</span><span class="dv">16</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">6</span><span class="op">/</span><span class="dv">16</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">15</span>)  <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">18</span><span class="op">/</span><span class="dv">150</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">9</span><span class="op">/</span><span class="dv">18</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">9</span><span class="op">/</span><span class="dv">18</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">17</span>)</a>
<a class="sourceLine" id="cb443-13" title="13"></a>
<a class="sourceLine" id="cb443-14" title="14"><span class="co"># medelfelet.</span></a>
<a class="sourceLine" id="cb443-15" title="15"></a>
<a class="sourceLine" id="cb443-16" title="16"><span class="kw">sqrt</span>(Var.hat.theta.hat.p)</a></code></pre></div>
<pre><code>## [1] 0.0522571</code></pre>
<ul>
<li>Svar: Medelfelet för andelen studenter som studerar minst 30 timmar i veckan är 0,0523.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Kan du beräkna ett 90% KI för andelen studenter vid universitetet som studenterar minst 20 timmar i veckan?
Vi vet inte andelen som uppger att de studerar minst 20 timmar i veckan men vi kan använda <span class="math inline">\(p=0,5\)</span> som ger störst varians och alltså bredast möjliga intervall. Om andelen är lika i samtliga strata finns emellertid ingen anledning att använda stratifieringen då den kommer att ge samma resultat som ett OSU.</li>
</ol>
<ul>
<li><p>Mål: Skatta andelen studenter som studerar minst 20 timmar i veckan med 90% konfidens.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen studenter i populationen som studerar minst 20 timmar i veckan.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}\)</span> = andelen studenter i stickprovet som studerar minst 20 timmar i veckan.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{p})=p\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 580. Urvalsstorlek: <span class="math inline">\(n\)</span> = 78. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\hat{p})\)</span> med <span class="math inline">\(\hat{V}(\hat{p})=\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}\)</span>.</li>
<li>Stickprovet är ganska stort så vi kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Ett 90% konfidensintervall för populationsandelen ges av</li>
</ul>
<p><span class="math display">\[\hat{p} \pm z_{\alpha/2} \sqrt{\left(\frac{N-n}{N-1}\right)\frac{p(1-p)}{n}}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,6449\)</span>. Insättning av värden ger</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1"><span class="co"># andelen som uppger att de studerar minst 20 timmar i veckan är okänd. Vi använder p = 0.5 här  (inte p &quot;hatt&quot;, utan p) då detta ger bredast möjliga intervall. Om andelen är lika stor i varje stratum kommer vi att kunna använda OSU-UÅ-formlerna istället.</span></a>
<a class="sourceLine" id="cb445-2" title="2"></a>
<a class="sourceLine" id="cb445-3" title="3">p &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb445-4" title="4"></a>
<a class="sourceLine" id="cb445-5" title="5"><span class="co"># varians för estimatorn.</span></a>
<a class="sourceLine" id="cb445-6" title="6"></a>
<a class="sourceLine" id="cb445-7" title="7">Var.theta.hat.p &lt;-<span class="st"> </span>( (Ntot <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(nj) ) <span class="op">/</span><span class="st"> </span>(Ntot <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) ) <span class="op">*</span><span class="st"> </span>( (p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">/</span><span class="kw">sum</span>(nj)    )</a>
<a class="sourceLine" id="cb445-8" title="8"></a>
<a class="sourceLine" id="cb445-9" title="9"><span class="co"># konfidensintervall.</span></a>
<a class="sourceLine" id="cb445-10" title="10"></a>
<a class="sourceLine" id="cb445-11" title="11">lower.lim &lt;-<span class="st"> </span>p <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.theta.hat.p)</a>
<a class="sourceLine" id="cb445-12" title="12"></a>
<a class="sourceLine" id="cb445-13" title="13">upper.lim &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.theta.hat.p)</a></code></pre></div>
<ul>
<li>Svar: Med 90% säkerhet täcker intervallet 0,413 till 0,587 andelen studenter vid universitetet som studerar minst 20 timmar i veckan.</li>
</ul>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.22" class="section level3 unnumbered">
<h3>Övning 7.22</h3>
<p>(Baserad på skrivningsuppgift A5, 110111) Anta att ICA Sverige med hjälp
av besöksintervjuer undersökte butikernas kontakter med lokala producenter.
Den primära undersökningsvariabeln var antalet lokala producenter. Den totala
stickprovsstorleken bestämdes till 200 och man genomförde ett proportionellt
stratifierat urval baserat på stratiferingsvariabeln butikstyp. Undersökningen
gav följande resultat:</p>
<table>
<thead>
<tr class="header">
<th>Stratum</th>
<th><span class="math inline">\(N_j\)</span></th>
<th><span class="math inline">\(n_j\)</span></th>
<th><span class="math inline">\(\bar{x}_j\)</span></th>
<th><span class="math inline">\(s_j\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ICA Nära</td>
<td>728</td>
<td>107</td>
<td>9</td>
<td>3</td>
</tr>
<tr class="even">
<td>ICA Supermarket</td>
<td>444</td>
<td>65</td>
<td>6</td>
<td>2</td>
</tr>
<tr class="odd">
<td>ICA Kvantum</td>
<td>119</td>
<td>18</td>
<td>6</td>
<td>3</td>
</tr>
<tr class="even">
<td>ICA Maxi</td>
<td>70</td>
<td>10</td>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Gör en punktskattning av det genomsnittliga antalet lokala producenter bland ICA-butikerna i Sverige. Beräkna även medelfelet för skattningen.</li>
</ol>
<ul>
<li><p>Mål: Punktskatta det genonsnittliga antalet lokala producenter bland ICA-butikerna i Sverige samt beräkna medelfelet för skattningen.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = det genonsnittliga antalet lokala producenter bland ICA-butikerna i Sverige.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^K\frac{N_j}{N}\bar{x}_j\)</span> = det genonsnittliga antalet lokala producenter i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi förutsätter OSU från respektive stratum har vi att <span class="math inline">\(E(\bar{x}_{st})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 1361. Urvalsstorlek: <span class="math inline">\(n\)</span> = 200. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\bar{x})\)</span> med <span class="math inline">\(\hat{V}(\bar{x}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Genomsnittet beräknas som:</li>
</ul>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" title="1"><span class="co"># Först sammanställer vi data</span></a>
<a class="sourceLine" id="cb447-2" title="2"></a>
<a class="sourceLine" id="cb447-3" title="3">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">728</span>, <span class="dv">444</span>, <span class="dv">119</span>, <span class="dv">70</span>)  <span class="co"># storlekar på strata. Observera att sum(Nj) = 6000 = Ntot.</span></a>
<a class="sourceLine" id="cb447-4" title="4"></a>
<a class="sourceLine" id="cb447-5" title="5">Ntot &lt;-<span class="st"> </span><span class="kw">sum</span>(Nj)   <span class="co"># populationsstorlek.</span></a>
<a class="sourceLine" id="cb447-6" title="6"></a>
<a class="sourceLine" id="cb447-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">107</span>, <span class="dv">65</span>, <span class="dv">18</span>, <span class="dv">10</span>)  <span class="co"># stickprovsstorlek per stratum. Vi har ett proportionellt stratifierat urval.</span></a>
<a class="sourceLine" id="cb447-8" title="8"></a>
<a class="sourceLine" id="cb447-9" title="9">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">4</span>)  <span class="co"># stickprovsmedelvärden per stratum.</span></a>
<a class="sourceLine" id="cb447-10" title="10"></a>
<a class="sourceLine" id="cb447-11" title="11">sj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)  <span class="co"># stickprovsstandardavvikelser per stratum.</span></a>
<a class="sourceLine" id="cb447-12" title="12"></a>
<a class="sourceLine" id="cb447-13" title="13"><span class="co"># Genomsnittsberäkning: Jämförelse med formler i formelsamling för stratifierat urval uppmuntras!</span></a>
<a class="sourceLine" id="cb447-14" title="14"></a>
<a class="sourceLine" id="cb447-15" title="15">x.bar.tot &lt;-<span class="st"> </span><span class="kw">sum</span>( (Nj<span class="op">/</span>Ntot) <span class="op">*</span><span class="st"> </span>x.bar.j)</a>
<a class="sourceLine" id="cb447-16" title="16">  (<span class="dv">200</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">20</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">23</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">80</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">40</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">150</span><span class="op">/</span><span class="dv">580</span>) <span class="op">*</span><span class="st"> </span><span class="dv">35</span></a></code></pre></div>
<pre><code>## [1] 27.41379</code></pre>
<p>Variansskattning:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" title="1">Var.hat.theta.hat.mu &lt;-<span class="st"> </span>(<span class="dv">728</span><span class="op">/</span><span class="dv">1361</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">107</span><span class="op">/</span><span class="dv">728</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">3</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">107</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">444</span><span class="op">/</span><span class="dv">1361</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">65</span><span class="op">/</span><span class="dv">444</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">65</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">119</span><span class="op">/</span><span class="dv">1361</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">18</span><span class="op">/</span><span class="dv">119</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">3</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">18</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">70</span><span class="op">/</span><span class="dv">1361</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">10</span><span class="op">/</span><span class="dv">70</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)</a></code></pre></div>
<p>Medelfelet blir:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" title="1"><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a></code></pre></div>
<pre><code>## [1] 0.1739847</code></pre>
<ul>
<li>Svar: Det genonsnittliga antalet lokala producenter bland ICA-butikerna i Sverige är 7,5 och skattningens medelfel är 0,174.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Din uppdragsgivare vill att du beräknar felmarginalen för skattningen i a-uppgiften. Använd konfidensgraden 95 procent. Tolka felmarginalen! Har du någon invändning som statistikkunnig beträffande felmarginalen?</li>
</ol>
<ul>
<li><p>Mål: Beräkna felmarginalen för skattningen i (a) med konfidensgraden 95%.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = det genonsnittliga antalet lokala producenter bland ICA-butikerna i Sverige.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}_{st}=\sum_{j=1}^K\frac{N_j}{N}\bar{x}_j\)</span> = det genonsnittliga antalet lokala producenter i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi förutsätter OSU från respektive stratum har vi att <span class="math inline">\(E(\bar{x}_{st})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 1361. Urvalsstorlek: <span class="math inline">\(n\)</span> = 200. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\bar{x})\)</span> med <span class="math inline">\(\hat{V}(\bar{x}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Tumregeln vid stratifierat urval att alla <span class="math inline">\(n_j&gt;20\)</span> är inte uppfylld vilket innebär att vi inte kan förlita oss på CGS utan måste anta normalfördelning för att kunna motivera beräkningen av felmarginalen.</li>
</ol>
<ul>
<li>Beräkning: Felmarginalen ges av</li>
</ul>
<p><span class="math display">\[z_{\alpha/2} \sqrt{\hat{V}(\bar{x}_{st})}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,025}=1,96\)</span>. Insättning av värden:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" title="1"><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a></code></pre></div>
<pre><code>## [1] 0.3410038</code></pre>
<ul>
<li>Svar: Felmarginalen innebär att vår punktskattning <span class="math inline">\(\bar{x}_{st}\)</span> med 95% säkerhet inte avviker med mer än 0,174 från det okända genonsnittliga antalet lokala producenter bland ICA-butikerna i Sverige.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Vid en upprepning av undersökningen nästkommande år finns nu en uppfattning om osäkerheten i respektive stratum. Använd de skattade standardavvikelserna och gör en Neyman-allokering av stickprovet. Anta att den totala stickprovsstorleken är samma som föregående år.</li>
</ol>
<ul>
<li><p>Mål: Gör en Neyman-allokering av stickprovet.</p></li>
<li><p>Beräkning: Vi antar att kostnaden är lika för alla strata och ska därför göra allokeringen med följande formel</p></li>
</ul>
<p><span class="math display">\[n_j=n\frac{N_j\sigma_j}{\sum_{j=1}^KN_j\sigma_j}.\]</span>
Vi beräknar först nämnaren som är:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" title="1">Nj.sigmaj &lt;-<span class="st"> </span><span class="dv">728</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">444</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">119</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">70</span> <span class="op">*</span><span class="dv">2</span></a></code></pre></div>
<p>Stickprovsstorleken är <span class="math inline">\(n=200\)</span> och den nya allokeringen blir:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" title="1">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb455-2" title="2"></a>
<a class="sourceLine" id="cb455-3" title="3"><span class="co"># allokeringar</span></a>
<a class="sourceLine" id="cb455-4" title="4"></a>
<a class="sourceLine" id="cb455-5" title="5">n1 &lt;-<span class="st"> </span><span class="dv">200</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">728</span><span class="op">*</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span>Nj.sigmaj)</a>
<a class="sourceLine" id="cb455-6" title="6"></a>
<a class="sourceLine" id="cb455-7" title="7">n2 &lt;-<span class="st"> </span><span class="dv">200</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">444</span><span class="op">*</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>Nj.sigmaj)</a>
<a class="sourceLine" id="cb455-8" title="8"></a>
<a class="sourceLine" id="cb455-9" title="9">n3 &lt;-<span class="st"> </span><span class="dv">200</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">119</span><span class="op">*</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span>Nj.sigmaj)</a>
<a class="sourceLine" id="cb455-10" title="10"></a>
<a class="sourceLine" id="cb455-11" title="11">n4 &lt;-<span class="st"> </span><span class="dv">200</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">70</span><span class="op">*</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>Nj.sigmaj)</a></code></pre></div>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.23" class="section level3 unnumbered">
<h3>Övning 7.23</h3>
<p>Ett franschiseföretag är intresserat av undersöka den totala försäljningen av en
specifik vara, <span class="math inline">\(\tau\)</span> . Företaget väljer med hjälp av stratifierat urval ut affärer i tre
strata och får följande resultat för antalet sålda varor:</p>
<p>Landsbygd (<span class="math inline">\(N_1 = 510\)</span>)
30 21 48 38 26 25 41 19 46 41 25 17 36 41 43 35 26 32 30 38 39 37 23 32 34
9 20 22 33 41 54 11</p>
<p>Samhälle (<span class="math inline">\(N_2 = 310\)</span>)
51 44 77 55 38 54 62 57 42 59 50 63 32 63 55 43 53 50 39 56 44</p>
<p>Stad (<span class="math inline">\(N_3 = 410\)</span>)
49 54 63 54 77 94 25 23 53 44 65 86 61 43 85 39 93 43 61 46 32 73 57</p>
<ol style="list-style-type: lower-alpha">
<li>Punktskatta det totala antalet sålda varor.</li>
</ol>
<ul>
<li><p>Mål: Punktskatta den totala försäljningen av varan.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = totala antalet sålda varor.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}_{st}=\sum_{j=1}^KN_j\bar{x}_j\)</span> = antalet sålda varor i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi utgår från att varje stratum är draget med OSU har vi att <span class="math inline">\(E(\hat{\tau}_{st})=NE(\bar{x}_{st})=\tau\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Den totala försäljningen ges av:</li>
</ul>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" title="1"><span class="co"># först sammanställer vi data.</span></a>
<a class="sourceLine" id="cb457-2" title="2"></a>
<a class="sourceLine" id="cb457-3" title="3">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">510</span>, <span class="dv">310</span>, <span class="dv">410</span>)</a>
<a class="sourceLine" id="cb457-4" title="4"></a>
<a class="sourceLine" id="cb457-5" title="5">landsbygd &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">21</span>, <span class="dv">48</span>, <span class="dv">38</span>, <span class="dv">26</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">19</span>, <span class="dv">46</span>, <span class="dv">41</span>, <span class="dv">25</span>, <span class="dv">17</span>, <span class="dv">36</span>, <span class="dv">41</span>, <span class="dv">43</span>, <span class="dv">35</span>, <span class="dv">26</span>, <span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">37</span>, <span class="dv">23</span>, <span class="dv">32</span>, <span class="dv">34</span>, <span class="dv">9</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">33</span>, <span class="dv">41</span>, <span class="dv">54</span>, <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb457-6" title="6"></a>
<a class="sourceLine" id="cb457-7" title="7">samh &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">51</span>, <span class="dv">44</span>, <span class="dv">77</span>, <span class="dv">55</span>, <span class="dv">38</span>, <span class="dv">54</span>, <span class="dv">62</span>, <span class="dv">57</span>, <span class="dv">42</span>, <span class="dv">59</span>, <span class="dv">50</span>, <span class="dv">63</span>, <span class="dv">32</span>, <span class="dv">63</span>, <span class="dv">55</span>, <span class="dv">43</span>, <span class="dv">53</span>, <span class="dv">50</span>, <span class="dv">39</span>, <span class="dv">56</span>, <span class="dv">44</span>)</a>
<a class="sourceLine" id="cb457-8" title="8"></a>
<a class="sourceLine" id="cb457-9" title="9">stad &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">49</span>, <span class="dv">54</span>, <span class="dv">63</span>, <span class="dv">54</span>, <span class="dv">77</span>, <span class="dv">94</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">53</span>, <span class="dv">44</span>, <span class="dv">65</span>, <span class="dv">86</span>, <span class="dv">61</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">39</span>, <span class="dv">93</span>, <span class="dv">43</span>, <span class="dv">61</span>, <span class="dv">46</span>, <span class="dv">32</span>, <span class="dv">73</span>, <span class="dv">57</span>)</a>
<a class="sourceLine" id="cb457-10" title="10"></a>
<a class="sourceLine" id="cb457-11" title="11">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(landsbygd), <span class="kw">length</span>(samh), <span class="kw">length</span>(stad))</a>
<a class="sourceLine" id="cb457-12" title="12"></a>
<a class="sourceLine" id="cb457-13" title="13">x.bar.j &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(landsbygd), <span class="kw">mean</span>(samh), <span class="kw">mean</span>(stad))</a>
<a class="sourceLine" id="cb457-14" title="14"></a>
<a class="sourceLine" id="cb457-15" title="15">sj &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">sd</span>(landsbygd), <span class="kw">sd</span>(samh), <span class="kw">sd</span>(stad)  )</a>
<a class="sourceLine" id="cb457-16" title="16"></a>
<a class="sourceLine" id="cb457-17" title="17"><span class="co"># punktesitmat för totalen.</span></a>
<a class="sourceLine" id="cb457-18" title="18"></a>
<a class="sourceLine" id="cb457-19" title="19">x.bar.tot &lt;-<span class="st"> </span><span class="dv">510</span> <span class="op">*</span><span class="st"> </span><span class="fl">31.65625</span> <span class="op">+</span><span class="st"> </span><span class="dv">310</span> <span class="op">*</span><span class="st"> </span><span class="fl">51.7619</span> <span class="op">+</span><span class="st"> </span><span class="dv">410</span> <span class="op">*</span><span class="st"> </span><span class="fl">57.3913</span></a>
<a class="sourceLine" id="cb457-20" title="20"></a>
<a class="sourceLine" id="cb457-21" title="21"><span class="co"># alternativt...</span></a>
<a class="sourceLine" id="cb457-22" title="22"></a>
<a class="sourceLine" id="cb457-23" title="23">x.bar.tot &lt;-<span class="st"> </span><span class="kw">sum</span>( Nj <span class="op">*</span><span class="st"> </span>x.bar.j   )</a></code></pre></div>
<ul>
<li>Svar: En punktskattning av den totala försäljningen av varan är 55721 stycken.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Ge en intervallskattning för det totala antalet sålda varor. Använd konfidensgraden 90 procent.</li>
</ol>
<ul>
<li><p>Mål: Intervallskatta det totala antalet sålda varor med konfidensgraden 90%.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = totala antalet sålda varor.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}_{st}=\sum_{j=1}^KN_j\bar{x}_j\)</span> = antalet sålda varor i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi utgår från att varje stratum är draget med OSU har vi att <span class="math inline">\(E(\hat{\tau}_{st})=NE(\bar{x}_{st})=\tau\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 1230. Urvalsstorlek: <span class="math inline">\(n\)</span> = 76. <span class="math inline">\(\frac{n}{N}&lt;0,1\)</span> men eftersom vi vet populationsstorleken använder vi ändlighetskorrektion och <span class="math inline">\(V(\hat{\tau}_{st})\)</span> skattas med <span class="math inline">\(\hat{V}(\hat{\tau}_{st})=\sum_{j=1}^{K}N_j^2\hat{V}(\bar{x}_j)=\sum_{j=1}^{K}N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{s_j^2}{n_j}\)</span>.</li>
<li>Tumregeln för stratifierat urval att <span class="math inline">\(n_j&gt;20\)</span> är uppfylld så vi kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Den skattade variansen för punktskattningen ges av</li>
</ul>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" title="1">Var.hat.theta.hat.mu &lt;-<span class="st"> </span><span class="dv">510</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">32</span><span class="op">/</span><span class="dv">510</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="fl">10.68798</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">32</span>) <span class="op">+</span><span class="st"> </span><span class="dv">310</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">21</span><span class="op">/</span><span class="dv">310</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="fl">10.39666</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">21</span>) <span class="op">+</span><span class="st"> </span><span class="dv">410</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">23</span><span class="op">/</span><span class="dv">410</span>) ) <span class="op">*</span><span class="st"> </span>(<span class="fl">20.20742</span><span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">23</span>)</a>
<a class="sourceLine" id="cb458-2" title="2"></a>
<a class="sourceLine" id="cb458-3" title="3"><span class="co"># alternativt...</span></a>
<a class="sourceLine" id="cb458-4" title="4"></a>
<a class="sourceLine" id="cb458-5" title="5">Var.hat.theta.hat.mu &lt;-<span class="st"> </span><span class="kw">sum</span>( Nj<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(nj <span class="op">/</span><span class="st"> </span>Nj) ) <span class="op">*</span><span class="st"> </span>(sj<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>nj)  )</a></code></pre></div>
<p>Ett 90% konfidensintervall för det totala antalet sålda varor ges av:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" title="1">lower.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a>
<a class="sourceLine" id="cb459-2" title="2"></a>
<a class="sourceLine" id="cb459-3" title="3">upper.lim &lt;-<span class="st"> </span>x.bar.tot <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.mu)</a></code></pre></div>
<ul>
<li>Svar: Med 90% säkerhet täcker intervallet 52371 till 59071 det totala antalet sålda varor.</li>
</ul>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.24" class="section level3 unnumbered">
<h3>Övning 7.24</h3>
<p>Ett landsting vill skatta det totala antalet vaccinationer
som behövs. Landstinget drar ett urval bestående av 23 vårdcentraler
med OSU-UÅ från totalt 90 vårdcentaler i landstinget.
Följande resultat erhålls från de 25 vårdcentralerna:</p>
<p>Antal vaccinationer: 210 239 238 211 262 219 248 227 259 247 207 212 185 253 247 233 177 197 222 198 215 279 242</p>
<p>Antal invånare som är listade vid vårdcentralen: 2680 3820 2010 2000 3900 2970 1640 3120 2280 1740 2080 3420 3040 2730 2370
2430 3390 2800 2860 2740 2950 3010 1600</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett 95% KI för det totala antalet vaccinationer som behövs i landstinget. Var noga med förutsättningar! Tolka intervallet!</li>
</ol>
<ul>
<li><p>Mål: Skatta det totala antalet vaccinationer som behövs i landstinget med 95% konfidens.</p></li>
<li><p>Parameter: <span class="math inline">\(\tau\)</span> = det totala antalet vaccinationer som behövs i landstinget.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{\tau}=N\bar{x}\)</span> = antalet vaccinationer i stickprovet där <span class="math inline">\(x_i\)</span> är antalet vaccinationer vid respektive vårdcentral.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{\tau})=NE(\bar{x})=N\mu=\tau\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 90. Urvalsstorlek: $n$ = 23. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\hat{\tau})\)</span> med <span class="math inline">\(\hat{V}(\hat{\tau})=N^2V(\bar{x})=N^2\left(1-\frac{n}{N}\right)\frac{s^2)}{n}\)</span>.</li>
<li>Vi har ett för litet stickprov för att kunna förlita oss på CGS och antar därför att antalet vaccinationer är normalfördelad i populationen för att kunna använda formlerna vi lärt oss.</li>
</ol>
<ul>
<li>Beräkning: En punktskattning av totala antalet vaccinationer som behövs är:</li>
</ul>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" title="1"><span class="co"># först sammanställer vi data.</span></a>
<a class="sourceLine" id="cb461-2" title="2"></a>
<a class="sourceLine" id="cb461-3" title="3">vacc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">210</span>, <span class="dv">239</span>, <span class="dv">238</span>, <span class="dv">211</span>, <span class="dv">262</span>, <span class="dv">219</span>, <span class="dv">248</span>, <span class="dv">227</span>, <span class="dv">259</span>, <span class="dv">247</span>, <span class="dv">207</span>, <span class="dv">212</span>, <span class="dv">185</span>, <span class="dv">253</span>, <span class="dv">247</span>, <span class="dv">233</span>, <span class="dv">177</span>, <span class="dv">197</span>, <span class="dv">222</span>, <span class="dv">198</span>, <span class="dv">215</span>, <span class="dv">279</span>, <span class="dv">242</span>)</a>
<a class="sourceLine" id="cb461-4" title="4"></a>
<a class="sourceLine" id="cb461-5" title="5">n &lt;-<span class="st"> </span><span class="kw">length</span>(vacc)</a>
<a class="sourceLine" id="cb461-6" title="6"></a>
<a class="sourceLine" id="cb461-7" title="7">N &lt;-<span class="st"> </span><span class="dv">90</span></a>
<a class="sourceLine" id="cb461-8" title="8"></a>
<a class="sourceLine" id="cb461-9" title="9">sum.vacc &lt;-<span class="st"> </span><span class="kw">sum</span>(vacc)</a>
<a class="sourceLine" id="cb461-10" title="10"></a>
<a class="sourceLine" id="cb461-11" title="11"><span class="co"># (a)</span></a>
<a class="sourceLine" id="cb461-12" title="12"></a>
<a class="sourceLine" id="cb461-13" title="13"><span class="co"># punktestimat</span></a>
<a class="sourceLine" id="cb461-14" title="14"></a>
<a class="sourceLine" id="cb461-15" title="15">point.est &lt;-<span class="st"> </span>N<span class="op">/</span>n <span class="op">*</span><span class="st"> </span>sum.vacc</a></code></pre></div>
<p>Variansskattning:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1">Var.hat.theta.hat &lt;-<span class="st"> </span><span class="dv">90</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">23</span> <span class="op">/</span><span class="st"> </span><span class="dv">90</span>)) <span class="op">*</span><span class="st"> </span>(<span class="kw">sd</span>(vacc)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">23</span>)</a></code></pre></div>
<p>Konfidensintervallet blir:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" title="1">lower.lim &lt;-<span class="st"> </span>point.est <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">23-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a>
<a class="sourceLine" id="cb463-2" title="2"></a>
<a class="sourceLine" id="cb463-3" title="3">upper.lim &lt;-<span class="st"> </span>point.est <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">23-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 19582 till 21325 det totala antalet vaccinationer som behövs i landstinget.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Vad är det genomsnittliga antalet vaccinationer per invånare? Ge en punktskattning. Var noga med förutsättningar!</li>
</ol>
<ul>
<li><p>Mål: Punktskatta det genomsnittliga antalet vaccinationer per invånare i landstinget.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = det genomsnittliga antalet vaccinationer per invånare i landstinget.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = det genomsnittliga antalet vaccinationer per invånare i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Om vi definierar <span class="math inline">\(\sum_{i=1}^{23}y_i\)</span> = antal vaccinationer i stickprovet och <span class="math inline">\(\sum_{i=1}^{23}z_i\)</span> = antalet invånare i stickprovet ges det genomsnittliga antalet vaccinationer per invånare av</li>
</ul>
<p><span class="math display">\[\bar{x}_{vac/inv}=\frac{\sum_{i=1}^{23}y_i}{\sum_{i=1}^{23}z_i}.\]</span>
Beräkning i R ger:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="co"># invånarantalet.</span></a>
<a class="sourceLine" id="cb464-2" title="2">inv &lt;-<span class="st"> </span><span class="dv">2680</span> <span class="op">+</span><span class="st"> </span><span class="dv">3820</span> <span class="op">+</span><span class="st"> </span><span class="dv">2010</span> <span class="op">+</span><span class="st"> </span><span class="dv">2000</span> <span class="op">+</span><span class="st"> </span><span class="dv">3900</span> <span class="op">+</span><span class="st"> </span><span class="dv">2970</span> <span class="op">+</span><span class="st"> </span><span class="dv">1640</span> <span class="op">+</span><span class="st"> </span><span class="dv">3120</span> <span class="op">+</span><span class="st"> </span><span class="dv">2280</span> <span class="op">+</span><span class="st"> </span><span class="dv">1740</span> <span class="op">+</span><span class="st"> </span><span class="dv">2080</span> <span class="op">+</span><span class="st"> </span><span class="dv">3420</span> <span class="op">+</span><span class="st"> </span><span class="dv">3040</span> <span class="op">+</span><span class="st"> </span><span class="dv">2730</span> <span class="op">+</span><span class="st"> </span><span class="dv">2370</span> <span class="op">+</span><span class="st"> </span><span class="dv">2430</span> <span class="op">+</span><span class="st"> </span><span class="dv">3390</span> <span class="op">+</span><span class="st"> </span><span class="dv">2800</span> <span class="op">+</span><span class="st"> </span><span class="dv">2860</span> <span class="op">+</span><span class="st"> </span><span class="dv">2740</span> <span class="op">+</span><span class="st"> </span><span class="dv">2950</span> <span class="op">+</span><span class="st"> </span><span class="dv">3010</span> <span class="op">+</span><span class="st"> </span><span class="dv">1600</span></a>
<a class="sourceLine" id="cb464-3" title="3"></a>
<a class="sourceLine" id="cb464-4" title="4">vacc.per.inv &lt;-<span class="st"> </span>sum.vacc <span class="op">/</span><span class="st"> </span>inv</a></code></pre></div>
<ul>
<li>Svar: En punktskattning av det genomsnittliga antalet vaccinationer per invånare i landstinget är 0,085.</li>
</ul>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.25" class="section level3 unnumbered">
<h3>Övning 7.25</h3>
<p>Vi vill undersöka andelen som röker bland högstadieelever i en kommun.
Vi drar därför ett OSU-UÅ bestående av 12 klasser från kommunens totalt
80 klasser och undersöker alla elever i dessa klasser. Totalt finns det 2200 högstadielever i kommunen.
Antalet som röker i klasserna i stickprovet är: 12 1 3 4 2 2 7 5 5 12 6 13
och dragna klassernas storlek är 34 26 33 27 21 24 25 29 28 28 30 19.</p>
<ol style="list-style-type: lower-alpha">
<li>Hur stor andel av kommunens högstadieelever röker? Ange förutsättningar!</li>
</ol>
<ul>
<li><p>Mål: Skatta hur stor andel av kommunens högstadieelever som röker.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen av kommunens högstadieelever som röker.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}\)</span> = andelen högstadieelever i stickprovet som röker.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\hat{p})=p\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 2200. Urvalsstorlek: <span class="math inline">\(n\)</span> = 324. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> skattas <span class="math inline">\(V(\hat{p})\)</span> med <span class="math inline">\(\hat{V}(\hat{p})=\left(1-\frac{n}{N}\right)\frac{\hat{p}(1-\hat{p})}{n-1}\)</span>.</li>
<li>Vi har ett stort stickprov och kan därmed förlita oss till CGS för approximativ normalfördelning.</li>
</ol>
<ul>
<li>Beräkning: Andelen i stickprovet som röker är</li>
</ul>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1"><span class="co"># Sammanställ data.</span></a>
<a class="sourceLine" id="cb466-2" title="2"></a>
<a class="sourceLine" id="cb466-3" title="3">n &lt;-<span class="st"> </span><span class="dv">34</span> <span class="op">+</span><span class="st"> </span><span class="dv">26</span> <span class="op">+</span><span class="st"> </span><span class="dv">33</span> <span class="op">+</span><span class="st"> </span><span class="dv">27</span> <span class="op">+</span><span class="st"> </span><span class="dv">21</span> <span class="op">+</span><span class="st"> </span><span class="dv">24</span> <span class="op">+</span><span class="st"> </span><span class="dv">25</span> <span class="op">+</span><span class="st"> </span><span class="dv">29</span> <span class="op">+</span><span class="st"> </span><span class="dv">28</span> <span class="op">+</span><span class="st"> </span><span class="dv">28</span> <span class="op">+</span><span class="st"> </span><span class="dv">30</span> <span class="op">+</span><span class="st"> </span><span class="dv">19</span></a>
<a class="sourceLine" id="cb466-4" title="4"></a>
<a class="sourceLine" id="cb466-5" title="5">N &lt;-<span class="st"> </span><span class="dv">2200</span></a>
<a class="sourceLine" id="cb466-6" title="6"></a>
<a class="sourceLine" id="cb466-7" title="7">smoke &lt;-<span class="st"> </span><span class="dv">12</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">13</span></a>
<a class="sourceLine" id="cb466-8" title="8"></a>
<a class="sourceLine" id="cb466-9" title="9"><span class="co"># punktestimat</span></a>
<a class="sourceLine" id="cb466-10" title="10"></a>
<a class="sourceLine" id="cb466-11" title="11">p.hat &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>n) <span class="op">*</span><span class="st"> </span>smoke</a></code></pre></div>
<p>och ett 95% konfidensintervall för andelen ges av
<span class="math display">\[\hat{p} \pm z_{\alpha/2} \sqrt{\hat{V}(\hat{p})}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,96\)</span>. Insättning av värden ger variansskattningen:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" title="1">Var.hat.theta.hat &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(smoke<span class="op">/</span>n) ) <span class="op">*</span><span class="st"> </span>(  (p.hat <span class="op">*</span><span class="st"> </span>( <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat ) )  <span class="op">/</span><span class="st"> </span>(n<span class="dv">-1</span>)   )</a></code></pre></div>
<p>Intervallet blir:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" title="1">lower.lim &lt;-<span class="st"> </span>p.hat <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a>
<a class="sourceLine" id="cb468-2" title="2"></a>
<a class="sourceLine" id="cb468-3" title="3">upper.lim &lt;-<span class="st"> </span>p.hat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat)</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 0,18 till 0,26 andelen av kommunens högstadieelever som röker.</li>
</ul>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.26" class="section level3 unnumbered">
<h3>Övning 7.26</h3>
<p>En organisation vill skatta medelåldern bland avlidna i ebola i ett område i Liberia. Urvalsramen består av 150 vårdenheter och 3 av dessa väljs med OSU-UÅ.
Information om åldern på de avlidna hämtas fram från respektive vårdenhet och är som följer:</p>
<p>Ålder på avlidna, vårdenhet 1: 13 36 31 23 34 14 23 20 26 28 33 39 32 29 26 26 40 22 19 30 42 34 28 9 47
25 15 26 18 11 18 30 27 25 33 2 15 33 28 38 31 42 16 23 33 35 20 43 11 35
35 31 19 31 43 20 49</p>
<p>Ålder på avlidna, vårdenhet 2: 30 25 30 27 23 31 30 21 36 31 28 32 35 38 28 27 41 35 34 32 33 30 40 29 29
29 34 25 26</p>
<p>Ålder på avlidna, vårdenhet 3: 29 40 36 28 17 24 31 27 40 20 26 35 40 34 23 44 30 12 32 35 37 28 35 35 39
33 40 40 36 25 46 40</p>
<p>Organisationen får fram att den genomsnittliga åldern bland de avlidna i området med 95% säkerhet är mellan 27,32 till 30,46 år.</p>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett alternativt medelfel om du vet att det totalt dog 5100 i ebola på de 150 vårdenheterna. Är ditt medelfel mer korrekt än organisationens?</li>
</ol>
<ul>
<li><p>Mål: Beräkna medelfelet för den genomsnittliga åldern bland avlidna i Ebola i stickprovet.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = den genomsnittliga åldern bland avlidna i Ebola i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = den genomsnittliga åldern bland avlidna i Ebola i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 5100. Urvalsstorlek: <span class="math inline">\(n\)</span> = 118. <span class="math inline">\(\frac{n}{N}&lt;0,1\)</span> men vi vet populationsstorleken och använder ändlighetskorrektion varpå <span class="math inline">\(V(\bar{x})\)</span> skattas med <span class="math inline">\(\hat{V}(\bar{x})=\left(1-\frac{n}{N}\right)\frac{s^2}{n}\)</span>.</li>
</ol>
<ul>
<li>Beräkning: Medelfelet ges av</li>
</ul>
<p><span class="math display">\[\text{Medelfel} = \sqrt{\hat{V}(\bar{x})} =\sqrt{\left(1-\frac{n}{N}\right)\frac{s^2}{n}}.\]</span>
Insättning av värden ger:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" title="1"><span class="co"># sammanställ data.</span></a>
<a class="sourceLine" id="cb470-2" title="2"></a>
<a class="sourceLine" id="cb470-3" title="3">N &lt;-<span class="st"> </span><span class="dv">5100</span></a>
<a class="sourceLine" id="cb470-4" title="4"></a>
<a class="sourceLine" id="cb470-5" title="5">age &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">36</span>, <span class="dv">31</span>, <span class="dv">23</span>, <span class="dv">34</span>, <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">33</span>, <span class="dv">39</span>, <span class="dv">32</span>, <span class="dv">29</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">40</span>, <span class="dv">22</span>, <span class="dv">19</span>, <span class="dv">30</span>, <span class="dv">42</span>, <span class="dv">34</span>, <span class="dv">28</span>, <span class="dv">9</span>, <span class="dv">47</span>, <span class="dv">25</span>, <span class="dv">15</span>, <span class="dv">26</span>, <span class="dv">18</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">30</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">33</span>, <span class="dv">2</span>, <span class="dv">15</span>, <span class="dv">33</span>, <span class="dv">28</span>, <span class="dv">38</span>, <span class="dv">31</span>, <span class="dv">42</span>, <span class="dv">16</span>, <span class="dv">23</span>, <span class="dv">33</span>, <span class="dv">35</span>, <span class="dv">20</span>, <span class="dv">43</span>, <span class="dv">11</span>, <span class="dv">35</span>, <span class="dv">35</span>, <span class="dv">31</span>, <span class="dv">19</span>, <span class="dv">31</span>, <span class="dv">43</span>, <span class="dv">20</span>, <span class="dv">49</span>,</a>
<a class="sourceLine" id="cb470-6" title="6">         <span class="dv">30</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">27</span>, <span class="dv">23</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">21</span>, <span class="dv">36</span>, <span class="dv">31</span>, <span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">35</span>, <span class="dv">38</span>, <span class="dv">28</span>, <span class="dv">27</span>, <span class="dv">41</span>, <span class="dv">35</span>, <span class="dv">34</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">29</span>, <span class="dv">29</span>, <span class="dv">29</span>, <span class="dv">34</span>, <span class="dv">25</span>, <span class="dv">26</span>,</a>
<a class="sourceLine" id="cb470-7" title="7">         <span class="dv">29</span>, <span class="dv">40</span>, <span class="dv">36</span>, <span class="dv">28</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">40</span>, <span class="dv">20</span>, <span class="dv">26</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">34</span>, <span class="dv">23</span>, <span class="dv">44</span>, <span class="dv">30</span>, <span class="dv">12</span>, <span class="dv">32</span>, <span class="dv">35</span>, <span class="dv">37</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">35</span>, <span class="dv">39</span>, <span class="dv">33</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">36</span>, <span class="dv">25</span>, <span class="dv">46</span>, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb470-8" title="8"></a>
<a class="sourceLine" id="cb470-9" title="9">n &lt;-<span class="st"> </span><span class="kw">length</span>(age)</a>
<a class="sourceLine" id="cb470-10" title="10"></a>
<a class="sourceLine" id="cb470-11" title="11"><span class="co"># alternativt medelfel, jämfört med organisationens.</span></a>
<a class="sourceLine" id="cb470-12" title="12"></a>
<a class="sourceLine" id="cb470-13" title="13">se.age &lt;-<span class="st"> </span><span class="kw">sqrt</span>( (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(n<span class="op">/</span>N)) <span class="op">*</span><span class="st"> </span>(<span class="kw">var</span>(age) <span class="op">/</span><span class="st"> </span>n )   )</a></code></pre></div>
<ul>
<li>Svar: Medelfelet för genomsnittsåldern bland avlidna i Ebola i området är 0,7878. Eftersom vi nu har använt information om populationsstorleken är vårt medelfel mer korrekt än organisationens.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Kan du beräkna ett konfidensintervall?</li>
</ol>
<ul>
<li><p>Mål: Beräkna ett 95% konfidensintervall för den genomsnittliga åldern i området.</p></li>
<li><p>Parameter: <span class="math inline">\(\mu\)</span> = den genomsnittliga åldern bland avlidna i Ebola i populationen.</p></li>
<li><p>Estimator: <span class="math inline">\(\bar{x}\)</span> = den genomsnittliga åldern bland avlidna i Ebola i stickprovet.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>OSU-UÅ ger att <span class="math inline">\(E(\bar{x})=\mu\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 5100. Urvalsstorlek: <span class="math inline">\(n\)</span> = 118. <span class="math inline">\(\frac{n}{N}&lt;0,1\)</span> men vi vet populationsstorleken och använder ändlighetskorrektion varpå <span class="math inline">\(V(\bar{x})\)</span> skattas med <span class="math inline">\(\hat{V}(\bar{x})=\left(1-\frac{n}{N}\right)\frac{s^2}{n}\)</span>.</li>
<li>Vi har ett stort stickprov och kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: Ett 95% konfidensintervall för populationsmedelvärdet ges av</li>
</ul>
<p><span class="math display">\[\bar{x} \pm z_{\alpha/2} \sqrt{\hat{V}(\bar{x})}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,96\)</span>. Insättning av värden i intervallet ger:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" title="1">point.est &lt;-<span class="st"> </span><span class="kw">mean</span>(age)</a>
<a class="sourceLine" id="cb471-2" title="2"></a>
<a class="sourceLine" id="cb471-3" title="3">lower.lim &lt;-<span class="st"> </span>point.est <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>se.age</a>
<a class="sourceLine" id="cb471-4" title="4"></a>
<a class="sourceLine" id="cb471-5" title="5">upper.lim &lt;-<span class="st"> </span>point.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>se.age</a></code></pre></div>
<ul>
<li>Svar: Med 95% säkerhet täcker intervallet 28,02 till 31,15 den genomsnittliga åldern bland avlidna i Ebola i området.</li>
</ul>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a></code></pre></div>
</div>
<div id="övning-7.27" class="section level3 unnumbered">
<h3>Övning 7.27</h3>
<p>En kommun vill undersöka andelen som ställer sig positiva till en ny arena.
Kommunen stratifierar på ålder och drar sedan i respektive ålderskategori ett systematiskt urval från RTB. Resultatet blev följande:</p>
<table>
<thead>
<tr class="header">
<th>Stratum</th>
<th><span class="math inline">\(N_j\)</span></th>
<th><span class="math inline">\(n_j\)</span></th>
<th>Andel positiva <span class="math inline">\(\hat{p}_j\)</span></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>18-34 år</td>
<td>3300</td>
<td>400</td>
<td>0,5</td>
<td></td>
</tr>
<tr class="even">
<td>35-59 år</td>
<td>4000</td>
<td>400</td>
<td>0,7</td>
<td></td>
</tr>
<tr class="odd">
<td>60 år eller äldre</td>
<td>3400</td>
<td>400</td>
<td>0,3</td>
<td></td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Beräkna ett 90% KI för andelen positiva i kommunen. Var noga med förutsättningar! Tolka intervallet!</li>
</ol>
<ul>
<li><p>Mål: Skatta andelen i kommunen som ställer sig positiva till en ny arena med ett 90% konfidensintervall.</p></li>
<li><p>Parameter: <span class="math inline">\(p\)</span> = andelen i kommunen som ställer sig positiva till en ny arena.</p></li>
<li><p>Estimator: <span class="math inline">\(\hat{p}_{st}=\sum_{j=1}^{K}\frac{N_j}{N}\hat{p}_j\)</span> = andelen i stickprovet som ställer sig positiva till en ny arena.</p></li>
<li><p>Förutsättningar:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Om vi utgår från att respektive stratum framtagits slupmässigt har vi att <span class="math inline">\(E(\hat{p}_{st})=p\)</span>.</li>
<li>Populationsstorlek: <span class="math inline">\(N\)</span> = 10700. Urvalsstorlek: <span class="math inline">\(n\)</span> = 1200. Eftersom <span class="math inline">\(\frac{n}{N}&gt;0,1\)</span> och populationsfördelningen är okänd skattas <span class="math inline">\(V(\hat{p}_{st})\)</span> med <span class="math inline">\(\hat{V}(\hat{p}_{st})=\sum_{j=1}^{K}\left(\frac{N_j}{N}\right)^2\left(1-\frac{n_j}{N_j}\right)\frac{\hat{p}_j(1-\hat{p}_j)}{n_j-1}\)</span>.</li>
<li>Tumregeln för stratifierat urval att <span class="math inline">\(n_j&gt;20\)</span> är uppfylld och vi kan förlita oss på CGS.</li>
</ol>
<ul>
<li>Beräkning: En punktskattning av andelen positiva är</li>
</ul>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" title="1"><span class="co"># sammanställ data. Anta slumpmässigt framtagna värden i våra strata.</span></a>
<a class="sourceLine" id="cb473-2" title="2"></a>
<a class="sourceLine" id="cb473-3" title="3">Nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3300</span>, <span class="dv">4000</span>, <span class="dv">3400</span>)</a>
<a class="sourceLine" id="cb473-4" title="4"></a>
<a class="sourceLine" id="cb473-5" title="5">Ntot &lt;-<span class="st"> </span><span class="kw">sum</span>(Nj)</a>
<a class="sourceLine" id="cb473-6" title="6"></a>
<a class="sourceLine" id="cb473-7" title="7">nj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">400</span>, <span class="dv">400</span>, <span class="dv">400</span>)</a>
<a class="sourceLine" id="cb473-8" title="8"></a>
<a class="sourceLine" id="cb473-9" title="9">pj.hat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb473-10" title="10"></a>
<a class="sourceLine" id="cb473-11" title="11"><span class="co"># punktskattning</span></a>
<a class="sourceLine" id="cb473-12" title="12"></a>
<a class="sourceLine" id="cb473-13" title="13">p.hat &lt;-<span class="st"> </span>(<span class="dv">3300</span><span class="op">/</span><span class="dv">10700</span>) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">4000</span><span class="op">/</span><span class="dv">10700</span>) <span class="op">*</span><span class="st"> </span><span class="fl">0.7</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">3400</span><span class="op">/</span><span class="dv">10700</span>) <span class="op">*</span><span class="st"> </span><span class="fl">0.3</span></a></code></pre></div>
<p>Den skattade variansen för punktskattningen är</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" title="1">Var.hat.theta.hat.p &lt;-<span class="st"> </span>(<span class="dv">3300</span><span class="op">/</span><span class="dv">10700</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">400</span><span class="op">/</span><span class="dv">3300</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">399</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">4000</span><span class="op">/</span><span class="dv">10700</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">400</span><span class="op">/</span><span class="dv">4000</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">7</span><span class="op">/</span><span class="dv">10</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">7</span><span class="op">/</span><span class="dv">10</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">399</span>)  <span class="op">+</span><span class="st"> </span>(<span class="dv">3400</span><span class="op">/</span><span class="dv">10700</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">400</span><span class="op">/</span><span class="dv">3400</span>) ) <span class="op">*</span><span class="st"> </span>( (<span class="dv">3</span><span class="op">/</span><span class="dv">10</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">3</span><span class="op">/</span><span class="dv">10</span>) ) <span class="op">/</span><span class="st"> </span><span class="dv">399</span>)</a></code></pre></div>
<p>Ett 90% konfidensintervall för andelen positiva i kommunen ges av</p>
<p><span class="math display">\[\hat{p}_{st} \pm z_{\alpha/2} \sqrt{\hat{V}(\hat{p}_{st})}\]</span>
där <span class="math inline">\(z_{\alpha/2}=z_{0,05}=1,6449\)</span>. Insättning av värden ger:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" title="1">lower.lim &lt;-<span class="st"> </span>p.hat <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.p)</a>
<a class="sourceLine" id="cb475-2" title="2"></a>
<a class="sourceLine" id="cb475-3" title="3">upper.lim &lt;-<span class="st"> </span>p.hat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(Var.hat.theta.hat.p)</a></code></pre></div>
<ul>
<li>Svar: Med 90% säkerhet täcker intervallet 0,4900 till 0,5324 andelen i kommunen som ställer sig positiva till en ny arena.</li>
</ul>
<!--chapter:end:09-OSU.Rmd-->
</div>
</div>
</div>
<div id="experiment" class="section level1">
<h1><span class="header-section-number">10</span> Experiment</h1>
<div id="det-klassiska-experimentet" class="section level2">
<h2><span class="header-section-number">10.1</span> Det klassiska experimentet</h2>
<div id="randomiseringen" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Randomiseringen</h3>
<p>I det klassiska experimentet allokeras <span class="math inline">\(n\)</span> objekt (individer) slumpmässigt till en behandlingsgrupp bestående av <span class="math inline">\(n_t\)</span> objekt eller en kontrollgrupp bestående av <span class="math inline">\(n_c\)</span> objekt. Sannolikheten för ett objekt att hamna i behandlingsgruppen är <span class="math inline">\(\Pr(T=1) = n_t/n\)</span> och sannolikhet att hamna i kontrollgruppen är <span class="math inline">\(1-\Pr(T=1) = \Pr(T=0) = n_c/n\)</span>.</p>
<p>För att i praktiken allokera objekten genomförs en slumpmässig permutation av objekt i en identifieringsvariabel (som vi kan kalla <em>id_nr</em>). Permutationen görs med <strong>sample()</strong> och utan återläggning. Objekten allokeras sedan till behandlingsgruppen och kontrollgruppen genom att skapa en binär behandlingsvariabel, <em>w</em>, där de första <span class="math inline">\(n_t\)</span> elementen består av 1or (eller ett annat värde som syftar på behandlingsgruppen) och de resterande <span class="math inline">\(n_c\)</span> elementen är 0or (eller något annat värde som syftar på kontrollgruppen).</p>
<p>Allokeringen kan genomföras oavsett om det finns en komplett lista på objekt (motsvarande en urvalsram i urvalsmetoder) eller om rekrytering sker löpande där id-nr relaterar till när ett objekt rekryteras till studiens. Det enda som krävs för allokeringen är kunskap om antalet objekt i behandlingsgruppen och kontrollgruppen. Traditionellt har man då haft kuvert med id-nummer innehållande en lapp som indikerar allokering.</p>
<p><strong>Exempel 1</strong></p>
<p><em>Adman och Larsson Taghizadeh (2020) ville bland annat undersöka om det finns en effekt av avsändarens yrkestitel i e-post på skoladministratörers respons vad gäller en frågor om skolval. Utifrån en lista baserat på alla Sveriges 290 kommuner gjordes en allokering till olika behandlingsgrupper.</em></p>
<p><strong>Exempel 2</strong></p>
<p><em>Selin et al. undersökte effekten av det värkstimulerade medlet oxytocin bland gravida med utdragen förlossning. Avsikten var att se om det fanns en effekt av dos oxytocin (låg vs hög dos) på tid till att barnet var fött. Rekryteringen till det här experimentet skedde löpande på ett antal förlossningsavdelningar i Sverige. En kvinna på förlossningen blev tillfrågad om hon ville delta i experimentet. Om hon tackade ja tilldelades hon ett id-nummer och en enkät fylldes in. Därefter öppnades ett kuvert med id-numret och i kuvertet fanns stod A eller B. Eftersom blindning är viktigt vet endast den som gjort randomiseringen vilken dos A eller B refererar till. Av 1296 kvinnor som tackade ja allokerades 647 till hög dos och 648 till låg dos.</em></p>
<p><strong>Exempel 3</strong></p>
<p><em>Anta att vi i Uppsala kommun rekryterar 40 individer till att delta i ett randomiserat försök. Individerna som valt att delta i experimentet slumpas till en av två grupper. Listan med allokeringen sparas. Id-nummer skrivs ner på ett kuvert och en lapp som indikerar behandlingsgrupp läggs i kuvertet.</em></p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb476-1" title="1"><span class="co"># Antal objekt (individer) i experimentet</span></a>
<a class="sourceLine" id="cb476-2" title="2"> n &lt;-<span class="st"> </span><span class="dv">40</span></a>
<a class="sourceLine" id="cb476-3" title="3"><span class="co"># Antal objekt i behandlingsgrupp</span></a>
<a class="sourceLine" id="cb476-4" title="4"> n_t &lt;-<span class="st"> </span><span class="dv">22</span></a>
<a class="sourceLine" id="cb476-5" title="5"><span class="co"># Antal objekt i kontrollgrupp </span></a>
<a class="sourceLine" id="cb476-6" title="6"> n_c &lt;-<span class="st"> </span><span class="dv">18</span></a>
<a class="sourceLine" id="cb476-7" title="7"><span class="co"># Lista med id-nr</span></a>
<a class="sourceLine" id="cb476-8" title="8"> id_nr &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">40</span></a>
<a class="sourceLine" id="cb476-9" title="9"><span class="co"># Skapa en slumpmässig permutation (Ni kommer få en annan fördelning om vi inte sätter slumptalsfröet).</span></a>
<a class="sourceLine" id="cb476-10" title="10"> <span class="kw">set.seed</span>(<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb476-11" title="11"> id &lt;-<span class="st"> </span><span class="kw">sample</span>(id_nr, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb476-12" title="12"><span class="co"># Skapa en behandlingsvariabel </span></a>
<a class="sourceLine" id="cb476-13" title="13"> w &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, n_t), <span class="kw">rep</span>(<span class="dv">0</span>, n_c))</a>
<a class="sourceLine" id="cb476-14" title="14"><span class="co"># Dataframe för data </span></a>
<a class="sourceLine" id="cb476-15" title="15"> df_trt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> id, <span class="dt">trt =</span> w)</a>
<a class="sourceLine" id="cb476-16" title="16"> df_trt</a>
<a class="sourceLine" id="cb476-17" title="17">   id trt</a>
<a class="sourceLine" id="cb476-18" title="18"><span class="dv">1</span>  <span class="dv">32</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-19" title="19"><span class="dv">2</span>  <span class="dv">34</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-20" title="20"><span class="dv">3</span>  <span class="dv">15</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-21" title="21"><span class="dv">4</span>  <span class="dv">12</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-22" title="22"><span class="dv">5</span>   <span class="dv">1</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-23" title="23"><span class="dv">6</span>  <span class="dv">29</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-24" title="24"><span class="dv">7</span>   <span class="dv">3</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-25" title="25"><span class="dv">8</span>   <span class="dv">6</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-26" title="26"><span class="dv">9</span>  <span class="dv">22</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-27" title="27"><span class="dv">10</span> <span class="dv">20</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-28" title="28"><span class="dv">11</span> <span class="dv">11</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-29" title="29"><span class="dv">12</span>  <span class="dv">8</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-30" title="30"><span class="dv">13</span>  <span class="dv">4</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-31" title="31"><span class="dv">14</span> <span class="dv">14</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-32" title="32"><span class="dv">15</span>  <span class="dv">9</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-33" title="33"><span class="dv">16</span> <span class="dv">26</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-34" title="34"><span class="dv">17</span> <span class="dv">37</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-35" title="35"><span class="dv">18</span>  <span class="dv">7</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-36" title="36"><span class="dv">19</span> <span class="dv">35</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-37" title="37"><span class="dv">20</span> <span class="dv">19</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-38" title="38"><span class="dv">21</span> <span class="dv">33</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-39" title="39"><span class="dv">22</span> <span class="dv">23</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb476-40" title="40"><span class="dv">23</span>  <span class="dv">2</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-41" title="41"><span class="dv">24</span> <span class="dv">38</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-42" title="42"><span class="dv">25</span> <span class="dv">17</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-43" title="43"><span class="dv">26</span> <span class="dv">10</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-44" title="44"><span class="dv">27</span> <span class="dv">13</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-45" title="45"><span class="dv">28</span> <span class="dv">31</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-46" title="46"><span class="dv">29</span> <span class="dv">25</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-47" title="47"><span class="dv">30</span> <span class="dv">16</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-48" title="48"><span class="dv">31</span> <span class="dv">40</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-49" title="49"><span class="dv">32</span>  <span class="dv">5</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-50" title="50"><span class="dv">33</span> <span class="dv">18</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-51" title="51"><span class="dv">34</span> <span class="dv">21</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-52" title="52"><span class="dv">35</span> <span class="dv">27</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-53" title="53"><span class="dv">36</span> <span class="dv">24</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-54" title="54"><span class="dv">37</span> <span class="dv">28</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-55" title="55"><span class="dv">38</span> <span class="dv">36</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-56" title="56"><span class="dv">39</span> <span class="dv">30</span>   <span class="dv">0</span></a>
<a class="sourceLine" id="cb476-57" title="57"><span class="dv">40</span> <span class="dv">39</span>   <span class="dv">0</span></a></code></pre></div>
<p>Det är dock mycket vanligt att vid rekryteringen eller före randomseringen samla in data om individerna/objekten. Denna information kan vara mycket användbar på många sätt och är ofta nödvändig för att skapa sig en helhetsbild i en studie. En oerhört viktig princip är att baslinjevariabler mäts <strong>före randomiseringen</strong> eller åtminstone före man öppnar kuvertet som anger allokeringen.</p>
<p><strong>Exempel 3 forts.</strong></p>
<p><em>Anta att vi i vårt exempel mäter ålder, kön och utbildning före öppnandet av kuvertet. Vi erhåller ett mer omfattande dataset med bakgrundvariabler.</em></p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" title="1">df &lt;-<span class="st"> </span>df_trt[<span class="kw">order</span>(df_trt<span class="op">$</span>id),]</a>
<a class="sourceLine" id="cb477-2" title="2"><span class="co"># Variablerna mäts efterhand som individerna deltar i studien. </span></a>
<a class="sourceLine" id="cb477-3" title="3">df<span class="op">$</span>alder &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">34</span>,<span class="dv">56</span>,<span class="dv">59</span>,<span class="dv">34</span>,<span class="dv">37</span>,<span class="dv">46</span>,<span class="dv">43</span>,<span class="dv">45</span>,<span class="dv">66</span>,<span class="dv">55</span>,<span class="dv">29</span>,<span class="dv">55</span>,<span class="dv">67</span>,<span class="dv">66</span>,<span class="dv">54</span>,<span class="dv">67</span>,<span class="dv">45</span>,<span class="dv">32</span>,<span class="dv">44</span>,<span class="dv">45</span>,<span class="dv">29</span>,<span class="dv">33</span>,<span class="dv">66</span>,<span class="dv">55</span>,<span class="dv">34</span>,<span class="dv">22</span>,<span class="dv">66</span>,<span class="dv">23</span>,<span class="dv">34</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">48</span>,<span class="dv">56</span>,<span class="dv">33</span>,<span class="dv">61</span>,<span class="dv">60</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">66</span>,<span class="dv">43</span>)</a>
<a class="sourceLine" id="cb477-4" title="4">df<span class="op">$</span>kon &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;kvinna&quot;</span>,  <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>,<span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;man&quot;</span>,<span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>,<span class="st">&quot;man&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;kvinna&quot;</span>,  <span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;kvinna&quot;</span>,<span class="st">&quot;man&quot;</span>,<span class="st">&quot;kvinna&quot;</span>), </a>
<a class="sourceLine" id="cb477-5" title="5">              <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;kvinna&quot;</span>, <span class="st">&quot;man&quot;</span>))</a>
<a class="sourceLine" id="cb477-6" title="6">df<span class="op">$</span>utbildning &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;mellan&quot;</span>,   <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;låg&quot;</span>, <span class="st">&quot;hög&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;mellan&quot;</span>), </a>
<a class="sourceLine" id="cb477-7" title="7">                     <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;låg&quot;</span>, <span class="st">&quot;mellan&quot;</span>, <span class="st">&quot;hög&quot;</span>) )</a>
<a class="sourceLine" id="cb477-8" title="8">df</a>
<a class="sourceLine" id="cb477-9" title="9">   id trt alder    kon utbildning</a>
<a class="sourceLine" id="cb477-10" title="10"><span class="dv">5</span>   <span class="dv">1</span>   <span class="dv">1</span>    <span class="dv">34</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-11" title="11"><span class="dv">23</span>  <span class="dv">2</span>   <span class="dv">0</span>    <span class="dv">56</span>    man     mellan</a>
<a class="sourceLine" id="cb477-12" title="12"><span class="dv">7</span>   <span class="dv">3</span>   <span class="dv">1</span>    <span class="dv">59</span>    man     mellan</a>
<a class="sourceLine" id="cb477-13" title="13"><span class="dv">13</span>  <span class="dv">4</span>   <span class="dv">1</span>    <span class="dv">34</span> kvinna        låg</a>
<a class="sourceLine" id="cb477-14" title="14"><span class="dv">32</span>  <span class="dv">5</span>   <span class="dv">0</span>    <span class="dv">37</span>    man        hög</a>
<a class="sourceLine" id="cb477-15" title="15"><span class="dv">8</span>   <span class="dv">6</span>   <span class="dv">1</span>    <span class="dv">46</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-16" title="16"><span class="dv">18</span>  <span class="dv">7</span>   <span class="dv">1</span>    <span class="dv">43</span>    man        låg</a>
<a class="sourceLine" id="cb477-17" title="17"><span class="dv">12</span>  <span class="dv">8</span>   <span class="dv">1</span>    <span class="dv">45</span> kvinna        låg</a>
<a class="sourceLine" id="cb477-18" title="18"><span class="dv">15</span>  <span class="dv">9</span>   <span class="dv">1</span>    <span class="dv">66</span>    man     mellan</a>
<a class="sourceLine" id="cb477-19" title="19"><span class="dv">26</span> <span class="dv">10</span>   <span class="dv">0</span>    <span class="dv">55</span>    man     mellan</a>
<a class="sourceLine" id="cb477-20" title="20"><span class="dv">11</span> <span class="dv">11</span>   <span class="dv">1</span>    <span class="dv">29</span>    man        låg</a>
<a class="sourceLine" id="cb477-21" title="21"><span class="dv">4</span>  <span class="dv">12</span>   <span class="dv">1</span>    <span class="dv">55</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-22" title="22"><span class="dv">27</span> <span class="dv">13</span>   <span class="dv">0</span>    <span class="dv">67</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-23" title="23"><span class="dv">14</span> <span class="dv">14</span>   <span class="dv">1</span>    <span class="dv">66</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-24" title="24"><span class="dv">3</span>  <span class="dv">15</span>   <span class="dv">1</span>    <span class="dv">54</span>    man        låg</a>
<a class="sourceLine" id="cb477-25" title="25"><span class="dv">30</span> <span class="dv">16</span>   <span class="dv">0</span>    <span class="dv">67</span> kvinna        låg</a>
<a class="sourceLine" id="cb477-26" title="26"><span class="dv">25</span> <span class="dv">17</span>   <span class="dv">0</span>    <span class="dv">45</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-27" title="27"><span class="dv">33</span> <span class="dv">18</span>   <span class="dv">0</span>    <span class="dv">32</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-28" title="28"><span class="dv">20</span> <span class="dv">19</span>   <span class="dv">1</span>    <span class="dv">44</span>    man        hög</a>
<a class="sourceLine" id="cb477-29" title="29"><span class="dv">10</span> <span class="dv">20</span>   <span class="dv">1</span>    <span class="dv">45</span> kvinna        låg</a>
<a class="sourceLine" id="cb477-30" title="30"><span class="dv">34</span> <span class="dv">21</span>   <span class="dv">0</span>    <span class="dv">29</span> kvinna        hög</a>
<a class="sourceLine" id="cb477-31" title="31"><span class="dv">9</span>  <span class="dv">22</span>   <span class="dv">1</span>    <span class="dv">33</span>    man     mellan</a>
<a class="sourceLine" id="cb477-32" title="32"><span class="dv">22</span> <span class="dv">23</span>   <span class="dv">1</span>    <span class="dv">66</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-33" title="33"><span class="dv">36</span> <span class="dv">24</span>   <span class="dv">0</span>    <span class="dv">55</span>    man     mellan</a>
<a class="sourceLine" id="cb477-34" title="34"><span class="dv">29</span> <span class="dv">25</span>   <span class="dv">0</span>    <span class="dv">34</span>    man        låg</a>
<a class="sourceLine" id="cb477-35" title="35"><span class="dv">16</span> <span class="dv">26</span>   <span class="dv">1</span>    <span class="dv">22</span>    man     mellan</a>
<a class="sourceLine" id="cb477-36" title="36"><span class="dv">35</span> <span class="dv">27</span>   <span class="dv">0</span>    <span class="dv">66</span>    man        låg</a>
<a class="sourceLine" id="cb477-37" title="37"><span class="dv">37</span> <span class="dv">28</span>   <span class="dv">0</span>    <span class="dv">23</span> kvinna        låg</a>
<a class="sourceLine" id="cb477-38" title="38"><span class="dv">6</span>  <span class="dv">29</span>   <span class="dv">1</span>    <span class="dv">34</span> kvinna        hög</a>
<a class="sourceLine" id="cb477-39" title="39"><span class="dv">39</span> <span class="dv">30</span>   <span class="dv">0</span>    <span class="dv">25</span>    man        låg</a>
<a class="sourceLine" id="cb477-40" title="40"><span class="dv">28</span> <span class="dv">31</span>   <span class="dv">0</span>    <span class="dv">26</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-41" title="41"><span class="dv">1</span>  <span class="dv">32</span>   <span class="dv">1</span>    <span class="dv">48</span>    man        hög</a>
<a class="sourceLine" id="cb477-42" title="42"><span class="dv">21</span> <span class="dv">33</span>   <span class="dv">1</span>    <span class="dv">56</span>    man        hög</a>
<a class="sourceLine" id="cb477-43" title="43"><span class="dv">2</span>  <span class="dv">34</span>   <span class="dv">1</span>    <span class="dv">33</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-44" title="44"><span class="dv">19</span> <span class="dv">35</span>   <span class="dv">1</span>    <span class="dv">61</span> kvinna        låg</a>
<a class="sourceLine" id="cb477-45" title="45"><span class="dv">38</span> <span class="dv">36</span>   <span class="dv">0</span>    <span class="dv">60</span> kvinna     mellan</a>
<a class="sourceLine" id="cb477-46" title="46"><span class="dv">17</span> <span class="dv">37</span>   <span class="dv">1</span>    <span class="dv">30</span>    man        låg</a>
<a class="sourceLine" id="cb477-47" title="47"><span class="dv">24</span> <span class="dv">38</span>   <span class="dv">0</span>    <span class="dv">40</span> kvinna        hög</a>
<a class="sourceLine" id="cb477-48" title="48"><span class="dv">40</span> <span class="dv">39</span>   <span class="dv">0</span>    <span class="dv">66</span>    man     mellan</a>
<a class="sourceLine" id="cb477-49" title="49"><span class="dv">31</span> <span class="dv">40</span>   <span class="dv">0</span>    <span class="dv">43</span> kvinna     mellan</a></code></pre></div>
</div>
<div id="balans-av-baslinjemätningar" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Balans av baslinjemätningar</h3>
<p>När randomiseringen blivit genomförd undersöker vi om randomseringen har fungerat. Detta görs genom att redovisa beskrivande statistik för <strong>baslinjemätningen</strong> i behandlingsgrupp respektive kontrollgrupp. Notera att vi inte genomför någon hypotesprövning vid en jämförelse av baslinjemätningarna. Eftersom behandlingen är slumpmässig vet vi de facto att populationen inte finns någon skillnad mellan behandlingsgrupperna. En hypotesprövning är därför ologisk att genomföra eftersom vi testar en hypotes som vi vet är sann.</p>
<p>Däremot är det viktigt att deskriptivt se på hur det ser ut i data och det gör vi genom vi genom att ställa upp deskriptiv statistik i en tabell. För kvantitativa variabler redovisar man i regel antingen medelvärde och median samt tillhörande spridning mått standardavvikelse eller kvartilavstånd. För kategorivariabler redovisas oftast antal och procent.</p>
<p><strong>Exempel 3 forts.</strong></p>
<p><em>Vi vill nu i vårt randomiserade försök studera om det finns en skillnad i stickprovet mellan behandlingsgrupperna. För att undersöka detta skapar vi en tabell. Tabellen kan man sedan exportera till html-format för vidare import till ett ordbehandlingsprogram.</em></p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb478-1" title="1"><span class="co"># Ålder</span></a>
<a class="sourceLine" id="cb478-2" title="2">alder_balans &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(df<span class="op">$</span>alder[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]), <span class="kw">sd</span>(df<span class="op">$</span>alder[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]),         </a>
<a class="sourceLine" id="cb478-3" title="3">                  <span class="kw">mean</span>(df<span class="op">$</span>alder[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]), <span class="kw">sd</span>(df<span class="op">$</span>alder[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb478-4" title="4"><span class="co"># Kön</span></a>
<a class="sourceLine" id="cb478-5" title="5">kon_balans_kvinna &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb478-6" title="6">                       <span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb478-7" title="7">kon_balans_man &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">2</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb478-8" title="8">                       <span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">2</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>kon[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb478-9" title="9"><span class="co"># Utbildning</span></a>
<a class="sourceLine" id="cb478-10" title="10">utbildning_balans_lag &lt;-<span class="st">   </span><span class="kw">c</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb478-11" title="11">                             <span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb478-12" title="12">utbildning_balans_mellan &lt;-<span class="st">   </span><span class="kw">c</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">2</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb478-13" title="13">                                <span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">2</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb478-14" title="14">utbildning_balans_hog &lt;-<span class="st">   </span><span class="kw">c</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">3</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">3</span>], </a>
<a class="sourceLine" id="cb478-15" title="15">                                <span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">3</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(df<span class="op">$</span>utbildning[df<span class="op">$</span>trt <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb478-16" title="16"><span class="co"># Antal i behandlingsgrupper samt NA eftersom vi har fyra kolumner.</span></a>
<a class="sourceLine" id="cb478-17" title="17">n &lt;-<span class="st"> </span><span class="kw">c</span>(n_t,<span class="ot">NA</span>,n_c,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb478-18" title="18"></a>
<a class="sourceLine" id="cb478-19" title="19"><span class="co"># Sammanfoga vektorerna och ange sedan kolumnnamn och radnanmn</span></a>
<a class="sourceLine" id="cb478-20" title="20">Tabell1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(n,</a>
<a class="sourceLine" id="cb478-21" title="21">                 alder_balans,</a>
<a class="sourceLine" id="cb478-22" title="22">                 kon_balans_kvinna,</a>
<a class="sourceLine" id="cb478-23" title="23">                 kon_balans_man,</a>
<a class="sourceLine" id="cb478-24" title="24">                 utbildning_balans_lag,</a>
<a class="sourceLine" id="cb478-25" title="25">                 utbildning_balans_mellan,</a>
<a class="sourceLine" id="cb478-26" title="26">                 utbildning_balans_hog)</a>
<a class="sourceLine" id="cb478-27" title="27"><span class="kw">colnames</span>(Tabell1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Behandlingsgrupp&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Kontrollgrupp&quot;</span>, <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb478-28" title="28"><span class="kw">rownames</span>(Tabell1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb478-29" title="29">                      <span class="st">&quot;Ålder (medelvärde (sd))&quot;</span>, </a>
<a class="sourceLine" id="cb478-30" title="30">                      <span class="st">&quot;Kön: Kvinna (antal (%))&quot;</span>, </a>
<a class="sourceLine" id="cb478-31" title="31">                      <span class="st">&quot;Kön: Man (antal (%))&quot;</span>, </a>
<a class="sourceLine" id="cb478-32" title="32">                      <span class="st">&quot;Utbildning: låg (antal (%))&quot;</span>, </a>
<a class="sourceLine" id="cb478-33" title="33">                      <span class="st">&quot;Utbildning: mellan (antal (%))&quot;</span>, </a>
<a class="sourceLine" id="cb478-34" title="34">                      <span class="st">&quot;Utbildning: hög (antal (%))&quot;</span>)</a>
<a class="sourceLine" id="cb478-35" title="35"><span class="co"># Exportera tabellen till html. Digits anger antal decimaler i respektive kolumna</span></a>
<a class="sourceLine" id="cb478-36" title="36"><span class="kw">library</span>(<span class="st">&quot;xtable&quot;</span>)</a>
<a class="sourceLine" id="cb478-37" title="37"><span class="kw">print</span>(<span class="kw">xtable</span>(Tabell1, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<!-- html table generated in R 3.6.3 by xtable 1.8-4 package -->
<!-- Tue Dec 01 02:27:37 2020 -->
<table border="1">
<tr>
<th>
</th>
<th>
Behandlingsgrupp
</th>
<th>
V2
</th>
<th>
Kontrollgrupp
</th>
<th>
V4
</th>
</tr>
<tr>
<td align="right">
n
</td>
<td align="right">
22.0
</td>
<td align="right">
</td>
<td align="right">
18.0
</td>
<td align="right">
</td>
</tr>
<tr>
<td align="right">
Ålder (medelvärde (sd))
</td>
<td align="right">
45.6
</td>
<td align="right">
13.4
</td>
<td align="right">
45.9
</td>
<td align="right">
15.8
</td>
</tr>
<tr>
<td align="right">
Kön: Kvinna (antal (%))
</td>
<td align="right">
11.0
</td>
<td align="right">
50.0
</td>
<td align="right">
10.0
</td>
<td align="right">
55.6
</td>
</tr>
<tr>
<td align="right">
Kön: Man (antal (%))
</td>
<td align="right">
11.0
</td>
<td align="right">
50.0
</td>
<td align="right">
8.0
</td>
<td align="right">
44.4
</td>
</tr>
<tr>
<td align="right">
Utbildning: låg (antal (%))
</td>
<td align="right">
8.0
</td>
<td align="right">
36.4
</td>
<td align="right">
5.0
</td>
<td align="right">
27.8
</td>
</tr>
<tr>
<td align="right">
Utbildning: mellan (antal (%))
</td>
<td align="right">
10.0
</td>
<td align="right">
45.5
</td>
<td align="right">
10.0
</td>
<td align="right">
55.6
</td>
</tr>
<tr>
<td align="right">
Utbildning: hög (antal (%))
</td>
<td align="right">
4.0
</td>
<td align="right">
18.2
</td>
<td align="right">
3.0
</td>
<td align="right">
16.7
</td>
</tr>
</table>
<p><strong>Exempel 4</strong></p>
<p><em>Vi använder National Supported Work Demonstration project, som är att arbetsstödsprogram för långtidsarbetslösa som riktade sig till fyra grupper: tidigare dömda för brott, tidigare narkomaner, kvinnor som under en lång tid fått ekonomiskt bistånd samt avhoppare från skola. Programmet pågick i 12-18 månader på 15 ställen i USA. 6600 invivider allokerades slumpmässigt till antingen deltagande i arbetsstödsprogram eller till en kontrollgrupp. Vi har här ett urval av originaldata bestående av 722 individer. Variablerna är</em></p>
<ul>
<li>treat: 1 jobbsupport, 0 ingen support</li>
<li>age: Ålder år</li>
<li>ed: Utbildningsår</li>
<li>black: 1 afro-amerikan, 0 annars.</li>
<li>hisp: 1 hispanic, 0 annars.</li>
<li>married: 1 gift, 0 annars</li>
<li>nodel: 1 collegeexamen, 0 annars.</li>
<li>re75: reel inkomst 1975 (efter randomiseringen och start av programmet)</li>
<li>re78: reel inkomst 1978 (huvudutfallet)</li>
</ul>
<p><em>Vi skapar nu en Tabell 1 för att studera om randomiseringen har fungerat.</em></p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" title="1"> <span class="kw">library</span>(<span class="st">&quot;ATE&quot;</span>)</a>
<a class="sourceLine" id="cb479-2" title="2"> <span class="kw">data</span>(nsw)</a>
<a class="sourceLine" id="cb479-3" title="3"> alder_balans &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(nsw<span class="op">$</span>age[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]), <span class="kw">sd</span>(nsw<span class="op">$</span>age[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]), </a>
<a class="sourceLine" id="cb479-4" title="4">                 <span class="kw">mean</span>(nsw<span class="op">$</span>age[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]), <span class="kw">sd</span>(nsw<span class="op">$</span>age[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb479-5" title="5"> utb_balans &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(nsw<span class="op">$</span>ed[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]), <span class="kw">sd</span>(nsw<span class="op">$</span>ed[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]), </a>
<a class="sourceLine" id="cb479-6" title="6">                 <span class="kw">mean</span>(nsw<span class="op">$</span>ed[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]), <span class="kw">sd</span>(nsw<span class="op">$</span>ed[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb479-7" title="7"> etnicitet_balans_black&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(nsw<span class="op">$</span>black[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>black[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb479-8" title="8">                            <span class="kw">table</span>(nsw<span class="op">$</span>black[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>black[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb479-9" title="9"> etnicitet_balans_hisp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(nsw<span class="op">$</span>hisp[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>hisp[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb479-10" title="10">                            <span class="kw">table</span>(nsw<span class="op">$</span>hisp[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>hisp[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb479-11" title="11"> civilstand_balans_gift&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(nsw<span class="op">$</span>married[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>married[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">1</span>],                                      <span class="kw">table</span>(nsw<span class="op">$</span>married[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>married[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb479-12" title="12"> examen_balans_nodeg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">table</span>(nsw<span class="op">$</span>nodeg[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>nodeg[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb479-13" title="13">                            <span class="kw">table</span>(nsw<span class="op">$</span>nodeg[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>],  <span class="dv">100</span><span class="op">*</span><span class="kw">prop.table</span>(<span class="kw">table</span>(nsw<span class="op">$</span>nodeg[nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb479-14" title="14"> n_t &lt;-<span class="st"> </span><span class="kw">sum</span>(nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb479-15" title="15"> n_c &lt;-<span class="st"> </span><span class="kw">sum</span>(nsw<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb479-16" title="16"> n &lt;-<span class="st"> </span><span class="kw">c</span>(n_t, <span class="ot">NA</span>, n_c, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb479-17" title="17"> </a>
<a class="sourceLine" id="cb479-18" title="18"> <span class="co"># Sammanfoga vektorerna och ange sedan kolumnnamn och radnanmn</span></a>
<a class="sourceLine" id="cb479-19" title="19">Tabell1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(n,</a>
<a class="sourceLine" id="cb479-20" title="20">                 alder_balans,</a>
<a class="sourceLine" id="cb479-21" title="21">                 utb_balans,</a>
<a class="sourceLine" id="cb479-22" title="22">                 etnicitet_balans_black,</a>
<a class="sourceLine" id="cb479-23" title="23">                 etnicitet_balans_hisp,</a>
<a class="sourceLine" id="cb479-24" title="24">                 civilstand_balans_gift,</a>
<a class="sourceLine" id="cb479-25" title="25">                 examen_balans_nodeg)</a>
<a class="sourceLine" id="cb479-26" title="26"><span class="kw">colnames</span>(Tabell1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Behandlingsgrupp&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Kontrollgrupp&quot;</span>, <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb479-27" title="27"><span class="kw">rownames</span>(Tabell1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb479-28" title="28">                      <span class="st">&quot;Ålder (medelvärde (sd))&quot;</span>, </a>
<a class="sourceLine" id="cb479-29" title="29">                      <span class="st">&quot;Utbildningsår: (medelvärde (sd))&quot;</span>, </a>
<a class="sourceLine" id="cb479-30" title="30">                      <span class="st">&quot;Etnicitet: Afro-amerikan (antal (%))&quot;</span>, </a>
<a class="sourceLine" id="cb479-31" title="31">                      <span class="st">&quot;Etnicitet: Hispanic (antal (%))&quot;</span>,</a>
<a class="sourceLine" id="cb479-32" title="32">                      <span class="st">&quot;Civilstånd: Gift (medelvärde (sd))&quot;</span>,</a>
<a class="sourceLine" id="cb479-33" title="33">                      <span class="st">&quot;Examen: Ingen examen (antal (%))&quot;</span>)</a>
<a class="sourceLine" id="cb479-34" title="34"><span class="co"># Exportera tabellen till html. Digits anger antal decimaler i respektive kolumna</span></a>
<a class="sourceLine" id="cb479-35" title="35"><span class="kw">library</span>(<span class="st">&quot;xtable&quot;</span>)</a>
<a class="sourceLine" id="cb479-36" title="36"><span class="kw">print</span>(<span class="kw">xtable</span>(Tabell1, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<!-- html table generated in R 3.6.3 by xtable 1.8-4 package -->
<!-- Tue Dec 01 02:27:38 2020 -->
<table border="1">
<tr>
<th>
</th>
<th>
Behandlingsgrupp
</th>
<th>
V2
</th>
<th>
Kontrollgrupp
</th>
<th>
V4
</th>
</tr>
<tr>
<td align="right">
n
</td>
<td align="right">
297.0
</td>
<td align="right">
</td>
<td align="right">
425.0
</td>
<td align="right">
</td>
</tr>
<tr>
<td align="right">
Ålder (medelvärde (sd))
</td>
<td align="right">
24.6
</td>
<td align="right">
6.7
</td>
<td align="right">
24.4
</td>
<td align="right">
6.6
</td>
</tr>
<tr>
<td align="right">
Utbildningsår: (medelvärde (sd))
</td>
<td align="right">
10.4
</td>
<td align="right">
1.8
</td>
<td align="right">
10.2
</td>
<td align="right">
1.6
</td>
</tr>
<tr>
<td align="right">
Etnicitet: Afro-amerikan (antal (%))
</td>
<td align="right">
59.0
</td>
<td align="right">
19.9
</td>
<td align="right">
85.0
</td>
<td align="right">
20.0
</td>
</tr>
<tr>
<td align="right">
Etnicitet: Hispanic (antal (%))
</td>
<td align="right">
269.0
</td>
<td align="right">
90.6
</td>
<td align="right">
377.0
</td>
<td align="right">
88.7
</td>
</tr>
<tr>
<td align="right">
Civilstånd: Gift (medelvärde (sd))
</td>
<td align="right">
247.0
</td>
<td align="right">
83.2
</td>
<td align="right">
358.0
</td>
<td align="right">
84.2
</td>
</tr>
<tr>
<td align="right">
Examen: Ingen examen (antal (%))
</td>
<td align="right">
80.0
</td>
<td align="right">
26.9
</td>
<td align="right">
79.0
</td>
<td align="right">
18.6
</td>
</tr>
</table>
<p>För att få tabellerna estetiskt tilltalande i en rapport är det enklare för nybörjaren att modifiera dem i ordbehandlingsprogrammet när rapport närmar sig att bli färdig. Nedan finns ett exempel på hur en sådan tabell kan se ut.</p>
<p><img src="docs/images/baslinjensw.png" width="65%" /></p>
<p>Det bör avslutningsvis nämnas att det finns paket i R som skapar tabeller som jämför baslinjemätningar i behandlingsgrupp och i kontrollgrupp.</p>
</div>
<div id="analys" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Analys</h3>
<p>Anta att målet är att jämföra två stycken populationer med avseende på medelvärden. I populationen har vi
<span class="math display">\[\delta = \mu_t - \mu_c\]</span></p>
<p>För att skatta denna skillnad använder vi
<span class="math display">\[\hat{\delta} = \bar{y}_t - \bar{y}_c\]</span>
där <span class="math inline">\(\bar{y}_t = \dfrac{1}{n_t}\sum_{i=1}^{n_t} y_{t,i}\)</span> och <span class="math inline">\(\bar{y}_c = \dfrac{1}{n_c}\sum_{i=1}^{n_c} y_{c,i}\)</span>.</p>
<p>För att skatta variansen för denna estimator använder vi
<span class="math display">\[\hat{V}(\hat{\delta}) = \dfrac{s^2_t}{n_t} +  \dfrac{s^2_c}{n_c}\]</span></p>
<p><span class="math inline">\(\hat{\delta}\)</span> är approximativt normalfördelad i stora stickprov.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb480-1" title="1"> <span class="kw">library</span>(<span class="st">&quot;ATE&quot;</span>)</a>
<a class="sourceLine" id="cb480-2" title="2"> <span class="kw">data</span>(nsw)</a>
<a class="sourceLine" id="cb480-3" title="3"> df &lt;-<span class="st"> </span>nsw</a>
<a class="sourceLine" id="cb480-4" title="4"> n_t &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb480-5" title="5"> n_c &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb480-6" title="6"> ybar_t &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb480-7" title="7"> ybar_c &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb480-8" title="8"> deltahat &lt;-<span class="st"> </span>ybar_t  <span class="op">-</span>ybar_c</a>
<a class="sourceLine" id="cb480-9" title="9"> s2_t &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb480-10" title="10"> s2_c &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb480-11" title="11"> vhatdeltahat &lt;-<span class="st"> </span>s2_t<span class="op">/</span>n_t <span class="op">+</span><span class="st"> </span>s2_c<span class="op">/</span>n_c</a>
<a class="sourceLine" id="cb480-12" title="12"> se_hatdelta &lt;-<span class="st"> </span><span class="kw">sqrt</span>(vhatdeltahat)</a>
<a class="sourceLine" id="cb480-13" title="13"> KI_delta &lt;-<span class="st"> </span><span class="kw">c</span>(deltahat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="kw">sqrt</span>(vhatdeltahat), deltahat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="kw">sqrt</span>(vhatdeltahat))</a>
<a class="sourceLine" id="cb480-14" title="14"> zobs &lt;-<span class="st"> </span>deltahat<span class="op">/</span><span class="kw">sqrt</span>(vhatdeltahat)</a>
<a class="sourceLine" id="cb480-15" title="15"> p_value &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st">  </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zobs)))</a>
<a class="sourceLine" id="cb480-16" title="16"> deltahat</a>
<a class="sourceLine" id="cb480-17" title="17">[<span class="dv">1</span>] <span class="fl">886.3037</span></a>
<a class="sourceLine" id="cb480-18" title="18"> se_hatdelta</a>
<a class="sourceLine" id="cb480-19" title="19">[<span class="dv">1</span>] <span class="fl">488.2045</span></a>
<a class="sourceLine" id="cb480-20" title="20"> KI_delta</a>
<a class="sourceLine" id="cb480-21" title="21">[<span class="dv">1</span>]  <span class="fl">-70.57715</span> <span class="fl">1843.18461</span></a>
<a class="sourceLine" id="cb480-22" title="22"> zobs</a>
<a class="sourceLine" id="cb480-23" title="23">[<span class="dv">1</span>] <span class="fl">1.815435</span></a>
<a class="sourceLine" id="cb480-24" title="24"> p_value</a>
<a class="sourceLine" id="cb480-25" title="25">[<span class="dv">1</span>] <span class="fl">0.06945704</span></a></code></pre></div>
<p>I R används Welchs <span class="math inline">\(t\)</span>-test</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" title="1"><span class="kw">t.test</span>(df<span class="op">$</span>re78 <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>treat, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb481-2" title="2"></a>
<a class="sourceLine" id="cb481-3" title="3">    Welch Two Sample t<span class="op">-</span>test</a>
<a class="sourceLine" id="cb481-4" title="4"></a>
<a class="sourceLine" id="cb481-5" title="5">data<span class="op">:</span><span class="st">  </span>df<span class="op">$</span>re78 by df<span class="op">$</span>treat</a>
<a class="sourceLine" id="cb481-6" title="6">t =<span class="st"> </span><span class="fl">-1.8154</span>, df =<span class="st"> </span><span class="fl">557.06</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.06999</span></a>
<a class="sourceLine" id="cb481-7" title="7">alternative hypothesis<span class="op">:</span><span class="st"> </span>true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></a>
<a class="sourceLine" id="cb481-8" title="8"><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb481-9" title="9"><span class="st"> </span><span class="fl">-1845.25051</span>    <span class="fl">72.64305</span></a>
<a class="sourceLine" id="cb481-10" title="10">sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb481-11" title="11">mean <span class="cf">in</span> group <span class="dv">0</span> mean <span class="cf">in</span> group <span class="dv">1</span> </a>
<a class="sourceLine" id="cb481-12" title="12">       <span class="fl">5090.048</span>        <span class="fl">5976.352</span> </a></code></pre></div>
<p>Lika eller olika varianser?</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" title="1"><span class="kw">t.test</span>(df<span class="op">$</span>re78 <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>treat, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb482-2" title="2"></a>
<a class="sourceLine" id="cb482-3" title="3">    Two Sample t<span class="op">-</span>test</a>
<a class="sourceLine" id="cb482-4" title="4"></a>
<a class="sourceLine" id="cb482-5" title="5">data<span class="op">:</span><span class="st">  </span>df<span class="op">$</span>re78 by df<span class="op">$</span>treat</a>
<a class="sourceLine" id="cb482-6" title="6">t =<span class="st"> </span><span class="fl">-1.8774</span>, df =<span class="st"> </span><span class="dv">720</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.06086</span></a>
<a class="sourceLine" id="cb482-7" title="7">alternative hypothesis<span class="op">:</span><span class="st"> </span>true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></a>
<a class="sourceLine" id="cb482-8" title="8"><span class="dv">95</span> percent confidence interval<span class="op">:</span></a>
<a class="sourceLine" id="cb482-9" title="9"><span class="st"> </span><span class="fl">-1813.13381</span>    <span class="fl">40.52635</span></a>
<a class="sourceLine" id="cb482-10" title="10">sample estimates<span class="op">:</span></a>
<a class="sourceLine" id="cb482-11" title="11">mean <span class="cf">in</span> group <span class="dv">0</span> mean <span class="cf">in</span> group <span class="dv">1</span> </a>
<a class="sourceLine" id="cb482-12" title="12">       <span class="fl">5090.048</span>        <span class="fl">5976.352</span> </a></code></pre></div>
</div>
</div>
<div id="stratifiering" class="section level2">
<h2><span class="header-section-number">10.2</span> Stratifiering</h2>
<p>Utgå från att vi har <span class="math inline">\(G\)</span> strata eller block där stratum <span class="math inline">\(g\)</span> består <span class="math inline">\(n_g\)</span> observationer. Vi utför inom varje stratum en randomisering, enligt det klassiska experimentet. Vi har nu en stratumspecifik medelvärdesskillnad
<span class="math display">\[\delta_g = \mu_{t,g} - \mu_{c,g}\]</span>
vilken skattas med
<span class="math display">\[\hat{\delta}_g = \bar{y}_{t,g} - \bar{y}_{c,g}\]</span>
{y}_{t,g}</p>
<p>Variansen för denna skattas med</p>
<p><span class="math display">\[\hat{V}(\hat{\delta}_g) = \dfrac{s^2_{t,g}}{n_{t,g}} +  \dfrac{s^2_{c,g}}{n_{c,g}}\]</span></p>
<p>Skattningarna vi får är nu</p>
<p><span class="math display">\[\hat{\delta}_{st} = \sum_{g=1}^G\left(\dfrac{n_g}{n}\right)\hat{\delta}_g\]</span>
vars varians skattas med
<span class="math display">\[\hat{V}\left(\hat{\delta}_{st}\right) = \sum_{g=1}^G\left(\dfrac{n_g}{n}\right)^2\hat{V}(\hat{\delta}_g)\]</span></p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb483-1" title="1"><span class="co"># Stratum (block) 1</span></a>
<a class="sourceLine" id="cb483-2" title="2"> n_t1 &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb483-3" title="3"> n_c1 &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb483-4" title="4"> n_<span class="dv">1</span> &lt;-<span class="st">  </span>n_t1 <span class="op">+</span><span class="st">  </span>n_c1</a>
<a class="sourceLine" id="cb483-5" title="5"> ybar_t1 &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb483-6" title="6"> ybar_c1 &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb483-7" title="7"> deltahat_<span class="dv">1</span> &lt;-<span class="st"> </span>ybar_t1 <span class="op">-</span><span class="st"> </span>ybar_c1</a>
<a class="sourceLine" id="cb483-8" title="8"> s2_t1 &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb483-9" title="9"> s2_c1 &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb483-10" title="10"> vhatdeltahat_<span class="dv">1</span> &lt;-<span class="st"> </span>s2_t1<span class="op">/</span>n_t1 <span class="op">+</span><span class="st"> </span>s2_c1<span class="op">/</span>n_c1</a>
<a class="sourceLine" id="cb483-11" title="11"> </a>
<a class="sourceLine" id="cb483-12" title="12"> <span class="co"># Stratum (block) 2</span></a>
<a class="sourceLine" id="cb483-13" title="13"> n_t2 &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb483-14" title="14"> n_c2 &lt;-<span class="st"> </span><span class="kw">sum</span>(df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb483-15" title="15"> n_<span class="dv">2</span> &lt;-<span class="st">  </span>n_t2 <span class="op">+</span><span class="st">  </span>n_c2</a>
<a class="sourceLine" id="cb483-16" title="16"> ybar_t2 &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb483-17" title="17"> ybar_c2 &lt;-<span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb483-18" title="18"> deltahat_<span class="dv">2</span> &lt;-<span class="st"> </span>ybar_t2 <span class="op">-</span><span class="st"> </span>ybar_c2</a>
<a class="sourceLine" id="cb483-19" title="19"> s2_t2 &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb483-20" title="20"> s2_c2 &lt;-<span class="st"> </span><span class="kw">var</span>(df<span class="op">$</span>re78[df<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>u75 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb483-21" title="21"> vhatdeltahat_<span class="dv">2</span> &lt;-<span class="st"> </span>s2_t2<span class="op">/</span>n_t2 <span class="op">+</span><span class="st"> </span>s2_c2<span class="op">/</span>n_c2</a>
<a class="sourceLine" id="cb483-22" title="22"></a>
<a class="sourceLine" id="cb483-23" title="23"> n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span></a>
<a class="sourceLine" id="cb483-24" title="24"> <span class="co"># Effekt</span></a>
<a class="sourceLine" id="cb483-25" title="25"> deltahat_st &lt;-<span class="st"> </span>(n_<span class="dv">1</span><span class="op">/</span>n)<span class="op">*</span>deltahat_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2</span><span class="op">/</span>n)<span class="op">*</span>deltahat_<span class="dv">2</span> </a>
<a class="sourceLine" id="cb483-26" title="26"> vhatdeltahat_st &lt;-<span class="st"> </span>(n_<span class="dv">1</span><span class="op">/</span>n)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatdeltahat_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2</span><span class="op">/</span>n)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>vhatdeltahat_<span class="dv">2</span> </a>
<a class="sourceLine" id="cb483-27" title="27"> se_hatdelta_st &lt;-<span class="st"> </span><span class="kw">sqrt</span>(vhatdeltahat_st)</a>
<a class="sourceLine" id="cb483-28" title="28"> zobs_st &lt;-<span class="st">  </span>deltahat_st<span class="op">/</span><span class="kw">sqrt</span>(vhatdeltahat_st)</a>
<a class="sourceLine" id="cb483-29" title="29"> p_value_st &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st">  </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zobs_st)))</a>
<a class="sourceLine" id="cb483-30" title="30"> </a>
<a class="sourceLine" id="cb483-31" title="31"> KI_delta_st &lt;-<span class="st"> </span><span class="kw">c</span>(deltahat_st <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="kw">sqrt</span>(vhatdeltahat_st), deltahat_st <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="kw">sqrt</span>(vhatdeltahat_st))</a>
<a class="sourceLine" id="cb483-32" title="32"></a>
<a class="sourceLine" id="cb483-33" title="33"> </a>
<a class="sourceLine" id="cb483-34" title="34"> deltahat_st</a>
<a class="sourceLine" id="cb483-35" title="35">[<span class="dv">1</span>] <span class="ot">NaN</span></a>
<a class="sourceLine" id="cb483-36" title="36"> se_hatdelta_st</a>
<a class="sourceLine" id="cb483-37" title="37">[<span class="dv">1</span>] <span class="ot">NaN</span></a>
<a class="sourceLine" id="cb483-38" title="38"> KI_delta_st</a>
<a class="sourceLine" id="cb483-39" title="39">[<span class="dv">1</span>] <span class="ot">NaN</span> <span class="ot">NaN</span></a>
<a class="sourceLine" id="cb483-40" title="40"> p_value_st</a>
<a class="sourceLine" id="cb483-41" title="41">[<span class="dv">1</span>] <span class="ot">NaN</span></a>
<a class="sourceLine" id="cb483-42" title="42"></a>
<a class="sourceLine" id="cb483-43" title="43"><span class="co"># Jämförelse av variansskattningar  </span></a>
<a class="sourceLine" id="cb483-44" title="44"> vhatdeltahat<span class="op">/</span>vhatdeltahat_st</a>
<a class="sourceLine" id="cb483-45" title="45">[<span class="dv">1</span>] <span class="ot">NaN</span></a></code></pre></div>
</div>
<div id="anova" class="section level2">
<h2><span class="header-section-number">10.3</span> ANOVA</h2>
<p>För att introducera Analysis of Variance (ANOVA) och få en förståelse för en del underliggande koncept ska vi se på mönstringsdatat INSARK. Framför allt fokuserar vi på benstyrkan hos unga män födda år 1962, 1968 och 1974 som mönstrade. Populationsdata som består av 52347 stycken 1962, 48771 år 1968 samt 43741 år 1974 presenteras nedan.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" title="1">df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/conscriptiondata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb484-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb484-3" title="3"><span class="kw">hist</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1962</span>], <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>)</a>
<a class="sourceLine" id="cb484-4" title="4"><span class="kw">hist</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1968</span>], <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,  <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb484-5" title="5"><span class="kw">hist</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1974</span>], <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb484-6" title="6"><span class="kw">plot</span>(<span class="kw">density</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1962</span>], <span class="dt">bw =</span> <span class="dv">15</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Tre populationner?&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>)</a>
<a class="sourceLine" id="cb484-7" title="7"><span class="kw">lines</span>(<span class="kw">density</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1968</span>], <span class="dt">bw =</span> <span class="dv">15</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb484-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1974</span>], <span class="dt">bw =</span> <span class="dv">15</span>), <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb484-9" title="9"><span class="kw">plot</span>(<span class="kw">density</span>(df<span class="op">$</span>legstrength[df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1962</span> <span class="op">|</span><span class="st"> </span>df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1968</span> <span class="op">|</span><span class="st"> </span>df<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1974</span>], <span class="dt">bw =</span> <span class="dv">40</span>), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">main =</span><span class="st">&quot;En population?&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-393-1.png" width="384" /></p>
<p>Börja nu med att anta att vi inte kan observera all data. Vi önskar dock få en uppfattning om benstyrkan i populationen och om denna skiljer sig åt mellan åren. För att besvara denna fråga drar vi ett OSU från respektive födelseår med storlekarna <span class="math inline">\(n_1=120\)</span>, <span class="math inline">\(n_2=300\)</span>, <span class="math inline">\(n_3=200\)</span>. Dessa individers benstyrka mäts och data lägga in i ett dataframe.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb485-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="fl">467.4</span>,<span class="fl">590.5</span>,<span class="fl">599.7</span>,<span class="fl">546.7</span>,<span class="fl">615.9</span>,<span class="fl">508.3</span>,<span class="fl">780.3</span>,<span class="fl">563.4</span>,<span class="dv">782</span>,<span class="fl">625.9</span>,<span class="fl">709.2</span>,<span class="fl">471.9</span>,<span class="fl">623.9</span>,<span class="fl">636.6</span>,<span class="fl">706.8</span>,<span class="fl">740.6</span>,<span class="fl">580.3</span>,<span class="fl">518.1</span>,<span class="fl">526.6</span>,<span class="fl">584.8</span>,<span class="fl">470.5</span>,<span class="fl">463.8</span>,<span class="fl">627.5</span>,<span class="fl">448.1</span>,<span class="fl">464.5</span>,<span class="fl">365.2</span>,<span class="fl">603.8</span>,<span class="fl">541.6</span>,<span class="fl">612.6</span>,<span class="fl">457.1</span>,<span class="fl">472.3</span>,<span class="fl">568.6</span>,<span class="fl">479.2</span>,<span class="fl">584.1</span>,<span class="dv">303</span>,<span class="fl">673.8</span>,<span class="fl">397.6</span>,<span class="fl">513.2</span>,<span class="fl">529.6</span>,<span class="fl">766.1</span>,<span class="dv">696</span>,<span class="fl">430.3</span>,<span class="fl">452.4</span>,<span class="fl">540.8</span>,<span class="fl">641.8</span>,<span class="fl">480.2</span>,<span class="fl">411.3</span>,<span class="fl">726.2</span>,<span class="fl">577.5</span>,<span class="fl">421.5</span>,<span class="fl">515.7</span>,<span class="fl">833.8</span>,<span class="fl">512.2</span>,<span class="fl">509.3</span>,<span class="fl">420.9</span>,<span class="fl">704.2</span>,<span class="fl">467.8</span>,<span class="fl">400.7</span>,<span class="dv">419</span>,<span class="fl">427.3</span>,<span class="fl">565.9</span>,<span class="fl">564.2</span>,<span class="fl">204.2</span>,<span class="fl">490.5</span>,<span class="fl">448.9</span>,<span class="dv">792</span>,<span class="fl">389.9</span>,<span class="fl">437.7</span>,<span class="fl">440.2</span>,<span class="fl">581.2</span>,<span class="fl">465.1</span>,<span class="fl">569.1</span>,<span class="fl">698.7</span>,<span class="fl">632.1</span>,<span class="fl">336.2</span>,<span class="fl">485.5</span>,<span class="fl">452.2</span>,<span class="fl">695.1</span>,<span class="fl">394.7</span>,<span class="fl">566.1</span>,<span class="fl">628.6</span>,<span class="fl">513.7</span>,<span class="fl">692.2</span>,<span class="fl">624.7</span>,<span class="dv">664</span>,<span class="fl">482.7</span>,<span class="fl">586.8</span>,<span class="dv">651</span>,<span class="dv">530</span>,<span class="fl">683.9</span>,<span class="fl">440.5</span>,<span class="dv">548</span>,<span class="dv">563</span>,<span class="fl">592.3</span>,<span class="dv">750</span>,<span class="fl">515.9</span>,<span class="fl">685.4</span>,<span class="dv">522</span>,<span class="fl">750.1</span>,<span class="fl">778.5</span>,<span class="fl">591.8</span>,<span class="fl">635.9</span>,<span class="fl">524.9</span>,<span class="fl">356.2</span>,<span class="fl">379.3</span>,<span class="fl">455.4</span>,<span class="fl">656.4</span>,<span class="fl">587.2</span>,<span class="fl">600.9</span>,<span class="fl">623.4</span>,<span class="fl">526.3</span>,<span class="fl">550.4</span>,<span class="fl">748.2</span>,<span class="dv">518</span>,<span class="fl">594.7</span>,<span class="fl">696.7</span>,<span class="fl">829.4</span>,<span class="fl">362.9</span>,<span class="fl">679.9</span>,<span class="fl">421.8</span>,<span class="fl">626.4</span>,<span class="dv">830</span>,<span class="fl">680.2</span>,<span class="fl">400.8</span>,<span class="fl">725.5</span>,<span class="fl">472.5</span>,<span class="fl">456.9</span>,<span class="dv">640</span>,<span class="fl">710.8</span>,<span class="fl">755.6</span>,<span class="fl">643.1</span>,<span class="fl">481.6</span>,<span class="fl">794.9</span>,<span class="fl">501.1</span>,<span class="fl">597.1</span>,<span class="fl">615.3</span>,<span class="dv">524</span>,<span class="fl">732.2</span>,<span class="fl">475.6</span>,<span class="fl">641.2</span>,<span class="fl">571.4</span>,<span class="fl">721.9</span>,<span class="fl">545.8</span>,<span class="fl">487.9</span>,<span class="fl">646.1</span>,<span class="fl">546.7</span>,<span class="dv">857</span>,<span class="fl">472.1</span>,<span class="fl">497.6</span>,<span class="fl">565.2</span>,<span class="dv">835</span>,<span class="fl">478.7</span>,<span class="fl">650.7</span>,<span class="fl">564.2</span>,<span class="fl">631.5</span>,<span class="fl">636.2</span>,<span class="fl">767.6</span>,<span class="fl">437.9</span>,<span class="fl">664.7</span>,<span class="fl">592.8</span>,<span class="fl">534.3</span>,<span class="fl">465.2</span>,<span class="dv">651</span>,<span class="fl">566.8</span>,<span class="fl">608.9</span>,<span class="fl">517.3</span>,<span class="fl">582.2</span>,<span class="fl">498.9</span>,<span class="fl">616.7</span>,<span class="fl">728.5</span>,<span class="fl">541.3</span>,<span class="fl">466.1</span>,<span class="fl">449.2</span>,<span class="fl">518.9</span>,<span class="fl">702.9</span>,<span class="fl">547.9</span>,<span class="fl">582.1</span>,<span class="fl">595.4</span>,<span class="fl">532.6</span>,<span class="fl">826.1</span>,<span class="fl">633.6</span>,<span class="fl">518.5</span>,<span class="fl">500.3</span>,<span class="fl">550.6</span>,<span class="fl">635.8</span>,<span class="fl">459.2</span>,<span class="fl">777.1</span>,<span class="fl">631.4</span>,<span class="fl">578.4</span>,<span class="fl">485.9</span>,<span class="fl">855.1</span>,<span class="fl">634.8</span>,<span class="fl">816.6</span>,<span class="fl">546.8</span>,<span class="fl">555.5</span>,<span class="fl">602.4</span>,<span class="fl">501.3</span>,<span class="fl">590.5</span>,<span class="dv">518</span>,<span class="fl">634.4</span>,<span class="fl">701.2</span>,<span class="fl">762.5</span>,<span class="fl">436.8</span>,<span class="fl">497.6</span>,<span class="fl">520.6</span>,<span class="fl">556.4</span>,<span class="fl">686.6</span>,<span class="fl">553.2</span>,<span class="fl">614.2</span>,<span class="fl">580.5</span>,<span class="fl">463.3</span>,<span class="fl">707.5</span>,<span class="fl">677.5</span>,<span class="fl">773.4</span>,<span class="dv">570</span>,<span class="fl">530.9</span>,<span class="fl">524.5</span>,<span class="fl">377.8</span>,<span class="fl">467.9</span>,<span class="fl">753.2</span>,<span class="fl">705.8</span>,<span class="fl">436.4</span>,<span class="fl">732.1</span>,<span class="fl">450.2</span>,<span class="fl">699.9</span>,<span class="fl">586.2</span>,<span class="fl">464.4</span>,<span class="fl">535.9</span>,<span class="fl">632.2</span>,<span class="dv">642</span>,<span class="fl">557.7</span>,<span class="dv">436</span>,<span class="fl">604.3</span>,<span class="fl">324.8</span>,<span class="fl">496.3</span>,<span class="fl">494.5</span>,<span class="fl">576.1</span>,<span class="fl">615.4</span>,<span class="fl">439.6</span>,<span class="fl">325.9</span>,<span class="fl">589.9</span>,<span class="fl">683.2</span>,<span class="fl">513.3</span>,<span class="dv">376</span>,<span class="dv">549</span>,<span class="fl">806.1</span>,<span class="fl">463.5</span>,<span class="dv">591</span>,<span class="dv">529</span>,<span class="fl">577.3</span>,<span class="fl">567.7</span>,<span class="fl">469.4</span>,<span class="fl">408.6</span>,<span class="dv">659</span>,<span class="fl">928.6</span>,<span class="fl">679.3</span>,<span class="fl">525.9</span>,<span class="fl">427.4</span>,<span class="fl">882.2</span>,<span class="fl">528.1</span>,<span class="fl">539.5</span>,<span class="fl">656.5</span>,<span class="fl">612.4</span>,<span class="dv">629</span>,<span class="fl">370.4</span>,<span class="fl">590.9</span>,<span class="fl">582.9</span>,<span class="fl">394.5</span>,<span class="fl">590.4</span>,<span class="fl">529.7</span>,<span class="fl">401.5</span>,<span class="fl">489.3</span>,<span class="fl">826.5</span>,<span class="fl">588.6</span>,<span class="fl">659.4</span>,<span class="fl">501.5</span>,<span class="fl">598.2</span>,<span class="fl">226.1</span>,<span class="fl">446.7</span>,<span class="fl">738.5</span>,<span class="fl">738.9</span>,<span class="fl">504.9</span>,<span class="fl">440.6</span>,<span class="fl">448.6</span>,<span class="fl">733.6</span>,<span class="fl">508.4</span>,<span class="fl">560.2</span>,<span class="fl">516.5</span>,<span class="dv">784</span>,<span class="fl">549.7</span>,<span class="fl">566.8</span>,<span class="fl">582.5</span>,<span class="fl">730.7</span>,<span class="fl">623.4</span>,<span class="fl">688.2</span>,<span class="fl">746.1</span>,<span class="dv">574</span>,<span class="fl">655.1</span>,<span class="fl">690.8</span>,<span class="fl">728.5</span>,<span class="fl">489.4</span>,<span class="fl">557.2</span>,<span class="fl">622.6</span>,<span class="fl">644.8</span>,<span class="fl">586.7</span>,<span class="fl">748.9</span>,<span class="dv">900</span>,<span class="fl">649.2</span>,<span class="fl">474.3</span>,<span class="fl">485.1</span>,<span class="fl">667.3</span>,<span class="dv">667</span>,<span class="fl">457.1</span>,<span class="fl">988.4</span>,<span class="fl">445.3</span>,<span class="fl">452.1</span>,<span class="dv">691</span>,<span class="fl">556.8</span>,<span class="fl">764.6</span>,<span class="fl">615.5</span>,<span class="fl">351.7</span>,<span class="fl">436.6</span>,<span class="fl">576.8</span>,<span class="fl">553.6</span>,<span class="fl">302.5</span>,<span class="fl">586.1</span>,<span class="fl">556.1</span>,<span class="fl">601.8</span>,<span class="fl">458.7</span>,<span class="fl">704.1</span>,<span class="fl">644.5</span>,<span class="fl">471.7</span>,<span class="fl">689.4</span>,<span class="dv">482</span>,<span class="fl">728.1</span>,<span class="fl">389.4</span>,<span class="fl">723.4</span>,<span class="fl">519.5</span>,<span class="fl">761.1</span>,<span class="fl">559.6</span>,<span class="fl">635.3</span>,<span class="fl">544.8</span>,<span class="fl">750.6</span>,<span class="fl">556.4</span>,<span class="fl">498.1</span>,<span class="fl">607.5</span>,<span class="fl">576.7</span>,<span class="fl">533.2</span>,<span class="fl">536.5</span>,<span class="fl">454.6</span>,<span class="fl">625.7</span>,<span class="fl">580.3</span>,<span class="fl">499.5</span>,<span class="fl">631.5</span>,<span class="fl">396.4</span>,<span class="fl">505.1</span>,<span class="fl">616.7</span>,<span class="fl">696.5</span>,<span class="fl">694.8</span>,<span class="fl">536.7</span>,<span class="fl">435.4</span>,<span class="fl">553.1</span>,<span class="dv">484</span>,<span class="dv">561</span>,<span class="dv">575</span>,<span class="fl">487.4</span>,<span class="fl">575.6</span>,<span class="fl">567.4</span>,<span class="fl">604.6</span>,<span class="fl">453.6</span>,<span class="fl">794.4</span>,<span class="fl">557.7</span>,<span class="fl">633.8</span>,<span class="fl">635.4</span>,<span class="fl">705.6</span>,<span class="fl">504.4</span>,<span class="fl">966.9</span>,<span class="fl">463.3</span>,<span class="fl">580.2</span>,<span class="fl">502.1</span>,<span class="fl">549.1</span>,<span class="fl">668.9</span>,<span class="dv">686</span>,<span class="fl">618.6</span>,<span class="fl">458.5</span>,<span class="fl">762.3</span>,<span class="fl">388.3</span>,<span class="fl">645.9</span>,<span class="fl">483.9</span>,<span class="fl">704.9</span>,<span class="fl">561.9</span>,<span class="fl">726.9</span>,<span class="fl">535.9</span>,<span class="fl">701.6</span>,<span class="fl">611.8</span>,<span class="fl">434.7</span>,<span class="fl">668.3</span>,<span class="fl">500.9</span>,<span class="fl">617.1</span>,<span class="fl">433.5</span>,<span class="fl">682.1</span>,<span class="fl">520.5</span>,<span class="fl">709.5</span>,<span class="fl">678.8</span>,<span class="fl">699.9</span>,<span class="fl">412.6</span>,<span class="fl">857.7</span>,<span class="fl">733.1</span>,<span class="fl">643.9</span>,<span class="fl">773.4</span>,<span class="fl">662.8</span>,<span class="fl">573.8</span>,<span class="fl">673.9</span>,<span class="fl">509.7</span>,<span class="fl">608.4</span>,<span class="fl">966.8</span>,<span class="fl">628.5</span>,<span class="fl">727.7</span>,<span class="fl">542.2</span>,<span class="fl">540.4</span>,<span class="fl">625.1</span>,<span class="fl">668.2</span>,<span class="fl">645.6</span>,<span class="fl">637.1</span>,<span class="fl">554.2</span>,<span class="fl">677.3</span>,<span class="fl">562.1</span>,<span class="fl">626.8</span>,<span class="fl">742.3</span>,<span class="fl">587.1</span>,<span class="fl">903.6</span>,<span class="fl">418.5</span>,<span class="fl">895.8</span>,<span class="fl">604.1</span>,<span class="fl">378.7</span>,<span class="fl">444.8</span>,<span class="fl">526.6</span>,<span class="fl">546.4</span>,<span class="fl">751.4</span>,<span class="fl">616.7</span>,<span class="fl">723.6</span>,<span class="fl">621.7</span>,<span class="fl">786.4</span>,<span class="fl">780.3</span>,<span class="fl">622.9</span>,<span class="fl">579.2</span>,<span class="fl">744.1</span>,<span class="fl">820.4</span>,<span class="fl">792.3</span>,<span class="fl">835.9</span>,<span class="fl">563.9</span>,<span class="fl">405.1</span>,<span class="fl">671.8</span>,<span class="fl">494.6</span>,<span class="fl">735.4</span>,<span class="fl">540.7</span>,<span class="fl">605.4</span>,<span class="dv">523</span>,<span class="fl">504.5</span>,<span class="fl">697.8</span>,<span class="fl">854.2</span>,<span class="fl">580.1</span>,<span class="fl">440.3</span>,<span class="dv">480</span>,<span class="fl">415.1</span>,<span class="fl">731.8</span>,<span class="fl">489.5</span>,<span class="fl">545.8</span>,<span class="fl">460.5</span>,<span class="fl">587.5</span>,<span class="fl">689.3</span>,<span class="fl">509.2</span>,<span class="fl">798.3</span>,<span class="fl">614.1</span>,<span class="fl">661.4</span>,<span class="dv">706</span>,<span class="fl">547.9</span>,<span class="fl">663.1</span>,<span class="fl">918.8</span>,<span class="fl">724.9</span>,<span class="fl">680.4</span>,<span class="fl">744.2</span>,<span class="fl">469.7</span>,<span class="fl">360.4</span>,<span class="fl">781.5</span>,<span class="fl">700.2</span>,<span class="fl">560.4</span>,<span class="fl">591.5</span>,<span class="fl">661.4</span>,<span class="dv">697</span>,<span class="fl">595.4</span>,<span class="fl">783.1</span>,<span class="dv">570</span>,<span class="dv">630</span>,<span class="fl">1011.9</span>,<span class="fl">584.2</span>,<span class="fl">572.7</span>,<span class="fl">611.4</span>,<span class="fl">543.5</span>,<span class="fl">687.2</span>,<span class="dv">666</span>,<span class="fl">435.7</span>,<span class="fl">775.8</span>,<span class="fl">709.3</span>,<span class="fl">441.8</span>,<span class="fl">723.2</span>,<span class="dv">874</span>,<span class="fl">767.6</span>,<span class="fl">555.3</span>,<span class="fl">595.6</span>,<span class="fl">497.3</span>,<span class="fl">722.2</span>,<span class="fl">589.8</span>,<span class="fl">607.3</span>,<span class="fl">673.2</span>,<span class="fl">616.3</span>,<span class="dv">537</span>,<span class="fl">645.6</span>,<span class="fl">622.5</span>,<span class="dv">666</span>,<span class="fl">659.5</span>,<span class="fl">731.3</span>,<span class="fl">621.6</span>,<span class="fl">426.3</span>,<span class="fl">638.4</span>,<span class="fl">686.8</span>,<span class="fl">661.7</span>,<span class="fl">615.5</span>,<span class="fl">606.2</span>,<span class="fl">565.2</span>,<span class="fl">585.9</span>,<span class="fl">461.9</span>,<span class="fl">646.6</span>,<span class="fl">847.2</span>,<span class="fl">590.7</span>,<span class="dv">707</span>,<span class="fl">574.1</span>,<span class="fl">711.4</span>,<span class="fl">501.1</span>,<span class="fl">621.3</span>,<span class="fl">618.3</span>,<span class="fl">569.1</span>,<span class="fl">680.4</span>,<span class="fl">541.7</span>,<span class="dv">729</span>,<span class="dv">577</span>,<span class="fl">702.8</span>,<span class="fl">608.5</span>,<span class="fl">690.5</span>,<span class="fl">442.7</span>,<span class="fl">613.7</span>,<span class="fl">541.6</span>,<span class="fl">568.6</span>,<span class="fl">598.2</span>,<span class="fl">577.8</span>,<span class="fl">505.5</span>,<span class="fl">507.3</span>,<span class="fl">722.8</span>,<span class="fl">482.4</span>,<span class="fl">640.7</span>,<span class="dv">554</span>,<span class="fl">789.2</span>,<span class="fl">661.4</span>,<span class="fl">680.1</span>,<span class="fl">525.4</span>,<span class="fl">645.4</span>,<span class="fl">650.1</span>,<span class="fl">499.4</span>,<span class="fl">826.5</span>,<span class="fl">493.2</span>,<span class="fl">580.1</span>,<span class="fl">728.4</span>,<span class="fl">511.8</span>,<span class="fl">711.7</span>,<span class="fl">813.2</span>,<span class="fl">610.9</span>,<span class="fl">385.2</span>,<span class="fl">604.5</span>,<span class="fl">516.6</span>,<span class="fl">737.1</span>,<span class="fl">489.7</span>,<span class="fl">674.7</span>,<span class="fl">643.4</span>,<span class="fl">641.3</span>,<span class="fl">1018.2</span>,<span class="fl">698.8</span>,<span class="fl">572.6</span>,<span class="fl">774.5</span>,<span class="fl">687.2</span>,<span class="fl">417.1</span>,<span class="fl">661.6</span>,<span class="fl">817.2</span>,<span class="fl">732.5</span>,<span class="fl">451.3</span>,<span class="fl">488.1</span>,<span class="fl">653.3</span>,<span class="fl">577.9</span>,<span class="fl">494.4</span>,<span class="fl">659.9</span>,<span class="fl">457.5</span>,<span class="fl">487.8</span>,<span class="fl">641.2</span>,<span class="fl">499.5</span>,<span class="fl">611.4</span>,<span class="dv">473</span>,<span class="fl">699.3</span>,<span class="fl">518.8</span>,<span class="fl">961.8</span>,<span class="fl">774.9</span>,<span class="fl">602.5</span>,<span class="fl">539.5</span>,<span class="fl">558.8</span>,<span class="dv">638</span>,<span class="fl">421.2</span>,<span class="fl">392.6</span>,<span class="fl">640.8</span>,<span class="dv">450</span>,<span class="fl">591.7</span>,<span class="fl">530.1</span>,<span class="fl">698.5</span>),</a>
<a class="sourceLine" id="cb485-2" title="2"><span class="dt">year =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1962&quot;</span>, <span class="dv">120</span>), <span class="kw">rep</span>(<span class="st">&quot;1968&quot;</span>, <span class="dv">300</span>), <span class="kw">rep</span>(<span class="st">&quot;1974&quot;</span>, <span class="dv">200</span>)))</a></code></pre></div>
<p>Som sig bör tittar vi på data, även om vi har formulerat vår frågeställning och eventuella statistiska hypoteser i förväg. Figurerna ger inte särskilt vägledning. Det verkar finnas ganska mycket överlapp mellan åren.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb486-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb486-2" title="2"><span class="kw">hist</span>(df<span class="op">$</span>y[df<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;1962&quot;</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1200</span>), <span class="dt">freq=</span> <span class="ot">FALSE</span>, <span class="dt">col =</span><span class="st">&quot;red&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;1962&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb486-3" title="3"><span class="kw">hist</span>(df<span class="op">$</span>y[df<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;1968&quot;</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1200</span>), <span class="dt">freq=</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;1968&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb486-4" title="4"><span class="kw">hist</span>(df<span class="op">$</span>y[df<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;1974&quot;</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1200</span>), <span class="dt">freq=</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;1974&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb486-5" title="5"><span class="kw">boxplot</span>(df<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>year, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Benstyrka (Newton)&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-395-1.png" width="384" /></p>
<p>Det är tur att vi redan bestämt oss för att undersöka detta formellt och inte utifrån att vi tittat på data. Vi inleder med att konstatera att en individs värde kan delas upp i två delar</p>
<p><span class="math display">\[y_{ij} = \mu_i + \varepsilon_{ij}\]</span></p>
<p>där <span class="math inline">\(\mu_i\)</span> är medelvärdet i population <span class="math inline">\(i\)</span> från vilket individen är vald och <span class="math inline">\(\varepsilon_{ij}\)</span> som är skillnaden mellan en populations medelvärde och individens värde. För en kontinuerlig variabel har alla individer i given population <span class="math inline">\(i\)</span> olika avvikelser. Eftersom individer väljs slumpmässigt med ett osu är denna avvikelse slumpmässig.</p>
<p>Nu kommer vi till en stort steg vad gäller målet för inferens. Vi slutar nämligen just här att intressera oss för just denna ändliga population.
Visserligen skulle vi med vårt stickprov undersöka om det finns en skillnad i medelvärden i den ändliga populationen, men vid närmare eftertanke är denna hypotes tämligen ointressant. Undersökte vi alla så skulle det förmodligen finnas skillnader mellan medelvärden, om än kanske liten! UDessutom vet vi att det finns en slumpmässig naturlig variation. Det finns ingen anledning att tänka sig att benstyrkan i populationen är exakt samma varje år, utan den kommer naturligtvis att variera.</p>
<p>För att en jämförelse ska bli användbar så att en intressant frågeställning kan besvaras, t ex har benstyrkan bland ungan män förändrats mellan åren, modifierar vi ovanstående ekvation. Istället för att ha ändliga populationen som utgångspunkt ställer vi upp populationen som en statistisk fördelning. Även om skulle observera alla individer varje år så antar vi att det är dessa statistiska fördelningar som gett upphov till individernas värden.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" title="1">x =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">1200</span></a>
<a class="sourceLine" id="cb487-2" title="2"><span class="kw">plot</span>(x, <span class="kw">dnorm</span>(x, <span class="fl">583.8242</span>, <span class="dv">120</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1200</span>), <span class="dt">main=</span> <span class="st">&quot;Nollhypotes&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-396-1.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" title="1"><span class="kw">plot</span>(x, <span class="kw">dnorm</span>(x, <span class="fl">552.1966</span>, <span class="dv">120</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Mothypotes&quot;</span>)</a>
<a class="sourceLine" id="cb488-2" title="2"><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="fl">592.1725</span>, <span class="dv">120</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb488-3" title="3"><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="fl">612.3662</span>, <span class="dv">120</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-396-2.png" width="672" /></p>
<p>Nollhypotesen är den översta populationen, dvs vi tänker att benstyrkan är samma för alla år och följer samma fördelning.
Mothypotesen är att minst något att medelvärdena skiljer sig åt, dvs populationerna har olika parametervärden. Och det är just detta vi vill undersöka, det vill säga har det skett än förändring i dessa underliggare fördelningar?</p>
<p>För att besvara detta ställer vi ekvation som förut
<span class="math display">\[y_{ij} = \mu_i + \varepsilon_{ij}\]</span></p>
<p>där vi nu antar att <span class="math inline">\(\varepsilon_{ij}\)</span> är en oberoende slumpvariabel som är normalfördelad med medelvärde 0 och varians <span class="math inline">\(\sigma^2_{\varepsilon}\)</span>. Oberoende innebär intuitivt att en slumpmässig dragning från denna modell inte påverkas av en tidigare dragning. Vi skriver detta som att
<span class="math display">\[\varepsilon_{ij} \sim $N(0,\sigma^2_{\varepsilon})\]</span>. Detta kan tyckas vara ett stort antagande att göra, men vi ska se att modellen trots detta är användbar.</p>
<p>Medelvärdena syftar nu på medelvärdena i dessa fördelningar, inte i den ändliga populationen och vi formulerar hypoteserna som</p>
<p><span class="math display">\[H_0: \mu_{1962} = \mu_{1968}  = \mu_{1974}\]</span>
vs
<span class="math display">\[H_0: \text{Minst ett av medelvärdena skiljer sig åt}\]</span></p>
<p>Detta är en <strong>modellbaserad ansats</strong> där vi utgår från att data kommer från statistisk modell, och vårt mål i detta fall är att med hjälp av detta data uttala oss om något om parametrarna i modellen.</p>
<ul>
<li>Vi <span class="math inline">\(a\)</span> stycken grupper.
<span class="math display">\[H_0: \mu_{1} = \mu_{2}  = \cdots =  \mu_{a}\]</span>
vs</li>
</ul>
<p><span class="math display">\[H_1: \text{Minst en}\,\, \mu_{i} \neq \mu_{j}\]</span></p>
<p>Vi observerar <span class="math inline">\(y_{ij}\)</span>, där</p>
<ul>
<li>Varje grupp har <span class="math inline">\(n_i\)</span> observationer.</li>
<li><span class="math inline">\(\bar{y}\)</span> är medelvärdet för alla observationer i stickprovet</li>
<li><span class="math inline">\(\bar{y}_i\)</span> är medelvärdet för observationerna i stickprovet tillhörande grupp <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(i = 1,\ldots,a\)</span> indexerar grupper/faktornivår/populationer</li>
<li><span class="math inline">\(j = 1,\ldots,n_{i}\)</span> indexerer individer i grupp <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(n = \sum_{1=i}^3 n_i\)</span> är antalet indivder i studien.</li>
</ul>
<p>För att undersöka detta studeras variationen mellan grupperna och inom grupper. Vi förkastar <span class="math inline">\(H_0\)</span> om variationen mellan grupperna är stor i relation till
variationen inom grupperna (som vi antar är samma).</p>
<p>Variationen <strong>mellan</strong> grupper mäter vi med</p>
<p><span class="math display">\[SSA = \sum_{i=1}^a n_i(\bar{y}_i - \bar{y})^2\]</span>
Variationen <strong>inom</strong> grupperna är
<span class="math display">\[SSE = \sum_{i=1}^a \sum_{j}^{n_i}(y_{ij} - \bar{y}_i)^2\]</span>
Den <strong>totala</strong> variation är
<span class="math display">\[SST = \sum_{i=1}^a \sum_{j}^{n_i}(y_{ij} - \bar{y})^2\]</span></p>
<p>Man kan visa att <span class="math inline">\(SST = SSA + SSE\)</span>! Detta är ett mycket viktigt resultat och kallas för kvadratsummeuppdelning.</p>
<p>Det visar sig att dessa kvadratsummor följer statistiska fördelningar. Vi har att</p>
<p><span class="math display">\[\dfrac{SST}{\sigma^2} \sim \chi^2_{n-1}\,\,\,\,\,\,\,\,\dfrac{SSA}{\sigma^2} \sim \chi^2_{a-1}\,\,\,\,\,\,\,\,\ \dfrac{SSE}{\sigma^2} \sim \chi^2_{n-a}\]</span></p>
<p>Om SSA och SSE är oberoende så är</p>
<p><span class="math display">\[\dfrac{SSA/(a-1)}{SSE/(n-a)} = \dfrac{MSA}{MSE}\sim F_{a-1,n-a}\]</span></p>
<p>Eftersom dessa kvadratsummor följer en fördelning under nollhypotesen så kan vi beräkna <span class="math display">\[F_{obs} =\dfrac{MSA}{MSE}\]</span>
och jämföra med denna fördelning. Om <span class="math inline">\(F_{obs} &gt; F_{a-1,n-a, \alpha}\)</span>, förkasta <span class="math inline">\(H_0\)</span>. Intutionen bakom testet är att om variationen mellan behandlingarna är stor relativt variationen inom behandlingarna så är <span class="math inline">\(F_{obs}\)</span> stort. Då är det troligt att det finns en underliggare skillnad mellan populationernan.
Om <span class="math inline">\(F_{obs}\)</span> är litet så är det med överensstämmelde med att det inte finns någon skillnad mellan grupperna.</p>
<p>F-fördelningen?</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb489-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb489-2" title="2">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb489-3" title="3"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, <span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;F(2,4)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb489-4" title="4"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, <span class="dv">2</span>, <span class="dv">40</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;F(2,40)&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb489-5" title="5"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, <span class="dv">2</span>, <span class="dv">400</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;F(2,400)&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb489-6" title="6"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, <span class="dv">5</span>, <span class="dv">4</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;F(5,4)&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb489-7" title="7"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, <span class="dv">5</span>, <span class="dv">40</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;F(5,40)&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a>
<a class="sourceLine" id="cb489-8" title="8"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, <span class="dv">5</span>, <span class="dv">400</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;F(5,400)&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Täthet&quot;</span>)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-397-1.png" width="576" /></p>
<p>Stegen för en ANOVA är alltså:</p>
<ul>
<li>Ställ upp modellen
<span class="math display">\[y_{ij} = \mu_i + \varepsilon_{ij}\]</span>
där <span class="math inline">\(\varepsilon_{ij} \sim N(0, \sigma^2_\varepsilon)\)</span>.</li>
<li>Ställ upp hypoteserna enligt ovan.</li>
<li>Beräkna F-statisikan.</li>
<li>Jämför observerade <span class="math inline">\(F\)</span>-värdet med <span class="math inline">\(F\)</span>-fördelningen under nollhypotesen.</li>
</ul>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb490-1" title="1"><span class="co"># Illustration</span></a>
<a class="sourceLine" id="cb490-2" title="2"> a &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb490-3" title="3"> y_<span class="dv">1</span> &lt;-<span class="st"> </span>df<span class="op">$</span>y[df<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;1962&quot;</span>]</a>
<a class="sourceLine" id="cb490-4" title="4"> y_<span class="dv">2</span> &lt;-<span class="st"> </span>df<span class="op">$</span>y[df<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;1968&quot;</span>]</a>
<a class="sourceLine" id="cb490-5" title="5"> y_<span class="dv">3</span> &lt;-<span class="st"> </span>df<span class="op">$</span>y[df<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;1974&quot;</span>]</a>
<a class="sourceLine" id="cb490-6" title="6"> y &lt;-<span class="st"> </span>df<span class="op">$</span>y</a>
<a class="sourceLine" id="cb490-7" title="7"> n_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">length</span>(y_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb490-8" title="8"> n_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">length</span>(y_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb490-9" title="9"> n_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">length</span>(y_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb490-10" title="10"> ybar &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb490-11" title="11"> ybar_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(y_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb490-12" title="12"> ybar_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(y_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb490-13" title="13"> ybar_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(y_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb490-14" title="14"> n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">3</span></a>
<a class="sourceLine" id="cb490-15" title="15"> SSA &lt;-<span class="st"> </span>n_<span class="dv">1</span><span class="op">*</span>(ybar_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ybar)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span><span class="op">*</span>(ybar_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>ybar)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">3</span><span class="op">*</span>(ybar_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>ybar)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb490-16" title="16"> SSE &lt;-<span class="st"> </span><span class="kw">sum</span>((y_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ybar_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((y_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>ybar_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((y_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>ybar_<span class="dv">3</span>)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb490-17" title="17"> SST &lt;-<span class="st"> </span><span class="kw">sum</span>((y <span class="op">-</span><span class="st"> </span>ybar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb490-18" title="18"> fg1 &lt;-<span class="st"> </span>a<span class="dv">-1</span></a>
<a class="sourceLine" id="cb490-19" title="19"> fg2 &lt;-<span class="st"> </span>n<span class="op">-</span>a</a>
<a class="sourceLine" id="cb490-20" title="20"> MSA &lt;-<span class="st"> </span>SSA<span class="op">/</span>fg1</a>
<a class="sourceLine" id="cb490-21" title="21"> MSE &lt;-<span class="st"> </span>SSE<span class="op">/</span>fg2</a>
<a class="sourceLine" id="cb490-22" title="22"> Fobs &lt;-<span class="st"> </span>MSA<span class="op">/</span>MSE</a>
<a class="sourceLine" id="cb490-23" title="23"> p_value &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pf</span>(Fobs, fg1, fg2)</a></code></pre></div>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb491-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb491-2" title="2"><span class="kw">df</span>(x, fg1, fg2)</a>
<a class="sourceLine" id="cb491-3" title="3">  [<span class="dv">1</span>] <span class="fl">1.000000e+00</span> <span class="fl">9.045589e-01</span> <span class="fl">8.182533e-01</span> <span class="fl">7.402064e-01</span> <span class="fl">6.696255e-01</span></a>
<a class="sourceLine" id="cb491-4" title="4">  [<span class="dv">6</span>] <span class="fl">6.057944e-01</span> <span class="fl">5.480656e-01</span> <span class="fl">4.958541e-01</span> <span class="fl">4.486311e-01</span> <span class="fl">4.059185e-01</span></a>
<a class="sourceLine" id="cb491-5" title="5"> [<span class="dv">11</span>] <span class="fl">3.672843e-01</span> <span class="fl">3.323380e-01</span> <span class="fl">3.007264e-01</span> <span class="fl">2.721305e-01</span> <span class="fl">2.462616e-01</span></a>
<a class="sourceLine" id="cb491-6" title="6"> [<span class="dv">16</span>] <span class="fl">2.228591e-01</span> <span class="fl">2.016870e-01</span> <span class="fl">1.825322e-01</span> <span class="fl">1.652019e-01</span> <span class="fl">1.495218e-01</span></a>
<a class="sourceLine" id="cb491-7" title="7"> [<span class="dv">21</span>] <span class="fl">1.353343e-01</span> <span class="fl">1.224970e-01</span> <span class="fl">1.108809e-01</span> <span class="fl">1.003695e-01</span> <span class="fl">9.085757e-02</span></a>
<a class="sourceLine" id="cb491-8" title="8"> [<span class="dv">26</span>] <span class="fl">8.224968e-02</span> <span class="fl">7.445968e-02</span> <span class="fl">6.740964e-02</span> <span class="fl">6.102907e-02</span> <span class="fl">5.525421e-02</span></a>
<a class="sourceLine" id="cb491-9" title="9"> [<span class="dv">31</span>] <span class="fl">5.002739e-02</span> <span class="fl">4.529645e-02</span> <span class="fl">4.101421e-02</span> <span class="fl">3.713798e-02</span> <span class="fl">3.362917e-02</span></a>
<a class="sourceLine" id="cb491-10" title="10"> [<span class="dv">36</span>] <span class="fl">3.045284e-02</span> <span class="fl">2.757739e-02</span> <span class="fl">2.497425e-02</span> <span class="fl">2.261755e-02</span> <span class="fl">2.048388e-02</span></a>
<a class="sourceLine" id="cb491-11" title="11"> [<span class="dv">41</span>] <span class="fl">1.855209e-02</span> <span class="fl">1.680302e-02</span> <span class="fl">1.521932e-02</span> <span class="fl">1.378533e-02</span> <span class="fl">1.248685e-02</span></a>
<a class="sourceLine" id="cb491-12" title="12"> [<span class="dv">46</span>] <span class="fl">1.131103e-02</span> <span class="fl">1.024626e-02</span> <span class="fl">9.282008e-03</span> <span class="fl">8.408768e-03</span> <span class="fl">7.617922e-03</span></a>
<a class="sourceLine" id="cb491-13" title="13"> [<span class="dv">51</span>] <span class="fl">6.901673e-03</span> <span class="fl">6.252963e-03</span> <span class="fl">5.665406e-03</span> <span class="fl">5.133220e-03</span> <span class="fl">4.651172e-03</span></a>
<a class="sourceLine" id="cb491-14" title="14"> [<span class="dv">56</span>] <span class="fl">4.214524e-03</span> <span class="fl">3.818988e-03</span> <span class="fl">3.460682e-03</span> <span class="fl">3.136091e-03</span> <span class="fl">2.842034e-03</span></a>
<a class="sourceLine" id="cb491-15" title="15"> [<span class="dv">61</span>] <span class="fl">2.575630e-03</span> <span class="fl">2.334271e-03</span> <span class="fl">2.115596e-03</span> <span class="fl">1.917466e-03</span> <span class="fl">1.737945e-03</span></a>
<a class="sourceLine" id="cb491-16" title="16"> [<span class="dv">66</span>] <span class="fl">1.575282e-03</span> <span class="fl">1.427887e-03</span> <span class="fl">1.294324e-03</span> <span class="fl">1.173291e-03</span> <span class="fl">1.063609e-03</span></a>
<a class="sourceLine" id="cb491-17" title="17"> [<span class="dv">71</span>] <span class="fl">9.642099e-04</span> <span class="fl">8.741275e-04</span> <span class="fl">7.924858e-04</span> <span class="fl">7.184916e-04</span> <span class="fl">6.514265e-04</span></a>
<a class="sourceLine" id="cb491-18" title="18"> [<span class="dv">76</span>] <span class="fl">5.906396e-04</span> <span class="fl">5.355415e-04</span> <span class="fl">4.855984e-04</span> <span class="fl">4.403264e-04</span> <span class="fl">3.992874e-04</span></a>
<a class="sourceLine" id="cb491-19" title="19"> [<span class="dv">81</span>] <span class="fl">3.620846e-04</span> <span class="fl">3.283582e-04</span> <span class="fl">2.977824e-04</span> <span class="fl">2.700621e-04</span> <span class="fl">2.449298e-04</span></a>
<a class="sourceLine" id="cb491-20" title="20"> [<span class="dv">86</span>] <span class="fl">2.221432e-04</span> <span class="fl">2.014827e-04</span> <span class="fl">1.827493e-04</span> <span class="fl">1.657629e-04</span> <span class="fl">1.503599e-04</span></a>
<a class="sourceLine" id="cb491-21" title="21"> [<span class="dv">91</span>] <span class="fl">1.363924e-04</span> <span class="fl">1.237262e-04</span> <span class="fl">1.122397e-04</span> <span class="fl">1.018227e-04</span> <span class="fl">9.237538e-05</span></a>
<a class="sourceLine" id="cb491-22" title="22"> [<span class="dv">96</span>] <span class="fl">8.380713e-05</span> <span class="fl">7.603596e-05</span> <span class="fl">6.898749e-05</span> <span class="fl">6.259432e-05</span> <span class="fl">5.679536e-05</span></a>
<a class="sourceLine" id="cb491-23" title="23">[<span class="dv">101</span>] <span class="fl">5.153520e-05</span></a>
<a class="sourceLine" id="cb491-24" title="24"><span class="kw">plot</span>(x, <span class="kw">df</span>(x, fg1, fg2), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb491-25" title="25"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(Fobs))</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-399-1.png" width="384" /></p>
<p>Det finns även inbyggd funktion i R för att beräkna.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1"><span class="co"># lm()</span></a>
<a class="sourceLine" id="cb492-2" title="2">  model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(df<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>year)</a>
<a class="sourceLine" id="cb492-3" title="3">  <span class="kw">anova</span>(model1)</a>
<a class="sourceLine" id="cb492-4" title="4">Analysis of Variance Table</a>
<a class="sourceLine" id="cb492-5" title="5"></a>
<a class="sourceLine" id="cb492-6" title="6">Response<span class="op">:</span><span class="st"> </span>df<span class="op">$</span>y</a>
<a class="sourceLine" id="cb492-7" title="7">           Df  Sum Sq Mean Sq F value    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </a>
<a class="sourceLine" id="cb492-8" title="8">df<span class="op">$</span>year     <span class="dv">2</span>  <span class="dv">338372</span>  <span class="dv">169186</span>  <span class="fl">11.393</span> <span class="fl">1.384e-05</span> <span class="op">**</span><span class="er">*</span></a>
<a class="sourceLine" id="cb492-9" title="9">Residuals <span class="dv">617</span> <span class="dv">9162495</span>   <span class="dv">14850</span>                      </a>
<a class="sourceLine" id="cb492-10" title="10"><span class="op">---</span></a>
<a class="sourceLine" id="cb492-11" title="11">Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb492-12" title="12">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb492-13" title="13">  <span class="kw">qqnorm</span>(model1<span class="op">$</span>residuals)</a>
<a class="sourceLine" id="cb492-14" title="14">  <span class="kw">hist</span>(model1<span class="op">$</span>residuals)</a></code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-400-1.png" width="480" /></p>
<p>Under förutsättning av variansen är samma kan vi även beräkna ett konfidensintervall. För det första skattas
<span class="math inline">\(\mu_i\)</span> med <span class="math inline">\(\bar{y}_i\)</span>. Eftersom <span class="math inline">\(\varepsilon_{ij} \sim N(0, \sigma^2_{\varepsilon})\)</span> så är
<span class="math display">\[V(\bar{y}_i) = \dfrac{\sigma^2_\varepsilon}{n_i} \approx \dfrac{MSE}{n_i}\]</span></p>
<p>Ett konfidensintervall för <span class="math inline">\(\mu_i\)</span> ges då av
<span class="math display">\[\bar{y}_i \pm t_{\alpha/2,n-a}\sqrt{\dfrac{MSE}{n_i}}\]</span>.</p>
</div>
<div id="jämförelse-med-t-test" class="section level2">
<h2><span class="header-section-number">10.4</span> Jämförelse med t-test</h2>
<p>ANOVA med två grupper är samma som t-test med lika varianser.</p>
<p>ANOVA är ett annat sätt att formulera regressionsanalys</p>
<p>I praktiken om experimenten är någotlunda stora, ingen skillnad.</p>
</div>
<div id="experimentella-designer" class="section level2">
<h2><span class="header-section-number">10.5</span> Experimentella designer</h2>
<ul>
<li>Completely randomized expreiment (analogt med OSU)</li>
<li>Strafifierat randomized exerpiment (analogit med stratifierat urval)</li>
<li>Grupp (kluster) randomized experiment (analogt med grupp urval)</li>
</ul>
</div>
<div id="aspekter-som-inte-ingår-i-detta-block" class="section level2">
<h2><span class="header-section-number">10.6</span> Aspekter som inte ingår i detta block</h2>
<ul>
<li>Hantering av bortfall.</li>
<li>Jämförelse av medelvärden vid ANOVA med mer än 2 behandling, t ex Tukeys eller Dunnets metod.</li>
<li>Diskussion om massignifikans.</li>
<li>Analys av klusterrandomiserade experiment</li>
<li>Val av relevant parameter: Intention-to-treat. Complier average causal effect. Per protocol.</li>
<li>Hänsyn tagen till utfall mätt före randomisering. Ingår dock i regressionsdelen på kursen.</li>
<li>Styrkeberäkning</li>
<li>En tydlig åtskillnad mellan block och strata.</li>
<li>Flera mätningar per individ.</li>
<li>Icke-parametriskt alternativ</li>
<li>Icke-normalitet</li>
</ul>
</div>
</div>
<div id="referenser-2" class="section level1">
<h1><span class="header-section-number">11</span> Referenser</h1>
<p>Adman, P., &amp; Taghizadeh, J. L. (2020) Offentliga tjänstemäns bemötande av minoritetsklienter. IFAU Rapport Serie.</p>
<p>Selin, Lotta, Ulla-Britt Wennerholm, Maria Jonsson, Anna Dencker, Gunnar Wallin, Eva Wiberg-Itzel, Elisabeth Almström, Max Petzold, and Marie Berg (2019). High-dose versus low-dose of oxytocin for labour augmentation: a randomised controlled trial. Women and Birth, 32(4), 356-363</p>
<!--chapter:end:10-Experiment.Rmd-->
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
