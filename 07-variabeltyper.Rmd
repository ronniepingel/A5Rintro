# Variabeltyper

I statistik skiljer vi på kvantitativa variabler (intervall- eller kvotskola) och kategorivariabler (nominal eller ordinalskala).



Dessutom kan kvantiativa variabler vara antingen kontinuerliga eller diskreta.

I R korresponderar detta till numeriska variabler. Notera att en kvantitativ variabl kan hanteras som en kategorivariabel om den har få kategorier.


+ Det finns två typer av kvantitativa variabler i R: **numeric** eller **integer** (heltal)
+ Kategorivariabler finns som två typer: **factor** och **ordered factor**.  

För att exemplifiera tittar vi på ett datamaterial. 

```{r, echo=TRUE, eval=TRUE, collapse=FALSE, prompt=FALSE, comment='>'}
# Skapa en population och urval

# Läs in data. Vi ska välja ut födda 1961 och födda 1975.
insark <- read.csv2("D:/conscriptiondata.csv")
# Välja ut insark för födda 1961
insark1 <- insark[insark$year == 1961,]
# Välj ut INSARK för födda 1975
insark2 <- insark[insark$year == 1975,]
# Skapa ett dataset av INSARK 1961 och 1975. 
insark3 <- rbind(insark1, insark2)
# Skapa nytt rad id baserat på delpopulationen 1961 och 1975
insark3$newid <-  1:length(insark3$id) 

# Dra urval
n <- 1000
set.seed(12345)
df <- insark3[sample(insark3$newid, n), ]
```

Du har nu en data frame. Med funktionen **str()** (Compactly Display the Structure of an Arbitrary R Object) tittar man på ett objekts interna struktur. 

```{r, echo=TRUE, eval=TRUE, collapse=TRUE, prompt=FALSE, comment='>'}
str(df)
```

I `df` finns variabler som är heltal`int` och numeriska `num`. I allra flesta fall har denna distinktion ingen betydelse, utan detta hur R sparat data. Integer är nämligen inte lika minneskrävande jämfört med numeric. Statistiskt är dock bägge kvantativa variabler.

## Faktorer
Faktorer är beteckningen som R använder för kategorivariabler. Faktorer är generellt sett besvärligare att arbeta än numeriska variabler och som kan vara förvirrande är att det finns två alternativ beträffande hur man arbetar med kategorivariabler. Det går nämligen att använda kategorivariabler

+ definierade som kategorivariabler (faktorer) i R
+ som numeriska variabler om de är kodade till 0-1 variabler (eller annan typ av numerisk kodning som ger en tolkning av intresse.)

Vi kommer utgå ifrån att vi alltid försöker ha **bägge typerna** av kodning för en kategorivariabel i vårt dataset, där kategorivariabler kodade som faktorer kallas **variabelnamn_cat** och numeriska kategorivariabler kallas för  **variabelnamn_bin** pm den är kodad 0-1 eller enbart **variabelnamn** om den innehåller numeriska värden.

Vid arbete med data det av stor vikt att vara bekväm med kategorivariabler! 


### Faktorer på ordinalskala
Vi börjar med att titta på variabler vars kategorier går att rangordna.

Variablen *psych* i INSARK mäter psykisk funktionsförmåga under stressade förhållande på en skala från från 1-9. Värdet är satt av en psykolog och kan betraktas som en variabel på ordinalskala. Därför skapar vi en ny variabel `psych_cat` som R använder som ordinalskala.

För att skapa en kategorivariabel används funktionen **factor()** och i detta fall lägger vi till argumentet **ordered = TRUE** eftersom det är en kategorivariabel som går att rangordna. Kör nedanstående kod och fundera varför R ger felmeddelanden.

```{r, echo=TRUE, eval=TRUE, collapse=TRUE, prompt=FALSE, comment='>', error=TRUE}
df$psych
df$psych_cat <- factor(df$psych, ordered=TRUE)
mean(df$psych)
mean(df$psych_cat)
hist(df$psych)
hist(df$psych_cat)
```

Naturligtvis är det på grund av att vi försöker skapa histogram och medelvärden på **psych_cat** som inte är en kvantitativ variabel. Titta återigen på ditt dataset. **psych_cat** är således kategorivariabel (factor) på ordinalskalnivå.

```{r, echo=TRUE, eval=TRUE, collapse=TRUE, prompt=FALSE, comment='>'}
str(df)
df$psych_cat
```

+ Faktorer består av olika nivåer, **levels**. Om variabeln är på ordinalskalenivå. För variabeln `psych_cat` står `Levels: 1 < 2 < 3 < 4 < 5 < 6 < 7 < 8 < 9` som indikerar hur nivåerna är rangordnade. **OBS!** Trots att det är siffror i variabeln hanteras inte dessa som numeriska värden. 
+ Faktorernas nivåer kan anges med funktionen **levels*, se nedan.

```{r, echo=TRUE, eval=TRUE, collapse=TRUE, prompt=FALSE, comment='>'}
# Namn på nivåerna i faktorn psych_cat 
levels(df$psych_cat)
# Ändra namn på nivåerna i psych_cat
levels(df$psych_cat)[levels(df$psych_cat)=="1"] <- "A"
levels(df$psych_cat)[levels(df$psych_cat)=="2"] <- "B"
levels(df$psych_cat)[levels(df$psych_cat)=="3"] <- "C"
levels(df$psych_cat)[levels(df$psych_cat)=="4"] <- "D"
levels(df$psych_cat)[levels(df$psych_cat)=="5"] <- "E"
levels(df$psych_cat)[levels(df$psych_cat)=="6"] <- "F"
levels(df$psych_cat)[levels(df$psych_cat)=="7"] <- "G"
levels(df$psych_cat)[levels(df$psych_cat)=="8"] <- "H"
levels(df$psych_cat)[levels(df$psych_cat)=="9"] <- "I"
levels(df$psych_cat)
str(df$psych_cat)
```

För att ändra rangordningen används funktionen **ordered()** och argumentet **levels**.

```{r, echo=TRUE, eval=TRUE, collapse=TRUE, prompt=FALSE, comment='>'}
df$psych_cat <- ordered(df$psych_cat, levels=c("I", "H", "G", "F", "E", "D", "C", "B", "A"))
str(df$psych_cat)
```

I exemplet vänds rangordningen, men det går att ordna nivåerna i vilken ordning som helst.

## Faktorer på nominalskala
Faktorer på nominalskala innebär att kategorierna inte går att rangordna.








