<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 11 Enkel linjär regression | R på kursen Tillämpad statistik (A5)</title>
  <meta name="description" content="Kapitel 11 Enkel linjär regression | R på kursen Tillämpad statistik (A5)" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 11 Enkel linjär regression | R på kursen Tillämpad statistik (A5)" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 11 Enkel linjär regression | R på kursen Tillämpad statistik (A5)" />
  
  
  

<meta name="author" content="Ronnie Pingel" />


<meta name="date" content="2019-12-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regressionsanalys.html"/>
<link rel="next" href="multipel-linjär-regression.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Förord</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#statistiska-program"><i class="fa fa-check"></i><b>1.1</b> Statistiska program</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#om-r"><i class="fa fa-check"></i><b>1.2</b> Om R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#allmänna-tips-om-r-på-kursen"><i class="fa fa-check"></i><b>1.3</b> Allmänna tips om R på kursen</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installation-av-r"><i class="fa fa-check"></i><b>2.1</b> Installation av R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="installation.html"><a href="installation.html#installation-av-r-på-macos"><i class="fa fa-check"></i><b>2.1.1</b> Installation av R på MacOS</a></li>
<li class="chapter" data-level="2.1.2" data-path="installation.html"><a href="installation.html#installation-av-r-på-windows"><i class="fa fa-check"></i><b>2.1.2</b> Installation av R på Windows</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installation-av-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installation av RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#paket"><i class="fa fa-check"></i><b>2.3</b> Paket</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="första-sessionen.html"><a href="första-sessionen.html"><i class="fa fa-check"></i><b>3</b> Första sessionen</a></li>
<li class="chapter" data-level="4" data-path="objekt.html"><a href="objekt.html"><i class="fa fa-check"></i><b>4</b> Objekt</a><ul>
<li class="chapter" data-level="4.1" data-path="objekt.html"><a href="objekt.html#vektorer"><i class="fa fa-check"></i><b>4.1</b> Vektorer</a></li>
<li class="chapter" data-level="4.2" data-path="objekt.html"><a href="objekt.html#matriser"><i class="fa fa-check"></i><b>4.2</b> Matriser</a></li>
<li class="chapter" data-level="4.3" data-path="objekt.html"><a href="objekt.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="funktioner.html"><a href="funktioner.html"><i class="fa fa-check"></i><b>5</b> Funktioner</a></li>
<li class="chapter" data-level="6" data-path="läsa-in-och-spara-data.html"><a href="läsa-in-och-spara-data.html"><i class="fa fa-check"></i><b>6</b> Läsa in och spara data</a><ul>
<li class="chapter" data-level="6.1" data-path="läsa-in-och-spara-data.html"><a href="läsa-in-och-spara-data.html#text--och-csv-filer"><i class="fa fa-check"></i><b>6.1</b> Text- och CSV-filer</a></li>
<li class="chapter" data-level="6.2" data-path="läsa-in-och-spara-data.html"><a href="läsa-in-och-spara-data.html#excel-filer"><i class="fa fa-check"></i><b>6.2</b> Excel-filer</a></li>
<li class="chapter" data-level="6.3" data-path="läsa-in-och-spara-data.html"><a href="läsa-in-och-spara-data.html#övriga-format"><i class="fa fa-check"></i><b>6.3</b> Övriga format</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="variabeltyper.html"><a href="variabeltyper.html"><i class="fa fa-check"></i><b>7</b> Variabeltyper</a><ul>
<li class="chapter" data-level="7.1" data-path="variabeltyper.html"><a href="variabeltyper.html#faktorer"><i class="fa fa-check"></i><b>7.1</b> Faktorer</a><ul>
<li class="chapter" data-level="7.1.1" data-path="variabeltyper.html"><a href="variabeltyper.html#faktorer-på-ordinalskala"><i class="fa fa-check"></i><b>7.1.1</b> Faktorer på ordinalskala</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variabeltyper.html"><a href="variabeltyper.html#faktorer-på-nominalskala"><i class="fa fa-check"></i><b>7.2</b> Faktorer på nominalskala</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tabeller.html"><a href="tabeller.html"><i class="fa fa-check"></i><b>8</b> Tabeller</a><ul>
<li class="chapter" data-level="8.1" data-path="tabeller.html"><a href="tabeller.html#frekvenstabeller"><i class="fa fa-check"></i><b>8.1</b> Frekvenstabeller</a><ul>
<li class="chapter" data-level="8.1.1" data-path="tabeller.html"><a href="tabeller.html#frekvenstabeller-med-table"><i class="fa fa-check"></i><b>8.1.1</b> Frekvenstabeller med table()</a></li>
<li class="chapter" data-level="8.1.2" data-path="tabeller.html"><a href="tabeller.html#frekvenstabeller-med-freq"><i class="fa fa-check"></i><b>8.1.2</b> Frekvenstabeller med freq()</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tabeller.html"><a href="tabeller.html#korstabeller"><i class="fa fa-check"></i><b>8.2</b> Korstabeller</a><ul>
<li class="chapter" data-level="8.2.1" data-path="tabeller.html"><a href="tabeller.html#korstabeller-med-table"><i class="fa fa-check"></i><b>8.2.1</b> Korstabeller med table()</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tabeller.html"><a href="tabeller.html#exportera-tabeller-till-html"><i class="fa fa-check"></i><b>8.3</b> Exportera tabeller till html</a></li>
<li class="chapter" data-level="8.4" data-path="tabeller.html"><a href="tabeller.html#frekvent-förekommande-tabeller"><i class="fa fa-check"></i><b>8.4</b> Frekvent förekommande tabeller</a><ul>
<li class="chapter" data-level="8.4.1" data-path="tabeller.html"><a href="tabeller.html#tabell-för-att-beskriva-urvalet"><i class="fa fa-check"></i><b>8.4.1</b> Tabell för att beskriva urvalet</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="tabeller.html"><a href="tabeller.html#statistisk-inferens-baserat-på-korstabeller"><i class="fa fa-check"></i><b>8.5</b> Statistisk inferens baserat på korstabeller</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="figurer.html"><a href="figurer.html"><i class="fa fa-check"></i><b>9</b> Figurer</a><ul>
<li class="chapter" data-level="9.1" data-path="figurer.html"><a href="figurer.html#typer-av-figurer"><i class="fa fa-check"></i><b>9.1</b> Typer av figurer</a><ul>
<li class="chapter" data-level="9.1.1" data-path="figurer.html"><a href="figurer.html#presentation-av-aggregerade-data"><i class="fa fa-check"></i><b>9.1.1</b> Presentation av aggregerade data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="figurer.html"><a href="figurer.html#lådagram"><i class="fa fa-check"></i><b>9.2</b> Lådagram</a></li>
<li class="chapter" data-level="9.3" data-path="figurer.html"><a href="figurer.html#histogram"><i class="fa fa-check"></i><b>9.3</b> Histogram</a></li>
<li class="chapter" data-level="9.4" data-path="figurer.html"><a href="figurer.html#spridningsdiagram"><i class="fa fa-check"></i><b>9.4</b> Spridningsdiagram</a></li>
<li class="chapter" data-level="9.5" data-path="figurer.html"><a href="figurer.html#några-frekvent-förekommande-diagram."><i class="fa fa-check"></i><b>9.5</b> Några frekvent förekommande diagram.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regressionsanalys.html"><a href="regressionsanalys.html"><i class="fa fa-check"></i><b>10</b> Regressionsanalys</a><ul>
<li class="chapter" data-level="10.1" data-path="regressionsanalys.html"><a href="regressionsanalys.html#inläsning-och-kodning-av-data"><i class="fa fa-check"></i><b>10.1</b> Inläsning och kodning av data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html"><i class="fa fa-check"></i><b>11</b> Enkel linjär regression</a><ul>
<li class="chapter" data-level="11.1" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#regression-och-lm"><i class="fa fa-check"></i><b>11.1</b> Regression och <strong>lm()</strong></a></li>
<li class="chapter" data-level="11.2" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#regressions-resultat"><i class="fa fa-check"></i><b>11.2</b> Regressions resultat</a></li>
<li class="chapter" data-level="11.3" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#konfidensintervall"><i class="fa fa-check"></i><b>11.3</b> Konfidensintervall</a></li>
<li class="chapter" data-level="11.4" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#residualanalys"><i class="fa fa-check"></i><b>11.4</b> Residualanalys</a></li>
<li class="chapter" data-level="11.5" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#skattning-av-betingade-medelvärden"><i class="fa fa-check"></i><b>11.5</b> Skattning av betingade medelvärden</a></li>
<li class="chapter" data-level="11.6" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#prediktion"><i class="fa fa-check"></i><b>11.6</b> Prediktion</a></li>
<li class="chapter" data-level="11.7" data-path="enkel-linjär-regression.html"><a href="enkel-linjär-regression.html#binära-oberoende-variabler"><i class="fa fa-check"></i><b>11.7</b> Binära oberoende variabler</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multipel-linjär-regression.html"><a href="multipel-linjär-regression.html"><i class="fa fa-check"></i><b>12</b> Multipel linjär regression</a><ul>
<li class="chapter" data-level="12.1" data-path="multipel-linjär-regression.html"><a href="multipel-linjär-regression.html#regression-och-lm-1"><i class="fa fa-check"></i><b>12.1</b> Regression och <strong>lm()</strong></a></li>
<li class="chapter" data-level="12.2" data-path="multipel-linjär-regression.html"><a href="multipel-linjär-regression.html#f-test-och-anova"><i class="fa fa-check"></i><b>12.2</b> <span class="math inline">\(F\)</span>-test och <strong>anova()</strong></a></li>
<li class="chapter" data-level="12.3" data-path="multipel-linjär-regression.html"><a href="multipel-linjär-regression.html#variabler-med-flera-än-två-kategorier."><i class="fa fa-check"></i><b>12.3</b> Variabler med flera än två kategorier.</a><ul>
<li class="chapter" data-level="12.3.1" data-path="multipel-linjär-regression.html"><a href="multipel-linjär-regression.html#dummy-variabler"><i class="fa fa-check"></i><b>12.3.1</b> Dummy-variabler</a></li>
<li class="chapter" data-level="12.3.2" data-path="multipel-linjär-regression.html"><a href="multipel-linjär-regression.html#faktor-variabler"><i class="fa fa-check"></i><b>12.3.2</b> Faktor-variabler</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R på kursen Tillämpad statistik (A5)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="enkel-linjär-regression" class="section level1">
<h1><span class="header-section-number">Kapitel 11</span> Enkel linjär regression</h1>
<div id="regression-och-lm" class="section level2">
<h2><span class="header-section-number">11.1</span> Regression och <strong>lm()</strong></h2>
<p>För att genomföra linjära regressionsanalyser i R används funktionen <strong>lm()</strong> (linear models) som implementerar minstakvadradmetoden och anpassar en linjär modell till data. Funktionen <strong>lm()</strong> inleds med en formel med formen <code>y ~ x</code>, där <span class="math inline">\(y\)</span> är den beroende variabeln och <span class="math inline">\(x\)</span> är oberoende variabeln. Denna formel representerar modellen. Ett krav för <strong>lm()</strong> är att <span class="math inline">\(y\)</span> är numerisk, däremot finns ingen sådan restriktion för <span class="math inline">\(x\)</span>. Dock är det viktigt att veta hur analysen påverkas om <span class="math inline">\(x\)</span> inkluderas som numerisk variabel eller som en faktor.</p>
<p>I regel är arbetsgången sådan att en anpassad regressionsmodell sparas som ett objekt. Därefter extraherar användaren den information som är av vikt för en analys. Detta skiljer R från andra statistikprogram, som direkt ger utförliga resultattabeller. Att arbeta med objekt är emellertid inte en nackdel eftersom det innebär att större fokus läggs på syftet med analysen. Eftersom en en frågeställning i regel kräver mer än en regressionsanalys innebär arbetet med objekt att det på ett enkelt sätt går att systematisera mer omfattande analyser. Förslagsvis används objektnamn som är konsekventa, till exempel kan en regressionanalys sparas i objektet <code>m1</code> som är förkortning för modell 1.</p>
<p>Med minstakvadrat-metoden ska vi nu anpassa en regressionslinje som beskriver sambandet mellan vikt och längd.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
df &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;D:/conscriptiondata_sample.csv&quot;</span>)
m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>height, <span class="dt">data=</span>df)</code></pre></div>
<p>Den linjära regressionsanalysen är sparad i <strong>m1</strong> som ger en högst kortfattad resultatredovisning, i princip enbart koefficienterna redovisas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> weight <span class="op">~</span><span class="st"> </span>height, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span>(Intercept)       height  
<span class="op">&gt;</span><span class="st">    </span><span class="op">-</span><span class="fl">67.0638</span>       <span class="fl">0.7658</span></code></pre></div>
<p>För att undersöka övrig information sparad i <strong>m1</strong> används <strong>str()</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hämta ut regressionskoefficienterna</span>
<span class="kw">str</span>(m1)
<span class="op">&gt;</span><span class="st"> </span>List of <span class="dv">12</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>coefficients <span class="op">:</span><span class="st"> </span>Named num [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">-</span><span class="fl">67.064</span> <span class="fl">0.766</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>residuals    <span class="op">:</span><span class="st"> </span>Named num [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="fl">14.751</span> <span class="fl">2.535</span> <span class="fl">6.58</span> <span class="fl">0.345</span> <span class="fl">2.282</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="st">&quot;1&quot;</span> <span class="st">&quot;2&quot;</span> <span class="st">&quot;3&quot;</span> <span class="st">&quot;4&quot;</span> ...
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>effects      <span class="op">:</span><span class="st"> </span>Named num [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="op">-</span><span class="fl">1402.6</span> <span class="fl">96.979</span> <span class="fl">5.801</span> <span class="op">-</span><span class="fl">0.446</span> <span class="fl">1.541</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span> <span class="st">&quot;&quot;</span> <span class="st">&quot;&quot;</span> ...
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>rank         <span class="op">:</span><span class="st"> </span>int <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>fitted.values<span class="op">:</span><span class="st"> </span>Named num [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="fl">69.2</span> <span class="fl">55.5</span> <span class="fl">65.4</span> <span class="fl">64.7</span> <span class="fl">67.7</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="st">&quot;1&quot;</span> <span class="st">&quot;2&quot;</span> <span class="st">&quot;3&quot;</span> <span class="st">&quot;4&quot;</span> ...
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>assign       <span class="op">:</span><span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="dv">0</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>qr           <span class="op">:</span>List of <span class="dv">5</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>qr   <span class="op">:</span><span class="st"> </span>num [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">-</span><span class="dv">20</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> <span class="fl">0.05</span> ...
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dimnames&quot;</span>)=List of <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="st">&quot;1&quot;</span> <span class="st">&quot;2&quot;</span> <span class="st">&quot;3&quot;</span> <span class="st">&quot;4&quot;</span> ...
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;assign&quot;</span>)=<span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="dv">0</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>qraux<span class="op">:</span><span class="st"> </span>num [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="fl">1.05</span> <span class="fl">1.15</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>pivot<span class="op">:</span><span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="dv">1</span> <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>tol  <span class="op">:</span><span class="st"> </span>num <span class="fl">1e-07</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>rank <span class="op">:</span><span class="st"> </span>int <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;class&quot;</span>)=<span class="st"> </span>chr <span class="st">&quot;qr&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>df.residual  <span class="op">:</span><span class="st"> </span>int <span class="dv">398</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>xlevels      <span class="op">:</span><span class="st"> </span>Named <span class="kw">list</span>()
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>call         <span class="op">:</span><span class="st"> </span>language <span class="kw">lm</span>(<span class="dt">formula =</span> weight <span class="op">~</span><span class="st"> </span>height, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>terms        <span class="op">:</span>Classes <span class="st">&#39;terms&#39;</span>, <span class="st">&#39;formula&#39;</span>  language weight <span class="op">~</span><span class="st"> </span>height
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;variables&quot;</span>)=<span class="st"> </span>language <span class="kw">list</span>(weight, height)
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;factors&quot;</span>)=<span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dimnames&quot;</span>)=List of <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;weight&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;term.labels&quot;</span>)=<span class="st"> </span>chr <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;order&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;intercept&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;response&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;.Environment&quot;</span>)=<span class="er">&lt;</span>environment<span class="op">:</span><span class="st"> </span>R_GlobalEnv<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;predvars&quot;</span>)=<span class="st"> </span>language <span class="kw">list</span>(weight, height)
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dataClasses&quot;</span>)=<span class="st"> </span>Named chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;numeric&quot;</span> <span class="st">&quot;numeric&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;weight&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>model        <span class="op">:</span><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">    </span><span class="dv">400</span> obs. of  <span class="dv">2</span> variables<span class="op">:</span>
<span class="er">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>weight<span class="op">:</span><span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="dv">84</span> <span class="dv">58</span> <span class="dv">72</span> <span class="dv">65</span> <span class="dv">70</span> <span class="dv">62</span> <span class="dv">56</span> <span class="dv">71</span> <span class="dv">78</span> <span class="dv">99</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">$</span><span class="st"> </span>height<span class="op">:</span><span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="dv">178</span> <span class="dv">160</span> <span class="dv">173</span> <span class="dv">172</span> <span class="dv">176</span> <span class="dv">176</span> <span class="dv">182</span> <span class="dv">179</span> <span class="dv">173</span> <span class="dv">183</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;terms&quot;</span>)=Classes <span class="st">&#39;terms&#39;</span>, <span class="st">&#39;formula&#39;</span>  language weight <span class="op">~</span><span class="st"> </span>height
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;variables&quot;</span>)=<span class="st"> </span>language <span class="kw">list</span>(weight, height)
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;factors&quot;</span>)=<span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dimnames&quot;</span>)=List of <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;weight&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;term.labels&quot;</span>)=<span class="st"> </span>chr <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;order&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;intercept&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;response&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;.Environment&quot;</span>)=<span class="er">&lt;</span>environment<span class="op">:</span><span class="st"> </span>R_GlobalEnv<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;predvars&quot;</span>)=<span class="st"> </span>language <span class="kw">list</span>(weight, height)
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dataClasses&quot;</span>)=<span class="st"> </span>Named chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;numeric&quot;</span> <span class="st">&quot;numeric&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;weight&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;class&quot;</span>)=<span class="st"> </span>chr <span class="st">&quot;lm&quot;</span></code></pre></div>
<p>De mest relevanta komponenterna är:</p>
<ul>
<li>koefficienterna: <code>m1$coefficients</code></li>
<li>residualerna: <code>m1$residuals</code>.</li>
<li>kvarvarande frihetsgrader, <span class="math inline">\(n-k\)</span> där <span class="math inline">\(n\)</span> antal observationer och <span class="math inline">\(k\)</span> är antalet skattade parametrar: <code>m1$df.residual</code>.</li>
</ul>
<p>Baserat på koefficienterna <span class="math inline">\(\hat{\beta}_0=\)</span> -67.064 och <span class="math inline">\(\hat{\beta}_1=\)</span> 0.766 kan den anpassade regressionslinjen ritas ut. Vidare kan med residualerna och antalet frihetsgrader beräkna residualspridningen <span class="math inline">\(s_{\varepsilon}\)</span> utifrån att antalet observationer är <span class="math inline">\(n=\)</span> 400 och antalet skattade parametrar är <span class="math inline">\(k=2\)</span>.</p>
<p>Notera att komponenter ofta består av flera element. Om ett ett flera element är av intresse får vi åtkomst till dessa med <code>[]</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  Spridningsdiagram för x och y samt anpassad regressionslinje yhat = b0 + b1*x </span>
<span class="kw">plot</span>(df<span class="op">$</span>height, df<span class="op">$</span>weight, <span class="dt">xlab =</span> <span class="st">&quot;Längd (cm)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Vikt (kg)&quot;</span>)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">140</span>, <span class="dt">to =</span> <span class="dv">250</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)
yhat &lt;-<span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">*</span>x
<span class="kw">lines</span>(x, yhat, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)

<span class="co"># Beräkna residualspridningen </span>
res.se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(m1<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>m1<span class="op">$</span>df.residual) 
res.se</code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre><code>&gt; [1] 9.165734</code></pre>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><p><strong>Koefficienterna:</strong> I genomsnitt ökar vikten med 0.8kg om längden ökar med en cm. Interceptet -67.1 saknar en praktisk tolkning eftersom det är den skattade medelvikten för längden noll cm.</p></li>
<li><strong>Residualspridning:</strong> Vikten för de olika längerna avviker med ungefär 9.2kg från den vikt som kan avläsas från regressionssambandet.</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<ul>
<li>Riktningskoefficienten <span class="math inline">\(\hat{\beta}_1 = \dfrac{\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^n(x_i-\bar{x})^2}\)</span> kan även definieras i termer av stickprovskovarians och stickprovsvarians <span class="math inline">\(\hat{\beta}_1 = \dfrac{s_{xy}}{s_x^2}\)</span> och Pearsons korrelationskoefficient och stickprovarianser <span class="math inline">\(\hat{\beta}_1 = \rho_{xy}\dfrac{s_{y}^2}{s_x^2}\)</span>.<br />
</li>
<li>Interceptet beräknas med <span class="math inline">\(\hat{\beta}_0 = \bar{y} + \hat{\beta_1}\bar{x}\)</span>.</li>
<li>Residualspridningen (residualstandardavvikelsen) <span class="math inline">\(\sqrt{s_{\varepsilon}^2}\)</span> är ett mått på i vilken utsträckning regressionslinjen är anpassad till observationerna.</li>
<li>Residualspridningen definieras utifrån residualvariansen <span class="math inline">\(s_{\varepsilon}^2 =\dfrac{\sum_{i=1}^n (\hat{\varepsilon} - \bar{\hat{\varepsilon}})_i^2}{n-k}\)</span> där det alltid gäller att <span class="math inline">\(\bar{\hat{\varepsilon}} = 0\)</span>, <span class="math inline">\(n\)</span> är antalet observationer och <span class="math inline">\(k\)</span> är antalet skattade parametrar i modellen. Differensen <span class="math inline">\(n-k\)</span> är modellens kvarvarande frihetsgrader (residual degrees of freedom).</li>
<li>Frihetsgrader kan intuitivt förstås som antalet obereonde bitar av information som tillgänglig för att estimatera ytterligare en bit information. I statistik kan översättas till att frihetsgrader är antalet oberoende observationer som är tillgängliga för att skatta en parameter i populationen.</li>
<li>Minstakvadrat-metoden kan alltid användas som en rent numerisk metod för att analysera data i ett stickprov. Det är först när vid inferens som ytterligare antaganden krävs.</li>
</ul>
</div>
<hr />
</div>
<div id="regressions-resultat" class="section level2">
<h2><span class="header-section-number">11.2</span> Regressions resultat</h2>
<p>Funktionen <strong>lm()</strong> är begränsad, men med andra funktioner kan ytterligare information extraheras från ett objekt. Vi ska nu se på funktionen <strong>summary()</strong>. Som vanligt sparas resultatet från en funktion i ett objekt, i detta fall <strong>sum_m1</strong> (summary av modell 1).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_m1 &lt;-<span class="st"> </span><span class="kw">summary</span>(m1)
sum_m1</code></pre></div>
<pre><code>&gt; 
&gt; Call:
&gt; lm(formula = weight ~ height, data = df)
&gt; 
&gt; Residuals:
&gt;     Min      1Q  Median      3Q     Max 
&gt; -16.313  -6.216  -1.249   4.420  47.219 
&gt; 
&gt; Coefficients:
&gt;              Estimate Std. Error t value Pr(&gt;|t|)    
&gt; (Intercept) -67.06380   12.97459  -5.169 3.74e-07 ***
&gt; height        0.76580    0.07238  10.581  &lt; 2e-16 ***
&gt; ---
&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt; 
&gt; Residual standard error: 9.166 on 398 degrees of freedom
&gt; Multiple R-squared:  0.2195,  Adjusted R-squared:  0.2176 
&gt; F-statistic: 111.9 on 1 and 398 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Resultatredovisningen påminner nu i större utsträckning om en utskrift från traditionella statistikprogram, om än något mer avskalad. Det som redovisas är</p>
<ul>
<li>Parameterskattningarna <span class="math inline">\(\hat{\beta}_0=\)</span> -67.064 och <span class="math inline">\(\hat{\beta}_1=\)</span> 0.766,</li>
<li>Medelfelen för parameterskattningarna <span class="math inline">\(\sqrt{\hat{V}(\hat{\beta}_0)}\)</span> = 12.975, <span class="math inline">\(\sqrt{\hat{V}(\hat{\beta}_1)}\)</span> = 0.072<br />
</li>
<li><span class="math inline">\(t\)</span>-värdena <span class="math inline">\(t_{\beta_0}=\hat{\beta}_0/\sqrt{\hat{V}(\hat{\beta}_0)}=\)</span> -5.169 och <span class="math inline">\(t_{\beta_1}=\hat{\beta}_1/\sqrt{\hat{V}(\hat{\beta}_1)}=\)</span> 10.581,</li>
<li><span class="math inline">\(p\)</span>-värdena för <span class="math inline">\(\hat{\beta}_0\)</span> och <span class="math inline">\(\hat{\beta}_1\)</span> om <span class="math inline">\(H_0:\beta_0=0\)</span> och <span class="math inline">\(H_0:\beta_1=0\)</span>, två-sidiga mothypoteser och <span class="math inline">\(t\)</span>-fördelningen med <span class="math inline">\(n-k\)</span> frihetsgrader där <span class="math inline">\(k\)</span> är antalet skattade parametrar, i detta fall <span class="math inline">\(\beta_0\)</span> och <span class="math inline">\(\beta_1\)</span>.</li>
<li>Residualstandardavvikelsen <span class="math inline">\(s_{\varepsilon} =\)</span> 9.166</li>
<li>Förklaringsgraden <span class="math inline">\(R^2=\)</span> 0.22</li>
<li>Justerad förklaringgrad <span class="math inline">\(R^2_{adj}=\)</span> 0.218</li>
<li><span class="math inline">\(F\)</span>-testet för hela modellen med <span class="math inline">\(F_{obs}=\)</span> 111.95 och tillhörande <span class="math inline">\(p\)</span>-värde från <span class="math inline">\(F\)</span>-fördelningen under nollhypotesen med frihetsgraderna 1 och 398 och <span class="math inline">\(H_0:\beta_0=\beta_1=0\)</span>.</li>
</ul>
<p>Slutligen återstår två delar i utskriften som inte förklarats:</p>
<ul>
<li>Överst beskrivs residualerna utifrån några lägesmått. Normalt sett gör vi i en analys en mer ingående residualanalys, vilket gör denna information något överflödig.</li>
<li>I resultatbeskrivningen inkluderas stjärnor som anger hur lågt <span class="math inline">\(p\)</span>-värdet är utifrån vad om är praxis inom många ämnesområden, dvs * om <span class="math inline">\(p&lt;0.05\)</span>, ** om <span class="math inline">\(p&lt;0.01\)</span> och *** om <span class="math inline">\(p&lt;0.001\)</span>.</li>
</ul>
<p>Funktionen <strong>summary</strong> sparar dock ytterligare resultat från regressionsanalysen objektet <code>sum_m1</code> och därför använder vi <strong>str()</strong> för undersöka vad detta är.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sum_m1)
<span class="op">&gt;</span><span class="st"> </span>List of <span class="dv">11</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>call         <span class="op">:</span><span class="st"> </span>language <span class="kw">lm</span>(<span class="dt">formula =</span> weight <span class="op">~</span><span class="st"> </span>height, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>terms        <span class="op">:</span>Classes <span class="st">&#39;terms&#39;</span>, <span class="st">&#39;formula&#39;</span>  language weight <span class="op">~</span><span class="st"> </span>height
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;variables&quot;</span>)=<span class="st"> </span>language <span class="kw">list</span>(weight, height)
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;factors&quot;</span>)=<span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dimnames&quot;</span>)=List of <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;weight&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. .. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;term.labels&quot;</span>)=<span class="st"> </span>chr <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;order&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;intercept&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;response&quot;</span>)=<span class="st"> </span>int <span class="dv">1</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;.Environment&quot;</span>)=<span class="er">&lt;</span>environment<span class="op">:</span><span class="st"> </span>R_GlobalEnv<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;predvars&quot;</span>)=<span class="st"> </span>language <span class="kw">list</span>(weight, height)
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dataClasses&quot;</span>)=<span class="st"> </span>Named chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;numeric&quot;</span> <span class="st">&quot;numeric&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. .. ..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;weight&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>residuals    <span class="op">:</span><span class="st"> </span>Named num [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="fl">14.751</span> <span class="fl">2.535</span> <span class="fl">6.58</span> <span class="fl">0.345</span> <span class="fl">2.282</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="st">&quot;1&quot;</span> <span class="st">&quot;2&quot;</span> <span class="st">&quot;3&quot;</span> <span class="st">&quot;4&quot;</span> ...
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>coefficients <span class="op">:</span><span class="st"> </span>num [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">-</span><span class="fl">67.0638</span> <span class="fl">0.7658</span> <span class="fl">12.9746</span> <span class="fl">0.0724</span> <span class="op">-</span><span class="fl">5.1689</span> ...
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dimnames&quot;</span>)=List of <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="st">&quot;Estimate&quot;</span> <span class="st">&quot;Std. Error&quot;</span> <span class="st">&quot;t value&quot;</span> <span class="st">&quot;Pr(&gt;|t|)&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>aliased      <span class="op">:</span><span class="st"> </span>Named logi [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="ot">FALSE</span> <span class="ot">FALSE</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>sigma        <span class="op">:</span><span class="st"> </span>num <span class="fl">9.17</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>df           <span class="op">:</span><span class="st"> </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="dv">2</span> <span class="dv">398</span> <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>r.squared    <span class="op">:</span><span class="st"> </span>num <span class="fl">0.22</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>adj.r.squared<span class="op">:</span><span class="st"> </span>num <span class="fl">0.218</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>fstatistic   <span class="op">:</span><span class="st"> </span>Named num [<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="dv">112</span> <span class="dv">1</span> <span class="dv">398</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;names&quot;</span>)=<span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="st">&quot;value&quot;</span> <span class="st">&quot;numdf&quot;</span> <span class="st">&quot;dendf&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="er">$</span><span class="st"> </span>cov.unscaled <span class="op">:</span><span class="st"> </span>num [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="fl">2.00</span> <span class="op">-</span><span class="fl">1.12e-02</span> <span class="op">-</span><span class="fl">1.12e-02</span> <span class="fl">6.24e-05</span>
<span class="op">&gt;</span><span class="st">   </span>..<span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;dimnames&quot;</span>)=List of <span class="dv">2</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">   </span>.. ..<span class="op">$</span><span class="st"> </span><span class="er">:</span><span class="st"> </span>chr [<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="st">&quot;(Intercept)&quot;</span> <span class="st">&quot;height&quot;</span>
<span class="op">&gt;</span><span class="st">  </span><span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(<span class="op">*</span>, <span class="st">&quot;class&quot;</span>)=<span class="st"> </span>chr <span class="st">&quot;summary.lm&quot;</span></code></pre></div>
<p>Följande väsentliga komponenter finns sparade i objektet <strong>sum_m1</strong>.</p>
<ul>
<li>Residualerna: <code>sum_m1$residuals</code></li>
<li>Frihetsgrader: <code>sum_m1$df</code></li>
<li>Förklaringsgraden <span class="math inline">\(R^2\)</span>: <code>sum_m1$r.squared</code></li>
<li>Justerad förklaringsgrad <span class="math inline">\(R^2_{adj}\)</span>: <code>sum_m1$ajd.r.squared</code>. Denna är relevant vid multipel linjär regression.</li>
<li>Residualspridningen <span class="math inline">\(s_{\varepsilon}\)</span>: <code>sum_m1$sigma</code></li>
<li>F-statistikan: <code>sum_m1$fstatistic</code> som består av tre elementen <span class="math inline">\(F_{obs}\)</span>, frihetsgrader som används av modellen och kvarvarande frihetsgrader. Denna är relevant vid multipel linjär regression.</li>
</ul>
<p>Dessutom har vi</p>
<ul>
<li>Inferens för koefficenterna: <code>sum_m1$coefficients</code> som ger en matris med information. För att hämta resultat krävs att användaren anger med <code>[]</code> vilka delar av matrisen man önskar extrahera. Vi exemplifierar med medelfelen för skattningarna.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Medelfel från model 1</span>
se_beta &lt;-<span class="st"> </span>sum_m1<span class="op">$</span>coefficients[,<span class="dv">2</span>]
se_beta
<span class="op">&gt;</span><span class="st"> </span>(Intercept)      height 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">12.97458763</span>  <span class="fl">0.07237785</span></code></pre></div>
<p>Medelfelen som extraheras är <span class="math inline">\(\sqrt{\hat{V}(\hat{\beta}_0)}=\)</span> 12.9746 och <span class="math inline">\(\sqrt{\hat{V}(\hat{\beta}_1)}=\)</span> 0.0724. För att erhålla de skattade varianserna kan vi kvadrera medelfelen.</p>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><strong>p-värdet:</strong> Givet att det inte finns något (linjärt) samband mellan längd och vikt är det mycket låg sannolikhet att observera ett så stort samband som det vi observerar eller större. Data stämmer således dåligt överens med modellen om inget samband!</li>
<li><strong>Förklaringsgraden:</strong> Av variationen i vikt kan 22% förklaras av variationen i längd.</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<ul>
<li>Medelfelet <span class="math inline">\(\sqrt{\hat{V}(\hat{\beta}_1)}\)</span> skattar standardavvikelsen i samplingfördelningen för <span class="math inline">\(\hat{\beta}_1\)</span>, som är fördelningen av alla <span class="math inline">\(\hat{\beta}_1\)</span> vid upprepade stickprovsdragningar.</li>
<li>Den skattade variansen kan <span class="math inline">\(\hat{V}(\hat{\beta}_1) = \dfrac{s^2_{\varepsilon}}{\sum_{i=1}^n (x_i - \bar{x})^2}\)</span> kan skrivas i termer av residualvarians och stickprovsvarians <span class="math inline">\(\dfrac{s^2_{\varepsilon}}{(n-1)s^2_x}\)</span>.</li>
<li>I många ämnesområdena refereras det ofta till trestjärnig, tvåstjärnig och enstjärnig signifikans. Detta sätt att kategorisera resultat rekommenderas <strong>inte</strong>, utan stjärnorna ska i vårt fall <strong>enbart</strong> ses som ett hjälpmedel för läsaren. Redovisa alltid, om möjligt, de faktiska <span class="math inline">\(p\)</span>-värdena.</li>
<li>Praktiskt signifikans är inte samma som statistisk signifikans. Först punktskattningarna, sedan <span class="math inline">\(p\)</span>-värden.</li>
</ul>
</div>
<hr />
</div>
<div id="konfidensintervall" class="section level2">
<h2><span class="header-section-number">11.3</span> Konfidensintervall</h2>
<p>För att skapa ett tvåsidigt konfidensintervall för parametrarna i en linjär regression används funktionen <strong>confint()</strong> på ett objekt från <strong>lm()</strong>. Med argumentet <strong>level</strong> anges konfidensgraden. Resultatet sparas i en matris med parametrarna radvis och i kolumnerna anges nedre och övre gränserna för konfidensintervallet.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">KI &lt;-<span class="st"> </span><span class="kw">confint</span>(m1, <span class="dt">level =</span> <span class="fl">0.95</span>)
KI
<span class="op">&gt;</span><span class="st">                   </span><span class="fl">2.5</span> <span class="op">%      97.5 %</span>
<span class="er">&gt;</span><span class="st"> </span>(Intercept) <span class="op">-</span><span class="fl">92.5710915</span> <span class="op">-</span><span class="fl">41.5565096</span>
<span class="op">&gt;</span><span class="st"> </span>height        <span class="fl">0.6235134</span>   <span class="fl">0.9080948</span></code></pre></div>
<p>Funktionen <strong>confint()</strong> förenklar, men det naturligtvis även att direkt använda formeln <span class="math display">\[\hat{\beta}_1 \pm z_{\alpha/2}\sqrt{\hat{V}(\hat{\beta}_1)}\]</span> för att genomföra en intervallskattning i R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zalpha2 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)
LL &lt;-<span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>zalpha2<span class="op">*</span>se_beta[<span class="dv">2</span>]
UL &lt;-<span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>zalpha2<span class="op">*</span>se_beta[<span class="dv">2</span>]
KI_approx_normal &lt;-<span class="st"> </span><span class="kw">c</span>(LL, UL)
KI_approx_normal
<span class="op">&gt;</span><span class="st">    </span>height    height 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">0.6239461</span> <span class="fl">0.9076621</span></code></pre></div>
<p>Det finns en liten skillnad mellan metoderna och det beror på att <strong>confint()</strong> använder fördelningen <span class="math inline">\(t_{\alpha/2,(n-k)}\)</span>, medan vår manuella beräkning utnyttjar tabellvärden från en approximiativ standardiserad normalfördelning. Används <code>qt(0.975, df = sum_m1$df[2])</code> istället för <code>qnorm(0.975)</code> så erhålls exakt samma resulat som <strong>confint()</strong>. I större stickprov finns ingen skillnad av betydelse.</p>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><strong>Konfidensintervall:</strong> Med 95 säkerhet ökar vikten i genomsnitt mellan 0.62kg till 0.91kg om längden ökar med en cm.</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<ul>
<li>Ett konfidensintervall ges av formeln <span class="math inline">\(estimat \pm tabellvärde\times medelfel\)</span>.</li>
<li>Ett konfidensintervall tolkas i termer av säkerthet, <strong>inte</strong> sannolikhet. Antingen täcker det framräknade intervallet parametern i populationen, eller så täcker intervallet inte den. Intervallet har dock egenskapen att om vi tänker oss att undersökningen upprepas kommer vi i långa loppet i 95% av fallen erhålla intervall som täcker parametern i populationen.</li>
<li>Konfidensgraden 95% är vanligast, men valet konfidensgrad beror på behovet av precision.</li>
<li>Presentera om möjligt alltid konfidensintervall tillsammans med dina punktskattningar! Konfidensintervall är i regel mer informativa än <span class="math inline">\(p\)</span>-värden.</li>
</ul>
</div>
<hr />
</div>
<div id="residualanalys" class="section level2">
<h2><span class="header-section-number">11.4</span> Residualanalys</h2>
<p>En regressionsanalys bygger på att ett antal förutsättningar är uppfyllda, beroende på den typ av inferens man önskar göra.</p>
<ol style="list-style-type: decimal">
<li>Linjäritet. Detta kan undersöka genom att studera residualerna.</li>
<li>Oberoende fel. Genom att studera residualernas ordning kan</li>
<li>Heteroskedasticitet</li>
<li>Normalitet.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Figurer för residualanalys. </span>
<span class="kw">plot</span>(m1<span class="op">$</span>fitted.value, m1<span class="op">$</span>residuals, <span class="dt">main =</span> <span class="st">&quot;Residuals vs Fitted Values&quot;</span>)
<span class="kw">qqnorm</span>(m1<span class="op">$</span>residuals, <span class="dt">main=</span><span class="st">&quot;Normality&quot;</span>)</code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-13-1.png" width="672" /><img src="dpk_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<ul>
<li>Varken linjäritets eller heteroskedasticitet verkar utgöra något problem.</li>
<li>Normalitetsantagandet verkar visserligen inte vara uppfyllt, men eftersom stickprovsstorleken är stor innebär centrala gränsvärdessatsen att samplingfördelningen för <span class="math inline">\(\hat{\beta}_1\)</span> är approximativt normalfördelad.</li>
</ul>
<p>Det är även möjligt att använda Rs funktion <strong>plot()</strong> på <strong>m1</strong> som då ger fyra residualplottar istället för två. I tur och ordning anges:</p>
<ul>
<li>Residuals vs fitted för att studera linjäritet. Den röda linjen är enbart ett glidande medelvärde för hjälpa läsaren.</li>
<li>En qq-plot för att studera normalitet.</li>
<li>En residualplot för att studera heteroskedasticitet, som är något tydligare än residuals vs fitted. Om den röda linjen är ett glidande medelvärde och bör<br />
</li>
<li>En residualplot som visar inflytelserika observationer, dock ej alltid outliers även om ofta så är fallet. Vi letar efter residualer som befinner sig i övre och nedre högre hörnen som är utanför en streckad linje (Cook’s Distance). Om dessa observationer tas bort kan regressionsresultatet förändras.</li>
</ul>
<p>De två senare figurer kan vara av vikt, speciellt den med inflytelserika observationer.</p>
<p><img src="dpk_files/figure-html/unnamed-chunk-14-1.png" width="672" /><img src="dpk_files/figure-html/unnamed-chunk-14-2.png" width="672" /><img src="dpk_files/figure-html/unnamed-chunk-14-3.png" width="672" /><img src="dpk_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><strong>Förutsättningar:</strong> Om vi utifrån ett <strong>deskriptivt syfte</strong> önskar studera sambandet mellan längd och vikt kan vi lita på analysen. Sambandet verkar vara linjärt och det finns ingen heteroskedasticitet som leder till felaktiga skattningar av medelfelen. Bristen på normalitet uppvägs av stickprovsstorleken.</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommentarer </font></p>
<ul>
<li>Residualanalys är viktigt framför allt vid små stickprov och vid multipel regression. Vid enkel linjär regression upptäcks problem i regel</li>
<li>Ha rutin på alltid göra en residualanalys för att försäkra dig själv om resultaten går att lita på. Det är dock inte nödvändigt att inkludera en residualanalys i en rapport eller vetenskaplig artikel. I en <strong>uppsats</strong> bör residualanalyser finnas med i en bilaga!</li>
</ul>
</div>
<hr />
</div>
<div id="skattning-av-betingade-medelvärden" class="section level2">
<h2><span class="header-section-number">11.5</span> Skattning av betingade medelvärden</h2>
<p>Målet är att skatta det betingade medelvärdet <span class="math inline">\(\mu_{y|x=x_p}\)</span> i modellen <span class="math display">\[E(y|x=x_p) = \beta_0 + \beta_1 x_p.\]</span></p>
<p>Givet att <span class="math inline">\(\hat{\beta}_0\)</span> och <span class="math inline">\(\hat{\beta}_1\)</span> är väntevärdesriktiga skattningarna av <span class="math inline">\(\beta_0\)</span> och <span class="math inline">\(\beta_1\)</span> så är <span class="math display">\[\hat{y} = \hat{\beta}_0 + \hat{\beta}_1\]</span> en väntevärdesriktig skattning av <span class="math inline">\(\mu_{y|X=x_p}\)</span>. Baserat på koefficienterna i <strong>m1</strong> går det enkelt att beräkna <span class="math inline">\(\hat{y}\)</span>. Observera att detta de facto är värdet på regressionslinjen för ett givet <span class="math inline">\(x\)</span>-värde.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Skattning för E(y|x=p) om xp = 180</span>
yhat_coef &lt;-<span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">*</span><span class="dv">180</span>
yhat_coef
<span class="op">&gt;</span><span class="st"> </span>(Intercept) 
<span class="op">&gt;</span><span class="st">    </span><span class="fl">70.78093</span></code></pre></div>
<p>En mer flexibel metod är att dock att använda funktionen <strong>predict()</strong>:</p>
<ol style="list-style-type: decimal">
<li>Använd <strong>lm()</strong> för att skatta <span class="math inline">\(\beta_0\)</span> och <span class="math inline">\(\beta_1\)</span> och spara analysen i ett objekt, t ex <strong>m1</strong>.</li>
<li>Skapa ett nytt data frame, t ex <strong>new</strong>, innehållande en <span class="math inline">\(x\)</span>-variabel med värdet <span class="math inline">\(x_p\)</span>. Namnet på variabeln i <strong>new</strong> måste vara <strong>exakt samma</strong> som namnet i den sparade modellen i m1.</li>
<li>Använd <strong>m1</strong> och <strong>new</strong> i funktionen <strong>predict</strong>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xp &lt;-<span class="st"> </span><span class="dv">180</span>
new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">height =</span> xp)
yhat &lt;-<span class="st"> </span><span class="kw">predict</span>(m1, new)
yhat
<span class="op">&gt;</span><span class="st">        </span><span class="dv">1</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">70.78093</span></code></pre></div>
<p>Vi ser att detta ger samma resultat som <code>yhat_coef</code> och <code>yhat</code>. Medelvikten för 18-åriga män som är 180cm långa är = 70.78</p>
<p>Detta säger dock inget om precisionen i skattningen. Med tillhägget <code>se.fit = TRUE</code> erhålls även medelfelet för skattningen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">yhat &lt;-<span class="st"> </span><span class="kw">predict</span>(m1, new, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)
yhat
<span class="op">&gt;</span><span class="st"> </span><span class="er">$</span>fit
<span class="op">&gt;</span><span class="st">        </span><span class="dv">1</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">70.78093</span> 
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>se.fit
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.4623976</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>df
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">398</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>residual.scale
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">9.165734</span></code></pre></div>
<p>Följande två väsentliga komponenter finns nu:</p>
<ul>
<li>Skattningen av betingade medelvärdet: <code>yhat$fit</code></li>
<li>Medelfelet för skattningen av det betingade medelvärdet: <code>yhat$se.fit</code></li>
</ul>
<p>Medelvikten för 18-åriga män som är 180cm långa skattas till = 70.78kg och medelfelet för denna skattning är 0.462. För att erhålla ett konfidensintervall för medelvikten givet en viss kroppslängd kan man lägga till <code>interval = &quot;confidence&quot;</code> i <strong>predict()</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">yhat &lt;-<span class="st"> </span><span class="kw">predict</span>(m1, new, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)
yhat
<span class="op">&gt;</span><span class="st"> </span><span class="er">$</span>fit
<span class="op">&gt;</span><span class="st">        </span>fit      lwr      upr
<span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="fl">70.78093</span> <span class="fl">69.87189</span> <span class="fl">71.68998</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>se.fit
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.4623976</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>df
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">398</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>residual.scale
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">9.165734</span></code></pre></div>
<p>Komponenten <code>$fit$</code> består nu av tre delar, där <code>yhat$fit[1]</code> är skattningen av medelvärdet, <code>yhat$fit[2]</code> den nedre och <code>yhat$fit[3]</code> den övre gränsen av det framräknade konfidensintervallet. Således kan vi säga att med 95% säkerhet är medelvikten för 18-åriga män som är 180cm mellan 69.87 och 71.69kg.</p>
<p>Detta går även att räkna ut manuellt baserat på den formler som vi har.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hämtar Residualspridningen från objektet sum_m1</span>
yhat.se &lt;-<span class="st"> </span><span class="kw">sqrt</span>( sum_m1<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span>( <span class="dv">1</span><span class="op">/</span>(m1<span class="op">$</span>df.residual <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(xp <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>height))<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sum</span>( (df<span class="op">$</span>height <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>height) )<span class="op">^</span><span class="dv">2</span> )))
z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)
yhat.LL &lt;-<span class="st"> </span>yhat<span class="op">$</span>fit[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>z<span class="op">*</span>yhat.se
yhat.UL &lt;-<span class="st"> </span>yhat<span class="op">$</span>fit[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>z<span class="op">*</span>yhat.se
yhat_approx_normal &lt;-<span class="st"> </span><span class="kw">c</span>(yhat.LL, yhat.UL)
yhat_approx_normal
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">69.87465</span> <span class="fl">71.68722</span></code></pre></div>
<p>Om man önskar göra skattningar av det betingade medelvärdet för flera <span class="math inline">\(x\)</span>-värden konstruerar vi ett data frame med flera <span class="math inline">\(x_p\)</span>. Observera att om detta görs för alla <span class="math inline">\(x\)</span> så är detta regressionlinjen!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xps &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">150</span>, <span class="dt">to =</span> <span class="dv">230</span>, <span class="dt">by =</span> <span class="dv">1</span>)
news &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">height =</span> xps)
yhat_band &lt;-<span class="st"> </span><span class="kw">predict</span>(m1, news, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)
yhat_band<span class="op">$</span>fit[,<span class="dv">1</span>]
<span class="op">&gt;</span><span class="st">         </span><span class="dv">1</span>         <span class="dv">2</span>         <span class="dv">3</span>         <span class="dv">4</span>         <span class="dv">5</span>         <span class="dv">6</span>         <span class="dv">7</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">47.80681</span>  <span class="fl">48.57262</span>  <span class="fl">49.33842</span>  <span class="fl">50.10422</span>  <span class="fl">50.87003</span>  <span class="fl">51.63583</span>  <span class="fl">52.40164</span> 
<span class="op">&gt;</span><span class="st">         </span><span class="dv">8</span>         <span class="dv">9</span>        <span class="dv">10</span>        <span class="dv">11</span>        <span class="dv">12</span>        <span class="dv">13</span>        <span class="dv">14</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">53.16744</span>  <span class="fl">53.93324</span>  <span class="fl">54.69905</span>  <span class="fl">55.46485</span>  <span class="fl">56.23066</span>  <span class="fl">56.99646</span>  <span class="fl">57.76226</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">15</span>        <span class="dv">16</span>        <span class="dv">17</span>        <span class="dv">18</span>        <span class="dv">19</span>        <span class="dv">20</span>        <span class="dv">21</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">58.52807</span>  <span class="fl">59.29387</span>  <span class="fl">60.05968</span>  <span class="fl">60.82548</span>  <span class="fl">61.59128</span>  <span class="fl">62.35709</span>  <span class="fl">63.12289</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">22</span>        <span class="dv">23</span>        <span class="dv">24</span>        <span class="dv">25</span>        <span class="dv">26</span>        <span class="dv">27</span>        <span class="dv">28</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">63.88870</span>  <span class="fl">64.65450</span>  <span class="fl">65.42030</span>  <span class="fl">66.18611</span>  <span class="fl">66.95191</span>  <span class="fl">67.71772</span>  <span class="fl">68.48352</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">29</span>        <span class="dv">30</span>        <span class="dv">31</span>        <span class="dv">32</span>        <span class="dv">33</span>        <span class="dv">34</span>        <span class="dv">35</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">69.24933</span>  <span class="fl">70.01513</span>  <span class="fl">70.78093</span>  <span class="fl">71.54674</span>  <span class="fl">72.31254</span>  <span class="fl">73.07835</span>  <span class="fl">73.84415</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">36</span>        <span class="dv">37</span>        <span class="dv">38</span>        <span class="dv">39</span>        <span class="dv">40</span>        <span class="dv">41</span>        <span class="dv">42</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">74.60995</span>  <span class="fl">75.37576</span>  <span class="fl">76.14156</span>  <span class="fl">76.90737</span>  <span class="fl">77.67317</span>  <span class="fl">78.43897</span>  <span class="fl">79.20478</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">43</span>        <span class="dv">44</span>        <span class="dv">45</span>        <span class="dv">46</span>        <span class="dv">47</span>        <span class="dv">48</span>        <span class="dv">49</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">79.97058</span>  <span class="fl">80.73639</span>  <span class="fl">81.50219</span>  <span class="fl">82.26799</span>  <span class="fl">83.03380</span>  <span class="fl">83.79960</span>  <span class="fl">84.56541</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">50</span>        <span class="dv">51</span>        <span class="dv">52</span>        <span class="dv">53</span>        <span class="dv">54</span>        <span class="dv">55</span>        <span class="dv">56</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">85.33121</span>  <span class="fl">86.09702</span>  <span class="fl">86.86282</span>  <span class="fl">87.62862</span>  <span class="fl">88.39443</span>  <span class="fl">89.16023</span>  <span class="fl">89.92604</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">57</span>        <span class="dv">58</span>        <span class="dv">59</span>        <span class="dv">60</span>        <span class="dv">61</span>        <span class="dv">62</span>        <span class="dv">63</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">90.69184</span>  <span class="fl">91.45764</span>  <span class="fl">92.22345</span>  <span class="fl">92.98925</span>  <span class="fl">93.75506</span>  <span class="fl">94.52086</span>  <span class="fl">95.28666</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">64</span>        <span class="dv">65</span>        <span class="dv">66</span>        <span class="dv">67</span>        <span class="dv">68</span>        <span class="dv">69</span>        <span class="dv">70</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">96.05247</span>  <span class="fl">96.81827</span>  <span class="fl">97.58408</span>  <span class="fl">98.34988</span>  <span class="fl">99.11568</span>  <span class="fl">99.88149</span> <span class="fl">100.64729</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">71</span>        <span class="dv">72</span>        <span class="dv">73</span>        <span class="dv">74</span>        <span class="dv">75</span>        <span class="dv">76</span>        <span class="dv">77</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">101.41310</span> <span class="fl">102.17890</span> <span class="fl">102.94470</span> <span class="fl">103.71051</span> <span class="fl">104.47631</span> <span class="fl">105.24212</span> <span class="fl">106.00792</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">78</span>        <span class="dv">79</span>        <span class="dv">80</span>        <span class="dv">81</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">106.77373</span> <span class="fl">107.53953</span> <span class="fl">108.30533</span> <span class="fl">109.07114</span></code></pre></div>
<p>Det följer av ovanstående att vi på motsvarande sätt kan för varje betingat medelvärde skapa konfidensintervall. Titta i objektet <code>yhat_band$fit</code>. Då ett sådant resultat är svårt att överblicka brukar sådana presenteras grafiskt, där vi först skapar ett spridningsdiagram, lägger till regressionslinjen, sedan ritar ut de nedre och övre gränser för de betingade medelvärde med funktionen <strong>lines()</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(df<span class="op">$</span>height, df<span class="op">$</span>weight, <span class="dt">xlab =</span> <span class="st">&quot;Längd (cm)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Vikt (kg)&quot;</span>, , <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">130</span>), <span class="dt">main =</span> <span class="st">&quot;95% KI&quot;</span>)
<span class="kw">abline</span>(m1)
<span class="kw">lines</span>(xps, yhat_band<span class="op">$</span>fit[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(xps, yhat_band<span class="op">$</span>fit[,<span class="dv">3</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><strong>Betingade medelvärdet:</strong> Enligt modellen är medelvikten bland 18-åriga män som är 180cm 70.7809335kg.</li>
<li><strong>Konfidensintervall:</strong> Med 95% säkerhet är medelvikten för 18-åriga män som är 180cm mellan 69.87 och 71.69kg.</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<ul>
<li>Vid enkel linjär regression är variansen för skattningen av det betingade medelvärdet givet <span class="math inline">\(x=x_p\)</span>. <span class="math display">\[\hat{V}(\hat{y}) = s^2_\varepsilon\left(\dfrac{1}{n} + \dfrac{(x_p-\bar{x})^2}{\sum_{i=1}^n (x_i - \bar{x})^2} \right),\]</span> där <span class="math inline">\(s_\varepsilon^2\)</span> är residualvariansen.</li>
<li>Bäst precision för skattningen av det betingade medelvärdet erhålls när vi betingar på medelvärdet för <span class="math inline">\(x\)</span>. Då blir den andra termen i variansen noll Ju längre bort från medelvärdet, desto sämre precision. Detta illustreras tydligt om vi ser på konfidensintervallen.</li>
<li>Beräkningarna för konfidensintervall baseras på normalapproximation där <span class="math inline">\(\hat{y}\)</span> är approximativt normalfördelad i stora stickprov.</li>
<li>I stora stickprov är <span class="math display">\[z=\dfrac{\hat{y}-\mu^0_{y|x=xp}}{\sqrt{\hat{V}(\hat{y})}}\]</span> appoximativt <span class="math inline">\(N(0,1)\)</span> om nollhypotesen <span class="math inline">\(H_0: \mu_{y|x=xp} = \mu^0_{y|x=x_p}\)</span> är sann. Notera att denna formulering av nollhypotesen döljer det viktiga antagandet att den linjära regressionsmodellen i övrigt är sann.</li>
</ul>
</div>
<hr />
</div>
<div id="prediktion" class="section level2">
<h2><span class="header-section-number">11.6</span> Prediktion</h2>
<p>Prediktion innebär en förutsägelse för vilket värde en ny observation kommer att ha, dvs <span class="math inline">\(y^*_i\)</span>, givet information om <span class="math inline">\(x_i\)</span>. Om linjär regression används för prediktion bygger prediktionen på skattningen av modellen <span class="math display">\[y_i = \beta_0 + \beta_1 x + \varepsilon_i\]</span></p>
<p>Det visar sig att prediktionen blir samma som skattningen för det betingade medelvärde. Anta att vi önskar göra prediktion avseende vikten för en 18-årig man som mönstrar. Om vi vet mannen är 180 cm så är prediktionen för vikten. Vår bästa gissning.</p>
<p>För att erhålla ett prediktionsintervall för en individs vikt givet individens kroppslängd kan man lägga till <code>interval = &quot;prediction&quot;</code> i <strong>predict()</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xp &lt;-<span class="st"> </span><span class="dv">180</span>
new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">height =</span> xp)
y_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(m1, new, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)
y_pred
<span class="op">&gt;</span><span class="st"> </span><span class="er">$</span>fit
<span class="op">&gt;</span><span class="st">        </span>fit      lwr      upr
<span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="fl">70.78093</span> <span class="fl">52.73871</span> <span class="fl">88.82315</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>se.fit
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">0.4623976</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>df
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">398</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="er">$</span>residual.scale
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">9.165734</span></code></pre></div>
<p>Komponenten <code>$fit$</code> består av tre delar, där <code>y_pred$fit[1]</code> är prediktionen, <code>y_pred$fit[2]</code> den nedre och <code>y_pred$fit[3]</code> den övre gränsen av det framräknade prediktionsintervallet Således kan vi säga att givet att vi mäter längden för en 18-årig man till 180cm är så är vikten med 95% <strong>sannolikhet</strong> mellan 52.74 och 88.82kg.</p>
<p>Detta går även att räkna ut manuellt baserat på den formler som vi har.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hämtar Residualspridningen från objektet sum_m1</span>
ypred.se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sum_m1<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>sum_m1<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span>( <span class="dv">1</span><span class="op">/</span>(m1<span class="op">$</span>df.residual <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(xp <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>height))<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sum</span>( (df<span class="op">$</span>height <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(df<span class="op">$</span>height) )<span class="op">^</span><span class="dv">2</span> )))
z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)
ypred.LL &lt;-<span class="st"> </span>yhat<span class="op">$</span>fit[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>z<span class="op">*</span>ypred.se
ypred.UL &lt;-<span class="st"> </span>yhat<span class="op">$</span>fit[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>z<span class="op">*</span>ypred.se
ypred_PI &lt;-<span class="st"> </span><span class="kw">c</span>(yhat.LL, yhat.UL)
ypred_PI
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="fl">69.87465</span> <span class="fl">71.68722</span></code></pre></div>
<p>Om man önskar göra skattningar av det betingade medelvärdet för flera <span class="math inline">\(x\)</span>-värden konstruerar vi ett data frame med flera <span class="math inline">\(x_p\)</span>. Observera att om detta görs för alla <span class="math inline">\(x\)</span> så är detta regressionlinjen!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xps &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">150</span>, <span class="dt">to =</span> <span class="dv">230</span>, <span class="dt">by =</span> <span class="dv">1</span>)
news &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">height =</span> xps)
ypred_band &lt;-<span class="st"> </span><span class="kw">predict</span>(m1, news, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>)
ypred_band<span class="op">$</span>fit[,<span class="dv">1</span>]
<span class="op">&gt;</span><span class="st">         </span><span class="dv">1</span>         <span class="dv">2</span>         <span class="dv">3</span>         <span class="dv">4</span>         <span class="dv">5</span>         <span class="dv">6</span>         <span class="dv">7</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">47.80681</span>  <span class="fl">48.57262</span>  <span class="fl">49.33842</span>  <span class="fl">50.10422</span>  <span class="fl">50.87003</span>  <span class="fl">51.63583</span>  <span class="fl">52.40164</span> 
<span class="op">&gt;</span><span class="st">         </span><span class="dv">8</span>         <span class="dv">9</span>        <span class="dv">10</span>        <span class="dv">11</span>        <span class="dv">12</span>        <span class="dv">13</span>        <span class="dv">14</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">53.16744</span>  <span class="fl">53.93324</span>  <span class="fl">54.69905</span>  <span class="fl">55.46485</span>  <span class="fl">56.23066</span>  <span class="fl">56.99646</span>  <span class="fl">57.76226</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">15</span>        <span class="dv">16</span>        <span class="dv">17</span>        <span class="dv">18</span>        <span class="dv">19</span>        <span class="dv">20</span>        <span class="dv">21</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">58.52807</span>  <span class="fl">59.29387</span>  <span class="fl">60.05968</span>  <span class="fl">60.82548</span>  <span class="fl">61.59128</span>  <span class="fl">62.35709</span>  <span class="fl">63.12289</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">22</span>        <span class="dv">23</span>        <span class="dv">24</span>        <span class="dv">25</span>        <span class="dv">26</span>        <span class="dv">27</span>        <span class="dv">28</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">63.88870</span>  <span class="fl">64.65450</span>  <span class="fl">65.42030</span>  <span class="fl">66.18611</span>  <span class="fl">66.95191</span>  <span class="fl">67.71772</span>  <span class="fl">68.48352</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">29</span>        <span class="dv">30</span>        <span class="dv">31</span>        <span class="dv">32</span>        <span class="dv">33</span>        <span class="dv">34</span>        <span class="dv">35</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">69.24933</span>  <span class="fl">70.01513</span>  <span class="fl">70.78093</span>  <span class="fl">71.54674</span>  <span class="fl">72.31254</span>  <span class="fl">73.07835</span>  <span class="fl">73.84415</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">36</span>        <span class="dv">37</span>        <span class="dv">38</span>        <span class="dv">39</span>        <span class="dv">40</span>        <span class="dv">41</span>        <span class="dv">42</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">74.60995</span>  <span class="fl">75.37576</span>  <span class="fl">76.14156</span>  <span class="fl">76.90737</span>  <span class="fl">77.67317</span>  <span class="fl">78.43897</span>  <span class="fl">79.20478</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">43</span>        <span class="dv">44</span>        <span class="dv">45</span>        <span class="dv">46</span>        <span class="dv">47</span>        <span class="dv">48</span>        <span class="dv">49</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">79.97058</span>  <span class="fl">80.73639</span>  <span class="fl">81.50219</span>  <span class="fl">82.26799</span>  <span class="fl">83.03380</span>  <span class="fl">83.79960</span>  <span class="fl">84.56541</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">50</span>        <span class="dv">51</span>        <span class="dv">52</span>        <span class="dv">53</span>        <span class="dv">54</span>        <span class="dv">55</span>        <span class="dv">56</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">85.33121</span>  <span class="fl">86.09702</span>  <span class="fl">86.86282</span>  <span class="fl">87.62862</span>  <span class="fl">88.39443</span>  <span class="fl">89.16023</span>  <span class="fl">89.92604</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">57</span>        <span class="dv">58</span>        <span class="dv">59</span>        <span class="dv">60</span>        <span class="dv">61</span>        <span class="dv">62</span>        <span class="dv">63</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">90.69184</span>  <span class="fl">91.45764</span>  <span class="fl">92.22345</span>  <span class="fl">92.98925</span>  <span class="fl">93.75506</span>  <span class="fl">94.52086</span>  <span class="fl">95.28666</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">64</span>        <span class="dv">65</span>        <span class="dv">66</span>        <span class="dv">67</span>        <span class="dv">68</span>        <span class="dv">69</span>        <span class="dv">70</span> 
<span class="op">&gt;</span><span class="st">  </span><span class="fl">96.05247</span>  <span class="fl">96.81827</span>  <span class="fl">97.58408</span>  <span class="fl">98.34988</span>  <span class="fl">99.11568</span>  <span class="fl">99.88149</span> <span class="fl">100.64729</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">71</span>        <span class="dv">72</span>        <span class="dv">73</span>        <span class="dv">74</span>        <span class="dv">75</span>        <span class="dv">76</span>        <span class="dv">77</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">101.41310</span> <span class="fl">102.17890</span> <span class="fl">102.94470</span> <span class="fl">103.71051</span> <span class="fl">104.47631</span> <span class="fl">105.24212</span> <span class="fl">106.00792</span> 
<span class="op">&gt;</span><span class="st">        </span><span class="dv">78</span>        <span class="dv">79</span>        <span class="dv">80</span>        <span class="dv">81</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="fl">106.77373</span> <span class="fl">107.53953</span> <span class="fl">108.30533</span> <span class="fl">109.07114</span></code></pre></div>
<p>Det följer av ovanstående att vi på motsvarande sätt kan för varje betingat medelvärde skapa konfidensintervall. Titta i objektet <code>ypred_band$fit</code>. Då ett sådant resultat är svårt att överblicka brukar sådana presenteras grafiskt, där vi först skapar ett spridningsdiagram, lägger till regressionslinjen, sedan ritar ut de nedre och övre gränser för de betingade medelvärde med funktionen <strong>lines()</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(df<span class="op">$</span>height, df<span class="op">$</span>weight, <span class="dt">xlab =</span> <span class="st">&quot;Längd (cm)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Vikt (kg)&quot;</span>, 
     <span class="dt">main =</span> <span class="st">&quot;95% PI&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">130</span>)) 
<span class="kw">abline</span>(m1) 
<span class="kw">lines</span>(xps, ypred_band<span class="op">$</span>fit[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>) 
<span class="kw">lines</span>(xps, ypred_band<span class="op">$</span>fit[,<span class="dv">3</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="dpk_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>För ytterligare klargöra skillnaden mellan prediktion och skattning av begingat medelvärdet illustrerar med sambandet mellan begåvingstest, A och B vid mönstring. En prediktion innebär att om en individ på Test A får <span class="math inline">\(x_i\)</span> poäng, så gör vi en förutsägelse för vad den individen kommer erhålla när individen gör <span class="math inline">\(Test B\)</span>. Detta är olikt skattning om betingade medelsom säger att individer med <span class="math inline">\(x\)</span> poäng på Test A har i genomsnitt <span class="math inline">\(y\)</span> poäng på Test B.</p>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><strong>Betingade medelvärdet:</strong> Om vi mäter en mönstrande man och denna är 180cm så är prediktion för denna individs vikt att vikten är 70.7809335kg.</li>
<li><strong>Prediktionsintervall:</strong> Med 95% sannolikhet är vikten för 18-årig män som är 180cm mellan 52.74 och 88.82kg.</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<ul>
<li>Vid enkel linjär regression är variansen för en prediktion givet <span class="math inline">\(x=x_p\)</span>. <span class="math display">\[\hat{V}(y^*) = \hat{V}(\hat{y}) + s^2_\varepsilon = s^2_\varepsilon\left(\dfrac{1}{n} + \dfrac{(x_p-\bar{x})^2}{\sum_{i=1}^n (x_i - \bar{x})^2} \right) + s^2_\varepsilon,\]</span> där <span class="math inline">\(s_\varepsilon^2\)</span> är residualvariansen. Notera hur detta korresponderar till modellen <span class="math display">\[y_i = \beta_0 + \beta_1x_i + \varepsilon_i\]</span> där denna första delen berör precisionen av skattningarna av <span class="math inline">\(\beta_0\)</span>+ <span class="math inline">\(\beta_1\)</span> och <span class="math inline">\(s_\varepsilon^2\)</span> berör variationen i feltermen från vilken en ny observation erhålls. Precisionen an den första delen kan vi påverka med stickprovstorleken. Den andra delen Den första delen kan vi på</li>
<li>Stickprovsstorleken påverkar endast <span class="math inline">\(\hat{V}(\hat{y})\)</span>, inte <span class="math inline">\(s^2_\varepsilon\)</span>. Om den skattade modellen ger stor spridning i termer av oförklarad variation så kommer ett större stickprov inte hjälpa oss för att göra prediktioner av enskilda indivder.</li>
<li>Beräkningarna för prediktionsintervall <strong>kräver</strong> att <span class="math inline">\(\varepsilon\)</span> är normalfördelad. Centrala gränsvärdessatsen gäller inte!</li>
<li>På grund av skattning av betingat medelvärde och prediktion är förvillande lika, förväxlas dessa ofta. Även om punktskattningarna är samma så är syfte och tolkning olika!</li>
</ul>
</div>
<hr />
</div>
<div id="binära-oberoende-variabler" class="section level2">
<h2><span class="header-section-number">11.7</span> Binära oberoende variabler</h2>
<p>En binär variabel kan inkluderas både som numerisk och som faktor i funktionen <strong>lm()</strong></p>
<p>För en binär variabel kodad numeriskt 0-1 är kategorin med 0 automatiskt referenskategorin. Riktningskoefficienten tolkas som skillnaden tolkas som skillnad mellan medelvärden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Inkludera oberoende variabel som numerisk 0 1</span>
<span class="co"># Kollar variabeln ifall du inte kommer ihåg kodningen.</span>
<span class="kw">str</span>(df<span class="op">$</span>sbp130)
<span class="op">&gt;</span><span class="st">  </span>int [<span class="dv">1</span><span class="op">:</span><span class="dv">400</span>] <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> ...
m1_bin &lt;-<span class="st"> </span><span class="kw">lm</span>(dbp <span class="op">~</span><span class="st"> </span>sbp130, <span class="dt">data =</span> df)
<span class="kw">summary</span>(m1_bin)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> dbp <span class="op">~</span><span class="st"> </span>sbp130, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residuals<span class="op">:</span>
<span class="er">&gt;</span><span class="st">      </span>Min       1Q   Median       3Q      Max 
<span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="fl">22.7230</span>  <span class="op">-</span><span class="fl">7.1658</span>  <span class="op">-</span><span class="fl">0.4444</span>   <span class="fl">7.2770</span>  <span class="fl">23.8342</span> 
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    
<span class="op">&gt;</span><span class="st"> </span>(Intercept)  <span class="fl">64.7230</span>     <span class="fl">0.6710</span>  <span class="fl">96.455</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span>
<span class="er">&gt;</span><span class="st"> </span>sbp130        <span class="fl">2.4428</span>     <span class="fl">0.9814</span>   <span class="fl">2.489</span>   <span class="fl">0.0132</span> <span class="op">*</span><span class="st">  </span>
<span class="er">&gt;</span><span class="st"> </span><span class="op">---</span>
<span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">9.793</span> on <span class="dv">398</span> degrees of freedom
<span class="op">&gt;</span><span class="st"> </span>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.01533</span>, Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.01285</span> 
<span class="op">&gt;</span><span class="st"> </span>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">6.196</span> on <span class="dv">1</span> and <span class="dv">398</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.01321</span></code></pre></div>
<p>Individer med högt systoliskt blodtryck har i genomsnitt 2.44 högre blodtryck jämfört med dem som inte har högt systoliskt blodtryck.</p>
<p>Notera att variabeln <code>sbp130</code> består av heltal, vilket du kan se om du tillämpar funktionen <strong>str()</strong>. I praktiken har distinktionen numerisk eller helttal sällan betydelse, utan det viktigaste motivet är att det anger hur data sparas, dvs heltal tar mindre minne.</p>
<p>För att ändra referensgrupp om vi arbetar med 0-1-variabler krävs omkodning, mer specifikt en reversering av kategorierna.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Omkodning av 0-1-variabel</span>
df<span class="op">$</span>sbpnot130 &lt;-<span class="st"> </span><span class="ot">NA</span>
df<span class="op">$</span>sbpnot130[df<span class="op">$</span>sbp130 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
df<span class="op">$</span>sbpnot130[df<span class="op">$</span>sbp130 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
m1_bin2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dbp <span class="op">~</span><span class="st"> </span>sbpnot130, <span class="dt">data =</span> df)
m1_bin2
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> dbp <span class="op">~</span><span class="st"> </span>sbpnot130, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span>(Intercept)    sbpnot130  
<span class="op">&gt;</span><span class="st">      </span><span class="fl">67.166</span>       <span class="op">-</span><span class="fl">2.443</span></code></pre></div>
<p>Individer som inte har högt systoliskt blodtryck har i genomsnitt -2.44 lägre blodtryck jämfört med dem som har högt systoliskt blodtryck.</p>
<p>Istället för inkludera 0-1-variabeln högt systoliskt blodtryck använder vi nu faktor-variabel <code>sbphigh</code>. Kategorierna har ingen numerisk tolkning och skulle vi <code>mean(df$sbphigh)</code> skulle ge ett felmeddelande. Däremot skulle <code>mean(df$sbp130)</code> ge andelen med högt systoliskt blodtryck. Det är emellertid inga problem att inkludera faktorvariabeln i <strong>lm()</strong> utan den jämför direkt mot en referenskategori.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Inkludera oberoende variabel som numerisk 0 1</span>
m1_bin3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dbp <span class="op">~</span><span class="st"> </span>sbphigh, <span class="dt">data =</span> df)
m1_bin3
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> dbp <span class="op">~</span><span class="st"> </span>sbphigh, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">   </span>(Intercept)  sbphigh<span class="op">&gt;=</span><span class="st"> </span><span class="dv">130</span>  
<span class="op">&gt;</span><span class="st">        </span><span class="fl">64.723</span>          <span class="fl">2.443</span></code></pre></div>
<p>Återigen ser vi att individer med högt systoliskt blodtryck har i genomsnitt 2.44 högre blodtryck jämfört med dem som inte har högt systoliskt blodtryck. Det som har ändrats är namnet på koefficienten. Om vi använder <strong>summary</strong> eller <strong>str()</strong> på objektet <code>m1_bin3</code>och jämför med <code>m1_bin1</code> så ser vi några skillnader som beskriver att vi har att göra med faktor, men resultatet i sig påverkas inte.</p>
<p>För att ändra referenskategorin för en faktor-variabel används funktionen <strong>relevel()</strong>. Vi sätter nu högt systoliskt blodtryck som referenskategori.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Inkludera oberoende variabel som numerisk 0 1</span>
df<span class="op">$</span>sbphigh &lt;-<span class="st"> </span><span class="kw">relevel</span>(df<span class="op">$</span>sbphigh, <span class="dt">ref =</span> <span class="st">&quot;&gt;= 130&quot;</span>)
m1_bin4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dbp <span class="op">~</span><span class="st"> </span>sbphigh, <span class="dt">data =</span> df)
m1_bin4
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Call<span class="op">:</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> dbp <span class="op">~</span><span class="st"> </span>sbphigh, <span class="dt">data =</span> df)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>Coefficients<span class="op">:</span>
<span class="er">&gt;</span><span class="st">  </span>(Intercept)  sbphigh<span class="op">&lt;</span><span class="st"> </span><span class="dv">130</span>  
<span class="op">&gt;</span><span class="st">       </span><span class="fl">67.166</span>        <span class="op">-</span><span class="fl">2.443</span></code></pre></div>
<p>Resultatet är nu motsvarande som när vi revereserade kodning för 0-1-variabeln.</p>
<hr />
<style>
div.blue { background-color:#D1F2EB; border-radius: 5px; padding: 20px;}
</style>
<div class="blue">
<p><font size="5"> Tolkning </font></p>
<ul>
<li><strong>Punktskattning:</strong> Om en variabeln är kodad som 0-1</li>
</ul>
</div>
<hr />
<style>
div.red{ background-color:#F5B7B1; border-radius: 5px; padding: 20px;}
</style>
<div class="red">
<p><font size="5"> Kommer du ihåg? </font></p>
<ul>
<li>En binär variabel i en enkel linjär regression med kodningen 0,1 ger skillnaden i medelvärden mellan två grupper. Detta är ekvivalent med <span class="math inline">\(t\)</span>-test med lika varianser.</li>
<li>Många gånger förenklas kod, i termer att koden blir mer kompakt, om man använder faktorer istället för 0-1-variabler. Emellertid är risken större för fel om man inte är bekväm med R.</li>
</ul>
</div>
<hr />

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regressionsanalys.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multipel-linjär-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
