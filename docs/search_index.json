[
["tabeller.html", "Kapitel 7 Tabeller", " Kapitel 7 Tabeller table() används för att skapa tabeller i R. Vi exemplifierar med data # Skapa en population och urval # Läs in data. Vi ska välja ut födda 1961 och födda 1975. insark &lt;- read.csv2(&quot;D:/conscriptiondata.csv&quot;) # Välja ut insark för födda 1961 insark1 &lt;- insark[insark$year == 1961,] # Välj ut INSARK för födda 1975 insark2 &lt;- insark[insark$year == 1975,] # Skapa ett dataset av INSARK 1961 och 1975. insark3 &lt;- rbind(insark1, insark2) # Skapa nytt rad id baserat på delpopulationen 1961 och 1975 insark3$newid &lt;- 1:length(insark3$id) # Dra urval n &lt;- 1000 set.seed(12345) df &lt;- insark3[sample(insark3$newid, n), ] df$psych_cat &lt;- factor(df$psych, ordered=TRUE) df$muscle_cat &lt;- factor(df$muscle, ordered=TRUE) table(df$muscle_cat) &gt; &gt; 2 3 4 5 6 7 8 9 &gt; 6 88 189 181 193 107 82 154 table1 &lt;- table(df$muscle_cat, df$year) str(table1) &gt; &#39;table&#39; int [1:8, 1:2] 3 59 103 73 98 44 35 57 3 29 ... &gt; - attr(*, &quot;dimnames&quot;)=List of 2 &gt; ..$ : chr [1:8] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ... &gt; ..$ : chr [1:2] &quot;1961&quot; &quot;1975&quot; table1 &gt; &gt; 1961 1975 &gt; 2 3 3 &gt; 3 59 29 &gt; 4 103 86 &gt; 5 73 108 &gt; 6 98 95 &gt; 7 44 63 &gt; 8 35 47 &gt; 9 57 97 table2 &lt;- addmargins(table1) table2 &gt; &gt; 1961 1975 Sum &gt; 2 3 3 6 &gt; 3 59 29 88 &gt; 4 103 86 189 &gt; 5 73 108 181 &gt; 6 98 95 193 &gt; 7 44 63 107 &gt; 8 35 47 82 &gt; 9 57 97 154 &gt; Sum 472 528 1000 prop.table(table1) &gt; &gt; 1961 1975 &gt; 2 0.003 0.003 &gt; 3 0.059 0.029 &gt; 4 0.103 0.086 &gt; 5 0.073 0.108 &gt; 6 0.098 0.095 &gt; 7 0.044 0.063 &gt; 8 0.035 0.047 &gt; 9 0.057 0.097 prop.table(table1, 1) &gt; &gt; 1961 1975 &gt; 2 0.5000000 0.5000000 &gt; 3 0.6704545 0.3295455 &gt; 4 0.5449735 0.4550265 &gt; 5 0.4033149 0.5966851 &gt; 6 0.5077720 0.4922280 &gt; 7 0.4112150 0.5887850 &gt; 8 0.4268293 0.5731707 &gt; 9 0.3701299 0.6298701 prop.table(table1, 2) &gt; &gt; 1961 1975 &gt; 2 0.006355932 0.005681818 &gt; 3 0.125000000 0.054924242 &gt; 4 0.218220339 0.162878788 &gt; 5 0.154661017 0.204545455 &gt; 6 0.207627119 0.179924242 &gt; 7 0.093220339 0.119318182 &gt; 8 0.074152542 0.089015152 &gt; 9 0.120762712 0.183712121 library(&quot;descr&quot;) library(&quot;xtable&quot;) tableA &lt;- CrossTable(df$muscle_cat, df$year) Warning in chisq.test(tab, correct = FALSE, ...): Chi-squared approximation may be incorrect tableA Cell Contents |-------------------------| | N | | Chi-square contribution | | N / Row Total | | N / Col Total | | N / Table Total | |-------------------------| ====================================== df$year df$muscle_cat 1961 1975 Total -------------------------------------- 2 3 3 6 0.010 0.009 0.500 0.500 0.006 0.006 0.006 0.003 0.003 -------------------------------------- 3 59 29 88 7.343 6.564 0.670 0.330 0.088 0.125 0.055 0.059 0.029 -------------------------------------- 4 103 86 189 2.132 1.906 0.545 0.455 0.189 0.218 0.163 0.103 0.086 -------------------------------------- 5 73 108 181 1.809 1.617 0.403 0.597 0.181 0.155 0.205 0.073 0.108 -------------------------------------- 6 98 95 193 0.523 0.468 0.508 0.492 0.193 0.208 0.180 0.098 0.095 -------------------------------------- 7 44 63 107 0.838 0.749 0.411 0.589 0.107 0.093 0.119 0.044 0.063 -------------------------------------- 8 35 47 82 0.354 0.317 0.427 0.573 0.082 0.074 0.089 0.035 0.047 -------------------------------------- 9 57 97 154 3.386 3.027 0.370 0.630 0.154 0.121 0.184 0.057 0.097 -------------------------------------- Total 472 528 1000 0.472 0.528 ====================================== tableA &lt;- CrossTable(df$muscle_cat, df$year) Warning in chisq.test(tab, correct = FALSE, ...): Chi-squared approximation may be incorrect A &lt;- CrossTable(df$muscle_cat, df$year, prop.r = FALSE, prop.c = TRUE, prop.t = FALSE, chisq=FALSE) Warning in chisq.test(tab, correct = FALSE, ...): Chi-squared approximation may be incorrect print(xtable(A), type=&quot;html&quot;, file=&quot;D:/tableA.html&quot;) n &lt;- 4000 n1 &lt;- 2000 n0 &lt;- 2000 p1 &lt;- 0.075 p0 &lt;- 0.09 d1 &lt;- p1*n1 d0 &lt;- p0*n0 y &lt;- c(rep(1, d1), rep(0, n1-d1), rep(1, d0), rep(0, n0-d0)) x &lt;- c(rep(1, n1), rep(0, n0)) table1 &lt;- table(x,y) table1 &lt;- table(df$year, df$muscle) ptable1 &lt;- prop.table(table1) chisq.test(df$year, df$muscle) Warning in chisq.test(df$year, df$muscle): Chi-squared approximation may be incorrect Pearson&#39;s Chi-squared test data: df$year and df$muscle X-squared = 31.052, df = 7, p-value = 6.082e-05 wilcox.test(df$muscle ~ df$year) Wilcoxon rank sum test with continuity correction data: df$muscle by df$year W = 105225, p-value = 1.652e-05 alternative hypothesis: true location shift is not equal to 0 barplot(ptable1, beside=TRUE, xlab=&quot;Medicinsk kapacitet (Muskelkraft)&quot;, ylab=&quot;Andel (%)&quot;, col=c(&quot;lightblue&quot;, &quot;darkblue&quot;)) legend(&quot;topleft&quot;, c(&quot;1961&quot;,&quot;1975&quot;), cex=1.3, bty=&quot;n&quot;, fill=c(&quot;lightblue&quot;, &quot;darkblue&quot;)) # Fall 3 Kx2 tabeller table2 &lt;- table(df$muscle, df$year) ptable2 &lt;- prop.table(table2) chisq.test(df$year, df$muscle) Warning in chisq.test(df$year, df$muscle): Chi-squared approximation may be incorrect Pearson&#39;s Chi-squared test data: df$year and df$muscle X-squared = 31.052, df = 7, p-value = 6.082e-05 wilcox.test(df$muscle ~ df$year) Wilcoxon rank sum test with continuity correction data: df$muscle by df$year W = 105225, p-value = 1.652e-05 alternative hypothesis: true location shift is not equal to 0 barplot(ptable2, beside=TRUE, xlab=&quot;Medicinsk kapacitet (Muskelkraft)&quot;, ylab=&quot;Andel (%)&quot;, col=c(&quot;lightblue&quot;, &quot;darkblue&quot;)) legend(&quot;topleft&quot;, c(&quot;1961&quot;,&quot;1975&quot;), cex=1.3, bty=&quot;n&quot;, fill=c(&quot;lightblue&quot;, &quot;darkblue&quot;)) "]
]
